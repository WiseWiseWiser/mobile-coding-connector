const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MockupsPage-C6XuI1tw.js","assets/MockupsPage-B9rBOOSO.css"])))=>i.map(i=>d[i]);
(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const c of l)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function i(l){const c={};return l.integrity&&(c.integrity=l.integrity),l.referrerPolicy&&(c.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?c.credentials="include":l.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(l){if(l.ep)return;l.ep=!0;const c=i(l);fetch(l.href,c)}})();function Km(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Wd={exports:{}},Nl={};var Ay;function Ej(){if(Ay)return Nl;Ay=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function i(r,l,c){var u=null;if(c!==void 0&&(u=""+c),l.key!==void 0&&(u=""+l.key),"key"in l){c={};for(var d in l)d!=="key"&&(c[d]=l[d])}else c=l;return l=c.ref,{$$typeof:e,type:r,key:u,ref:l!==void 0?l:null,props:c}}return Nl.Fragment=t,Nl.jsx=i,Nl.jsxs=i,Nl}var Ly;function Tj(){return Ly||(Ly=1,Wd.exports=Ej()),Wd.exports}var a=Tj(),Vd={exports:{}},Te={};var My;function Rj(){if(My)return Te;My=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),c=Symbol.for("react.consumer"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),_=Symbol.for("react.activity"),S=Symbol.iterator;function x(P){return P===null||typeof P!="object"?null:(P=S&&P[S]||P["@@iterator"],typeof P=="function"?P:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,T={};function k(P,H,L){this.props=P,this.context=H,this.refs=T,this.updater=L||b}k.prototype.isReactComponent={},k.prototype.setState=function(P,H){if(typeof P!="object"&&typeof P!="function"&&P!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,P,H,"setState")},k.prototype.forceUpdate=function(P){this.updater.enqueueForceUpdate(this,P,"forceUpdate")};function R(){}R.prototype=k.prototype;function N(P,H,L){this.props=P,this.context=H,this.refs=T,this.updater=L||b}var E=N.prototype=new R;E.constructor=N,C(E,k.prototype),E.isPureReactComponent=!0;var z=Array.isArray;function B(){}var I={H:null,A:null,T:null,S:null},q=Object.prototype.hasOwnProperty;function F(P,H,L){var re=L.ref;return{$$typeof:e,type:P,key:H,ref:re!==void 0?re:null,props:L}}function V(P,H){return F(P.type,H,P.props)}function G(P){return typeof P=="object"&&P!==null&&P.$$typeof===e}function Y(P){var H={"=":"=0",":":"=2"};return"$"+P.replace(/[=:]/g,function(L){return H[L]})}var M=/\/+/g;function j(P,H){return typeof P=="object"&&P!==null&&P.key!=null?Y(""+P.key):H.toString(36)}function A(P){switch(P.status){case"fulfilled":return P.value;case"rejected":throw P.reason;default:switch(typeof P.status=="string"?P.then(B,B):(P.status="pending",P.then(function(H){P.status==="pending"&&(P.status="fulfilled",P.value=H)},function(H){P.status==="pending"&&(P.status="rejected",P.reason=H)})),P.status){case"fulfilled":return P.value;case"rejected":throw P.reason}}throw P}function D(P,H,L,re,me){var he=typeof P;(he==="undefined"||he==="boolean")&&(P=null);var de=!1;if(P===null)de=!0;else switch(he){case"bigint":case"string":case"number":de=!0;break;case"object":switch(P.$$typeof){case e:case t:de=!0;break;case v:return de=P._init,D(de(P._payload),H,L,re,me)}}if(de)return me=me(P),de=re===""?"."+j(P,0):re,z(me)?(L="",de!=null&&(L=de.replace(M,"$&/")+"/"),D(me,H,L,"",function(ue){return ue})):me!=null&&(G(me)&&(me=V(me,L+(me.key==null||P&&P.key===me.key?"":(""+me.key).replace(M,"$&/")+"/")+de)),H.push(me)),1;de=0;var oe=re===""?".":re+":";if(z(P))for(var ye=0;ye<P.length;ye++)re=P[ye],he=oe+j(re,ye),de+=D(re,H,L,he,me);else if(ye=x(P),typeof ye=="function")for(P=ye.call(P),ye=0;!(re=P.next()).done;)re=re.value,he=oe+j(re,ye++),de+=D(re,H,L,he,me);else if(he==="object"){if(typeof P.then=="function")return D(A(P),H,L,re,me);throw H=String(P),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(P).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return de}function $(P,H,L){if(P==null)return P;var re=[],me=0;return D(P,re,"","",function(he){return H.call(L,he,me++)}),re}function W(P){if(P._status===-1){var H=P._result;H=H(),H.then(function(L){(P._status===0||P._status===-1)&&(P._status=1,P._result=L)},function(L){(P._status===0||P._status===-1)&&(P._status=2,P._result=L)}),P._status===-1&&(P._status=0,P._result=H)}if(P._status===1)return P._result.default;throw P._result}var ne=typeof reportError=="function"?reportError:function(P){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof P=="object"&&P!==null&&typeof P.message=="string"?String(P.message):String(P),error:P});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",P);return}console.error(P)},U={map:$,forEach:function(P,H,L){$(P,function(){H.apply(this,arguments)},L)},count:function(P){var H=0;return $(P,function(){H++}),H},toArray:function(P){return $(P,function(H){return H})||[]},only:function(P){if(!G(P))throw Error("React.Children.only expected to receive a single React element child.");return P}};return Te.Activity=_,Te.Children=U,Te.Component=k,Te.Fragment=i,Te.Profiler=l,Te.PureComponent=N,Te.StrictMode=r,Te.Suspense=m,Te.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=I,Te.__COMPILER_RUNTIME={__proto__:null,c:function(P){return I.H.useMemoCache(P)}},Te.cache=function(P){return function(){return P.apply(null,arguments)}},Te.cacheSignal=function(){return null},Te.cloneElement=function(P,H,L){if(P==null)throw Error("The argument must be a React element, but you passed "+P+".");var re=C({},P.props),me=P.key;if(H!=null)for(he in H.key!==void 0&&(me=""+H.key),H)!q.call(H,he)||he==="key"||he==="__self"||he==="__source"||he==="ref"&&H.ref===void 0||(re[he]=H[he]);var he=arguments.length-2;if(he===1)re.children=L;else if(1<he){for(var de=Array(he),oe=0;oe<he;oe++)de[oe]=arguments[oe+2];re.children=de}return F(P.type,me,re)},Te.createContext=function(P){return P={$$typeof:u,_currentValue:P,_currentValue2:P,_threadCount:0,Provider:null,Consumer:null},P.Provider=P,P.Consumer={$$typeof:c,_context:P},P},Te.createElement=function(P,H,L){var re,me={},he=null;if(H!=null)for(re in H.key!==void 0&&(he=""+H.key),H)q.call(H,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(me[re]=H[re]);var de=arguments.length-2;if(de===1)me.children=L;else if(1<de){for(var oe=Array(de),ye=0;ye<de;ye++)oe[ye]=arguments[ye+2];me.children=oe}if(P&&P.defaultProps)for(re in de=P.defaultProps,de)me[re]===void 0&&(me[re]=de[re]);return F(P,he,me)},Te.createRef=function(){return{current:null}},Te.forwardRef=function(P){return{$$typeof:d,render:P}},Te.isValidElement=G,Te.lazy=function(P){return{$$typeof:v,_payload:{_status:-1,_result:P},_init:W}},Te.memo=function(P,H){return{$$typeof:f,type:P,compare:H===void 0?null:H}},Te.startTransition=function(P){var H=I.T,L={};I.T=L;try{var re=P(),me=I.S;me!==null&&me(L,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(B,ne)}catch(he){ne(he)}finally{H!==null&&L.types!==null&&(H.types=L.types),I.T=H}},Te.unstable_useCacheRefresh=function(){return I.H.useCacheRefresh()},Te.use=function(P){return I.H.use(P)},Te.useActionState=function(P,H,L){return I.H.useActionState(P,H,L)},Te.useCallback=function(P,H){return I.H.useCallback(P,H)},Te.useContext=function(P){return I.H.useContext(P)},Te.useDebugValue=function(){},Te.useDeferredValue=function(P,H){return I.H.useDeferredValue(P,H)},Te.useEffect=function(P,H){return I.H.useEffect(P,H)},Te.useEffectEvent=function(P){return I.H.useEffectEvent(P)},Te.useId=function(){return I.H.useId()},Te.useImperativeHandle=function(P,H,L){return I.H.useImperativeHandle(P,H,L)},Te.useInsertionEffect=function(P,H){return I.H.useInsertionEffect(P,H)},Te.useLayoutEffect=function(P,H){return I.H.useLayoutEffect(P,H)},Te.useMemo=function(P,H){return I.H.useMemo(P,H)},Te.useOptimistic=function(P,H){return I.H.useOptimistic(P,H)},Te.useReducer=function(P,H,L){return I.H.useReducer(P,H,L)},Te.useRef=function(P){return I.H.useRef(P)},Te.useState=function(P){return I.H.useState(P)},Te.useSyncExternalStore=function(P,H,L){return I.H.useSyncExternalStore(P,H,L)},Te.useTransition=function(){return I.H.useTransition()},Te.version="19.2.4",Te}var By;function qm(){return By||(By=1,Vd.exports=Rj()),Vd.exports}var y=qm();const fr=Km(y);var Gd={exports:{}},El={},Yd={exports:{}},Xd={};var Oy;function Dj(){return Oy||(Oy=1,(function(e){function t(D,$){var W=D.length;D.push($);e:for(;0<W;){var ne=W-1>>>1,U=D[ne];if(0<l(U,$))D[ne]=$,D[W]=U,W=ne;else break e}}function i(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var $=D[0],W=D.pop();if(W!==$){D[0]=W;e:for(var ne=0,U=D.length,P=U>>>1;ne<P;){var H=2*(ne+1)-1,L=D[H],re=H+1,me=D[re];if(0>l(L,W))re<U&&0>l(me,L)?(D[ne]=me,D[re]=W,ne=re):(D[ne]=L,D[H]=W,ne=H);else if(re<U&&0>l(me,W))D[ne]=me,D[re]=W,ne=re;else break e}}return $}function l(D,$){var W=D.sortIndex-$.sortIndex;return W!==0?W:D.id-$.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var c=performance;e.unstable_now=function(){return c.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var m=[],f=[],v=1,_=null,S=3,x=!1,b=!1,C=!1,T=!1,k=typeof setTimeout=="function"?setTimeout:null,R=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function E(D){for(var $=i(f);$!==null;){if($.callback===null)r(f);else if($.startTime<=D)r(f),$.sortIndex=$.expirationTime,t(m,$);else break;$=i(f)}}function z(D){if(C=!1,E(D),!b)if(i(m)!==null)b=!0,B||(B=!0,Y());else{var $=i(f);$!==null&&A(z,$.startTime-D)}}var B=!1,I=-1,q=5,F=-1;function V(){return T?!0:!(e.unstable_now()-F<q)}function G(){if(T=!1,B){var D=e.unstable_now();F=D;var $=!0;try{e:{b=!1,C&&(C=!1,R(I),I=-1),x=!0;var W=S;try{t:{for(E(D),_=i(m);_!==null&&!(_.expirationTime>D&&V());){var ne=_.callback;if(typeof ne=="function"){_.callback=null,S=_.priorityLevel;var U=ne(_.expirationTime<=D);if(D=e.unstable_now(),typeof U=="function"){_.callback=U,E(D),$=!0;break t}_===i(m)&&r(m),E(D)}else r(m);_=i(m)}if(_!==null)$=!0;else{var P=i(f);P!==null&&A(z,P.startTime-D),$=!1}}break e}finally{_=null,S=W,x=!1}$=void 0}}finally{$?Y():B=!1}}}var Y;if(typeof N=="function")Y=function(){N(G)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,j=M.port2;M.port1.onmessage=G,Y=function(){j.postMessage(null)}}else Y=function(){k(G,0)};function A(D,$){I=k(function(){D(e.unstable_now())},$)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(D){D.callback=null},e.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):q=0<D?Math.floor(1e3/D):5},e.unstable_getCurrentPriorityLevel=function(){return S},e.unstable_next=function(D){switch(S){case 1:case 2:case 3:var $=3;break;default:$=S}var W=S;S=$;try{return D()}finally{S=W}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(D,$){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var W=S;S=D;try{return $()}finally{S=W}},e.unstable_scheduleCallback=function(D,$,W){var ne=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?ne+W:ne):W=ne,D){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=W+U,D={id:v++,callback:$,priorityLevel:D,startTime:W,expirationTime:U,sortIndex:-1},W>ne?(D.sortIndex=W,t(f,D),i(m)===null&&D===i(f)&&(C?(R(I),I=-1):C=!0,A(z,W-ne))):(D.sortIndex=U,t(m,D),b||x||(b=!0,B||(B=!0,Y()))),D},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(D){var $=S;return function(){var W=S;S=$;try{return D.apply(this,arguments)}finally{S=W}}}})(Xd)),Xd}var zy;function Aj(){return zy||(zy=1,Yd.exports=Dj()),Yd.exports}var Jd={exports:{}},Jt={};var Py;function Lj(){if(Py)return Jt;Py=1;var e=qm();function t(m){var f="https://react.dev/errors/"+m;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var v=2;v<arguments.length;v++)f+="&args[]="+encodeURIComponent(arguments[v])}return"Minified React error #"+m+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(){}var r={d:{f:i,r:function(){throw Error(t(522))},D:i,C:i,L:i,m:i,X:i,S:i,M:i},p:0,findDOMNode:null},l=Symbol.for("react.portal");function c(m,f,v){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:l,key:_==null?null:""+_,children:m,containerInfo:f,implementation:v}}var u=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function d(m,f){if(m==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Jt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Jt.createPortal=function(m,f){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return c(m,f,null,v)},Jt.flushSync=function(m){var f=u.T,v=r.p;try{if(u.T=null,r.p=2,m)return m()}finally{u.T=f,r.p=v,r.d.f()}},Jt.preconnect=function(m,f){typeof m=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(m,f))},Jt.prefetchDNS=function(m){typeof m=="string"&&r.d.D(m)},Jt.preinit=function(m,f){if(typeof m=="string"&&f&&typeof f.as=="string"){var v=f.as,_=d(v,f.crossOrigin),S=typeof f.integrity=="string"?f.integrity:void 0,x=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;v==="style"?r.d.S(m,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:_,integrity:S,fetchPriority:x}):v==="script"&&r.d.X(m,{crossOrigin:_,integrity:S,fetchPriority:x,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Jt.preinitModule=function(m,f){if(typeof m=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var v=d(f.as,f.crossOrigin);r.d.M(m,{crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(m)},Jt.preload=function(m,f){if(typeof m=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var v=f.as,_=d(v,f.crossOrigin);r.d.L(m,v,{crossOrigin:_,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Jt.preloadModule=function(m,f){if(typeof m=="string")if(f){var v=d(f.as,f.crossOrigin);r.d.m(m,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:v,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(m)},Jt.requestFormReset=function(m){r.d.r(m)},Jt.unstable_batchedUpdates=function(m,f){return m(f)},Jt.useFormState=function(m,f,v){return u.H.useFormState(m,f,v)},Jt.useFormStatus=function(){return u.H.useHostTransitionStatus()},Jt.version="19.2.4",Jt}var Hy;function Mj(){if(Hy)return Jd.exports;Hy=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Jd.exports=Lj(),Jd.exports}var Iy;function Bj(){if(Iy)return El;Iy=1;var e=Aj(),t=qm(),i=Mj();function r(n){var s="https://react.dev/errors/"+n;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function l(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function c(n){var s=n,o=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(o=s.return),n=s.return;while(n)}return s.tag===3?o:null}function u(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function d(n){if(n.tag===31){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function m(n){if(c(n)!==n)throw Error(r(188))}function f(n){var s=n.alternate;if(!s){if(s=c(n),s===null)throw Error(r(188));return s!==n?null:n}for(var o=n,h=s;;){var p=o.return;if(p===null)break;var g=p.alternate;if(g===null){if(h=p.return,h!==null){o=h;continue}break}if(p.child===g.child){for(g=p.child;g;){if(g===o)return m(p),n;if(g===h)return m(p),s;g=g.sibling}throw Error(r(188))}if(o.return!==h.return)o=p,h=g;else{for(var w=!1,O=p.child;O;){if(O===o){w=!0,o=p,h=g;break}if(O===h){w=!0,h=p,o=g;break}O=O.sibling}if(!w){for(O=g.child;O;){if(O===o){w=!0,o=g,h=p;break}if(O===h){w=!0,h=g,o=p;break}O=O.sibling}if(!w)throw Error(r(189))}}if(o.alternate!==h)throw Error(r(190))}if(o.tag!==3)throw Error(r(188));return o.stateNode.current===o?n:s}function v(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n;for(n=n.child;n!==null;){if(s=v(n),s!==null)return s;n=n.sibling}return null}var _=Object.assign,S=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),R=Symbol.for("react.consumer"),N=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),B=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),F=Symbol.for("react.activity"),V=Symbol.for("react.memo_cache_sentinel"),G=Symbol.iterator;function Y(n){return n===null||typeof n!="object"?null:(n=G&&n[G]||n["@@iterator"],typeof n=="function"?n:null)}var M=Symbol.for("react.client.reference");function j(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===M?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case C:return"Fragment";case k:return"Profiler";case T:return"StrictMode";case z:return"Suspense";case B:return"SuspenseList";case F:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case b:return"Portal";case N:return n.displayName||"Context";case R:return(n._context.displayName||"Context")+".Consumer";case E:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case I:return s=n.displayName||null,s!==null?s:j(n.type)||"Memo";case q:s=n._payload,n=n._init;try{return j(n(s))}catch{}}return null}var A=Array.isArray,D=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$=i.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W={pending:!1,data:null,method:null,action:null},ne=[],U=-1;function P(n){return{current:n}}function H(n){0>U||(n.current=ne[U],ne[U]=null,U--)}function L(n,s){U++,ne[U]=n.current,n.current=s}var re=P(null),me=P(null),he=P(null),de=P(null);function oe(n,s){switch(L(he,s),L(me,n),L(re,null),s.nodeType){case 9:case 11:n=(n=s.documentElement)&&(n=n.namespaceURI)?ty(n):0;break;default:if(n=s.tagName,s=s.namespaceURI)s=ty(s),n=ny(s,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}H(re),L(re,n)}function ye(){H(re),H(me),H(he)}function ue(n){n.memoizedState!==null&&L(de,n);var s=re.current,o=ny(s,n.type);s!==o&&(L(me,n),L(re,o))}function Se(n){me.current===n&&(H(re),H(me)),de.current===n&&(H(de),wl._currentValue=W)}var Oe,De;function yt(n){if(Oe===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Oe=s&&s[1]||"",De=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Oe+n+De}var xe=!1;function di(n,s){if(!n||xe)return"";xe=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var le=function(){throw Error()};if(Object.defineProperty(le.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(le,[])}catch(te){var ee=te}Reflect.construct(n,[],le)}else{try{le.call()}catch(te){ee=te}n.call(le.prototype)}}else{try{throw Error()}catch(te){ee=te}(le=n())&&typeof le.catch=="function"&&le.catch(function(){})}}catch(te){if(te&&ee&&typeof te.stack=="string")return[te.stack,ee.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var g=h.DetermineComponentFrameRoot(),w=g[0],O=g[1];if(w&&O){var K=w.split(`
`),Q=O.split(`
`);for(p=h=0;h<K.length&&!K[h].includes("DetermineComponentFrameRoot");)h++;for(;p<Q.length&&!Q[p].includes("DetermineComponentFrameRoot");)p++;if(h===K.length||p===Q.length)for(h=K.length-1,p=Q.length-1;1<=h&&0<=p&&K[h]!==Q[p];)p--;for(;1<=h&&0<=p;h--,p--)if(K[h]!==Q[p]){if(h!==1||p!==1)do if(h--,p--,0>p||K[h]!==Q[p]){var se=`
`+K[h].replace(" at new "," at ");return n.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",n.displayName)),se}while(1<=h&&0<=p);break}}}finally{xe=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?yt(o):""}function br(n,s){switch(n.tag){case 26:case 27:case 5:return yt(n.type);case 16:return yt("Lazy");case 13:return n.child!==s&&s!==null?yt("Suspense Fallback"):yt("Suspense");case 19:return yt("SuspenseList");case 0:case 15:return di(n.type,!1);case 11:return di(n.type.render,!1);case 1:return di(n.type,!0);case 31:return yt("Activity");default:return""}}function fi(n){try{var s="",o=null;do s+=br(n,o),o=n,n=n.return;while(n);return s}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Kt=Object.prototype.hasOwnProperty,tn=e.unstable_scheduleCallback,Us=e.unstable_cancelCallback,wr=e.unstable_shouldYield,Fs=e.unstable_requestPaint,Ot=e.unstable_now,cn=e.unstable_getCurrentPriorityLevel,ie=e.unstable_ImmediatePriority,pe=e.unstable_UserBlockingPriority,ke=e.unstable_NormalPriority,ze=e.unstable_LowPriority,Ve=e.unstable_IdlePriority,bn=e.log,Ri=e.unstable_setDisableYieldValue,nn=null,Dt=null;function un(n){if(typeof bn=="function"&&Ri(n),Dt&&typeof Dt.setStrictMode=="function")try{Dt.setStrictMode(nn,n)}catch{}}var et=Math.clz32?Math.clz32:mw,is=Math.log,ri=Math.LN2;function mw(n){return n>>>=0,n===0?32:31-(is(n)/ri|0)|0}var yo=256,xo=262144,So=4194304;function $s(n){var s=n&42;if(s!==0)return s;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function bo(n,s,o){var h=n.pendingLanes;if(h===0)return 0;var p=0,g=n.suspendedLanes,w=n.pingedLanes;n=n.warmLanes;var O=h&134217727;return O!==0?(h=O&~g,h!==0?p=$s(h):(w&=O,w!==0?p=$s(w):o||(o=O&~n,o!==0&&(p=$s(o))))):(O=h&~g,O!==0?p=$s(O):w!==0?p=$s(w):o||(o=h&~n,o!==0&&(p=$s(o)))),p===0?0:s!==0&&s!==p&&(s&g)===0&&(g=p&-p,o=s&-s,g>=o||g===32&&(o&4194048)!==0)?s:p}function Oa(n,s){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&s)===0}function pw(n,s){switch(n){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Op(){var n=So;return So<<=1,(So&62914560)===0&&(So=4194304),n}function Mu(n){for(var s=[],o=0;31>o;o++)s.push(n);return s}function za(n,s){n.pendingLanes|=s,s!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function gw(n,s,o,h,p,g){var w=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var O=n.entanglements,K=n.expirationTimes,Q=n.hiddenUpdates;for(o=w&~o;0<o;){var se=31-et(o),le=1<<se;O[se]=0,K[se]=-1;var ee=Q[se];if(ee!==null)for(Q[se]=null,se=0;se<ee.length;se++){var te=ee[se];te!==null&&(te.lane&=-536870913)}o&=~le}h!==0&&zp(n,h,0),g!==0&&p===0&&n.tag!==0&&(n.suspendedLanes|=g&~(w&~s))}function zp(n,s,o){n.pendingLanes|=s,n.suspendedLanes&=~s;var h=31-et(s);n.entangledLanes|=s,n.entanglements[h]=n.entanglements[h]|1073741824|o&261930}function Pp(n,s){var o=n.entangledLanes|=s;for(n=n.entanglements;o;){var h=31-et(o),p=1<<h;p&s|n[h]&s&&(n[h]|=s),o&=~p}}function Hp(n,s){var o=s&-s;return o=(o&42)!==0?1:Bu(o),(o&(n.suspendedLanes|s))!==0?0:o}function Bu(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Ou(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Ip(){var n=$.p;return n!==0?n:(n=window.event,n===void 0?32:jy(n.type))}function Up(n,s){var o=$.p;try{return $.p=n,s()}finally{$.p=o}}var ss=Math.random().toString(36).slice(2),qt="__reactFiber$"+ss,hn="__reactProps$"+ss,Cr="__reactContainer$"+ss,zu="__reactEvents$"+ss,vw="__reactListeners$"+ss,_w="__reactHandles$"+ss,Fp="__reactResources$"+ss,Pa="__reactMarker$"+ss;function Pu(n){delete n[qt],delete n[hn],delete n[zu],delete n[vw],delete n[_w]}function jr(n){var s=n[qt];if(s)return s;for(var o=n.parentNode;o;){if(s=o[Cr]||o[qt]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(n=cy(n);n!==null;){if(o=n[qt])return o;n=cy(n)}return s}n=o,o=n.parentNode}return null}function kr(n){if(n=n[qt]||n[Cr]){var s=n.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return n}return null}function Ha(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n.stateNode;throw Error(r(33))}function Nr(n){var s=n[Fp];return s||(s=n[Fp]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function zt(n){n[Pa]=!0}var $p=new Set,Kp={};function Ks(n,s){Er(n,s),Er(n+"Capture",s)}function Er(n,s){for(Kp[n]=s,n=0;n<s.length;n++)$p.add(s[n])}var yw=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),qp={},Wp={};function xw(n){return Kt.call(Wp,n)?!0:Kt.call(qp,n)?!1:yw.test(n)?Wp[n]=!0:(qp[n]=!0,!1)}function wo(n,s,o){if(xw(s))if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){n.removeAttribute(s);return}}n.setAttribute(s,""+o)}}function Co(n,s,o){if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttribute(s,""+o)}}function Di(n,s,o,h){if(h===null)n.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(s,o,""+h)}}function Un(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Vp(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function Sw(n,s,o){var h=Object.getOwnPropertyDescriptor(n.constructor.prototype,s);if(!n.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var p=h.get,g=h.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return p.call(this)},set:function(w){o=""+w,g.call(this,w)}}),Object.defineProperty(n,s,{enumerable:h.enumerable}),{getValue:function(){return o},setValue:function(w){o=""+w},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function Hu(n){if(!n._valueTracker){var s=Vp(n)?"checked":"value";n._valueTracker=Sw(n,s,""+n[s])}}function Gp(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var o=s.getValue(),h="";return n&&(h=Vp(n)?n.checked?"true":"false":n.value),n=h,n!==o?(s.setValue(n),!0):!1}function jo(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var bw=/[\n"\\]/g;function Fn(n){return n.replace(bw,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Iu(n,s,o,h,p,g,w,O){n.name="",w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?n.type=w:n.removeAttribute("type"),s!=null?w==="number"?(s===0&&n.value===""||n.value!=s)&&(n.value=""+Un(s)):n.value!==""+Un(s)&&(n.value=""+Un(s)):w!=="submit"&&w!=="reset"||n.removeAttribute("value"),s!=null?Uu(n,w,Un(s)):o!=null?Uu(n,w,Un(o)):h!=null&&n.removeAttribute("value"),p==null&&g!=null&&(n.defaultChecked=!!g),p!=null&&(n.checked=p&&typeof p!="function"&&typeof p!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?n.name=""+Un(O):n.removeAttribute("name")}function Yp(n,s,o,h,p,g,w,O){if(g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"&&(n.type=g),s!=null||o!=null){if(!(g!=="submit"&&g!=="reset"||s!=null)){Hu(n);return}o=o!=null?""+Un(o):"",s=s!=null?""+Un(s):o,O||s===n.value||(n.value=s),n.defaultValue=s}h=h??p,h=typeof h!="function"&&typeof h!="symbol"&&!!h,n.checked=O?n.checked:!!h,n.defaultChecked=!!h,w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(n.name=w),Hu(n)}function Uu(n,s,o){s==="number"&&jo(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Tr(n,s,o,h){if(n=n.options,s){s={};for(var p=0;p<o.length;p++)s["$"+o[p]]=!0;for(o=0;o<n.length;o++)p=s.hasOwnProperty("$"+n[o].value),n[o].selected!==p&&(n[o].selected=p),p&&h&&(n[o].defaultSelected=!0)}else{for(o=""+Un(o),s=null,p=0;p<n.length;p++){if(n[p].value===o){n[p].selected=!0,h&&(n[p].defaultSelected=!0);return}s!==null||n[p].disabled||(s=n[p])}s!==null&&(s.selected=!0)}}function Xp(n,s,o){if(s!=null&&(s=""+Un(s),s!==n.value&&(n.value=s),o==null)){n.defaultValue!==s&&(n.defaultValue=s);return}n.defaultValue=o!=null?""+Un(o):""}function Jp(n,s,o,h){if(s==null){if(h!=null){if(o!=null)throw Error(r(92));if(A(h)){if(1<h.length)throw Error(r(93));h=h[0]}o=h}o==null&&(o=""),s=o}o=Un(s),n.defaultValue=o,h=n.textContent,h===o&&h!==""&&h!==null&&(n.value=h),Hu(n)}function Rr(n,s){if(s){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=s;return}}n.textContent=s}var ww=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Zp(n,s,o){var h=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?h?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="":h?n.setProperty(s,o):typeof o!="number"||o===0||ww.has(s)?s==="float"?n.cssFloat=o:n[s]=(""+o).trim():n[s]=o+"px"}function Qp(n,s,o){if(s!=null&&typeof s!="object")throw Error(r(62));if(n=n.style,o!=null){for(var h in o)!o.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?n.setProperty(h,""):h==="float"?n.cssFloat="":n[h]="");for(var p in s)h=s[p],s.hasOwnProperty(p)&&o[p]!==h&&Zp(n,p,h)}else for(var g in s)s.hasOwnProperty(g)&&Zp(n,g,s[g])}function Fu(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Cw=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),jw=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ko(n){return jw.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Ai(){}var $u=null;function Ku(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Dr=null,Ar=null;function eg(n){var s=kr(n);if(s&&(n=s.stateNode)){var o=n[hn]||null;e:switch(n=s.stateNode,s.type){case"input":if(Iu(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Fn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var h=o[s];if(h!==n&&h.form===n.form){var p=h[hn]||null;if(!p)throw Error(r(90));Iu(h,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<o.length;s++)h=o[s],h.form===n.form&&Gp(h)}break e;case"textarea":Xp(n,o.value,o.defaultValue);break e;case"select":s=o.value,s!=null&&Tr(n,!!o.multiple,s,!1)}}}var qu=!1;function tg(n,s,o){if(qu)return n(s,o);qu=!0;try{var h=n(s);return h}finally{if(qu=!1,(Dr!==null||Ar!==null)&&(fc(),Dr&&(s=Dr,n=Ar,Ar=Dr=null,eg(s),n)))for(s=0;s<n.length;s++)eg(n[s])}}function Ia(n,s){var o=n.stateNode;if(o===null)return null;var h=o[hn]||null;if(h===null)return null;o=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(n=n.type,h=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!h;break e;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(r(231,s,typeof o));return o}var Li=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wu=!1;if(Li)try{var Ua={};Object.defineProperty(Ua,"passive",{get:function(){Wu=!0}}),window.addEventListener("test",Ua,Ua),window.removeEventListener("test",Ua,Ua)}catch{Wu=!1}var rs=null,Vu=null,No=null;function ng(){if(No)return No;var n,s=Vu,o=s.length,h,p="value"in rs?rs.value:rs.textContent,g=p.length;for(n=0;n<o&&s[n]===p[n];n++);var w=o-n;for(h=1;h<=w&&s[o-h]===p[g-h];h++);return No=p.slice(n,1<h?1-h:void 0)}function Eo(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function To(){return!0}function ig(){return!1}function dn(n){function s(o,h,p,g,w){this._reactName=o,this._targetInst=p,this.type=h,this.nativeEvent=g,this.target=w,this.currentTarget=null;for(var O in n)n.hasOwnProperty(O)&&(o=n[O],this[O]=o?o(g):g[O]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?To:ig,this.isPropagationStopped=ig,this}return _(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=To)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=To)},persist:function(){},isPersistent:To}),s}var qs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ro=dn(qs),Fa=_({},qs,{view:0,detail:0}),kw=dn(Fa),Gu,Yu,$a,Do=_({},Fa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ju,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==$a&&($a&&n.type==="mousemove"?(Gu=n.screenX-$a.screenX,Yu=n.screenY-$a.screenY):Yu=Gu=0,$a=n),Gu)},movementY:function(n){return"movementY"in n?n.movementY:Yu}}),sg=dn(Do),Nw=_({},Do,{dataTransfer:0}),Ew=dn(Nw),Tw=_({},Fa,{relatedTarget:0}),Xu=dn(Tw),Rw=_({},qs,{animationName:0,elapsedTime:0,pseudoElement:0}),Dw=dn(Rw),Aw=_({},qs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Lw=dn(Aw),Mw=_({},qs,{data:0}),rg=dn(Mw),Bw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ow={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pw(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=zw[n])?!!s[n]:!1}function Ju(){return Pw}var Hw=_({},Fa,{key:function(n){if(n.key){var s=Bw[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=Eo(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ow[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ju,charCode:function(n){return n.type==="keypress"?Eo(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Eo(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Iw=dn(Hw),Uw=_({},Do,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ag=dn(Uw),Fw=_({},Fa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ju}),$w=dn(Fw),Kw=_({},qs,{propertyName:0,elapsedTime:0,pseudoElement:0}),qw=dn(Kw),Ww=_({},Do,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Vw=dn(Ww),Gw=_({},qs,{newState:0,oldState:0}),Yw=dn(Gw),Xw=[9,13,27,32],Zu=Li&&"CompositionEvent"in window,Ka=null;Li&&"documentMode"in document&&(Ka=document.documentMode);var Jw=Li&&"TextEvent"in window&&!Ka,lg=Li&&(!Zu||Ka&&8<Ka&&11>=Ka),og=" ",cg=!1;function ug(n,s){switch(n){case"keyup":return Xw.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hg(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Lr=!1;function Zw(n,s){switch(n){case"compositionend":return hg(s);case"keypress":return s.which!==32?null:(cg=!0,og);case"textInput":return n=s.data,n===og&&cg?null:n;default:return null}}function Qw(n,s){if(Lr)return n==="compositionend"||!Zu&&ug(n,s)?(n=ng(),No=Vu=rs=null,Lr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return lg&&s.locale!=="ko"?null:s.data;default:return null}}var eC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dg(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!eC[n.type]:s==="textarea"}function fg(n,s,o,h){Dr?Ar?Ar.push(h):Ar=[h]:Dr=h,s=xc(s,"onChange"),0<s.length&&(o=new Ro("onChange","change",null,o,h),n.push({event:o,listeners:s}))}var qa=null,Wa=null;function tC(n){Y_(n,0)}function Ao(n){var s=Ha(n);if(Gp(s))return n}function mg(n,s){if(n==="change")return s}var pg=!1;if(Li){var Qu;if(Li){var eh="oninput"in document;if(!eh){var gg=document.createElement("div");gg.setAttribute("oninput","return;"),eh=typeof gg.oninput=="function"}Qu=eh}else Qu=!1;pg=Qu&&(!document.documentMode||9<document.documentMode)}function vg(){qa&&(qa.detachEvent("onpropertychange",_g),Wa=qa=null)}function _g(n){if(n.propertyName==="value"&&Ao(Wa)){var s=[];fg(s,Wa,n,Ku(n)),tg(tC,s)}}function nC(n,s,o){n==="focusin"?(vg(),qa=s,Wa=o,qa.attachEvent("onpropertychange",_g)):n==="focusout"&&vg()}function iC(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ao(Wa)}function sC(n,s){if(n==="click")return Ao(s)}function rC(n,s){if(n==="input"||n==="change")return Ao(s)}function aC(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var wn=typeof Object.is=="function"?Object.is:aC;function Va(n,s){if(wn(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var o=Object.keys(n),h=Object.keys(s);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var p=o[h];if(!Kt.call(s,p)||!wn(n[p],s[p]))return!1}return!0}function yg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function xg(n,s){var o=yg(n);n=0;for(var h;o;){if(o.nodeType===3){if(h=n+o.textContent.length,n<=s&&h>=s)return{node:o,offset:s-n};n=h}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=yg(o)}}function Sg(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?Sg(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function bg(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var s=jo(n.document);s instanceof n.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)n=s.contentWindow;else break;s=jo(n.document)}return s}function th(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}var lC=Li&&"documentMode"in document&&11>=document.documentMode,Mr=null,nh=null,Ga=null,ih=!1;function wg(n,s,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;ih||Mr==null||Mr!==jo(h)||(h=Mr,"selectionStart"in h&&th(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Ga&&Va(Ga,h)||(Ga=h,h=xc(nh,"onSelect"),0<h.length&&(s=new Ro("onSelect","select",null,s,o),n.push({event:s,listeners:h}),s.target=Mr)))}function Ws(n,s){var o={};return o[n.toLowerCase()]=s.toLowerCase(),o["Webkit"+n]="webkit"+s,o["Moz"+n]="moz"+s,o}var Br={animationend:Ws("Animation","AnimationEnd"),animationiteration:Ws("Animation","AnimationIteration"),animationstart:Ws("Animation","AnimationStart"),transitionrun:Ws("Transition","TransitionRun"),transitionstart:Ws("Transition","TransitionStart"),transitioncancel:Ws("Transition","TransitionCancel"),transitionend:Ws("Transition","TransitionEnd")},sh={},Cg={};Li&&(Cg=document.createElement("div").style,"AnimationEvent"in window||(delete Br.animationend.animation,delete Br.animationiteration.animation,delete Br.animationstart.animation),"TransitionEvent"in window||delete Br.transitionend.transition);function Vs(n){if(sh[n])return sh[n];if(!Br[n])return n;var s=Br[n],o;for(o in s)if(s.hasOwnProperty(o)&&o in Cg)return sh[n]=s[o];return n}var jg=Vs("animationend"),kg=Vs("animationiteration"),Ng=Vs("animationstart"),oC=Vs("transitionrun"),cC=Vs("transitionstart"),uC=Vs("transitioncancel"),Eg=Vs("transitionend"),Tg=new Map,rh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");rh.push("scrollEnd");function ai(n,s){Tg.set(n,s),Ks(s,[n])}var Lo=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},$n=[],Or=0,ah=0;function Mo(){for(var n=Or,s=ah=Or=0;s<n;){var o=$n[s];$n[s++]=null;var h=$n[s];$n[s++]=null;var p=$n[s];$n[s++]=null;var g=$n[s];if($n[s++]=null,h!==null&&p!==null){var w=h.pending;w===null?p.next=p:(p.next=w.next,w.next=p),h.pending=p}g!==0&&Rg(o,p,g)}}function Bo(n,s,o,h){$n[Or++]=n,$n[Or++]=s,$n[Or++]=o,$n[Or++]=h,ah|=h,n.lanes|=h,n=n.alternate,n!==null&&(n.lanes|=h)}function lh(n,s,o,h){return Bo(n,s,o,h),Oo(n)}function Gs(n,s){return Bo(n,null,null,s),Oo(n)}function Rg(n,s,o){n.lanes|=o;var h=n.alternate;h!==null&&(h.lanes|=o);for(var p=!1,g=n.return;g!==null;)g.childLanes|=o,h=g.alternate,h!==null&&(h.childLanes|=o),g.tag===22&&(n=g.stateNode,n===null||n._visibility&1||(p=!0)),n=g,g=g.return;return n.tag===3?(g=n.stateNode,p&&s!==null&&(p=31-et(o),n=g.hiddenUpdates,h=n[p],h===null?n[p]=[s]:h.push(s),s.lane=o|536870912),g):null}function Oo(n){if(50<gl)throw gl=0,gd=null,Error(r(185));for(var s=n.return;s!==null;)n=s,s=n.return;return n.tag===3?n.stateNode:null}var zr={};function hC(n,s,o,h){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cn(n,s,o,h){return new hC(n,s,o,h)}function oh(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Mi(n,s){var o=n.alternate;return o===null?(o=Cn(n.tag,s,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=s,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,s=n.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function Dg(n,s){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,s=o.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),n}function zo(n,s,o,h,p,g){var w=0;if(h=n,typeof n=="function")oh(n)&&(w=1);else if(typeof n=="string")w=gj(n,o,re.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case F:return n=Cn(31,o,s,p),n.elementType=F,n.lanes=g,n;case C:return Ys(o.children,p,g,s);case T:w=8,p|=24;break;case k:return n=Cn(12,o,s,p|2),n.elementType=k,n.lanes=g,n;case z:return n=Cn(13,o,s,p),n.elementType=z,n.lanes=g,n;case B:return n=Cn(19,o,s,p),n.elementType=B,n.lanes=g,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case N:w=10;break e;case R:w=9;break e;case E:w=11;break e;case I:w=14;break e;case q:w=16,h=null;break e}w=29,o=Error(r(130,n===null?"null":typeof n,"")),h=null}return s=Cn(w,o,s,p),s.elementType=n,s.type=h,s.lanes=g,s}function Ys(n,s,o,h){return n=Cn(7,n,h,s),n.lanes=o,n}function ch(n,s,o){return n=Cn(6,n,null,s),n.lanes=o,n}function Ag(n){var s=Cn(18,null,null,0);return s.stateNode=n,s}function uh(n,s,o){return s=Cn(4,n.children!==null?n.children:[],n.key,s),s.lanes=o,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}var Lg=new WeakMap;function Kn(n,s){if(typeof n=="object"&&n!==null){var o=Lg.get(n);return o!==void 0?o:(s={value:n,source:s,stack:fi(s)},Lg.set(n,s),s)}return{value:n,source:s,stack:fi(s)}}var Pr=[],Hr=0,Po=null,Ya=0,qn=[],Wn=0,as=null,mi=1,pi="";function Bi(n,s){Pr[Hr++]=Ya,Pr[Hr++]=Po,Po=n,Ya=s}function Mg(n,s,o){qn[Wn++]=mi,qn[Wn++]=pi,qn[Wn++]=as,as=n;var h=mi;n=pi;var p=32-et(h)-1;h&=~(1<<p),o+=1;var g=32-et(s)+p;if(30<g){var w=p-p%5;g=(h&(1<<w)-1).toString(32),h>>=w,p-=w,mi=1<<32-et(s)+p|o<<p|h,pi=g+n}else mi=1<<g|o<<p|h,pi=n}function hh(n){n.return!==null&&(Bi(n,1),Mg(n,1,0))}function dh(n){for(;n===Po;)Po=Pr[--Hr],Pr[Hr]=null,Ya=Pr[--Hr],Pr[Hr]=null;for(;n===as;)as=qn[--Wn],qn[Wn]=null,pi=qn[--Wn],qn[Wn]=null,mi=qn[--Wn],qn[Wn]=null}function Bg(n,s){qn[Wn++]=mi,qn[Wn++]=pi,qn[Wn++]=as,mi=s.id,pi=s.overflow,as=n}var Wt=null,at=null,Fe=!1,ls=null,Vn=!1,fh=Error(r(519));function os(n){var s=Error(r(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Xa(Kn(s,n)),fh}function Og(n){var s=n.stateNode,o=n.type,h=n.memoizedProps;switch(s[qt]=n,s[hn]=h,o){case"dialog":He("cancel",s),He("close",s);break;case"iframe":case"object":case"embed":He("load",s);break;case"video":case"audio":for(o=0;o<_l.length;o++)He(_l[o],s);break;case"source":He("error",s);break;case"img":case"image":case"link":He("error",s),He("load",s);break;case"details":He("toggle",s);break;case"input":He("invalid",s),Yp(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":He("invalid",s);break;case"textarea":He("invalid",s),Jp(s,h.value,h.defaultValue,h.children)}o=h.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||h.suppressHydrationWarning===!0||Q_(s.textContent,o)?(h.popover!=null&&(He("beforetoggle",s),He("toggle",s)),h.onScroll!=null&&He("scroll",s),h.onScrollEnd!=null&&He("scrollend",s),h.onClick!=null&&(s.onclick=Ai),s=!0):s=!1,s||os(n,!0)}function zg(n){for(Wt=n.return;Wt;)switch(Wt.tag){case 5:case 31:case 13:Vn=!1;return;case 27:case 3:Vn=!0;return;default:Wt=Wt.return}}function Ir(n){if(n!==Wt)return!1;if(!Fe)return zg(n),Fe=!0,!1;var s=n.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||Dd(n.type,n.memoizedProps)),o=!o),o&&at&&os(n),zg(n),s===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));at=oy(n)}else if(s===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));at=oy(n)}else s===27?(s=at,bs(n.type)?(n=Od,Od=null,at=n):at=s):at=Wt?Yn(n.stateNode.nextSibling):null;return!0}function Xs(){at=Wt=null,Fe=!1}function mh(){var n=ls;return n!==null&&(gn===null?gn=n:gn.push.apply(gn,n),ls=null),n}function Xa(n){ls===null?ls=[n]:ls.push(n)}var ph=P(null),Js=null,Oi=null;function cs(n,s,o){L(ph,s._currentValue),s._currentValue=o}function zi(n){n._currentValue=ph.current,H(ph)}function gh(n,s,o){for(;n!==null;){var h=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),n===o)break;n=n.return}}function vh(n,s,o,h){var p=n.child;for(p!==null&&(p.return=n);p!==null;){var g=p.dependencies;if(g!==null){var w=p.child;g=g.firstContext;e:for(;g!==null;){var O=g;g=p;for(var K=0;K<s.length;K++)if(O.context===s[K]){g.lanes|=o,O=g.alternate,O!==null&&(O.lanes|=o),gh(g.return,o,n),h||(w=null);break e}g=O.next}}else if(p.tag===18){if(w=p.return,w===null)throw Error(r(341));w.lanes|=o,g=w.alternate,g!==null&&(g.lanes|=o),gh(w,o,n),w=null}else w=p.child;if(w!==null)w.return=p;else for(w=p;w!==null;){if(w===n){w=null;break}if(p=w.sibling,p!==null){p.return=w.return,w=p;break}w=w.return}p=w}}function Ur(n,s,o,h){n=null;for(var p=s,g=!1;p!==null;){if(!g){if((p.flags&524288)!==0)g=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var w=p.alternate;if(w===null)throw Error(r(387));if(w=w.memoizedProps,w!==null){var O=p.type;wn(p.pendingProps.value,w.value)||(n!==null?n.push(O):n=[O])}}else if(p===de.current){if(w=p.alternate,w===null)throw Error(r(387));w.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(n!==null?n.push(wl):n=[wl])}p=p.return}n!==null&&vh(s,n,o,h),s.flags|=262144}function Ho(n){for(n=n.firstContext;n!==null;){if(!wn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Zs(n){Js=n,Oi=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Vt(n){return Pg(Js,n)}function Io(n,s){return Js===null&&Zs(n),Pg(n,s)}function Pg(n,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Oi===null){if(n===null)throw Error(r(308));Oi=s,n.dependencies={lanes:0,firstContext:s},n.flags|=524288}else Oi=Oi.next=s;return o}var dC=typeof AbortController<"u"?AbortController:function(){var n=[],s=this.signal={aborted:!1,addEventListener:function(o,h){n.push(h)}};this.abort=function(){s.aborted=!0,n.forEach(function(o){return o()})}},fC=e.unstable_scheduleCallback,mC=e.unstable_NormalPriority,Ct={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function _h(){return{controller:new dC,data:new Map,refCount:0}}function Ja(n){n.refCount--,n.refCount===0&&fC(mC,function(){n.controller.abort()})}var Za=null,yh=0,Fr=0,$r=null;function pC(n,s){if(Za===null){var o=Za=[];yh=0,Fr=bd(),$r={status:"pending",value:void 0,then:function(h){o.push(h)}}}return yh++,s.then(Hg,Hg),s}function Hg(){if(--yh===0&&Za!==null){$r!==null&&($r.status="fulfilled");var n=Za;Za=null,Fr=0,$r=null;for(var s=0;s<n.length;s++)(0,n[s])()}}function gC(n,s){var o=[],h={status:"pending",value:null,reason:null,then:function(p){o.push(p)}};return n.then(function(){h.status="fulfilled",h.value=s;for(var p=0;p<o.length;p++)(0,o[p])(s)},function(p){for(h.status="rejected",h.reason=p,p=0;p<o.length;p++)(0,o[p])(void 0)}),h}var Ig=D.S;D.S=function(n,s){w_=Ot(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&pC(n,s),Ig!==null&&Ig(n,s)};var Qs=P(null);function xh(){var n=Qs.current;return n!==null?n:tt.pooledCache}function Uo(n,s){s===null?L(Qs,Qs.current):L(Qs,s.pool)}function Ug(){var n=xh();return n===null?null:{parent:Ct._currentValue,pool:n}}var Kr=Error(r(460)),Sh=Error(r(474)),Fo=Error(r(542)),$o={then:function(){}};function Fg(n){return n=n.status,n==="fulfilled"||n==="rejected"}function $g(n,s,o){switch(o=n[o],o===void 0?n.push(s):o!==s&&(s.then(Ai,Ai),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,qg(n),n;default:if(typeof s.status=="string")s.then(Ai,Ai);else{if(n=tt,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=s,n.status="pending",n.then(function(h){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=h}},function(h){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,qg(n),n}throw tr=s,Kr}}function er(n){try{var s=n._init;return s(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(tr=o,Kr):o}}var tr=null;function Kg(){if(tr===null)throw Error(r(459));var n=tr;return tr=null,n}function qg(n){if(n===Kr||n===Fo)throw Error(r(483))}var qr=null,Qa=0;function Ko(n){var s=Qa;return Qa+=1,qr===null&&(qr=[]),$g(qr,n,s)}function el(n,s){s=s.props.ref,n.ref=s!==void 0?s:null}function qo(n,s){throw s.$$typeof===S?Error(r(525)):(n=Object.prototype.toString.call(s),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n)))}function Wg(n){function s(J,X){if(n){var Z=J.deletions;Z===null?(J.deletions=[X],J.flags|=16):Z.push(X)}}function o(J,X){if(!n)return null;for(;X!==null;)s(J,X),X=X.sibling;return null}function h(J){for(var X=new Map;J!==null;)J.key!==null?X.set(J.key,J):X.set(J.index,J),J=J.sibling;return X}function p(J,X){return J=Mi(J,X),J.index=0,J.sibling=null,J}function g(J,X,Z){return J.index=Z,n?(Z=J.alternate,Z!==null?(Z=Z.index,Z<X?(J.flags|=67108866,X):Z):(J.flags|=67108866,X)):(J.flags|=1048576,X)}function w(J){return n&&J.alternate===null&&(J.flags|=67108866),J}function O(J,X,Z,ae){return X===null||X.tag!==6?(X=ch(Z,J.mode,ae),X.return=J,X):(X=p(X,Z),X.return=J,X)}function K(J,X,Z,ae){var Ce=Z.type;return Ce===C?se(J,X,Z.props.children,ae,Z.key):X!==null&&(X.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===q&&er(Ce)===X.type)?(X=p(X,Z.props),el(X,Z),X.return=J,X):(X=zo(Z.type,Z.key,Z.props,null,J.mode,ae),el(X,Z),X.return=J,X)}function Q(J,X,Z,ae){return X===null||X.tag!==4||X.stateNode.containerInfo!==Z.containerInfo||X.stateNode.implementation!==Z.implementation?(X=uh(Z,J.mode,ae),X.return=J,X):(X=p(X,Z.children||[]),X.return=J,X)}function se(J,X,Z,ae,Ce){return X===null||X.tag!==7?(X=Ys(Z,J.mode,ae,Ce),X.return=J,X):(X=p(X,Z),X.return=J,X)}function le(J,X,Z){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return X=ch(""+X,J.mode,Z),X.return=J,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case x:return Z=zo(X.type,X.key,X.props,null,J.mode,Z),el(Z,X),Z.return=J,Z;case b:return X=uh(X,J.mode,Z),X.return=J,X;case q:return X=er(X),le(J,X,Z)}if(A(X)||Y(X))return X=Ys(X,J.mode,Z,null),X.return=J,X;if(typeof X.then=="function")return le(J,Ko(X),Z);if(X.$$typeof===N)return le(J,Io(J,X),Z);qo(J,X)}return null}function ee(J,X,Z,ae){var Ce=X!==null?X.key:null;if(typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint")return Ce!==null?null:O(J,X,""+Z,ae);if(typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case x:return Z.key===Ce?K(J,X,Z,ae):null;case b:return Z.key===Ce?Q(J,X,Z,ae):null;case q:return Z=er(Z),ee(J,X,Z,ae)}if(A(Z)||Y(Z))return Ce!==null?null:se(J,X,Z,ae,null);if(typeof Z.then=="function")return ee(J,X,Ko(Z),ae);if(Z.$$typeof===N)return ee(J,X,Io(J,Z),ae);qo(J,Z)}return null}function te(J,X,Z,ae,Ce){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return J=J.get(Z)||null,O(X,J,""+ae,Ce);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case x:return J=J.get(ae.key===null?Z:ae.key)||null,K(X,J,ae,Ce);case b:return J=J.get(ae.key===null?Z:ae.key)||null,Q(X,J,ae,Ce);case q:return ae=er(ae),te(J,X,Z,ae,Ce)}if(A(ae)||Y(ae))return J=J.get(Z)||null,se(X,J,ae,Ce,null);if(typeof ae.then=="function")return te(J,X,Z,Ko(ae),Ce);if(ae.$$typeof===N)return te(J,X,Z,Io(X,ae),Ce);qo(X,ae)}return null}function be(J,X,Z,ae){for(var Ce=null,$e=null,we=X,Ae=X=0,Ue=null;we!==null&&Ae<Z.length;Ae++){we.index>Ae?(Ue=we,we=null):Ue=we.sibling;var Ke=ee(J,we,Z[Ae],ae);if(Ke===null){we===null&&(we=Ue);break}n&&we&&Ke.alternate===null&&s(J,we),X=g(Ke,X,Ae),$e===null?Ce=Ke:$e.sibling=Ke,$e=Ke,we=Ue}if(Ae===Z.length)return o(J,we),Fe&&Bi(J,Ae),Ce;if(we===null){for(;Ae<Z.length;Ae++)we=le(J,Z[Ae],ae),we!==null&&(X=g(we,X,Ae),$e===null?Ce=we:$e.sibling=we,$e=we);return Fe&&Bi(J,Ae),Ce}for(we=h(we);Ae<Z.length;Ae++)Ue=te(we,J,Ae,Z[Ae],ae),Ue!==null&&(n&&Ue.alternate!==null&&we.delete(Ue.key===null?Ae:Ue.key),X=g(Ue,X,Ae),$e===null?Ce=Ue:$e.sibling=Ue,$e=Ue);return n&&we.forEach(function(Ns){return s(J,Ns)}),Fe&&Bi(J,Ae),Ce}function je(J,X,Z,ae){if(Z==null)throw Error(r(151));for(var Ce=null,$e=null,we=X,Ae=X=0,Ue=null,Ke=Z.next();we!==null&&!Ke.done;Ae++,Ke=Z.next()){we.index>Ae?(Ue=we,we=null):Ue=we.sibling;var Ns=ee(J,we,Ke.value,ae);if(Ns===null){we===null&&(we=Ue);break}n&&we&&Ns.alternate===null&&s(J,we),X=g(Ns,X,Ae),$e===null?Ce=Ns:$e.sibling=Ns,$e=Ns,we=Ue}if(Ke.done)return o(J,we),Fe&&Bi(J,Ae),Ce;if(we===null){for(;!Ke.done;Ae++,Ke=Z.next())Ke=le(J,Ke.value,ae),Ke!==null&&(X=g(Ke,X,Ae),$e===null?Ce=Ke:$e.sibling=Ke,$e=Ke);return Fe&&Bi(J,Ae),Ce}for(we=h(we);!Ke.done;Ae++,Ke=Z.next())Ke=te(we,J,Ae,Ke.value,ae),Ke!==null&&(n&&Ke.alternate!==null&&we.delete(Ke.key===null?Ae:Ke.key),X=g(Ke,X,Ae),$e===null?Ce=Ke:$e.sibling=Ke,$e=Ke);return n&&we.forEach(function(Nj){return s(J,Nj)}),Fe&&Bi(J,Ae),Ce}function Ze(J,X,Z,ae){if(typeof Z=="object"&&Z!==null&&Z.type===C&&Z.key===null&&(Z=Z.props.children),typeof Z=="object"&&Z!==null){switch(Z.$$typeof){case x:e:{for(var Ce=Z.key;X!==null;){if(X.key===Ce){if(Ce=Z.type,Ce===C){if(X.tag===7){o(J,X.sibling),ae=p(X,Z.props.children),ae.return=J,J=ae;break e}}else if(X.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===q&&er(Ce)===X.type){o(J,X.sibling),ae=p(X,Z.props),el(ae,Z),ae.return=J,J=ae;break e}o(J,X);break}else s(J,X);X=X.sibling}Z.type===C?(ae=Ys(Z.props.children,J.mode,ae,Z.key),ae.return=J,J=ae):(ae=zo(Z.type,Z.key,Z.props,null,J.mode,ae),el(ae,Z),ae.return=J,J=ae)}return w(J);case b:e:{for(Ce=Z.key;X!==null;){if(X.key===Ce)if(X.tag===4&&X.stateNode.containerInfo===Z.containerInfo&&X.stateNode.implementation===Z.implementation){o(J,X.sibling),ae=p(X,Z.children||[]),ae.return=J,J=ae;break e}else{o(J,X);break}else s(J,X);X=X.sibling}ae=uh(Z,J.mode,ae),ae.return=J,J=ae}return w(J);case q:return Z=er(Z),Ze(J,X,Z,ae)}if(A(Z))return be(J,X,Z,ae);if(Y(Z)){if(Ce=Y(Z),typeof Ce!="function")throw Error(r(150));return Z=Ce.call(Z),je(J,X,Z,ae)}if(typeof Z.then=="function")return Ze(J,X,Ko(Z),ae);if(Z.$$typeof===N)return Ze(J,X,Io(J,Z),ae);qo(J,Z)}return typeof Z=="string"&&Z!==""||typeof Z=="number"||typeof Z=="bigint"?(Z=""+Z,X!==null&&X.tag===6?(o(J,X.sibling),ae=p(X,Z),ae.return=J,J=ae):(o(J,X),ae=ch(Z,J.mode,ae),ae.return=J,J=ae),w(J)):o(J,X)}return function(J,X,Z,ae){try{Qa=0;var Ce=Ze(J,X,Z,ae);return qr=null,Ce}catch(we){if(we===Kr||we===Fo)throw we;var $e=Cn(29,we,null,J.mode);return $e.lanes=ae,$e.return=J,$e}}}var nr=Wg(!0),Vg=Wg(!1),us=!1;function bh(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wh(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function hs(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function ds(n,s,o){var h=n.updateQueue;if(h===null)return null;if(h=h.shared,(qe&2)!==0){var p=h.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),h.pending=s,s=Oo(n),Rg(n,null,o),s}return Bo(n,h,s,o),Oo(n)}function tl(n,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Pp(n,o)}}function Ch(n,s){var o=n.updateQueue,h=n.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var p=null,g=null;if(o=o.firstBaseUpdate,o!==null){do{var w={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};g===null?p=g=w:g=g.next=w,o=o.next}while(o!==null);g===null?p=g=s:g=g.next=s}else p=g=s;o={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:g,shared:h.shared,callbacks:h.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=s:n.next=s,o.lastBaseUpdate=s}var jh=!1;function nl(){if(jh){var n=$r;if(n!==null)throw n}}function il(n,s,o,h){jh=!1;var p=n.updateQueue;us=!1;var g=p.firstBaseUpdate,w=p.lastBaseUpdate,O=p.shared.pending;if(O!==null){p.shared.pending=null;var K=O,Q=K.next;K.next=null,w===null?g=Q:w.next=Q,w=K;var se=n.alternate;se!==null&&(se=se.updateQueue,O=se.lastBaseUpdate,O!==w&&(O===null?se.firstBaseUpdate=Q:O.next=Q,se.lastBaseUpdate=K))}if(g!==null){var le=p.baseState;w=0,se=Q=K=null,O=g;do{var ee=O.lane&-536870913,te=ee!==O.lane;if(te?(Ie&ee)===ee:(h&ee)===ee){ee!==0&&ee===Fr&&(jh=!0),se!==null&&(se=se.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var be=n,je=O;ee=s;var Ze=o;switch(je.tag){case 1:if(be=je.payload,typeof be=="function"){le=be.call(Ze,le,ee);break e}le=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=je.payload,ee=typeof be=="function"?be.call(Ze,le,ee):be,ee==null)break e;le=_({},le,ee);break e;case 2:us=!0}}ee=O.callback,ee!==null&&(n.flags|=64,te&&(n.flags|=8192),te=p.callbacks,te===null?p.callbacks=[ee]:te.push(ee))}else te={lane:ee,tag:O.tag,payload:O.payload,callback:O.callback,next:null},se===null?(Q=se=te,K=le):se=se.next=te,w|=ee;if(O=O.next,O===null){if(O=p.shared.pending,O===null)break;te=O,O=te.next,te.next=null,p.lastBaseUpdate=te,p.shared.pending=null}}while(!0);se===null&&(K=le),p.baseState=K,p.firstBaseUpdate=Q,p.lastBaseUpdate=se,g===null&&(p.shared.lanes=0),vs|=w,n.lanes=w,n.memoizedState=le}}function Gg(n,s){if(typeof n!="function")throw Error(r(191,n));n.call(s)}function Yg(n,s){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)Gg(o[n],s)}var Wr=P(null),Wo=P(0);function Xg(n,s){n=Wi,L(Wo,n),L(Wr,s),Wi=n|s.baseLanes}function kh(){L(Wo,Wi),L(Wr,Wr.current)}function Nh(){Wi=Wo.current,H(Wr),H(Wo)}var jn=P(null),Gn=null;function fs(n){var s=n.alternate;L(xt,xt.current&1),L(jn,n),Gn===null&&(s===null||Wr.current!==null||s.memoizedState!==null)&&(Gn=n)}function Eh(n){L(xt,xt.current),L(jn,n),Gn===null&&(Gn=n)}function Jg(n){n.tag===22?(L(xt,xt.current),L(jn,n),Gn===null&&(Gn=n)):ms()}function ms(){L(xt,xt.current),L(jn,jn.current)}function kn(n){H(jn),Gn===n&&(Gn=null),H(xt)}var xt=P(0);function Vo(n){for(var s=n;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Md(o)||Bd(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Pi=0,Re=null,Xe=null,jt=null,Go=!1,Vr=!1,ir=!1,Yo=0,sl=0,Gr=null,vC=0;function pt(){throw Error(r(321))}function Th(n,s){if(s===null)return!1;for(var o=0;o<s.length&&o<n.length;o++)if(!wn(n[o],s[o]))return!1;return!0}function Rh(n,s,o,h,p,g){return Pi=g,Re=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,D.H=n===null||n.memoizedState===null?Mv:qh,ir=!1,g=o(h,p),ir=!1,Vr&&(g=Qg(s,o,h,p)),Zg(n),g}function Zg(n){D.H=ll;var s=Xe!==null&&Xe.next!==null;if(Pi=0,jt=Xe=Re=null,Go=!1,sl=0,Gr=null,s)throw Error(r(300));n===null||kt||(n=n.dependencies,n!==null&&Ho(n)&&(kt=!0))}function Qg(n,s,o,h){Re=n;var p=0;do{if(Vr&&(Gr=null),sl=0,Vr=!1,25<=p)throw Error(r(301));if(p+=1,jt=Xe=null,n.updateQueue!=null){var g=n.updateQueue;g.lastEffect=null,g.events=null,g.stores=null,g.memoCache!=null&&(g.memoCache.index=0)}D.H=Bv,g=s(o,h)}while(Vr);return g}function _C(){var n=D.H,s=n.useState()[0];return s=typeof s.then=="function"?rl(s):s,n=n.useState()[0],(Xe!==null?Xe.memoizedState:null)!==n&&(Re.flags|=1024),s}function Dh(){var n=Yo!==0;return Yo=0,n}function Ah(n,s,o){s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~o}function Lh(n){if(Go){for(n=n.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Go=!1}Pi=0,jt=Xe=Re=null,Vr=!1,sl=Yo=0,Gr=null}function sn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?Re.memoizedState=jt=n:jt=jt.next=n,jt}function St(){if(Xe===null){var n=Re.alternate;n=n!==null?n.memoizedState:null}else n=Xe.next;var s=jt===null?Re.memoizedState:jt.next;if(s!==null)jt=s,Xe=n;else{if(n===null)throw Re.alternate===null?Error(r(467)):Error(r(310));Xe=n,n={memoizedState:Xe.memoizedState,baseState:Xe.baseState,baseQueue:Xe.baseQueue,queue:Xe.queue,next:null},jt===null?Re.memoizedState=jt=n:jt=jt.next=n}return jt}function Xo(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function rl(n){var s=sl;return sl+=1,Gr===null&&(Gr=[]),n=$g(Gr,n,s),s=Re,(jt===null?s.memoizedState:jt.next)===null&&(s=s.alternate,D.H=s===null||s.memoizedState===null?Mv:qh),n}function Jo(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return rl(n);if(n.$$typeof===N)return Vt(n)}throw Error(r(438,String(n)))}function Mh(n){var s=null,o=Re.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var h=Re.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=Xo(),Re.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(n),h=0;h<n;h++)o[h]=V;return s.index++,o}function Hi(n,s){return typeof s=="function"?s(n):s}function Zo(n){var s=St();return Bh(s,Xe,n)}function Bh(n,s,o){var h=n.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=o;var p=n.baseQueue,g=h.pending;if(g!==null){if(p!==null){var w=p.next;p.next=g.next,g.next=w}s.baseQueue=p=g,h.pending=null}if(g=n.baseState,p===null)n.memoizedState=g;else{s=p.next;var O=w=null,K=null,Q=s,se=!1;do{var le=Q.lane&-536870913;if(le!==Q.lane?(Ie&le)===le:(Pi&le)===le){var ee=Q.revertLane;if(ee===0)K!==null&&(K=K.next={lane:0,revertLane:0,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null}),le===Fr&&(se=!0);else if((Pi&ee)===ee){Q=Q.next,ee===Fr&&(se=!0);continue}else le={lane:0,revertLane:Q.revertLane,gesture:null,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},K===null?(O=K=le,w=g):K=K.next=le,Re.lanes|=ee,vs|=ee;le=Q.action,ir&&o(g,le),g=Q.hasEagerState?Q.eagerState:o(g,le)}else ee={lane:le,revertLane:Q.revertLane,gesture:Q.gesture,action:Q.action,hasEagerState:Q.hasEagerState,eagerState:Q.eagerState,next:null},K===null?(O=K=ee,w=g):K=K.next=ee,Re.lanes|=le,vs|=le;Q=Q.next}while(Q!==null&&Q!==s);if(K===null?w=g:K.next=O,!wn(g,n.memoizedState)&&(kt=!0,se&&(o=$r,o!==null)))throw o;n.memoizedState=g,n.baseState=w,n.baseQueue=K,h.lastRenderedState=g}return p===null&&(h.lanes=0),[n.memoizedState,h.dispatch]}function Oh(n){var s=St(),o=s.queue;if(o===null)throw Error(r(311));o.lastRenderedReducer=n;var h=o.dispatch,p=o.pending,g=s.memoizedState;if(p!==null){o.pending=null;var w=p=p.next;do g=n(g,w.action),w=w.next;while(w!==p);wn(g,s.memoizedState)||(kt=!0),s.memoizedState=g,s.baseQueue===null&&(s.baseState=g),o.lastRenderedState=g}return[g,h]}function ev(n,s,o){var h=Re,p=St(),g=Fe;if(g){if(o===void 0)throw Error(r(407));o=o()}else o=s();var w=!wn((Xe||p).memoizedState,o);if(w&&(p.memoizedState=o,kt=!0),p=p.queue,Hh(iv.bind(null,h,p,n),[n]),p.getSnapshot!==s||w||jt!==null&&jt.memoizedState.tag&1){if(h.flags|=2048,Yr(9,{destroy:void 0},nv.bind(null,h,p,o,s),null),tt===null)throw Error(r(349));g||(Pi&127)!==0||tv(h,s,o)}return o}function tv(n,s,o){n.flags|=16384,n={getSnapshot:s,value:o},s=Re.updateQueue,s===null?(s=Xo(),Re.updateQueue=s,s.stores=[n]):(o=s.stores,o===null?s.stores=[n]:o.push(n))}function nv(n,s,o,h){s.value=o,s.getSnapshot=h,sv(s)&&rv(n)}function iv(n,s,o){return o(function(){sv(s)&&rv(n)})}function sv(n){var s=n.getSnapshot;n=n.value;try{var o=s();return!wn(n,o)}catch{return!0}}function rv(n){var s=Gs(n,2);s!==null&&vn(s,n,2)}function zh(n){var s=sn();if(typeof n=="function"){var o=n;if(n=o(),ir){un(!0);try{o()}finally{un(!1)}}}return s.memoizedState=s.baseState=n,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:n},s}function av(n,s,o,h){return n.baseState=o,Bh(n,Xe,typeof h=="function"?h:Hi)}function yC(n,s,o,h,p){if(tc(n))throw Error(r(485));if(n=s.action,n!==null){var g={payload:p,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(w){g.listeners.push(w)}};D.T!==null?o(!0):g.isTransition=!1,h(g),o=s.pending,o===null?(g.next=s.pending=g,lv(s,g)):(g.next=o.next,s.pending=o.next=g)}}function lv(n,s){var o=s.action,h=s.payload,p=n.state;if(s.isTransition){var g=D.T,w={};D.T=w;try{var O=o(p,h),K=D.S;K!==null&&K(w,O),ov(n,s,O)}catch(Q){Ph(n,s,Q)}finally{g!==null&&w.types!==null&&(g.types=w.types),D.T=g}}else try{g=o(p,h),ov(n,s,g)}catch(Q){Ph(n,s,Q)}}function ov(n,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(h){cv(n,s,h)},function(h){return Ph(n,s,h)}):cv(n,s,o)}function cv(n,s,o){s.status="fulfilled",s.value=o,uv(s),n.state=o,s=n.pending,s!==null&&(o=s.next,o===s?n.pending=null:(o=o.next,s.next=o,lv(n,o)))}function Ph(n,s,o){var h=n.pending;if(n.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=o,uv(s),s=s.next;while(s!==h)}n.action=null}function uv(n){n=n.listeners;for(var s=0;s<n.length;s++)(0,n[s])()}function hv(n,s){return s}function dv(n,s){if(Fe){var o=tt.formState;if(o!==null){e:{var h=Re;if(Fe){if(at){t:{for(var p=at,g=Vn;p.nodeType!==8;){if(!g){p=null;break t}if(p=Yn(p.nextSibling),p===null){p=null;break t}}g=p.data,p=g==="F!"||g==="F"?p:null}if(p){at=Yn(p.nextSibling),h=p.data==="F!";break e}}os(h)}h=!1}h&&(s=o[0])}}return o=sn(),o.memoizedState=o.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:hv,lastRenderedState:s},o.queue=h,o=Dv.bind(null,Re,h),h.dispatch=o,h=zh(!1),g=Kh.bind(null,Re,!1,h.queue),h=sn(),p={state:s,dispatch:null,action:n,pending:null},h.queue=p,o=yC.bind(null,Re,p,g,o),p.dispatch=o,h.memoizedState=n,[s,o,!1]}function fv(n){var s=St();return mv(s,Xe,n)}function mv(n,s,o){if(s=Bh(n,s,hv)[0],n=Zo(Hi)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=rl(s)}catch(w){throw w===Kr?Fo:w}else h=s;s=St();var p=s.queue,g=p.dispatch;return o!==s.memoizedState&&(Re.flags|=2048,Yr(9,{destroy:void 0},xC.bind(null,p,o),null)),[h,g,n]}function xC(n,s){n.action=s}function pv(n){var s=St(),o=Xe;if(o!==null)return mv(s,o,n);St(),s=s.memoizedState,o=St();var h=o.queue.dispatch;return o.memoizedState=n,[s,h,!1]}function Yr(n,s,o,h){return n={tag:n,create:o,deps:h,inst:s,next:null},s=Re.updateQueue,s===null&&(s=Xo(),Re.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=n.next=n:(h=o.next,o.next=n,n.next=h,s.lastEffect=n),n}function gv(){return St().memoizedState}function Qo(n,s,o,h){var p=sn();Re.flags|=n,p.memoizedState=Yr(1|s,{destroy:void 0},o,h===void 0?null:h)}function ec(n,s,o,h){var p=St();h=h===void 0?null:h;var g=p.memoizedState.inst;Xe!==null&&h!==null&&Th(h,Xe.memoizedState.deps)?p.memoizedState=Yr(s,g,o,h):(Re.flags|=n,p.memoizedState=Yr(1|s,g,o,h))}function vv(n,s){Qo(8390656,8,n,s)}function Hh(n,s){ec(2048,8,n,s)}function SC(n){Re.flags|=4;var s=Re.updateQueue;if(s===null)s=Xo(),Re.updateQueue=s,s.events=[n];else{var o=s.events;o===null?s.events=[n]:o.push(n)}}function _v(n){var s=St().memoizedState;return SC({ref:s,nextImpl:n}),function(){if((qe&2)!==0)throw Error(r(440));return s.impl.apply(void 0,arguments)}}function yv(n,s){return ec(4,2,n,s)}function xv(n,s){return ec(4,4,n,s)}function Sv(n,s){if(typeof s=="function"){n=n();var o=s(n);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function bv(n,s,o){o=o!=null?o.concat([n]):null,ec(4,4,Sv.bind(null,s,n),o)}function Ih(){}function wv(n,s){var o=St();s=s===void 0?null:s;var h=o.memoizedState;return s!==null&&Th(s,h[1])?h[0]:(o.memoizedState=[n,s],n)}function Cv(n,s){var o=St();s=s===void 0?null:s;var h=o.memoizedState;if(s!==null&&Th(s,h[1]))return h[0];if(h=n(),ir){un(!0);try{n()}finally{un(!1)}}return o.memoizedState=[h,s],h}function Uh(n,s,o){return o===void 0||(Pi&1073741824)!==0&&(Ie&261930)===0?n.memoizedState=s:(n.memoizedState=o,n=j_(),Re.lanes|=n,vs|=n,o)}function jv(n,s,o,h){return wn(o,s)?o:Wr.current!==null?(n=Uh(n,o,h),wn(n,s)||(kt=!0),n):(Pi&42)===0||(Pi&1073741824)!==0&&(Ie&261930)===0?(kt=!0,n.memoizedState=o):(n=j_(),Re.lanes|=n,vs|=n,s)}function kv(n,s,o,h,p){var g=$.p;$.p=g!==0&&8>g?g:8;var w=D.T,O={};D.T=O,Kh(n,!1,s,o);try{var K=p(),Q=D.S;if(Q!==null&&Q(O,K),K!==null&&typeof K=="object"&&typeof K.then=="function"){var se=gC(K,h);al(n,s,se,Tn(n))}else al(n,s,h,Tn(n))}catch(le){al(n,s,{then:function(){},status:"rejected",reason:le},Tn())}finally{$.p=g,w!==null&&O.types!==null&&(w.types=O.types),D.T=w}}function bC(){}function Fh(n,s,o,h){if(n.tag!==5)throw Error(r(476));var p=Nv(n).queue;kv(n,p,s,W,o===null?bC:function(){return Ev(n),o(h)})}function Nv(n){var s=n.memoizedState;if(s!==null)return s;s={memoizedState:W,baseState:W,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:W},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Hi,lastRenderedState:o},next:null},n.memoizedState=s,n=n.alternate,n!==null&&(n.memoizedState=s),s}function Ev(n){var s=Nv(n);s.next===null&&(s=n.alternate.memoizedState),al(n,s.next.queue,{},Tn())}function $h(){return Vt(wl)}function Tv(){return St().memoizedState}function Rv(){return St().memoizedState}function wC(n){for(var s=n.return;s!==null;){switch(s.tag){case 24:case 3:var o=Tn();n=hs(o);var h=ds(s,n,o);h!==null&&(vn(h,s,o),tl(h,s,o)),s={cache:_h()},n.payload=s;return}s=s.return}}function CC(n,s,o){var h=Tn();o={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},tc(n)?Av(s,o):(o=lh(n,s,o,h),o!==null&&(vn(o,n,h),Lv(o,s,h)))}function Dv(n,s,o){var h=Tn();al(n,s,o,h)}function al(n,s,o,h){var p={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(tc(n))Av(s,p);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=s.lastRenderedReducer,g!==null))try{var w=s.lastRenderedState,O=g(w,o);if(p.hasEagerState=!0,p.eagerState=O,wn(O,w))return Bo(n,s,p,0),tt===null&&Mo(),!1}catch{}if(o=lh(n,s,p,h),o!==null)return vn(o,n,h),Lv(o,s,h),!0}return!1}function Kh(n,s,o,h){if(h={lane:2,revertLane:bd(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},tc(n)){if(s)throw Error(r(479))}else s=lh(n,o,h,2),s!==null&&vn(s,n,2)}function tc(n){var s=n.alternate;return n===Re||s!==null&&s===Re}function Av(n,s){Vr=Go=!0;var o=n.pending;o===null?s.next=s:(s.next=o.next,o.next=s),n.pending=s}function Lv(n,s,o){if((o&4194048)!==0){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Pp(n,o)}}var ll={readContext:Vt,use:Jo,useCallback:pt,useContext:pt,useEffect:pt,useImperativeHandle:pt,useLayoutEffect:pt,useInsertionEffect:pt,useMemo:pt,useReducer:pt,useRef:pt,useState:pt,useDebugValue:pt,useDeferredValue:pt,useTransition:pt,useSyncExternalStore:pt,useId:pt,useHostTransitionStatus:pt,useFormState:pt,useActionState:pt,useOptimistic:pt,useMemoCache:pt,useCacheRefresh:pt};ll.useEffectEvent=pt;var Mv={readContext:Vt,use:Jo,useCallback:function(n,s){return sn().memoizedState=[n,s===void 0?null:s],n},useContext:Vt,useEffect:vv,useImperativeHandle:function(n,s,o){o=o!=null?o.concat([n]):null,Qo(4194308,4,Sv.bind(null,s,n),o)},useLayoutEffect:function(n,s){return Qo(4194308,4,n,s)},useInsertionEffect:function(n,s){Qo(4,2,n,s)},useMemo:function(n,s){var o=sn();s=s===void 0?null:s;var h=n();if(ir){un(!0);try{n()}finally{un(!1)}}return o.memoizedState=[h,s],h},useReducer:function(n,s,o){var h=sn();if(o!==void 0){var p=o(s);if(ir){un(!0);try{o(s)}finally{un(!1)}}}else p=s;return h.memoizedState=h.baseState=p,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:p},h.queue=n,n=n.dispatch=CC.bind(null,Re,n),[h.memoizedState,n]},useRef:function(n){var s=sn();return n={current:n},s.memoizedState=n},useState:function(n){n=zh(n);var s=n.queue,o=Dv.bind(null,Re,s);return s.dispatch=o,[n.memoizedState,o]},useDebugValue:Ih,useDeferredValue:function(n,s){var o=sn();return Uh(o,n,s)},useTransition:function(){var n=zh(!1);return n=kv.bind(null,Re,n.queue,!0,!1),sn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,s,o){var h=Re,p=sn();if(Fe){if(o===void 0)throw Error(r(407));o=o()}else{if(o=s(),tt===null)throw Error(r(349));(Ie&127)!==0||tv(h,s,o)}p.memoizedState=o;var g={value:o,getSnapshot:s};return p.queue=g,vv(iv.bind(null,h,g,n),[n]),h.flags|=2048,Yr(9,{destroy:void 0},nv.bind(null,h,g,o,s),null),o},useId:function(){var n=sn(),s=tt.identifierPrefix;if(Fe){var o=pi,h=mi;o=(h&~(1<<32-et(h)-1)).toString(32)+o,s="_"+s+"R_"+o,o=Yo++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=vC++,s="_"+s+"r_"+o.toString(32)+"_";return n.memoizedState=s},useHostTransitionStatus:$h,useFormState:dv,useActionState:dv,useOptimistic:function(n){var s=sn();s.memoizedState=s.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=Kh.bind(null,Re,!0,o),o.dispatch=s,[n,s]},useMemoCache:Mh,useCacheRefresh:function(){return sn().memoizedState=wC.bind(null,Re)},useEffectEvent:function(n){var s=sn(),o={impl:n};return s.memoizedState=o,function(){if((qe&2)!==0)throw Error(r(440));return o.impl.apply(void 0,arguments)}}},qh={readContext:Vt,use:Jo,useCallback:wv,useContext:Vt,useEffect:Hh,useImperativeHandle:bv,useInsertionEffect:yv,useLayoutEffect:xv,useMemo:Cv,useReducer:Zo,useRef:gv,useState:function(){return Zo(Hi)},useDebugValue:Ih,useDeferredValue:function(n,s){var o=St();return jv(o,Xe.memoizedState,n,s)},useTransition:function(){var n=Zo(Hi)[0],s=St().memoizedState;return[typeof n=="boolean"?n:rl(n),s]},useSyncExternalStore:ev,useId:Tv,useHostTransitionStatus:$h,useFormState:fv,useActionState:fv,useOptimistic:function(n,s){var o=St();return av(o,Xe,n,s)},useMemoCache:Mh,useCacheRefresh:Rv};qh.useEffectEvent=_v;var Bv={readContext:Vt,use:Jo,useCallback:wv,useContext:Vt,useEffect:Hh,useImperativeHandle:bv,useInsertionEffect:yv,useLayoutEffect:xv,useMemo:Cv,useReducer:Oh,useRef:gv,useState:function(){return Oh(Hi)},useDebugValue:Ih,useDeferredValue:function(n,s){var o=St();return Xe===null?Uh(o,n,s):jv(o,Xe.memoizedState,n,s)},useTransition:function(){var n=Oh(Hi)[0],s=St().memoizedState;return[typeof n=="boolean"?n:rl(n),s]},useSyncExternalStore:ev,useId:Tv,useHostTransitionStatus:$h,useFormState:pv,useActionState:pv,useOptimistic:function(n,s){var o=St();return Xe!==null?av(o,Xe,n,s):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:Mh,useCacheRefresh:Rv};Bv.useEffectEvent=_v;function Wh(n,s,o,h){s=n.memoizedState,o=o(h,s),o=o==null?s:_({},s,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var Vh={enqueueSetState:function(n,s,o){n=n._reactInternals;var h=Tn(),p=hs(h);p.payload=s,o!=null&&(p.callback=o),s=ds(n,p,h),s!==null&&(vn(s,n,h),tl(s,n,h))},enqueueReplaceState:function(n,s,o){n=n._reactInternals;var h=Tn(),p=hs(h);p.tag=1,p.payload=s,o!=null&&(p.callback=o),s=ds(n,p,h),s!==null&&(vn(s,n,h),tl(s,n,h))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var o=Tn(),h=hs(o);h.tag=2,s!=null&&(h.callback=s),s=ds(n,h,o),s!==null&&(vn(s,n,o),tl(s,n,o))}};function Ov(n,s,o,h,p,g,w){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(h,g,w):s.prototype&&s.prototype.isPureReactComponent?!Va(o,h)||!Va(p,g):!0}function zv(n,s,o,h){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,h),s.state!==n&&Vh.enqueueReplaceState(s,s.state,null)}function sr(n,s){var o=s;if("ref"in s){o={};for(var h in s)h!=="ref"&&(o[h]=s[h])}if(n=n.defaultProps){o===s&&(o=_({},o));for(var p in n)o[p]===void 0&&(o[p]=n[p])}return o}function Pv(n){Lo(n)}function Hv(n){console.error(n)}function Iv(n){Lo(n)}function nc(n,s){try{var o=n.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function Uv(n,s,o){try{var h=n.onCaughtError;h(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Gh(n,s,o){return o=hs(o),o.tag=3,o.payload={element:null},o.callback=function(){nc(n,s)},o}function Fv(n){return n=hs(n),n.tag=3,n}function $v(n,s,o,h){var p=o.type.getDerivedStateFromError;if(typeof p=="function"){var g=h.value;n.payload=function(){return p(g)},n.callback=function(){Uv(s,o,h)}}var w=o.stateNode;w!==null&&typeof w.componentDidCatch=="function"&&(n.callback=function(){Uv(s,o,h),typeof p!="function"&&(_s===null?_s=new Set([this]):_s.add(this));var O=h.stack;this.componentDidCatch(h.value,{componentStack:O!==null?O:""})})}function jC(n,s,o,h,p){if(o.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=o.alternate,s!==null&&Ur(s,o,p,!0),o=jn.current,o!==null){switch(o.tag){case 31:case 13:return Gn===null?mc():o.alternate===null&&gt===0&&(gt=3),o.flags&=-257,o.flags|=65536,o.lanes=p,h===$o?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([h]):s.add(h),yd(n,h,p)),!1;case 22:return o.flags|=65536,h===$o?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([h]):o.add(h)),yd(n,h,p)),!1}throw Error(r(435,o.tag))}return yd(n,h,p),mc(),!1}if(Fe)return s=jn.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,h!==fh&&(n=Error(r(422),{cause:h}),Xa(Kn(n,o)))):(h!==fh&&(s=Error(r(423),{cause:h}),Xa(Kn(s,o))),n=n.current.alternate,n.flags|=65536,p&=-p,n.lanes|=p,h=Kn(h,o),p=Gh(n.stateNode,h,p),Ch(n,p),gt!==4&&(gt=2)),!1;var g=Error(r(520),{cause:h});if(g=Kn(g,o),pl===null?pl=[g]:pl.push(g),gt!==4&&(gt=2),s===null)return!0;h=Kn(h,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,n=p&-p,o.lanes|=n,n=Gh(o.stateNode,h,n),Ch(o,n),!1;case 1:if(s=o.type,g=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(_s===null||!_s.has(g))))return o.flags|=65536,p&=-p,o.lanes|=p,p=Fv(p),$v(p,n,o,h),Ch(o,p),!1}o=o.return}while(o!==null);return!1}var Yh=Error(r(461)),kt=!1;function Gt(n,s,o,h){s.child=n===null?Vg(s,null,o,h):nr(s,n.child,o,h)}function Kv(n,s,o,h,p){o=o.render;var g=s.ref;if("ref"in h){var w={};for(var O in h)O!=="ref"&&(w[O]=h[O])}else w=h;return Zs(s),h=Rh(n,s,o,w,g,p),O=Dh(),n!==null&&!kt?(Ah(n,s,p),Ii(n,s,p)):(Fe&&O&&hh(s),s.flags|=1,Gt(n,s,h,p),s.child)}function qv(n,s,o,h,p){if(n===null){var g=o.type;return typeof g=="function"&&!oh(g)&&g.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=g,Wv(n,s,g,h,p)):(n=zo(o.type,null,h,s,s.mode,p),n.ref=s.ref,n.return=s,s.child=n)}if(g=n.child,!id(n,p)){var w=g.memoizedProps;if(o=o.compare,o=o!==null?o:Va,o(w,h)&&n.ref===s.ref)return Ii(n,s,p)}return s.flags|=1,n=Mi(g,h),n.ref=s.ref,n.return=s,s.child=n}function Wv(n,s,o,h,p){if(n!==null){var g=n.memoizedProps;if(Va(g,h)&&n.ref===s.ref)if(kt=!1,s.pendingProps=h=g,id(n,p))(n.flags&131072)!==0&&(kt=!0);else return s.lanes=n.lanes,Ii(n,s,p)}return Xh(n,s,o,h,p)}function Vv(n,s,o,h){var p=h.children,g=n!==null?n.memoizedState:null;if(n===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((s.flags&128)!==0){if(g=g!==null?g.baseLanes|o:o,n!==null){for(h=s.child=n.child,p=0;h!==null;)p=p|h.lanes|h.childLanes,h=h.sibling;h=p&~g}else h=0,s.child=null;return Gv(n,s,g,o,h)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},n!==null&&Uo(s,g!==null?g.cachePool:null),g!==null?Xg(s,g):kh(),Jg(s);else return h=s.lanes=536870912,Gv(n,s,g!==null?g.baseLanes|o:o,o,h)}else g!==null?(Uo(s,g.cachePool),Xg(s,g),ms(),s.memoizedState=null):(n!==null&&Uo(s,null),kh(),ms());return Gt(n,s,p,o),s.child}function ol(n,s){return n!==null&&n.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function Gv(n,s,o,h,p){var g=xh();return g=g===null?null:{parent:Ct._currentValue,pool:g},s.memoizedState={baseLanes:o,cachePool:g},n!==null&&Uo(s,null),kh(),Jg(s),n!==null&&Ur(n,s,h,!0),s.childLanes=p,null}function ic(n,s){return s=rc({mode:s.mode,children:s.children},n.mode),s.ref=n.ref,n.child=s,s.return=n,s}function Yv(n,s,o){return nr(s,n.child,null,o),n=ic(s,s.pendingProps),n.flags|=2,kn(s),s.memoizedState=null,n}function kC(n,s,o){var h=s.pendingProps,p=(s.flags&128)!==0;if(s.flags&=-129,n===null){if(Fe){if(h.mode==="hidden")return n=ic(s,h),s.lanes=536870912,ol(null,n);if(Eh(s),(n=at)?(n=ly(n,Vn),n=n!==null&&n.data==="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:as!==null?{id:mi,overflow:pi}:null,retryLane:536870912,hydrationErrors:null},o=Ag(n),o.return=s,s.child=o,Wt=s,at=null)):n=null,n===null)throw os(s);return s.lanes=536870912,null}return ic(s,h)}var g=n.memoizedState;if(g!==null){var w=g.dehydrated;if(Eh(s),p)if(s.flags&256)s.flags&=-257,s=Yv(n,s,o);else if(s.memoizedState!==null)s.child=n.child,s.flags|=128,s=null;else throw Error(r(558));else if(kt||Ur(n,s,o,!1),p=(o&n.childLanes)!==0,kt||p){if(h=tt,h!==null&&(w=Hp(h,o),w!==0&&w!==g.retryLane))throw g.retryLane=w,Gs(n,w),vn(h,n,w),Yh;mc(),s=Yv(n,s,o)}else n=g.treeContext,at=Yn(w.nextSibling),Wt=s,Fe=!0,ls=null,Vn=!1,n!==null&&Bg(s,n),s=ic(s,h),s.flags|=4096;return s}return n=Mi(n.child,{mode:h.mode,children:h.children}),n.ref=s.ref,s.child=n,n.return=s,n}function sc(n,s){var o=s.ref;if(o===null)n!==null&&n.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(r(284));(n===null||n.ref!==o)&&(s.flags|=4194816)}}function Xh(n,s,o,h,p){return Zs(s),o=Rh(n,s,o,h,void 0,p),h=Dh(),n!==null&&!kt?(Ah(n,s,p),Ii(n,s,p)):(Fe&&h&&hh(s),s.flags|=1,Gt(n,s,o,p),s.child)}function Xv(n,s,o,h,p,g){return Zs(s),s.updateQueue=null,o=Qg(s,h,o,p),Zg(n),h=Dh(),n!==null&&!kt?(Ah(n,s,g),Ii(n,s,g)):(Fe&&h&&hh(s),s.flags|=1,Gt(n,s,o,g),s.child)}function Jv(n,s,o,h,p){if(Zs(s),s.stateNode===null){var g=zr,w=o.contextType;typeof w=="object"&&w!==null&&(g=Vt(w)),g=new o(h,g),s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Vh,s.stateNode=g,g._reactInternals=s,g=s.stateNode,g.props=h,g.state=s.memoizedState,g.refs={},bh(s),w=o.contextType,g.context=typeof w=="object"&&w!==null?Vt(w):zr,g.state=s.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(Wh(s,o,w,h),g.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(w=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),w!==g.state&&Vh.enqueueReplaceState(g,g.state,null),il(s,h,g,p),nl(),g.state=s.memoizedState),typeof g.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(n===null){g=s.stateNode;var O=s.memoizedProps,K=sr(o,O);g.props=K;var Q=g.context,se=o.contextType;w=zr,typeof se=="object"&&se!==null&&(w=Vt(se));var le=o.getDerivedStateFromProps;se=typeof le=="function"||typeof g.getSnapshotBeforeUpdate=="function",O=s.pendingProps!==O,se||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(O||Q!==w)&&zv(s,g,h,w),us=!1;var ee=s.memoizedState;g.state=ee,il(s,h,g,p),nl(),Q=s.memoizedState,O||ee!==Q||us?(typeof le=="function"&&(Wh(s,o,le,h),Q=s.memoizedState),(K=us||Ov(s,o,K,h,ee,Q,w))?(se||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount()),typeof g.componentDidMount=="function"&&(s.flags|=4194308)):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=Q),g.props=h,g.state=Q,g.context=w,h=K):(typeof g.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{g=s.stateNode,wh(n,s),w=s.memoizedProps,se=sr(o,w),g.props=se,le=s.pendingProps,ee=g.context,Q=o.contextType,K=zr,typeof Q=="object"&&Q!==null&&(K=Vt(Q)),O=o.getDerivedStateFromProps,(Q=typeof O=="function"||typeof g.getSnapshotBeforeUpdate=="function")||typeof g.UNSAFE_componentWillReceiveProps!="function"&&typeof g.componentWillReceiveProps!="function"||(w!==le||ee!==K)&&zv(s,g,h,K),us=!1,ee=s.memoizedState,g.state=ee,il(s,h,g,p),nl();var te=s.memoizedState;w!==le||ee!==te||us||n!==null&&n.dependencies!==null&&Ho(n.dependencies)?(typeof O=="function"&&(Wh(s,o,O,h),te=s.memoizedState),(se=us||Ov(s,o,se,h,ee,te,K)||n!==null&&n.dependencies!==null&&Ho(n.dependencies))?(Q||typeof g.UNSAFE_componentWillUpdate!="function"&&typeof g.componentWillUpdate!="function"||(typeof g.componentWillUpdate=="function"&&g.componentWillUpdate(h,te,K),typeof g.UNSAFE_componentWillUpdate=="function"&&g.UNSAFE_componentWillUpdate(h,te,K)),typeof g.componentDidUpdate=="function"&&(s.flags|=4),typeof g.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof g.componentDidUpdate!="function"||w===n.memoizedProps&&ee===n.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||w===n.memoizedProps&&ee===n.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=te),g.props=h,g.state=te,g.context=K,h=se):(typeof g.componentDidUpdate!="function"||w===n.memoizedProps&&ee===n.memoizedState||(s.flags|=4),typeof g.getSnapshotBeforeUpdate!="function"||w===n.memoizedProps&&ee===n.memoizedState||(s.flags|=1024),h=!1)}return g=h,sc(n,s),h=(s.flags&128)!==0,g||h?(g=s.stateNode,o=h&&typeof o.getDerivedStateFromError!="function"?null:g.render(),s.flags|=1,n!==null&&h?(s.child=nr(s,n.child,null,p),s.child=nr(s,null,o,p)):Gt(n,s,o,p),s.memoizedState=g.state,n=s.child):n=Ii(n,s,p),n}function Zv(n,s,o,h){return Xs(),s.flags|=256,Gt(n,s,o,h),s.child}var Jh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Zh(n){return{baseLanes:n,cachePool:Ug()}}function Qh(n,s,o){return n=n!==null?n.childLanes&~o:0,s&&(n|=En),n}function Qv(n,s,o){var h=s.pendingProps,p=!1,g=(s.flags&128)!==0,w;if((w=g)||(w=n!==null&&n.memoizedState===null?!1:(xt.current&2)!==0),w&&(p=!0,s.flags&=-129),w=(s.flags&32)!==0,s.flags&=-33,n===null){if(Fe){if(p?fs(s):ms(),(n=at)?(n=ly(n,Vn),n=n!==null&&n.data!=="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:as!==null?{id:mi,overflow:pi}:null,retryLane:536870912,hydrationErrors:null},o=Ag(n),o.return=s,s.child=o,Wt=s,at=null)):n=null,n===null)throw os(s);return Bd(n)?s.lanes=32:s.lanes=536870912,null}var O=h.children;return h=h.fallback,p?(ms(),p=s.mode,O=rc({mode:"hidden",children:O},p),h=Ys(h,p,o,null),O.return=s,h.return=s,O.sibling=h,s.child=O,h=s.child,h.memoizedState=Zh(o),h.childLanes=Qh(n,w,o),s.memoizedState=Jh,ol(null,h)):(fs(s),ed(s,O))}var K=n.memoizedState;if(K!==null&&(O=K.dehydrated,O!==null)){if(g)s.flags&256?(fs(s),s.flags&=-257,s=td(n,s,o)):s.memoizedState!==null?(ms(),s.child=n.child,s.flags|=128,s=null):(ms(),O=h.fallback,p=s.mode,h=rc({mode:"visible",children:h.children},p),O=Ys(O,p,o,null),O.flags|=2,h.return=s,O.return=s,h.sibling=O,s.child=h,nr(s,n.child,null,o),h=s.child,h.memoizedState=Zh(o),h.childLanes=Qh(n,w,o),s.memoizedState=Jh,s=ol(null,h));else if(fs(s),Bd(O)){if(w=O.nextSibling&&O.nextSibling.dataset,w)var Q=w.dgst;w=Q,h=Error(r(419)),h.stack="",h.digest=w,Xa({value:h,source:null,stack:null}),s=td(n,s,o)}else if(kt||Ur(n,s,o,!1),w=(o&n.childLanes)!==0,kt||w){if(w=tt,w!==null&&(h=Hp(w,o),h!==0&&h!==K.retryLane))throw K.retryLane=h,Gs(n,h),vn(w,n,h),Yh;Md(O)||mc(),s=td(n,s,o)}else Md(O)?(s.flags|=192,s.child=n.child,s=null):(n=K.treeContext,at=Yn(O.nextSibling),Wt=s,Fe=!0,ls=null,Vn=!1,n!==null&&Bg(s,n),s=ed(s,h.children),s.flags|=4096);return s}return p?(ms(),O=h.fallback,p=s.mode,K=n.child,Q=K.sibling,h=Mi(K,{mode:"hidden",children:h.children}),h.subtreeFlags=K.subtreeFlags&65011712,Q!==null?O=Mi(Q,O):(O=Ys(O,p,o,null),O.flags|=2),O.return=s,h.return=s,h.sibling=O,s.child=h,ol(null,h),h=s.child,O=n.child.memoizedState,O===null?O=Zh(o):(p=O.cachePool,p!==null?(K=Ct._currentValue,p=p.parent!==K?{parent:K,pool:K}:p):p=Ug(),O={baseLanes:O.baseLanes|o,cachePool:p}),h.memoizedState=O,h.childLanes=Qh(n,w,o),s.memoizedState=Jh,ol(n.child,h)):(fs(s),o=n.child,n=o.sibling,o=Mi(o,{mode:"visible",children:h.children}),o.return=s,o.sibling=null,n!==null&&(w=s.deletions,w===null?(s.deletions=[n],s.flags|=16):w.push(n)),s.child=o,s.memoizedState=null,o)}function ed(n,s){return s=rc({mode:"visible",children:s},n.mode),s.return=n,n.child=s}function rc(n,s){return n=Cn(22,n,null,s),n.lanes=0,n}function td(n,s,o){return nr(s,n.child,null,o),n=ed(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function e_(n,s,o){n.lanes|=s;var h=n.alternate;h!==null&&(h.lanes|=s),gh(n.return,s,o)}function nd(n,s,o,h,p,g){var w=n.memoizedState;w===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:p,treeForkCount:g}:(w.isBackwards=s,w.rendering=null,w.renderingStartTime=0,w.last=h,w.tail=o,w.tailMode=p,w.treeForkCount=g)}function t_(n,s,o){var h=s.pendingProps,p=h.revealOrder,g=h.tail;h=h.children;var w=xt.current,O=(w&2)!==0;if(O?(w=w&1|2,s.flags|=128):w&=1,L(xt,w),Gt(n,s,h,o),h=Fe?Ya:0,!O&&n!==null&&(n.flags&128)!==0)e:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&e_(n,o,s);else if(n.tag===19)e_(n,o,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break e;for(;n.sibling===null;){if(n.return===null||n.return===s)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(p){case"forwards":for(o=s.child,p=null;o!==null;)n=o.alternate,n!==null&&Vo(n)===null&&(p=o),o=o.sibling;o=p,o===null?(p=s.child,s.child=null):(p=o.sibling,o.sibling=null),nd(s,!1,p,o,g,h);break;case"backwards":case"unstable_legacy-backwards":for(o=null,p=s.child,s.child=null;p!==null;){if(n=p.alternate,n!==null&&Vo(n)===null){s.child=p;break}n=p.sibling,p.sibling=o,o=p,p=n}nd(s,!0,o,null,g,h);break;case"together":nd(s,!1,null,null,void 0,h);break;default:s.memoizedState=null}return s.child}function Ii(n,s,o){if(n!==null&&(s.dependencies=n.dependencies),vs|=s.lanes,(o&s.childLanes)===0)if(n!==null){if(Ur(n,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(n!==null&&s.child!==n.child)throw Error(r(153));if(s.child!==null){for(n=s.child,o=Mi(n,n.pendingProps),s.child=o,o.return=s;n.sibling!==null;)n=n.sibling,o=o.sibling=Mi(n,n.pendingProps),o.return=s;o.sibling=null}return s.child}function id(n,s){return(n.lanes&s)!==0?!0:(n=n.dependencies,!!(n!==null&&Ho(n)))}function NC(n,s,o){switch(s.tag){case 3:oe(s,s.stateNode.containerInfo),cs(s,Ct,n.memoizedState.cache),Xs();break;case 27:case 5:ue(s);break;case 4:oe(s,s.stateNode.containerInfo);break;case 10:cs(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Eh(s),null;break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(fs(s),s.flags|=128,null):(o&s.child.childLanes)!==0?Qv(n,s,o):(fs(s),n=Ii(n,s,o),n!==null?n.sibling:null);fs(s);break;case 19:var p=(n.flags&128)!==0;if(h=(o&s.childLanes)!==0,h||(Ur(n,s,o,!1),h=(o&s.childLanes)!==0),p){if(h)return t_(n,s,o);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),L(xt,xt.current),h)break;return null;case 22:return s.lanes=0,Vv(n,s,o,s.pendingProps);case 24:cs(s,Ct,n.memoizedState.cache)}return Ii(n,s,o)}function n_(n,s,o){if(n!==null)if(n.memoizedProps!==s.pendingProps)kt=!0;else{if(!id(n,o)&&(s.flags&128)===0)return kt=!1,NC(n,s,o);kt=(n.flags&131072)!==0}else kt=!1,Fe&&(s.flags&1048576)!==0&&Mg(s,Ya,s.index);switch(s.lanes=0,s.tag){case 16:e:{var h=s.pendingProps;if(n=er(s.elementType),s.type=n,typeof n=="function")oh(n)?(h=sr(n,h),s.tag=1,s=Jv(null,s,n,h,o)):(s.tag=0,s=Xh(null,s,n,h,o));else{if(n!=null){var p=n.$$typeof;if(p===E){s.tag=11,s=Kv(null,s,n,h,o);break e}else if(p===I){s.tag=14,s=qv(null,s,n,h,o);break e}}throw s=j(n)||n,Error(r(306,s,""))}}return s;case 0:return Xh(n,s,s.type,s.pendingProps,o);case 1:return h=s.type,p=sr(h,s.pendingProps),Jv(n,s,h,p,o);case 3:e:{if(oe(s,s.stateNode.containerInfo),n===null)throw Error(r(387));h=s.pendingProps;var g=s.memoizedState;p=g.element,wh(n,s),il(s,h,null,o);var w=s.memoizedState;if(h=w.cache,cs(s,Ct,h),h!==g.cache&&vh(s,[Ct],o,!0),nl(),h=w.element,g.isDehydrated)if(g={element:h,isDehydrated:!1,cache:w.cache},s.updateQueue.baseState=g,s.memoizedState=g,s.flags&256){s=Zv(n,s,h,o);break e}else if(h!==p){p=Kn(Error(r(424)),s),Xa(p),s=Zv(n,s,h,o);break e}else for(n=s.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,at=Yn(n.firstChild),Wt=s,Fe=!0,ls=null,Vn=!0,o=Vg(s,null,h,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Xs(),h===p){s=Ii(n,s,o);break e}Gt(n,s,h,o)}s=s.child}return s;case 26:return sc(n,s),n===null?(o=fy(s.type,null,s.pendingProps,null))?s.memoizedState=o:Fe||(o=s.type,n=s.pendingProps,h=Sc(he.current).createElement(o),h[qt]=s,h[hn]=n,Yt(h,o,n),zt(h),s.stateNode=h):s.memoizedState=fy(s.type,n.memoizedProps,s.pendingProps,n.memoizedState),null;case 27:return ue(s),n===null&&Fe&&(h=s.stateNode=uy(s.type,s.pendingProps,he.current),Wt=s,Vn=!0,p=at,bs(s.type)?(Od=p,at=Yn(h.firstChild)):at=p),Gt(n,s,s.pendingProps.children,o),sc(n,s),n===null&&(s.flags|=4194304),s.child;case 5:return n===null&&Fe&&((p=h=at)&&(h=ij(h,s.type,s.pendingProps,Vn),h!==null?(s.stateNode=h,Wt=s,at=Yn(h.firstChild),Vn=!1,p=!0):p=!1),p||os(s)),ue(s),p=s.type,g=s.pendingProps,w=n!==null?n.memoizedProps:null,h=g.children,Dd(p,g)?h=null:w!==null&&Dd(p,w)&&(s.flags|=32),s.memoizedState!==null&&(p=Rh(n,s,_C,null,null,o),wl._currentValue=p),sc(n,s),Gt(n,s,h,o),s.child;case 6:return n===null&&Fe&&((n=o=at)&&(o=sj(o,s.pendingProps,Vn),o!==null?(s.stateNode=o,Wt=s,at=null,n=!0):n=!1),n||os(s)),null;case 13:return Qv(n,s,o);case 4:return oe(s,s.stateNode.containerInfo),h=s.pendingProps,n===null?s.child=nr(s,null,h,o):Gt(n,s,h,o),s.child;case 11:return Kv(n,s,s.type,s.pendingProps,o);case 7:return Gt(n,s,s.pendingProps,o),s.child;case 8:return Gt(n,s,s.pendingProps.children,o),s.child;case 12:return Gt(n,s,s.pendingProps.children,o),s.child;case 10:return h=s.pendingProps,cs(s,s.type,h.value),Gt(n,s,h.children,o),s.child;case 9:return p=s.type._context,h=s.pendingProps.children,Zs(s),p=Vt(p),h=h(p),s.flags|=1,Gt(n,s,h,o),s.child;case 14:return qv(n,s,s.type,s.pendingProps,o);case 15:return Wv(n,s,s.type,s.pendingProps,o);case 19:return t_(n,s,o);case 31:return kC(n,s,o);case 22:return Vv(n,s,o,s.pendingProps);case 24:return Zs(s),h=Vt(Ct),n===null?(p=xh(),p===null&&(p=tt,g=_h(),p.pooledCache=g,g.refCount++,g!==null&&(p.pooledCacheLanes|=o),p=g),s.memoizedState={parent:h,cache:p},bh(s),cs(s,Ct,p)):((n.lanes&o)!==0&&(wh(n,s),il(s,null,null,o),nl()),p=n.memoizedState,g=s.memoizedState,p.parent!==h?(p={parent:h,cache:h},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),cs(s,Ct,h)):(h=g.cache,cs(s,Ct,h),h!==p.cache&&vh(s,[Ct],o,!0))),Gt(n,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function Ui(n){n.flags|=4}function sd(n,s,o,h,p){if((s=(n.mode&32)!==0)&&(s=!1),s){if(n.flags|=16777216,(p&335544128)===p)if(n.stateNode.complete)n.flags|=8192;else if(T_())n.flags|=8192;else throw tr=$o,Sh}else n.flags&=-16777217}function i_(n,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!_y(s))if(T_())n.flags|=8192;else throw tr=$o,Sh}function ac(n,s){s!==null&&(n.flags|=4),n.flags&16384&&(s=n.tag!==22?Op():536870912,n.lanes|=s,Qr|=s)}function cl(n,s){if(!Fe)switch(n.tailMode){case"hidden":s=n.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:h.sibling=null}}function lt(n){var s=n.alternate!==null&&n.alternate.child===n.child,o=0,h=0;if(s)for(var p=n.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags&65011712,h|=p.flags&65011712,p.return=n,p=p.sibling;else for(p=n.child;p!==null;)o|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=n,p=p.sibling;return n.subtreeFlags|=h,n.childLanes=o,s}function EC(n,s,o){var h=s.pendingProps;switch(dh(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lt(s),null;case 1:return lt(s),null;case 3:return o=s.stateNode,h=null,n!==null&&(h=n.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),zi(Ct),ye(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(Ir(s)?Ui(s):n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,mh())),lt(s),null;case 26:var p=s.type,g=s.memoizedState;return n===null?(Ui(s),g!==null?(lt(s),i_(s,g)):(lt(s),sd(s,p,null,h,o))):g?g!==n.memoizedState?(Ui(s),lt(s),i_(s,g)):(lt(s),s.flags&=-16777217):(n=n.memoizedProps,n!==h&&Ui(s),lt(s),sd(s,p,n,h,o)),null;case 27:if(Se(s),o=he.current,p=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&Ui(s);else{if(!h){if(s.stateNode===null)throw Error(r(166));return lt(s),null}n=re.current,Ir(s)?Og(s):(n=uy(p,h,o),s.stateNode=n,Ui(s))}return lt(s),null;case 5:if(Se(s),p=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&Ui(s);else{if(!h){if(s.stateNode===null)throw Error(r(166));return lt(s),null}if(g=re.current,Ir(s))Og(s);else{var w=Sc(he.current);switch(g){case 1:g=w.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:g=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":g=w.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":g=w.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":g=w.createElement("div"),g.innerHTML="<script><\/script>",g=g.removeChild(g.firstChild);break;case"select":g=typeof h.is=="string"?w.createElement("select",{is:h.is}):w.createElement("select"),h.multiple?g.multiple=!0:h.size&&(g.size=h.size);break;default:g=typeof h.is=="string"?w.createElement(p,{is:h.is}):w.createElement(p)}}g[qt]=s,g[hn]=h;e:for(w=s.child;w!==null;){if(w.tag===5||w.tag===6)g.appendChild(w.stateNode);else if(w.tag!==4&&w.tag!==27&&w.child!==null){w.child.return=w,w=w.child;continue}if(w===s)break e;for(;w.sibling===null;){if(w.return===null||w.return===s)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}s.stateNode=g;e:switch(Yt(g,p,h),p){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}h&&Ui(s)}}return lt(s),sd(s,s.type,n===null?null:n.memoizedProps,s.pendingProps,o),null;case 6:if(n&&s.stateNode!=null)n.memoizedProps!==h&&Ui(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(r(166));if(n=he.current,Ir(s)){if(n=s.stateNode,o=s.memoizedProps,h=null,p=Wt,p!==null)switch(p.tag){case 27:case 5:h=p.memoizedProps}n[qt]=s,n=!!(n.nodeValue===o||h!==null&&h.suppressHydrationWarning===!0||Q_(n.nodeValue,o)),n||os(s,!0)}else n=Sc(n).createTextNode(h),n[qt]=s,s.stateNode=n}return lt(s),null;case 31:if(o=s.memoizedState,n===null||n.memoizedState!==null){if(h=Ir(s),o!==null){if(n===null){if(!h)throw Error(r(318));if(n=s.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(557));n[qt]=s}else Xs(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;lt(s),n=!1}else o=mh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return s.flags&256?(kn(s),s):(kn(s),null);if((s.flags&128)!==0)throw Error(r(558))}return lt(s),null;case 13:if(h=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(p=Ir(s),h!==null&&h.dehydrated!==null){if(n===null){if(!p)throw Error(r(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[qt]=s}else Xs(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;lt(s),p=!1}else p=mh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(kn(s),s):(kn(s),null)}return kn(s),(s.flags&128)!==0?(s.lanes=o,s):(o=h!==null,n=n!==null&&n.memoizedState!==null,o&&(h=s.child,p=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(p=h.alternate.memoizedState.cachePool.pool),g=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(g=h.memoizedState.cachePool.pool),g!==p&&(h.flags|=2048)),o!==n&&o&&(s.child.flags|=8192),ac(s,s.updateQueue),lt(s),null);case 4:return ye(),n===null&&kd(s.stateNode.containerInfo),lt(s),null;case 10:return zi(s.type),lt(s),null;case 19:if(H(xt),h=s.memoizedState,h===null)return lt(s),null;if(p=(s.flags&128)!==0,g=h.rendering,g===null)if(p)cl(h,!1);else{if(gt!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(g=Vo(n),g!==null){for(s.flags|=128,cl(h,!1),n=g.updateQueue,s.updateQueue=n,ac(s,n),s.subtreeFlags=0,n=o,o=s.child;o!==null;)Dg(o,n),o=o.sibling;return L(xt,xt.current&1|2),Fe&&Bi(s,h.treeForkCount),s.child}n=n.sibling}h.tail!==null&&Ot()>hc&&(s.flags|=128,p=!0,cl(h,!1),s.lanes=4194304)}else{if(!p)if(n=Vo(g),n!==null){if(s.flags|=128,p=!0,n=n.updateQueue,s.updateQueue=n,ac(s,n),cl(h,!0),h.tail===null&&h.tailMode==="hidden"&&!g.alternate&&!Fe)return lt(s),null}else 2*Ot()-h.renderingStartTime>hc&&o!==536870912&&(s.flags|=128,p=!0,cl(h,!1),s.lanes=4194304);h.isBackwards?(g.sibling=s.child,s.child=g):(n=h.last,n!==null?n.sibling=g:s.child=g,h.last=g)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=Ot(),n.sibling=null,o=xt.current,L(xt,p?o&1|2:o&1),Fe&&Bi(s,h.treeForkCount),n):(lt(s),null);case 22:case 23:return kn(s),Nh(),h=s.memoizedState!==null,n!==null?n.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(o&536870912)!==0&&(s.flags&128)===0&&(lt(s),s.subtreeFlags&6&&(s.flags|=8192)):lt(s),o=s.updateQueue,o!==null&&ac(s,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==o&&(s.flags|=2048),n!==null&&H(Qs),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),zi(Ct),lt(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function TC(n,s){switch(dh(s),s.tag){case 1:return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return zi(Ct),ye(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 26:case 27:case 5:return Se(s),null;case 31:if(s.memoizedState!==null){if(kn(s),s.alternate===null)throw Error(r(340));Xs()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 13:if(kn(s),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(r(340));Xs()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return H(xt),null;case 4:return ye(),null;case 10:return zi(s.type),null;case 22:case 23:return kn(s),Nh(),n!==null&&H(Qs),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 24:return zi(Ct),null;case 25:return null;default:return null}}function s_(n,s){switch(dh(s),s.tag){case 3:zi(Ct),ye();break;case 26:case 27:case 5:Se(s);break;case 4:ye();break;case 31:s.memoizedState!==null&&kn(s);break;case 13:kn(s);break;case 19:H(xt);break;case 10:zi(s.type);break;case 22:case 23:kn(s),Nh(),n!==null&&H(Qs);break;case 24:zi(Ct)}}function ul(n,s){try{var o=s.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var p=h.next;o=p;do{if((o.tag&n)===n){h=void 0;var g=o.create,w=o.inst;h=g(),w.destroy=h}o=o.next}while(o!==p)}}catch(O){Ye(s,s.return,O)}}function ps(n,s,o){try{var h=s.updateQueue,p=h!==null?h.lastEffect:null;if(p!==null){var g=p.next;h=g;do{if((h.tag&n)===n){var w=h.inst,O=w.destroy;if(O!==void 0){w.destroy=void 0,p=s;var K=o,Q=O;try{Q()}catch(se){Ye(p,K,se)}}}h=h.next}while(h!==g)}}catch(se){Ye(s,s.return,se)}}function r_(n){var s=n.updateQueue;if(s!==null){var o=n.stateNode;try{Yg(s,o)}catch(h){Ye(n,n.return,h)}}}function a_(n,s,o){o.props=sr(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(h){Ye(n,s,h)}}function hl(n,s){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var h=n.stateNode;break;case 30:h=n.stateNode;break;default:h=n.stateNode}typeof o=="function"?n.refCleanup=o(h):o.current=h}}catch(p){Ye(n,s,p)}}function gi(n,s){var o=n.ref,h=n.refCleanup;if(o!==null)if(typeof h=="function")try{h()}catch(p){Ye(n,s,p)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(p){Ye(n,s,p)}else o.current=null}function l_(n){var s=n.type,o=n.memoizedProps,h=n.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&h.focus();break e;case"img":o.src?h.src=o.src:o.srcSet&&(h.srcset=o.srcSet)}}catch(p){Ye(n,n.return,p)}}function rd(n,s,o){try{var h=n.stateNode;JC(h,n.type,o,s),h[hn]=s}catch(p){Ye(n,n.return,p)}}function o_(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&bs(n.type)||n.tag===4}function ad(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||o_(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&bs(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function ld(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(n),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=Ai));else if(h!==4&&(h===27&&bs(n.type)&&(o=n.stateNode,s=null),n=n.child,n!==null))for(ld(n,s,o),n=n.sibling;n!==null;)ld(n,s,o),n=n.sibling}function lc(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?o.insertBefore(n,s):o.appendChild(n);else if(h!==4&&(h===27&&bs(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(lc(n,s,o),n=n.sibling;n!==null;)lc(n,s,o),n=n.sibling}function c_(n){var s=n.stateNode,o=n.memoizedProps;try{for(var h=n.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);Yt(s,h,o),s[qt]=n,s[hn]=o}catch(g){Ye(n,n.return,g)}}var Fi=!1,Nt=!1,od=!1,u_=typeof WeakSet=="function"?WeakSet:Set,Pt=null;function RC(n,s){if(n=n.containerInfo,Td=Ec,n=bg(n),th(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else e:{o=(o=n.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var p=h.anchorOffset,g=h.focusNode;h=h.focusOffset;try{o.nodeType,g.nodeType}catch{o=null;break e}var w=0,O=-1,K=-1,Q=0,se=0,le=n,ee=null;t:for(;;){for(var te;le!==o||p!==0&&le.nodeType!==3||(O=w+p),le!==g||h!==0&&le.nodeType!==3||(K=w+h),le.nodeType===3&&(w+=le.nodeValue.length),(te=le.firstChild)!==null;)ee=le,le=te;for(;;){if(le===n)break t;if(ee===o&&++Q===p&&(O=w),ee===g&&++se===h&&(K=w),(te=le.nextSibling)!==null)break;le=ee,ee=le.parentNode}le=te}o=O===-1||K===-1?null:{start:O,end:K}}else o=null}o=o||{start:0,end:0}}else o=null;for(Rd={focusedElem:n,selectionRange:o},Ec=!1,Pt=s;Pt!==null;)if(s=Pt,n=s.child,(s.subtreeFlags&1028)!==0&&n!==null)n.return=s,Pt=n;else for(;Pt!==null;){switch(s=Pt,g=s.alternate,n=s.flags,s.tag){case 0:if((n&4)!==0&&(n=s.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)p=n[o],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&g!==null){n=void 0,o=s,p=g.memoizedProps,g=g.memoizedState,h=o.stateNode;try{var be=sr(o.type,p);n=h.getSnapshotBeforeUpdate(be,g),h.__reactInternalSnapshotBeforeUpdate=n}catch(je){Ye(o,o.return,je)}}break;case 3:if((n&1024)!==0){if(n=s.stateNode.containerInfo,o=n.nodeType,o===9)Ld(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Ld(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=s.sibling,n!==null){n.return=s.return,Pt=n;break}Pt=s.return}}function h_(n,s,o){var h=o.flags;switch(o.tag){case 0:case 11:case 15:Ki(n,o),h&4&&ul(5,o);break;case 1:if(Ki(n,o),h&4)if(n=o.stateNode,s===null)try{n.componentDidMount()}catch(w){Ye(o,o.return,w)}else{var p=sr(o.type,s.memoizedProps);s=s.memoizedState;try{n.componentDidUpdate(p,s,n.__reactInternalSnapshotBeforeUpdate)}catch(w){Ye(o,o.return,w)}}h&64&&r_(o),h&512&&hl(o,o.return);break;case 3:if(Ki(n,o),h&64&&(n=o.updateQueue,n!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{Yg(n,s)}catch(w){Ye(o,o.return,w)}}break;case 27:s===null&&h&4&&c_(o);case 26:case 5:Ki(n,o),s===null&&h&4&&l_(o),h&512&&hl(o,o.return);break;case 12:Ki(n,o);break;case 31:Ki(n,o),h&4&&m_(n,o);break;case 13:Ki(n,o),h&4&&p_(n,o),h&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=HC.bind(null,o),rj(n,o))));break;case 22:if(h=o.memoizedState!==null||Fi,!h){s=s!==null&&s.memoizedState!==null||Nt,p=Fi;var g=Nt;Fi=h,(Nt=s)&&!g?qi(n,o,(o.subtreeFlags&8772)!==0):Ki(n,o),Fi=p,Nt=g}break;case 30:break;default:Ki(n,o)}}function d_(n){var s=n.alternate;s!==null&&(n.alternate=null,d_(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&Pu(s)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var ct=null,fn=!1;function $i(n,s,o){for(o=o.child;o!==null;)f_(n,s,o),o=o.sibling}function f_(n,s,o){if(Dt&&typeof Dt.onCommitFiberUnmount=="function")try{Dt.onCommitFiberUnmount(nn,o)}catch{}switch(o.tag){case 26:Nt||gi(o,s),$i(n,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Nt||gi(o,s);var h=ct,p=fn;bs(o.type)&&(ct=o.stateNode,fn=!1),$i(n,s,o),xl(o.stateNode),ct=h,fn=p;break;case 5:Nt||gi(o,s);case 6:if(h=ct,p=fn,ct=null,$i(n,s,o),ct=h,fn=p,ct!==null)if(fn)try{(ct.nodeType===9?ct.body:ct.nodeName==="HTML"?ct.ownerDocument.body:ct).removeChild(o.stateNode)}catch(g){Ye(o,s,g)}else try{ct.removeChild(o.stateNode)}catch(g){Ye(o,s,g)}break;case 18:ct!==null&&(fn?(n=ct,ry(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),la(n)):ry(ct,o.stateNode));break;case 4:h=ct,p=fn,ct=o.stateNode.containerInfo,fn=!0,$i(n,s,o),ct=h,fn=p;break;case 0:case 11:case 14:case 15:ps(2,o,s),Nt||ps(4,o,s),$i(n,s,o);break;case 1:Nt||(gi(o,s),h=o.stateNode,typeof h.componentWillUnmount=="function"&&a_(o,s,h)),$i(n,s,o);break;case 21:$i(n,s,o);break;case 22:Nt=(h=Nt)||o.memoizedState!==null,$i(n,s,o),Nt=h;break;default:$i(n,s,o)}}function m_(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{la(n)}catch(o){Ye(s,s.return,o)}}}function p_(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{la(n)}catch(o){Ye(s,s.return,o)}}function DC(n){switch(n.tag){case 31:case 13:case 19:var s=n.stateNode;return s===null&&(s=n.stateNode=new u_),s;case 22:return n=n.stateNode,s=n._retryCache,s===null&&(s=n._retryCache=new u_),s;default:throw Error(r(435,n.tag))}}function oc(n,s){var o=DC(n);s.forEach(function(h){if(!o.has(h)){o.add(h);var p=IC.bind(null,n,h);h.then(p,p)}})}function mn(n,s){var o=s.deletions;if(o!==null)for(var h=0;h<o.length;h++){var p=o[h],g=n,w=s,O=w;e:for(;O!==null;){switch(O.tag){case 27:if(bs(O.type)){ct=O.stateNode,fn=!1;break e}break;case 5:ct=O.stateNode,fn=!1;break e;case 3:case 4:ct=O.stateNode.containerInfo,fn=!0;break e}O=O.return}if(ct===null)throw Error(r(160));f_(g,w,p),ct=null,fn=!1,g=p.alternate,g!==null&&(g.return=null),p.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)g_(s,n),s=s.sibling}var li=null;function g_(n,s){var o=n.alternate,h=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:mn(s,n),pn(n),h&4&&(ps(3,n,n.return),ul(3,n),ps(5,n,n.return));break;case 1:mn(s,n),pn(n),h&512&&(Nt||o===null||gi(o,o.return)),h&64&&Fi&&(n=n.updateQueue,n!==null&&(h=n.callbacks,h!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?h:o.concat(h))));break;case 26:var p=li;if(mn(s,n),pn(n),h&512&&(Nt||o===null||gi(o,o.return)),h&4){var g=o!==null?o.memoizedState:null;if(h=n.memoizedState,o===null)if(h===null)if(n.stateNode===null){e:{h=n.type,o=n.memoizedProps,p=p.ownerDocument||p;t:switch(h){case"title":g=p.getElementsByTagName("title")[0],(!g||g[Pa]||g[qt]||g.namespaceURI==="http://www.w3.org/2000/svg"||g.hasAttribute("itemprop"))&&(g=p.createElement(h),p.head.insertBefore(g,p.querySelector("head > title"))),Yt(g,h,o),g[qt]=n,zt(g),h=g;break e;case"link":var w=gy("link","href",p).get(h+(o.href||""));if(w){for(var O=0;O<w.length;O++)if(g=w[O],g.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&g.getAttribute("rel")===(o.rel==null?null:o.rel)&&g.getAttribute("title")===(o.title==null?null:o.title)&&g.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){w.splice(O,1);break t}}g=p.createElement(h),Yt(g,h,o),p.head.appendChild(g);break;case"meta":if(w=gy("meta","content",p).get(h+(o.content||""))){for(O=0;O<w.length;O++)if(g=w[O],g.getAttribute("content")===(o.content==null?null:""+o.content)&&g.getAttribute("name")===(o.name==null?null:o.name)&&g.getAttribute("property")===(o.property==null?null:o.property)&&g.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&g.getAttribute("charset")===(o.charSet==null?null:o.charSet)){w.splice(O,1);break t}}g=p.createElement(h),Yt(g,h,o),p.head.appendChild(g);break;default:throw Error(r(468,h))}g[qt]=n,zt(g),h=g}n.stateNode=h}else vy(p,n.type,n.stateNode);else n.stateNode=py(p,h,n.memoizedProps);else g!==h?(g===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):g.count--,h===null?vy(p,n.type,n.stateNode):py(p,h,n.memoizedProps)):h===null&&n.stateNode!==null&&rd(n,n.memoizedProps,o.memoizedProps)}break;case 27:mn(s,n),pn(n),h&512&&(Nt||o===null||gi(o,o.return)),o!==null&&h&4&&rd(n,n.memoizedProps,o.memoizedProps);break;case 5:if(mn(s,n),pn(n),h&512&&(Nt||o===null||gi(o,o.return)),n.flags&32){p=n.stateNode;try{Rr(p,"")}catch(be){Ye(n,n.return,be)}}h&4&&n.stateNode!=null&&(p=n.memoizedProps,rd(n,p,o!==null?o.memoizedProps:p)),h&1024&&(od=!0);break;case 6:if(mn(s,n),pn(n),h&4){if(n.stateNode===null)throw Error(r(162));h=n.memoizedProps,o=n.stateNode;try{o.nodeValue=h}catch(be){Ye(n,n.return,be)}}break;case 3:if(Cc=null,p=li,li=bc(s.containerInfo),mn(s,n),li=p,pn(n),h&4&&o!==null&&o.memoizedState.isDehydrated)try{la(s.containerInfo)}catch(be){Ye(n,n.return,be)}od&&(od=!1,v_(n));break;case 4:h=li,li=bc(n.stateNode.containerInfo),mn(s,n),pn(n),li=h;break;case 12:mn(s,n),pn(n);break;case 31:mn(s,n),pn(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,oc(n,h)));break;case 13:mn(s,n),pn(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(uc=Ot()),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,oc(n,h)));break;case 22:p=n.memoizedState!==null;var K=o!==null&&o.memoizedState!==null,Q=Fi,se=Nt;if(Fi=Q||p,Nt=se||K,mn(s,n),Nt=se,Fi=Q,pn(n),h&8192)e:for(s=n.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(o===null||K||Fi||Nt||rr(n)),o=null,s=n;;){if(s.tag===5||s.tag===26){if(o===null){K=o=s;try{if(g=K.stateNode,p)w=g.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none";else{O=K.stateNode;var le=K.memoizedProps.style,ee=le!=null&&le.hasOwnProperty("display")?le.display:null;O.style.display=ee==null||typeof ee=="boolean"?"":(""+ee).trim()}}catch(be){Ye(K,K.return,be)}}}else if(s.tag===6){if(o===null){K=s;try{K.stateNode.nodeValue=p?"":K.memoizedProps}catch(be){Ye(K,K.return,be)}}}else if(s.tag===18){if(o===null){K=s;try{var te=K.stateNode;p?ay(te,!0):ay(K.stateNode,!1)}catch(be){Ye(K,K.return,be)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===n)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break e;for(;s.sibling===null;){if(s.return===null||s.return===n)break e;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=n.updateQueue,h!==null&&(o=h.retryQueue,o!==null&&(h.retryQueue=null,oc(n,o))));break;case 19:mn(s,n),pn(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,oc(n,h)));break;case 30:break;case 21:break;default:mn(s,n),pn(n)}}function pn(n){var s=n.flags;if(s&2){try{for(var o,h=n.return;h!==null;){if(o_(h)){o=h;break}h=h.return}if(o==null)throw Error(r(160));switch(o.tag){case 27:var p=o.stateNode,g=ad(n);lc(n,g,p);break;case 5:var w=o.stateNode;o.flags&32&&(Rr(w,""),o.flags&=-33);var O=ad(n);lc(n,O,w);break;case 3:case 4:var K=o.stateNode.containerInfo,Q=ad(n);ld(n,Q,K);break;default:throw Error(r(161))}}catch(se){Ye(n,n.return,se)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function v_(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var s=n;v_(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),n=n.sibling}}function Ki(n,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)h_(n,s.alternate,s),s=s.sibling}function rr(n){for(n=n.child;n!==null;){var s=n;switch(s.tag){case 0:case 11:case 14:case 15:ps(4,s,s.return),rr(s);break;case 1:gi(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&a_(s,s.return,o),rr(s);break;case 27:xl(s.stateNode);case 26:case 5:gi(s,s.return),rr(s);break;case 22:s.memoizedState===null&&rr(s);break;case 30:rr(s);break;default:rr(s)}n=n.sibling}}function qi(n,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,p=n,g=s,w=g.flags;switch(g.tag){case 0:case 11:case 15:qi(p,g,o),ul(4,g);break;case 1:if(qi(p,g,o),h=g,p=h.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(Q){Ye(h,h.return,Q)}if(h=g,p=h.updateQueue,p!==null){var O=h.stateNode;try{var K=p.shared.hiddenCallbacks;if(K!==null)for(p.shared.hiddenCallbacks=null,p=0;p<K.length;p++)Gg(K[p],O)}catch(Q){Ye(h,h.return,Q)}}o&&w&64&&r_(g),hl(g,g.return);break;case 27:c_(g);case 26:case 5:qi(p,g,o),o&&h===null&&w&4&&l_(g),hl(g,g.return);break;case 12:qi(p,g,o);break;case 31:qi(p,g,o),o&&w&4&&m_(p,g);break;case 13:qi(p,g,o),o&&w&4&&p_(p,g);break;case 22:g.memoizedState===null&&qi(p,g,o),hl(g,g.return);break;case 30:break;default:qi(p,g,o)}s=s.sibling}}function cd(n,s){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&Ja(o))}function ud(n,s){n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&Ja(n))}function oi(n,s,o,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)__(n,s,o,h),s=s.sibling}function __(n,s,o,h){var p=s.flags;switch(s.tag){case 0:case 11:case 15:oi(n,s,o,h),p&2048&&ul(9,s);break;case 1:oi(n,s,o,h);break;case 3:oi(n,s,o,h),p&2048&&(n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&Ja(n)));break;case 12:if(p&2048){oi(n,s,o,h),n=s.stateNode;try{var g=s.memoizedProps,w=g.id,O=g.onPostCommit;typeof O=="function"&&O(w,s.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(K){Ye(s,s.return,K)}}else oi(n,s,o,h);break;case 31:oi(n,s,o,h);break;case 13:oi(n,s,o,h);break;case 23:break;case 22:g=s.stateNode,w=s.alternate,s.memoizedState!==null?g._visibility&2?oi(n,s,o,h):dl(n,s):g._visibility&2?oi(n,s,o,h):(g._visibility|=2,Xr(n,s,o,h,(s.subtreeFlags&10256)!==0||!1)),p&2048&&cd(w,s);break;case 24:oi(n,s,o,h),p&2048&&ud(s.alternate,s);break;default:oi(n,s,o,h)}}function Xr(n,s,o,h,p){for(p=p&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var g=n,w=s,O=o,K=h,Q=w.flags;switch(w.tag){case 0:case 11:case 15:Xr(g,w,O,K,p),ul(8,w);break;case 23:break;case 22:var se=w.stateNode;w.memoizedState!==null?se._visibility&2?Xr(g,w,O,K,p):dl(g,w):(se._visibility|=2,Xr(g,w,O,K,p)),p&&Q&2048&&cd(w.alternate,w);break;case 24:Xr(g,w,O,K,p),p&&Q&2048&&ud(w.alternate,w);break;default:Xr(g,w,O,K,p)}s=s.sibling}}function dl(n,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=n,h=s,p=h.flags;switch(h.tag){case 22:dl(o,h),p&2048&&cd(h.alternate,h);break;case 24:dl(o,h),p&2048&&ud(h.alternate,h);break;default:dl(o,h)}s=s.sibling}}var fl=8192;function Jr(n,s,o){if(n.subtreeFlags&fl)for(n=n.child;n!==null;)y_(n,s,o),n=n.sibling}function y_(n,s,o){switch(n.tag){case 26:Jr(n,s,o),n.flags&fl&&n.memoizedState!==null&&vj(o,li,n.memoizedState,n.memoizedProps);break;case 5:Jr(n,s,o);break;case 3:case 4:var h=li;li=bc(n.stateNode.containerInfo),Jr(n,s,o),li=h;break;case 22:n.memoizedState===null&&(h=n.alternate,h!==null&&h.memoizedState!==null?(h=fl,fl=16777216,Jr(n,s,o),fl=h):Jr(n,s,o));break;default:Jr(n,s,o)}}function x_(n){var s=n.alternate;if(s!==null&&(n=s.child,n!==null)){s.child=null;do s=n.sibling,n.sibling=null,n=s;while(n!==null)}}function ml(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Pt=h,b_(h,n)}x_(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)S_(n),n=n.sibling}function S_(n){switch(n.tag){case 0:case 11:case 15:ml(n),n.flags&2048&&ps(9,n,n.return);break;case 3:ml(n);break;case 12:ml(n);break;case 22:var s=n.stateNode;n.memoizedState!==null&&s._visibility&2&&(n.return===null||n.return.tag!==13)?(s._visibility&=-3,cc(n)):ml(n);break;default:ml(n)}}function cc(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Pt=h,b_(h,n)}x_(n)}for(n=n.child;n!==null;){switch(s=n,s.tag){case 0:case 11:case 15:ps(8,s,s.return),cc(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,cc(s));break;default:cc(s)}n=n.sibling}}function b_(n,s){for(;Pt!==null;){var o=Pt;switch(o.tag){case 0:case 11:case 15:ps(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var h=o.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Ja(o.memoizedState.cache)}if(h=o.child,h!==null)h.return=o,Pt=h;else e:for(o=n;Pt!==null;){h=Pt;var p=h.sibling,g=h.return;if(d_(h),h===o){Pt=null;break e}if(p!==null){p.return=g,Pt=p;break e}Pt=g}}}var AC={getCacheForType:function(n){var s=Vt(Ct),o=s.data.get(n);return o===void 0&&(o=n(),s.data.set(n,o)),o},cacheSignal:function(){return Vt(Ct).controller.signal}},LC=typeof WeakMap=="function"?WeakMap:Map,qe=0,tt=null,Pe=null,Ie=0,Ge=0,Nn=null,gs=!1,Zr=!1,hd=!1,Wi=0,gt=0,vs=0,ar=0,dd=0,En=0,Qr=0,pl=null,gn=null,fd=!1,uc=0,w_=0,hc=1/0,dc=null,_s=null,At=0,ys=null,ea=null,Vi=0,md=0,pd=null,C_=null,gl=0,gd=null;function Tn(){return(qe&2)!==0&&Ie!==0?Ie&-Ie:D.T!==null?bd():Ip()}function j_(){if(En===0)if((Ie&536870912)===0||Fe){var n=xo;xo<<=1,(xo&3932160)===0&&(xo=262144),En=n}else En=536870912;return n=jn.current,n!==null&&(n.flags|=32),En}function vn(n,s,o){(n===tt&&(Ge===2||Ge===9)||n.cancelPendingCommit!==null)&&(ta(n,0),xs(n,Ie,En,!1)),za(n,o),((qe&2)===0||n!==tt)&&(n===tt&&((qe&2)===0&&(ar|=o),gt===4&&xs(n,Ie,En,!1)),vi(n))}function k_(n,s,o){if((qe&6)!==0)throw Error(r(327));var h=!o&&(s&127)===0&&(s&n.expiredLanes)===0||Oa(n,s),p=h?OC(n,s):_d(n,s,!0),g=h;do{if(p===0){Zr&&!h&&xs(n,s,0,!1);break}else{if(o=n.current.alternate,g&&!MC(o)){p=_d(n,s,!1),g=!1;continue}if(p===2){if(g=s,n.errorRecoveryDisabledLanes&g)var w=0;else w=n.pendingLanes&-536870913,w=w!==0?w:w&536870912?536870912:0;if(w!==0){s=w;e:{var O=n;p=pl;var K=O.current.memoizedState.isDehydrated;if(K&&(ta(O,w).flags|=256),w=_d(O,w,!1),w!==2){if(hd&&!K){O.errorRecoveryDisabledLanes|=g,ar|=g,p=4;break e}g=gn,gn=p,g!==null&&(gn===null?gn=g:gn.push.apply(gn,g))}p=w}if(g=!1,p!==2)continue}}if(p===1){ta(n,0),xs(n,s,0,!0);break}e:{switch(h=n,g=p,g){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:xs(h,s,En,!gs);break e;case 2:gn=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(p=uc+300-Ot(),10<p)){if(xs(h,s,En,!gs),bo(h,0,!0)!==0)break e;Vi=s,h.timeoutHandle=iy(N_.bind(null,h,o,gn,dc,fd,s,En,ar,Qr,gs,g,"Throttled",-0,0),p);break e}N_(h,o,gn,dc,fd,s,En,ar,Qr,gs,g,null,-0,0)}}break}while(!0);vi(n)}function N_(n,s,o,h,p,g,w,O,K,Q,se,le,ee,te){if(n.timeoutHandle=-1,le=s.subtreeFlags,le&8192||(le&16785408)===16785408){le={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ai},y_(s,g,le);var be=(g&62914560)===g?uc-Ot():(g&4194048)===g?w_-Ot():0;if(be=_j(le,be),be!==null){Vi=g,n.cancelPendingCommit=be(B_.bind(null,n,s,g,o,h,p,w,O,K,se,le,null,ee,te)),xs(n,g,w,!Q);return}}B_(n,s,g,o,h,p,w,O,K)}function MC(n){for(var s=n;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var h=0;h<o.length;h++){var p=o[h],g=p.getSnapshot;p=p.value;try{if(!wn(g(),p))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function xs(n,s,o,h){s&=~dd,s&=~ar,n.suspendedLanes|=s,n.pingedLanes&=~s,h&&(n.warmLanes|=s),h=n.expirationTimes;for(var p=s;0<p;){var g=31-et(p),w=1<<g;h[g]=-1,p&=~w}o!==0&&zp(n,o,s)}function fc(){return(qe&6)===0?(vl(0),!1):!0}function vd(){if(Pe!==null){if(Ge===0)var n=Pe.return;else n=Pe,Oi=Js=null,Lh(n),qr=null,Qa=0,n=Pe;for(;n!==null;)s_(n.alternate,n),n=n.return;Pe=null}}function ta(n,s){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,ej(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),Vi=0,vd(),tt=n,Pe=o=Mi(n.current,null),Ie=s,Ge=0,Nn=null,gs=!1,Zr=Oa(n,s),hd=!1,Qr=En=dd=ar=vs=gt=0,gn=pl=null,fd=!1,(s&8)!==0&&(s|=s&32);var h=n.entangledLanes;if(h!==0)for(n=n.entanglements,h&=s;0<h;){var p=31-et(h),g=1<<p;s|=n[p],h&=~g}return Wi=s,Mo(),o}function E_(n,s){Re=null,D.H=ll,s===Kr||s===Fo?(s=Kg(),Ge=3):s===Sh?(s=Kg(),Ge=4):Ge=s===Yh?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Nn=s,Pe===null&&(gt=1,nc(n,Kn(s,n.current)))}function T_(){var n=jn.current;return n===null?!0:(Ie&4194048)===Ie?Gn===null:(Ie&62914560)===Ie||(Ie&536870912)!==0?n===Gn:!1}function R_(){var n=D.H;return D.H=ll,n===null?ll:n}function D_(){var n=D.A;return D.A=AC,n}function mc(){gt=4,gs||(Ie&4194048)!==Ie&&jn.current!==null||(Zr=!0),(vs&134217727)===0&&(ar&134217727)===0||tt===null||xs(tt,Ie,En,!1)}function _d(n,s,o){var h=qe;qe|=2;var p=R_(),g=D_();(tt!==n||Ie!==s)&&(dc=null,ta(n,s)),s=!1;var w=gt;e:do try{if(Ge!==0&&Pe!==null){var O=Pe,K=Nn;switch(Ge){case 8:vd(),w=6;break e;case 3:case 2:case 9:case 6:jn.current===null&&(s=!0);var Q=Ge;if(Ge=0,Nn=null,na(n,O,K,Q),o&&Zr){w=0;break e}break;default:Q=Ge,Ge=0,Nn=null,na(n,O,K,Q)}}BC(),w=gt;break}catch(se){E_(n,se)}while(!0);return s&&n.shellSuspendCounter++,Oi=Js=null,qe=h,D.H=p,D.A=g,Pe===null&&(tt=null,Ie=0,Mo()),w}function BC(){for(;Pe!==null;)A_(Pe)}function OC(n,s){var o=qe;qe|=2;var h=R_(),p=D_();tt!==n||Ie!==s?(dc=null,hc=Ot()+500,ta(n,s)):Zr=Oa(n,s);e:do try{if(Ge!==0&&Pe!==null){s=Pe;var g=Nn;t:switch(Ge){case 1:Ge=0,Nn=null,na(n,s,g,1);break;case 2:case 9:if(Fg(g)){Ge=0,Nn=null,L_(s);break}s=function(){Ge!==2&&Ge!==9||tt!==n||(Ge=7),vi(n)},g.then(s,s);break e;case 3:Ge=7;break e;case 4:Ge=5;break e;case 7:Fg(g)?(Ge=0,Nn=null,L_(s)):(Ge=0,Nn=null,na(n,s,g,7));break;case 5:var w=null;switch(Pe.tag){case 26:w=Pe.memoizedState;case 5:case 27:var O=Pe;if(w?_y(w):O.stateNode.complete){Ge=0,Nn=null;var K=O.sibling;if(K!==null)Pe=K;else{var Q=O.return;Q!==null?(Pe=Q,pc(Q)):Pe=null}break t}}Ge=0,Nn=null,na(n,s,g,5);break;case 6:Ge=0,Nn=null,na(n,s,g,6);break;case 8:vd(),gt=6;break e;default:throw Error(r(462))}}zC();break}catch(se){E_(n,se)}while(!0);return Oi=Js=null,D.H=h,D.A=p,qe=o,Pe!==null?0:(tt=null,Ie=0,Mo(),gt)}function zC(){for(;Pe!==null&&!wr();)A_(Pe)}function A_(n){var s=n_(n.alternate,n,Wi);n.memoizedProps=n.pendingProps,s===null?pc(n):Pe=s}function L_(n){var s=n,o=s.alternate;switch(s.tag){case 15:case 0:s=Xv(o,s,s.pendingProps,s.type,void 0,Ie);break;case 11:s=Xv(o,s,s.pendingProps,s.type.render,s.ref,Ie);break;case 5:Lh(s);default:s_(o,s),s=Pe=Dg(s,Wi),s=n_(o,s,Wi)}n.memoizedProps=n.pendingProps,s===null?pc(n):Pe=s}function na(n,s,o,h){Oi=Js=null,Lh(s),qr=null,Qa=0;var p=s.return;try{if(jC(n,p,s,o,Ie)){gt=1,nc(n,Kn(o,n.current)),Pe=null;return}}catch(g){if(p!==null)throw Pe=p,g;gt=1,nc(n,Kn(o,n.current)),Pe=null;return}s.flags&32768?(Fe||h===1?n=!0:Zr||(Ie&536870912)!==0?n=!1:(gs=n=!0,(h===2||h===9||h===3||h===6)&&(h=jn.current,h!==null&&h.tag===13&&(h.flags|=16384))),M_(s,n)):pc(s)}function pc(n){var s=n;do{if((s.flags&32768)!==0){M_(s,gs);return}n=s.return;var o=EC(s.alternate,s,Wi);if(o!==null){Pe=o;return}if(s=s.sibling,s!==null){Pe=s;return}Pe=s=n}while(s!==null);gt===0&&(gt=5)}function M_(n,s){do{var o=TC(n.alternate,n);if(o!==null){o.flags&=32767,Pe=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(n=n.sibling,n!==null)){Pe=n;return}Pe=n=o}while(n!==null);gt=6,Pe=null}function B_(n,s,o,h,p,g,w,O,K){n.cancelPendingCommit=null;do gc();while(At!==0);if((qe&6)!==0)throw Error(r(327));if(s!==null){if(s===n.current)throw Error(r(177));if(g=s.lanes|s.childLanes,g|=ah,gw(n,o,g,w,O,K),n===tt&&(Pe=tt=null,Ie=0),ea=s,ys=n,Vi=o,md=g,pd=p,C_=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,UC(ke,function(){return I_(),null})):(n.callbackNode=null,n.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=D.T,D.T=null,p=$.p,$.p=2,w=qe,qe|=4;try{RC(n,s,o)}finally{qe=w,$.p=p,D.T=h}}At=1,O_(),z_(),P_()}}function O_(){if(At===1){At=0;var n=ys,s=ea,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=D.T,D.T=null;var h=$.p;$.p=2;var p=qe;qe|=4;try{g_(s,n);var g=Rd,w=bg(n.containerInfo),O=g.focusedElem,K=g.selectionRange;if(w!==O&&O&&O.ownerDocument&&Sg(O.ownerDocument.documentElement,O)){if(K!==null&&th(O)){var Q=K.start,se=K.end;if(se===void 0&&(se=Q),"selectionStart"in O)O.selectionStart=Q,O.selectionEnd=Math.min(se,O.value.length);else{var le=O.ownerDocument||document,ee=le&&le.defaultView||window;if(ee.getSelection){var te=ee.getSelection(),be=O.textContent.length,je=Math.min(K.start,be),Ze=K.end===void 0?je:Math.min(K.end,be);!te.extend&&je>Ze&&(w=Ze,Ze=je,je=w);var J=xg(O,je),X=xg(O,Ze);if(J&&X&&(te.rangeCount!==1||te.anchorNode!==J.node||te.anchorOffset!==J.offset||te.focusNode!==X.node||te.focusOffset!==X.offset)){var Z=le.createRange();Z.setStart(J.node,J.offset),te.removeAllRanges(),je>Ze?(te.addRange(Z),te.extend(X.node,X.offset)):(Z.setEnd(X.node,X.offset),te.addRange(Z))}}}}for(le=[],te=O;te=te.parentNode;)te.nodeType===1&&le.push({element:te,left:te.scrollLeft,top:te.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<le.length;O++){var ae=le[O];ae.element.scrollLeft=ae.left,ae.element.scrollTop=ae.top}}Ec=!!Td,Rd=Td=null}finally{qe=p,$.p=h,D.T=o}}n.current=s,At=2}}function z_(){if(At===2){At=0;var n=ys,s=ea,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=D.T,D.T=null;var h=$.p;$.p=2;var p=qe;qe|=4;try{h_(n,s.alternate,s)}finally{qe=p,$.p=h,D.T=o}}At=3}}function P_(){if(At===4||At===3){At=0,Fs();var n=ys,s=ea,o=Vi,h=C_;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?At=5:(At=0,ea=ys=null,H_(n,n.pendingLanes));var p=n.pendingLanes;if(p===0&&(_s=null),Ou(o),s=s.stateNode,Dt&&typeof Dt.onCommitFiberRoot=="function")try{Dt.onCommitFiberRoot(nn,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=D.T,p=$.p,$.p=2,D.T=null;try{for(var g=n.onRecoverableError,w=0;w<h.length;w++){var O=h[w];g(O.value,{componentStack:O.stack})}}finally{D.T=s,$.p=p}}(Vi&3)!==0&&gc(),vi(n),p=n.pendingLanes,(o&261930)!==0&&(p&42)!==0?n===gd?gl++:(gl=0,gd=n):gl=0,vl(0)}}function H_(n,s){(n.pooledCacheLanes&=s)===0&&(s=n.pooledCache,s!=null&&(n.pooledCache=null,Ja(s)))}function gc(){return O_(),z_(),P_(),I_()}function I_(){if(At!==5)return!1;var n=ys,s=md;md=0;var o=Ou(Vi),h=D.T,p=$.p;try{$.p=32>o?32:o,D.T=null,o=pd,pd=null;var g=ys,w=Vi;if(At=0,ea=ys=null,Vi=0,(qe&6)!==0)throw Error(r(331));var O=qe;if(qe|=4,S_(g.current),__(g,g.current,w,o),qe=O,vl(0,!1),Dt&&typeof Dt.onPostCommitFiberRoot=="function")try{Dt.onPostCommitFiberRoot(nn,g)}catch{}return!0}finally{$.p=p,D.T=h,H_(n,s)}}function U_(n,s,o){s=Kn(o,s),s=Gh(n.stateNode,s,2),n=ds(n,s,2),n!==null&&(za(n,2),vi(n))}function Ye(n,s,o){if(n.tag===3)U_(n,n,o);else for(;s!==null;){if(s.tag===3){U_(s,n,o);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(_s===null||!_s.has(h))){n=Kn(o,n),o=Fv(2),h=ds(s,o,2),h!==null&&($v(o,h,s,n),za(h,2),vi(h));break}}s=s.return}}function yd(n,s,o){var h=n.pingCache;if(h===null){h=n.pingCache=new LC;var p=new Set;h.set(s,p)}else p=h.get(s),p===void 0&&(p=new Set,h.set(s,p));p.has(o)||(hd=!0,p.add(o),n=PC.bind(null,n,s,o),s.then(n,n))}function PC(n,s,o){var h=n.pingCache;h!==null&&h.delete(s),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,tt===n&&(Ie&o)===o&&(gt===4||gt===3&&(Ie&62914560)===Ie&&300>Ot()-uc?(qe&2)===0&&ta(n,0):dd|=o,Qr===Ie&&(Qr=0)),vi(n)}function F_(n,s){s===0&&(s=Op()),n=Gs(n,s),n!==null&&(za(n,s),vi(n))}function HC(n){var s=n.memoizedState,o=0;s!==null&&(o=s.retryLane),F_(n,o)}function IC(n,s){var o=0;switch(n.tag){case 31:case 13:var h=n.stateNode,p=n.memoizedState;p!==null&&(o=p.retryLane);break;case 19:h=n.stateNode;break;case 22:h=n.stateNode._retryCache;break;default:throw Error(r(314))}h!==null&&h.delete(s),F_(n,o)}function UC(n,s){return tn(n,s)}var vc=null,ia=null,xd=!1,_c=!1,Sd=!1,Ss=0;function vi(n){n!==ia&&n.next===null&&(ia===null?vc=ia=n:ia=ia.next=n),_c=!0,xd||(xd=!0,$C())}function vl(n,s){if(!Sd&&_c){Sd=!0;do for(var o=!1,h=vc;h!==null;){if(n!==0){var p=h.pendingLanes;if(p===0)var g=0;else{var w=h.suspendedLanes,O=h.pingedLanes;g=(1<<31-et(42|n)+1)-1,g&=p&~(w&~O),g=g&201326741?g&201326741|1:g?g|2:0}g!==0&&(o=!0,W_(h,g))}else g=Ie,g=bo(h,h===tt?g:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(g&3)===0||Oa(h,g)||(o=!0,W_(h,g));h=h.next}while(o);Sd=!1}}function FC(){$_()}function $_(){_c=xd=!1;var n=0;Ss!==0&&QC()&&(n=Ss);for(var s=Ot(),o=null,h=vc;h!==null;){var p=h.next,g=K_(h,s);g===0?(h.next=null,o===null?vc=p:o.next=p,p===null&&(ia=o)):(o=h,(n!==0||(g&3)!==0)&&(_c=!0)),h=p}At!==0&&At!==5||vl(n),Ss!==0&&(Ss=0)}function K_(n,s){for(var o=n.suspendedLanes,h=n.pingedLanes,p=n.expirationTimes,g=n.pendingLanes&-62914561;0<g;){var w=31-et(g),O=1<<w,K=p[w];K===-1?((O&o)===0||(O&h)!==0)&&(p[w]=pw(O,s)):K<=s&&(n.expiredLanes|=O),g&=~O}if(s=tt,o=Ie,o=bo(n,n===s?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h=n.callbackNode,o===0||n===s&&(Ge===2||Ge===9)||n.cancelPendingCommit!==null)return h!==null&&h!==null&&Us(h),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Oa(n,o)){if(s=o&-o,s===n.callbackPriority)return s;switch(h!==null&&Us(h),Ou(o)){case 2:case 8:o=pe;break;case 32:o=ke;break;case 268435456:o=Ve;break;default:o=ke}return h=q_.bind(null,n),o=tn(o,h),n.callbackPriority=s,n.callbackNode=o,s}return h!==null&&h!==null&&Us(h),n.callbackPriority=2,n.callbackNode=null,2}function q_(n,s){if(At!==0&&At!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(gc()&&n.callbackNode!==o)return null;var h=Ie;return h=bo(n,n===tt?h:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h===0?null:(k_(n,h,s),K_(n,Ot()),n.callbackNode!=null&&n.callbackNode===o?q_.bind(null,n):null)}function W_(n,s){if(gc())return null;k_(n,s,!0)}function $C(){tj(function(){(qe&6)!==0?tn(ie,FC):$_()})}function bd(){if(Ss===0){var n=Fr;n===0&&(n=yo,yo<<=1,(yo&261888)===0&&(yo=256)),Ss=n}return Ss}function V_(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:ko(""+n)}function G_(n,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,n.id&&o.setAttribute("form",n.id),s.parentNode.insertBefore(o,s),n=new FormData(n),o.parentNode.removeChild(o),n}function KC(n,s,o,h,p){if(s==="submit"&&o&&o.stateNode===p){var g=V_((p[hn]||null).action),w=h.submitter;w&&(s=(s=w[hn]||null)?V_(s.formAction):w.getAttribute("formAction"),s!==null&&(g=s,w=null));var O=new Ro("action","action",null,h,p);n.push({event:O,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Ss!==0){var K=w?G_(p,w):new FormData(p);Fh(o,{pending:!0,data:K,method:p.method,action:g},null,K)}}else typeof g=="function"&&(O.preventDefault(),K=w?G_(p,w):new FormData(p),Fh(o,{pending:!0,data:K,method:p.method,action:g},g,K))},currentTarget:p}]})}}for(var wd=0;wd<rh.length;wd++){var Cd=rh[wd],qC=Cd.toLowerCase(),WC=Cd[0].toUpperCase()+Cd.slice(1);ai(qC,"on"+WC)}ai(jg,"onAnimationEnd"),ai(kg,"onAnimationIteration"),ai(Ng,"onAnimationStart"),ai("dblclick","onDoubleClick"),ai("focusin","onFocus"),ai("focusout","onBlur"),ai(oC,"onTransitionRun"),ai(cC,"onTransitionStart"),ai(uC,"onTransitionCancel"),ai(Eg,"onTransitionEnd"),Er("onMouseEnter",["mouseout","mouseover"]),Er("onMouseLeave",["mouseout","mouseover"]),Er("onPointerEnter",["pointerout","pointerover"]),Er("onPointerLeave",["pointerout","pointerover"]),Ks("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ks("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ks("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ks("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ks("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ks("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var _l="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),VC=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(_l));function Y_(n,s){s=(s&4)!==0;for(var o=0;o<n.length;o++){var h=n[o],p=h.event;h=h.listeners;e:{var g=void 0;if(s)for(var w=h.length-1;0<=w;w--){var O=h[w],K=O.instance,Q=O.currentTarget;if(O=O.listener,K!==g&&p.isPropagationStopped())break e;g=O,p.currentTarget=Q;try{g(p)}catch(se){Lo(se)}p.currentTarget=null,g=K}else for(w=0;w<h.length;w++){if(O=h[w],K=O.instance,Q=O.currentTarget,O=O.listener,K!==g&&p.isPropagationStopped())break e;g=O,p.currentTarget=Q;try{g(p)}catch(se){Lo(se)}p.currentTarget=null,g=K}}}}function He(n,s){var o=s[zu];o===void 0&&(o=s[zu]=new Set);var h=n+"__bubble";o.has(h)||(X_(s,n,2,!1),o.add(h))}function jd(n,s,o){var h=0;s&&(h|=4),X_(o,n,h,s)}var yc="_reactListening"+Math.random().toString(36).slice(2);function kd(n){if(!n[yc]){n[yc]=!0,$p.forEach(function(o){o!=="selectionchange"&&(VC.has(o)||jd(o,!1,n),jd(o,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[yc]||(s[yc]=!0,jd("selectionchange",!1,s))}}function X_(n,s,o,h){switch(jy(s)){case 2:var p=Sj;break;case 8:p=bj;break;default:p=Ud}o=p.bind(null,s,o,n),p=void 0,!Wu||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),h?p!==void 0?n.addEventListener(s,o,{capture:!0,passive:p}):n.addEventListener(s,o,!0):p!==void 0?n.addEventListener(s,o,{passive:p}):n.addEventListener(s,o,!1)}function Nd(n,s,o,h,p){var g=h;if((s&1)===0&&(s&2)===0&&h!==null)e:for(;;){if(h===null)return;var w=h.tag;if(w===3||w===4){var O=h.stateNode.containerInfo;if(O===p)break;if(w===4)for(w=h.return;w!==null;){var K=w.tag;if((K===3||K===4)&&w.stateNode.containerInfo===p)return;w=w.return}for(;O!==null;){if(w=jr(O),w===null)return;if(K=w.tag,K===5||K===6||K===26||K===27){h=g=w;continue e}O=O.parentNode}}h=h.return}tg(function(){var Q=g,se=Ku(o),le=[];e:{var ee=Tg.get(n);if(ee!==void 0){var te=Ro,be=n;switch(n){case"keypress":if(Eo(o)===0)break e;case"keydown":case"keyup":te=Iw;break;case"focusin":be="focus",te=Xu;break;case"focusout":be="blur",te=Xu;break;case"beforeblur":case"afterblur":te=Xu;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=sg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=Ew;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=$w;break;case jg:case kg:case Ng:te=Dw;break;case Eg:te=qw;break;case"scroll":case"scrollend":te=kw;break;case"wheel":te=Vw;break;case"copy":case"cut":case"paste":te=Lw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=ag;break;case"toggle":case"beforetoggle":te=Yw}var je=(s&4)!==0,Ze=!je&&(n==="scroll"||n==="scrollend"),J=je?ee!==null?ee+"Capture":null:ee;je=[];for(var X=Q,Z;X!==null;){var ae=X;if(Z=ae.stateNode,ae=ae.tag,ae!==5&&ae!==26&&ae!==27||Z===null||J===null||(ae=Ia(X,J),ae!=null&&je.push(yl(X,ae,Z))),Ze)break;X=X.return}0<je.length&&(ee=new te(ee,be,null,o,se),le.push({event:ee,listeners:je}))}}if((s&7)===0){e:{if(ee=n==="mouseover"||n==="pointerover",te=n==="mouseout"||n==="pointerout",ee&&o!==$u&&(be=o.relatedTarget||o.fromElement)&&(jr(be)||be[Cr]))break e;if((te||ee)&&(ee=se.window===se?se:(ee=se.ownerDocument)?ee.defaultView||ee.parentWindow:window,te?(be=o.relatedTarget||o.toElement,te=Q,be=be?jr(be):null,be!==null&&(Ze=c(be),je=be.tag,be!==Ze||je!==5&&je!==27&&je!==6)&&(be=null)):(te=null,be=Q),te!==be)){if(je=sg,ae="onMouseLeave",J="onMouseEnter",X="mouse",(n==="pointerout"||n==="pointerover")&&(je=ag,ae="onPointerLeave",J="onPointerEnter",X="pointer"),Ze=te==null?ee:Ha(te),Z=be==null?ee:Ha(be),ee=new je(ae,X+"leave",te,o,se),ee.target=Ze,ee.relatedTarget=Z,ae=null,jr(se)===Q&&(je=new je(J,X+"enter",be,o,se),je.target=Z,je.relatedTarget=Ze,ae=je),Ze=ae,te&&be)t:{for(je=GC,J=te,X=be,Z=0,ae=J;ae;ae=je(ae))Z++;ae=0;for(var Ce=X;Ce;Ce=je(Ce))ae++;for(;0<Z-ae;)J=je(J),Z--;for(;0<ae-Z;)X=je(X),ae--;for(;Z--;){if(J===X||X!==null&&J===X.alternate){je=J;break t}J=je(J),X=je(X)}je=null}else je=null;te!==null&&J_(le,ee,te,je,!1),be!==null&&Ze!==null&&J_(le,Ze,be,je,!0)}}e:{if(ee=Q?Ha(Q):window,te=ee.nodeName&&ee.nodeName.toLowerCase(),te==="select"||te==="input"&&ee.type==="file")var $e=mg;else if(dg(ee))if(pg)$e=rC;else{$e=iC;var we=nC}else te=ee.nodeName,!te||te.toLowerCase()!=="input"||ee.type!=="checkbox"&&ee.type!=="radio"?Q&&Fu(Q.elementType)&&($e=mg):$e=sC;if($e&&($e=$e(n,Q))){fg(le,$e,o,se);break e}we&&we(n,ee,Q),n==="focusout"&&Q&&ee.type==="number"&&Q.memoizedProps.value!=null&&Uu(ee,"number",ee.value)}switch(we=Q?Ha(Q):window,n){case"focusin":(dg(we)||we.contentEditable==="true")&&(Mr=we,nh=Q,Ga=null);break;case"focusout":Ga=nh=Mr=null;break;case"mousedown":ih=!0;break;case"contextmenu":case"mouseup":case"dragend":ih=!1,wg(le,o,se);break;case"selectionchange":if(lC)break;case"keydown":case"keyup":wg(le,o,se)}var Ae;if(Zu)e:{switch(n){case"compositionstart":var Ue="onCompositionStart";break e;case"compositionend":Ue="onCompositionEnd";break e;case"compositionupdate":Ue="onCompositionUpdate";break e}Ue=void 0}else Lr?ug(n,o)&&(Ue="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(Ue="onCompositionStart");Ue&&(lg&&o.locale!=="ko"&&(Lr||Ue!=="onCompositionStart"?Ue==="onCompositionEnd"&&Lr&&(Ae=ng()):(rs=se,Vu="value"in rs?rs.value:rs.textContent,Lr=!0)),we=xc(Q,Ue),0<we.length&&(Ue=new rg(Ue,n,null,o,se),le.push({event:Ue,listeners:we}),Ae?Ue.data=Ae:(Ae=hg(o),Ae!==null&&(Ue.data=Ae)))),(Ae=Jw?Zw(n,o):Qw(n,o))&&(Ue=xc(Q,"onBeforeInput"),0<Ue.length&&(we=new rg("onBeforeInput","beforeinput",null,o,se),le.push({event:we,listeners:Ue}),we.data=Ae)),KC(le,n,Q,o,se)}Y_(le,s)})}function yl(n,s,o){return{instance:n,listener:s,currentTarget:o}}function xc(n,s){for(var o=s+"Capture",h=[];n!==null;){var p=n,g=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||g===null||(p=Ia(n,o),p!=null&&h.unshift(yl(n,p,g)),p=Ia(n,s),p!=null&&h.push(yl(n,p,g))),n.tag===3)return h;n=n.return}return[]}function GC(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function J_(n,s,o,h,p){for(var g=s._reactName,w=[];o!==null&&o!==h;){var O=o,K=O.alternate,Q=O.stateNode;if(O=O.tag,K!==null&&K===h)break;O!==5&&O!==26&&O!==27||Q===null||(K=Q,p?(Q=Ia(o,g),Q!=null&&w.unshift(yl(o,Q,K))):p||(Q=Ia(o,g),Q!=null&&w.push(yl(o,Q,K)))),o=o.return}w.length!==0&&n.push({event:s,listeners:w})}var YC=/\r\n?/g,XC=/\u0000|\uFFFD/g;function Z_(n){return(typeof n=="string"?n:""+n).replace(YC,`
`).replace(XC,"")}function Q_(n,s){return s=Z_(s),Z_(n)===s}function Je(n,s,o,h,p,g){switch(o){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||Rr(n,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&Rr(n,""+h);break;case"className":Co(n,"class",h);break;case"tabIndex":Co(n,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Co(n,o,h);break;case"style":Qp(n,h,g);break;case"data":if(s!=="object"){Co(n,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||o!=="href")){n.removeAttribute(o);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=ko(""+h),n.setAttribute(o,h);break;case"action":case"formAction":if(typeof h=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof g=="function"&&(o==="formAction"?(s!=="input"&&Je(n,s,"name",p.name,p,null),Je(n,s,"formEncType",p.formEncType,p,null),Je(n,s,"formMethod",p.formMethod,p,null),Je(n,s,"formTarget",p.formTarget,p,null)):(Je(n,s,"encType",p.encType,p,null),Je(n,s,"method",p.method,p,null),Je(n,s,"target",p.target,p,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=ko(""+h),n.setAttribute(o,h);break;case"onClick":h!=null&&(n.onclick=Ai);break;case"onScroll":h!=null&&He("scroll",n);break;case"onScrollEnd":h!=null&&He("scrollend",n);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(o=h.__html,o!=null){if(p.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"multiple":n.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":n.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){n.removeAttribute("xlink:href");break}o=ko(""+h),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""+h):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":h===!0?n.setAttribute(o,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,h):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?n.setAttribute(o,h):n.removeAttribute(o);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?n.removeAttribute(o):n.setAttribute(o,h);break;case"popover":He("beforetoggle",n),He("toggle",n),wo(n,"popover",h);break;case"xlinkActuate":Di(n,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Di(n,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Di(n,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Di(n,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Di(n,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Di(n,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Di(n,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Di(n,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Di(n,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":wo(n,"is",h);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Cw.get(o)||o,wo(n,o,h))}}function Ed(n,s,o,h,p,g){switch(o){case"style":Qp(n,h,g);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(o=h.__html,o!=null){if(p.children!=null)throw Error(r(60));n.innerHTML=o}}break;case"children":typeof h=="string"?Rr(n,h):(typeof h=="number"||typeof h=="bigint")&&Rr(n,""+h);break;case"onScroll":h!=null&&He("scroll",n);break;case"onScrollEnd":h!=null&&He("scrollend",n);break;case"onClick":h!=null&&(n.onclick=Ai);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Kp.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(p=o.endsWith("Capture"),s=o.slice(2,p?o.length-7:void 0),g=n[hn]||null,g=g!=null?g[o]:null,typeof g=="function"&&n.removeEventListener(s,g,p),typeof h=="function")){typeof g!="function"&&g!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(s,h,p);break e}o in n?n[o]=h:h===!0?n.setAttribute(o,""):wo(n,o,h)}}}function Yt(n,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":He("error",n),He("load",n);var h=!1,p=!1,g;for(g in o)if(o.hasOwnProperty(g)){var w=o[g];if(w!=null)switch(g){case"src":h=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Je(n,s,g,w,o,null)}}p&&Je(n,s,"srcSet",o.srcSet,o,null),h&&Je(n,s,"src",o.src,o,null);return;case"input":He("invalid",n);var O=g=w=p=null,K=null,Q=null;for(h in o)if(o.hasOwnProperty(h)){var se=o[h];if(se!=null)switch(h){case"name":p=se;break;case"type":w=se;break;case"checked":K=se;break;case"defaultChecked":Q=se;break;case"value":g=se;break;case"defaultValue":O=se;break;case"children":case"dangerouslySetInnerHTML":if(se!=null)throw Error(r(137,s));break;default:Je(n,s,h,se,o,null)}}Yp(n,g,O,K,Q,w,p,!1);return;case"select":He("invalid",n),h=w=g=null;for(p in o)if(o.hasOwnProperty(p)&&(O=o[p],O!=null))switch(p){case"value":g=O;break;case"defaultValue":w=O;break;case"multiple":h=O;default:Je(n,s,p,O,o,null)}s=g,o=w,n.multiple=!!h,s!=null?Tr(n,!!h,s,!1):o!=null&&Tr(n,!!h,o,!0);return;case"textarea":He("invalid",n),g=p=h=null;for(w in o)if(o.hasOwnProperty(w)&&(O=o[w],O!=null))switch(w){case"value":h=O;break;case"defaultValue":p=O;break;case"children":g=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(r(91));break;default:Je(n,s,w,O,o,null)}Jp(n,h,p,g);return;case"option":for(K in o)o.hasOwnProperty(K)&&(h=o[K],h!=null)&&(K==="selected"?n.selected=h&&typeof h!="function"&&typeof h!="symbol":Je(n,s,K,h,o,null));return;case"dialog":He("beforetoggle",n),He("toggle",n),He("cancel",n),He("close",n);break;case"iframe":case"object":He("load",n);break;case"video":case"audio":for(h=0;h<_l.length;h++)He(_l[h],n);break;case"image":He("error",n),He("load",n);break;case"details":He("toggle",n);break;case"embed":case"source":case"link":He("error",n),He("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Q in o)if(o.hasOwnProperty(Q)&&(h=o[Q],h!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:Je(n,s,Q,h,o,null)}return;default:if(Fu(s)){for(se in o)o.hasOwnProperty(se)&&(h=o[se],h!==void 0&&Ed(n,s,se,h,o,void 0));return}}for(O in o)o.hasOwnProperty(O)&&(h=o[O],h!=null&&Je(n,s,O,h,o,null))}function JC(n,s,o,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,g=null,w=null,O=null,K=null,Q=null,se=null;for(te in o){var le=o[te];if(o.hasOwnProperty(te)&&le!=null)switch(te){case"checked":break;case"value":break;case"defaultValue":K=le;default:h.hasOwnProperty(te)||Je(n,s,te,null,h,le)}}for(var ee in h){var te=h[ee];if(le=o[ee],h.hasOwnProperty(ee)&&(te!=null||le!=null))switch(ee){case"type":g=te;break;case"name":p=te;break;case"checked":Q=te;break;case"defaultChecked":se=te;break;case"value":w=te;break;case"defaultValue":O=te;break;case"children":case"dangerouslySetInnerHTML":if(te!=null)throw Error(r(137,s));break;default:te!==le&&Je(n,s,ee,te,h,le)}}Iu(n,w,O,K,Q,se,g,p);return;case"select":te=w=O=ee=null;for(g in o)if(K=o[g],o.hasOwnProperty(g)&&K!=null)switch(g){case"value":break;case"multiple":te=K;default:h.hasOwnProperty(g)||Je(n,s,g,null,h,K)}for(p in h)if(g=h[p],K=o[p],h.hasOwnProperty(p)&&(g!=null||K!=null))switch(p){case"value":ee=g;break;case"defaultValue":O=g;break;case"multiple":w=g;default:g!==K&&Je(n,s,p,g,h,K)}s=O,o=w,h=te,ee!=null?Tr(n,!!o,ee,!1):!!h!=!!o&&(s!=null?Tr(n,!!o,s,!0):Tr(n,!!o,o?[]:"",!1));return;case"textarea":te=ee=null;for(O in o)if(p=o[O],o.hasOwnProperty(O)&&p!=null&&!h.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:Je(n,s,O,null,h,p)}for(w in h)if(p=h[w],g=o[w],h.hasOwnProperty(w)&&(p!=null||g!=null))switch(w){case"value":ee=p;break;case"defaultValue":te=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(r(91));break;default:p!==g&&Je(n,s,w,p,h,g)}Xp(n,ee,te);return;case"option":for(var be in o)ee=o[be],o.hasOwnProperty(be)&&ee!=null&&!h.hasOwnProperty(be)&&(be==="selected"?n.selected=!1:Je(n,s,be,null,h,ee));for(K in h)ee=h[K],te=o[K],h.hasOwnProperty(K)&&ee!==te&&(ee!=null||te!=null)&&(K==="selected"?n.selected=ee&&typeof ee!="function"&&typeof ee!="symbol":Je(n,s,K,ee,h,te));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var je in o)ee=o[je],o.hasOwnProperty(je)&&ee!=null&&!h.hasOwnProperty(je)&&Je(n,s,je,null,h,ee);for(Q in h)if(ee=h[Q],te=o[Q],h.hasOwnProperty(Q)&&ee!==te&&(ee!=null||te!=null))switch(Q){case"children":case"dangerouslySetInnerHTML":if(ee!=null)throw Error(r(137,s));break;default:Je(n,s,Q,ee,h,te)}return;default:if(Fu(s)){for(var Ze in o)ee=o[Ze],o.hasOwnProperty(Ze)&&ee!==void 0&&!h.hasOwnProperty(Ze)&&Ed(n,s,Ze,void 0,h,ee);for(se in h)ee=h[se],te=o[se],!h.hasOwnProperty(se)||ee===te||ee===void 0&&te===void 0||Ed(n,s,se,ee,h,te);return}}for(var J in o)ee=o[J],o.hasOwnProperty(J)&&ee!=null&&!h.hasOwnProperty(J)&&Je(n,s,J,null,h,ee);for(le in h)ee=h[le],te=o[le],!h.hasOwnProperty(le)||ee===te||ee==null&&te==null||Je(n,s,le,ee,h,te)}function ey(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function ZC(){if(typeof performance.getEntriesByType=="function"){for(var n=0,s=0,o=performance.getEntriesByType("resource"),h=0;h<o.length;h++){var p=o[h],g=p.transferSize,w=p.initiatorType,O=p.duration;if(g&&O&&ey(w)){for(w=0,O=p.responseEnd,h+=1;h<o.length;h++){var K=o[h],Q=K.startTime;if(Q>O)break;var se=K.transferSize,le=K.initiatorType;se&&ey(le)&&(K=K.responseEnd,w+=se*(K<O?1:(O-Q)/(K-Q)))}if(--h,s+=8*(g+w)/(p.duration/1e3),n++,10<n)break}}if(0<n)return s/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Td=null,Rd=null;function Sc(n){return n.nodeType===9?n:n.ownerDocument}function ty(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ny(n,s){if(n===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&s==="foreignObject"?0:n}function Dd(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Ad=null;function QC(){var n=window.event;return n&&n.type==="popstate"?n===Ad?!1:(Ad=n,!0):(Ad=null,!1)}var iy=typeof setTimeout=="function"?setTimeout:void 0,ej=typeof clearTimeout=="function"?clearTimeout:void 0,sy=typeof Promise=="function"?Promise:void 0,tj=typeof queueMicrotask=="function"?queueMicrotask:typeof sy<"u"?function(n){return sy.resolve(null).then(n).catch(nj)}:iy;function nj(n){setTimeout(function(){throw n})}function bs(n){return n==="head"}function ry(n,s){var o=s,h=0;do{var p=o.nextSibling;if(n.removeChild(o),p&&p.nodeType===8)if(o=p.data,o==="/$"||o==="/&"){if(h===0){n.removeChild(p),la(s);return}h--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")h++;else if(o==="html")xl(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,xl(o);for(var g=o.firstChild;g;){var w=g.nextSibling,O=g.nodeName;g[Pa]||O==="SCRIPT"||O==="STYLE"||O==="LINK"&&g.rel.toLowerCase()==="stylesheet"||o.removeChild(g),g=w}}else o==="body"&&xl(n.ownerDocument.body);o=p}while(o);la(s)}function ay(n,s){var o=n;n=0;do{var h=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),h&&h.nodeType===8)if(o=h.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=h}while(o)}function Ld(n){var s=n.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Ld(o),Pu(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function ij(n,s,o,h){for(;n.nodeType===1;){var p=o;if(n.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(h){if(!n[Pa])switch(s){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(g=n.getAttribute("rel"),g==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(g!==p.rel||n.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||n.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||n.getAttribute("title")!==(p.title==null?null:p.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(g=n.getAttribute("src"),(g!==(p.src==null?null:p.src)||n.getAttribute("type")!==(p.type==null?null:p.type)||n.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&g&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(s==="input"&&n.type==="hidden"){var g=p.name==null?null:""+p.name;if(p.type==="hidden"&&n.getAttribute("name")===g)return n}else return n;if(n=Yn(n.nextSibling),n===null)break}return null}function sj(n,s,o){if(s==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Yn(n.nextSibling),n===null))return null;return n}function ly(n,s){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!s||(n=Yn(n.nextSibling),n===null))return null;return n}function Md(n){return n.data==="$?"||n.data==="$~"}function Bd(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function rj(n,s){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=s;else if(n.data!=="$?"||o.readyState!=="loading")s();else{var h=function(){s(),o.removeEventListener("DOMContentLoaded",h)};o.addEventListener("DOMContentLoaded",h),n._reactRetry=h}}function Yn(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return n}var Od=null;function oy(n){n=n.nextSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(s===0)return Yn(n.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}n=n.nextSibling}return null}function cy(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return n;s--}else o!=="/$"&&o!=="/&"||s++}n=n.previousSibling}return null}function uy(n,s,o){switch(s=Sc(o),n){case"html":if(n=s.documentElement,!n)throw Error(r(452));return n;case"head":if(n=s.head,!n)throw Error(r(453));return n;case"body":if(n=s.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function xl(n){for(var s=n.attributes;s.length;)n.removeAttributeNode(s[0]);Pu(n)}var Xn=new Map,hy=new Set;function bc(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Gi=$.d;$.d={f:aj,r:lj,D:oj,C:cj,L:uj,m:hj,X:fj,S:dj,M:mj};function aj(){var n=Gi.f(),s=fc();return n||s}function lj(n){var s=kr(n);s!==null&&s.tag===5&&s.type==="form"?Ev(s):Gi.r(n)}var sa=typeof document>"u"?null:document;function dy(n,s,o){var h=sa;if(h&&typeof s=="string"&&s){var p=Fn(s);p='link[rel="'+n+'"][href="'+p+'"]',typeof o=="string"&&(p+='[crossorigin="'+o+'"]'),hy.has(p)||(hy.add(p),n={rel:n,crossOrigin:o,href:s},h.querySelector(p)===null&&(s=h.createElement("link"),Yt(s,"link",n),zt(s),h.head.appendChild(s)))}}function oj(n){Gi.D(n),dy("dns-prefetch",n,null)}function cj(n,s){Gi.C(n,s),dy("preconnect",n,s)}function uj(n,s,o){Gi.L(n,s,o);var h=sa;if(h&&n&&s){var p='link[rel="preload"][as="'+Fn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(p+='[imagesrcset="'+Fn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(p+='[imagesizes="'+Fn(o.imageSizes)+'"]')):p+='[href="'+Fn(n)+'"]';var g=p;switch(s){case"style":g=ra(n);break;case"script":g=aa(n)}Xn.has(g)||(n=_({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:n,as:s},o),Xn.set(g,n),h.querySelector(p)!==null||s==="style"&&h.querySelector(Sl(g))||s==="script"&&h.querySelector(bl(g))||(s=h.createElement("link"),Yt(s,"link",n),zt(s),h.head.appendChild(s)))}}function hj(n,s){Gi.m(n,s);var o=sa;if(o&&n){var h=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+Fn(h)+'"][href="'+Fn(n)+'"]',g=p;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":g=aa(n)}if(!Xn.has(g)&&(n=_({rel:"modulepreload",href:n},s),Xn.set(g,n),o.querySelector(p)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(bl(g)))return}h=o.createElement("link"),Yt(h,"link",n),zt(h),o.head.appendChild(h)}}}function dj(n,s,o){Gi.S(n,s,o);var h=sa;if(h&&n){var p=Nr(h).hoistableStyles,g=ra(n);s=s||"default";var w=p.get(g);if(!w){var O={loading:0,preload:null};if(w=h.querySelector(Sl(g)))O.loading=5;else{n=_({rel:"stylesheet",href:n,"data-precedence":s},o),(o=Xn.get(g))&&zd(n,o);var K=w=h.createElement("link");zt(K),Yt(K,"link",n),K._p=new Promise(function(Q,se){K.onload=Q,K.onerror=se}),K.addEventListener("load",function(){O.loading|=1}),K.addEventListener("error",function(){O.loading|=2}),O.loading|=4,wc(w,s,h)}w={type:"stylesheet",instance:w,count:1,state:O},p.set(g,w)}}}function fj(n,s){Gi.X(n,s);var o=sa;if(o&&n){var h=Nr(o).hoistableScripts,p=aa(n),g=h.get(p);g||(g=o.querySelector(bl(p)),g||(n=_({src:n,async:!0},s),(s=Xn.get(p))&&Pd(n,s),g=o.createElement("script"),zt(g),Yt(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},h.set(p,g))}}function mj(n,s){Gi.M(n,s);var o=sa;if(o&&n){var h=Nr(o).hoistableScripts,p=aa(n),g=h.get(p);g||(g=o.querySelector(bl(p)),g||(n=_({src:n,async:!0,type:"module"},s),(s=Xn.get(p))&&Pd(n,s),g=o.createElement("script"),zt(g),Yt(g,"link",n),o.head.appendChild(g)),g={type:"script",instance:g,count:1,state:null},h.set(p,g))}}function fy(n,s,o,h){var p=(p=he.current)?bc(p):null;if(!p)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=ra(o.href),o=Nr(p).hoistableStyles,h=o.get(s),h||(h={type:"style",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=ra(o.href);var g=Nr(p).hoistableStyles,w=g.get(n);if(w||(p=p.ownerDocument||p,w={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},g.set(n,w),(g=p.querySelector(Sl(n)))&&!g._p&&(w.instance=g,w.state.loading=5),Xn.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Xn.set(n,o),g||pj(p,n,o,w.state))),s&&h===null)throw Error(r(528,""));return w}if(s&&h!==null)throw Error(r(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=aa(o),o=Nr(p).hoistableScripts,h=o.get(s),h||(h={type:"script",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function ra(n){return'href="'+Fn(n)+'"'}function Sl(n){return'link[rel="stylesheet"]['+n+"]"}function my(n){return _({},n,{"data-precedence":n.precedence,precedence:null})}function pj(n,s,o,h){n.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=n.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),Yt(s,"link",o),zt(s),n.head.appendChild(s))}function aa(n){return'[src="'+Fn(n)+'"]'}function bl(n){return"script[async]"+n}function py(n,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var h=n.querySelector('style[data-href~="'+Fn(o.href)+'"]');if(h)return s.instance=h,zt(h),h;var p=_({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return h=(n.ownerDocument||n).createElement("style"),zt(h),Yt(h,"style",p),wc(h,o.precedence,n),s.instance=h;case"stylesheet":p=ra(o.href);var g=n.querySelector(Sl(p));if(g)return s.state.loading|=4,s.instance=g,zt(g),g;h=my(o),(p=Xn.get(p))&&zd(h,p),g=(n.ownerDocument||n).createElement("link"),zt(g);var w=g;return w._p=new Promise(function(O,K){w.onload=O,w.onerror=K}),Yt(g,"link",h),s.state.loading|=4,wc(g,o.precedence,n),s.instance=g;case"script":return g=aa(o.src),(p=n.querySelector(bl(g)))?(s.instance=p,zt(p),p):(h=o,(p=Xn.get(g))&&(h=_({},o),Pd(h,p)),n=n.ownerDocument||n,p=n.createElement("script"),zt(p),Yt(p,"link",h),n.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,wc(h,o.precedence,n));return s.instance}function wc(n,s,o){for(var h=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=h.length?h[h.length-1]:null,g=p,w=0;w<h.length;w++){var O=h[w];if(O.dataset.precedence===s)g=O;else if(g!==p)break}g?g.parentNode.insertBefore(n,g.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(n,s.firstChild))}function zd(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.title==null&&(n.title=s.title)}function Pd(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.integrity==null&&(n.integrity=s.integrity)}var Cc=null;function gy(n,s,o){if(Cc===null){var h=new Map,p=Cc=new Map;p.set(o,h)}else p=Cc,h=p.get(o),h||(h=new Map,p.set(o,h));if(h.has(n))return h;for(h.set(n,null),o=o.getElementsByTagName(n),p=0;p<o.length;p++){var g=o[p];if(!(g[Pa]||g[qt]||n==="link"&&g.getAttribute("rel")==="stylesheet")&&g.namespaceURI!=="http://www.w3.org/2000/svg"){var w=g.getAttribute(s)||"";w=n+w;var O=h.get(w);O?O.push(g):h.set(w,[g])}}return h}function vy(n,s,o){n=n.ownerDocument||n,n.head.insertBefore(o,s==="title"?n.querySelector("head > title"):null)}function gj(n,s,o){if(o===1||s.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(n=s.disabled,typeof s.precedence=="string"&&n==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function _y(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function vj(n,s,o,h){if(o.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var p=ra(h.href),g=s.querySelector(Sl(p));if(g){s=g._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(n.count++,n=jc.bind(n),s.then(n,n)),o.state.loading|=4,o.instance=g,zt(g);return}g=s.ownerDocument||s,h=my(h),(p=Xn.get(p))&&zd(h,p),g=g.createElement("link"),zt(g);var w=g;w._p=new Promise(function(O,K){w.onload=O,w.onerror=K}),Yt(g,"link",h),o.instance=g}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=jc.bind(n),s.addEventListener("load",o),s.addEventListener("error",o))}}var Hd=0;function _j(n,s){return n.stylesheets&&n.count===0&&Nc(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var h=setTimeout(function(){if(n.stylesheets&&Nc(n,n.stylesheets),n.unsuspend){var g=n.unsuspend;n.unsuspend=null,g()}},6e4+s);0<n.imgBytes&&Hd===0&&(Hd=62500*ZC());var p=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&Nc(n,n.stylesheets),n.unsuspend)){var g=n.unsuspend;n.unsuspend=null,g()}},(n.imgBytes>Hd?50:800)+s);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(h),clearTimeout(p)}}:null}function jc(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Nc(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var kc=null;function Nc(n,s){n.stylesheets=null,n.unsuspend!==null&&(n.count++,kc=new Map,s.forEach(yj,n),kc=null,jc.call(n))}function yj(n,s){if(!(s.state.loading&4)){var o=kc.get(n);if(o)var h=o.get(null);else{o=new Map,kc.set(n,o);for(var p=n.querySelectorAll("link[data-precedence],style[data-precedence]"),g=0;g<p.length;g++){var w=p[g];(w.nodeName==="LINK"||w.getAttribute("media")!=="not all")&&(o.set(w.dataset.precedence,w),h=w)}h&&o.set(null,h)}p=s.instance,w=p.getAttribute("data-precedence"),g=o.get(w)||h,g===h&&o.set(null,p),o.set(w,p),this.count++,h=jc.bind(this),p.addEventListener("load",h),p.addEventListener("error",h),g?g.parentNode.insertBefore(p,g.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(p,n.firstChild)),s.state.loading|=4}}var wl={$$typeof:N,Provider:null,Consumer:null,_currentValue:W,_currentValue2:W,_threadCount:0};function xj(n,s,o,h,p,g,w,O,K){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Mu(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Mu(0),this.hiddenUpdates=Mu(null),this.identifierPrefix=h,this.onUncaughtError=p,this.onCaughtError=g,this.onRecoverableError=w,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=K,this.incompleteTransitions=new Map}function yy(n,s,o,h,p,g,w,O,K,Q,se,le){return n=new xj(n,s,o,w,K,Q,se,le,O),s=1,g===!0&&(s|=24),g=Cn(3,null,null,s),n.current=g,g.stateNode=n,s=_h(),s.refCount++,n.pooledCache=s,s.refCount++,g.memoizedState={element:h,isDehydrated:o,cache:s},bh(g),n}function xy(n){return n?(n=zr,n):zr}function Sy(n,s,o,h,p,g){p=xy(p),h.context===null?h.context=p:h.pendingContext=p,h=hs(s),h.payload={element:o},g=g===void 0?null:g,g!==null&&(h.callback=g),o=ds(n,h,s),o!==null&&(vn(o,n,s),tl(o,n,s))}function by(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<s?o:s}}function Id(n,s){by(n,s),(n=n.alternate)&&by(n,s)}function wy(n){if(n.tag===13||n.tag===31){var s=Gs(n,67108864);s!==null&&vn(s,n,67108864),Id(n,67108864)}}function Cy(n){if(n.tag===13||n.tag===31){var s=Tn();s=Bu(s);var o=Gs(n,s);o!==null&&vn(o,n,s),Id(n,s)}}var Ec=!0;function Sj(n,s,o,h){var p=D.T;D.T=null;var g=$.p;try{$.p=2,Ud(n,s,o,h)}finally{$.p=g,D.T=p}}function bj(n,s,o,h){var p=D.T;D.T=null;var g=$.p;try{$.p=8,Ud(n,s,o,h)}finally{$.p=g,D.T=p}}function Ud(n,s,o,h){if(Ec){var p=Fd(h);if(p===null)Nd(n,s,h,Tc,o),ky(n,h);else if(Cj(p,n,s,o,h))h.stopPropagation();else if(ky(n,h),s&4&&-1<wj.indexOf(n)){for(;p!==null;){var g=kr(p);if(g!==null)switch(g.tag){case 3:if(g=g.stateNode,g.current.memoizedState.isDehydrated){var w=$s(g.pendingLanes);if(w!==0){var O=g;for(O.pendingLanes|=2,O.entangledLanes|=2;w;){var K=1<<31-et(w);O.entanglements[1]|=K,w&=~K}vi(g),(qe&6)===0&&(hc=Ot()+500,vl(0))}}break;case 31:case 13:O=Gs(g,2),O!==null&&vn(O,g,2),fc(),Id(g,2)}if(g=Fd(h),g===null&&Nd(n,s,h,Tc,o),g===p)break;p=g}p!==null&&h.stopPropagation()}else Nd(n,s,h,null,o)}}function Fd(n){return n=Ku(n),$d(n)}var Tc=null;function $d(n){if(Tc=null,n=jr(n),n!==null){var s=c(n);if(s===null)n=null;else{var o=s.tag;if(o===13){if(n=u(s),n!==null)return n;n=null}else if(o===31){if(n=d(s),n!==null)return n;n=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return Tc=n,null}function jy(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(cn()){case ie:return 2;case pe:return 8;case ke:case ze:return 32;case Ve:return 268435456;default:return 32}default:return 32}}var Kd=!1,ws=null,Cs=null,js=null,Cl=new Map,jl=new Map,ks=[],wj="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ky(n,s){switch(n){case"focusin":case"focusout":ws=null;break;case"dragenter":case"dragleave":Cs=null;break;case"mouseover":case"mouseout":js=null;break;case"pointerover":case"pointerout":Cl.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":jl.delete(s.pointerId)}}function kl(n,s,o,h,p,g){return n===null||n.nativeEvent!==g?(n={blockedOn:s,domEventName:o,eventSystemFlags:h,nativeEvent:g,targetContainers:[p]},s!==null&&(s=kr(s),s!==null&&wy(s)),n):(n.eventSystemFlags|=h,s=n.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),n)}function Cj(n,s,o,h,p){switch(s){case"focusin":return ws=kl(ws,n,s,o,h,p),!0;case"dragenter":return Cs=kl(Cs,n,s,o,h,p),!0;case"mouseover":return js=kl(js,n,s,o,h,p),!0;case"pointerover":var g=p.pointerId;return Cl.set(g,kl(Cl.get(g)||null,n,s,o,h,p)),!0;case"gotpointercapture":return g=p.pointerId,jl.set(g,kl(jl.get(g)||null,n,s,o,h,p)),!0}return!1}function Ny(n){var s=jr(n.target);if(s!==null){var o=c(s);if(o!==null){if(s=o.tag,s===13){if(s=u(o),s!==null){n.blockedOn=s,Up(n.priority,function(){Cy(o)});return}}else if(s===31){if(s=d(o),s!==null){n.blockedOn=s,Up(n.priority,function(){Cy(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Rc(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var o=Fd(n.nativeEvent);if(o===null){o=n.nativeEvent;var h=new o.constructor(o.type,o);$u=h,o.target.dispatchEvent(h),$u=null}else return s=kr(o),s!==null&&wy(s),n.blockedOn=o,!1;s.shift()}return!0}function Ey(n,s,o){Rc(n)&&o.delete(s)}function jj(){Kd=!1,ws!==null&&Rc(ws)&&(ws=null),Cs!==null&&Rc(Cs)&&(Cs=null),js!==null&&Rc(js)&&(js=null),Cl.forEach(Ey),jl.forEach(Ey)}function Dc(n,s){n.blockedOn===s&&(n.blockedOn=null,Kd||(Kd=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,jj)))}var Ac=null;function Ty(n){Ac!==n&&(Ac=n,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){Ac===n&&(Ac=null);for(var s=0;s<n.length;s+=3){var o=n[s],h=n[s+1],p=n[s+2];if(typeof h!="function"){if($d(h||o)===null)continue;break}var g=kr(o);g!==null&&(n.splice(s,3),s-=3,Fh(g,{pending:!0,data:p,method:o.method,action:h},h,p))}}))}function la(n){function s(K){return Dc(K,n)}ws!==null&&Dc(ws,n),Cs!==null&&Dc(Cs,n),js!==null&&Dc(js,n),Cl.forEach(s),jl.forEach(s);for(var o=0;o<ks.length;o++){var h=ks[o];h.blockedOn===n&&(h.blockedOn=null)}for(;0<ks.length&&(o=ks[0],o.blockedOn===null);)Ny(o),o.blockedOn===null&&ks.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(h=0;h<o.length;h+=3){var p=o[h],g=o[h+1],w=p[hn]||null;if(typeof g=="function")w||Ty(o);else if(w){var O=null;if(g&&g.hasAttribute("formAction")){if(p=g,w=g[hn]||null)O=w.formAction;else if($d(p)!==null)continue}else O=w.action;typeof O=="function"?o[h+1]=O:(o.splice(h,3),h-=3),Ty(o)}}}function Ry(){function n(g){g.canIntercept&&g.info==="react-transition"&&g.intercept({handler:function(){return new Promise(function(w){return p=w})},focusReset:"manual",scroll:"manual"})}function s(){p!==null&&(p(),p=null),h||setTimeout(o,20)}function o(){if(!h&&!navigation.transition){var g=navigation.currentEntry;g&&g.url!=null&&navigation.navigate(g.url,{state:g.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,p=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){h=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),p!==null&&(p(),p=null)}}}function qd(n){this._internalRoot=n}Lc.prototype.render=qd.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(r(409));var o=s.current,h=Tn();Sy(o,h,n,s,null,null)},Lc.prototype.unmount=qd.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;Sy(n.current,2,null,n,null,null),fc(),s[Cr]=null}};function Lc(n){this._internalRoot=n}Lc.prototype.unstable_scheduleHydration=function(n){if(n){var s=Ip();n={blockedOn:null,target:n,priority:s};for(var o=0;o<ks.length&&s!==0&&s<ks[o].priority;o++);ks.splice(o,0,n),o===0&&Ny(n)}};var Dy=t.version;if(Dy!=="19.2.4")throw Error(r(527,Dy,"19.2.4"));$.findDOMNode=function(n){var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=f(s),n=n!==null?v(n):null,n=n===null?null:n.stateNode,n};var kj={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mc.isDisabled&&Mc.supportsFiber)try{nn=Mc.inject(kj),Dt=Mc}catch{}}return El.createRoot=function(n,s){if(!l(n))throw Error(r(299));var o=!1,h="",p=Pv,g=Hv,w=Iv;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(g=s.onCaughtError),s.onRecoverableError!==void 0&&(w=s.onRecoverableError)),s=yy(n,1,!1,null,null,o,h,null,p,g,w,Ry),n[Cr]=s.current,kd(n),new qd(s)},El.hydrateRoot=function(n,s,o){if(!l(n))throw Error(r(299));var h=!1,p="",g=Pv,w=Hv,O=Iv,K=null;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(w=o.onCaughtError),o.onRecoverableError!==void 0&&(O=o.onRecoverableError),o.formState!==void 0&&(K=o.formState)),s=yy(n,1,!0,s,o??null,h,p,K,g,w,O,Ry),s.context=xy(null),o=s.current,h=Tn(),h=Bu(h),p=hs(h),p.callback=null,ds(o,p,h),o=h,s.current.lanes=o,za(s,o),vi(s),n[Cr]=s.current,kd(n),new Lc(s)},El.version="19.2.4",El}var Uy;function Oj(){if(Uy)return Gd.exports;Uy=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),Gd.exports=Bj(),Gd.exports}var zj=Oj();const Pj="modulepreload",Hj=function(e){return"/"+e},Fy={},Lb=function(t,i,r){let l=Promise.resolve();if(i&&i.length>0){let m=function(f){return Promise.all(f.map(v=>Promise.resolve(v).then(_=>({status:"fulfilled",value:_}),_=>({status:"rejected",reason:_}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),d=u?.nonce||u?.getAttribute("nonce");l=m(i.map(f=>{if(f=Hj(f),f in Fy)return;Fy[f]=!0;const v=f.endsWith(".css"),_=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${_}`))return;const S=document.createElement("link");if(S.rel=v?"stylesheet":Pj,v||(S.as="script"),S.crossOrigin="",S.href=f,d&&S.setAttribute("nonce",d),document.head.appendChild(S),v)return new Promise((x,b)=>{S.addEventListener("load",x),S.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function c(u){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=u,window.dispatchEvent(d),!d.defaultPrevented)throw u}return l.then(u=>{for(const d of u||[])d.status==="rejected"&&c(d.reason);return t().catch(c)})};var $y="popstate";function Ij(e={}){function t(r,l){let{pathname:c,search:u,hash:d}=r.location;return Uf("",{pathname:c,search:u,hash:d},l.state&&l.state.usr||null,l.state&&l.state.key||"default")}function i(r,l){return typeof l=="string"?l:Ql(l)}return Fj(t,i,null,e)}function ut(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ni(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Uj(){return Math.random().toString(36).substring(2,10)}function Ky(e,t){return{usr:e.state,key:e.key,idx:t}}function Uf(e,t,i=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?Ca(t):t,state:i,key:t&&t.key||r||Uj()}}function Ql({pathname:e="/",search:t="",hash:i=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),i&&i!=="#"&&(e+=i.charAt(0)==="#"?i:"#"+i),e}function Ca(e){let t={};if(e){let i=e.indexOf("#");i>=0&&(t.hash=e.substring(i),e=e.substring(0,i));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function Fj(e,t,i,r={}){let{window:l=document.defaultView,v5Compat:c=!1}=r,u=l.history,d="POP",m=null,f=v();f==null&&(f=0,u.replaceState({...u.state,idx:f},""));function v(){return(u.state||{idx:null}).idx}function _(){d="POP";let T=v(),k=T==null?null:T-f;f=T,m&&m({action:d,location:C.location,delta:k})}function S(T,k){d="PUSH";let R=Uf(C.location,T,k);f=v()+1;let N=Ky(R,f),E=C.createHref(R);try{u.pushState(N,"",E)}catch(z){if(z instanceof DOMException&&z.name==="DataCloneError")throw z;l.location.assign(E)}c&&m&&m({action:d,location:C.location,delta:1})}function x(T,k){d="REPLACE";let R=Uf(C.location,T,k);f=v();let N=Ky(R,f),E=C.createHref(R);u.replaceState(N,"",E),c&&m&&m({action:d,location:C.location,delta:0})}function b(T){return $j(T)}let C={get action(){return d},get location(){return e(l,u)},listen(T){if(m)throw new Error("A history only accepts one active listener");return l.addEventListener($y,_),m=T,()=>{l.removeEventListener($y,_),m=null}},createHref(T){return t(l,T)},createURL:b,encodeLocation(T){let k=b(T);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:S,replace:x,go(T){return u.go(T)}};return C}function $j(e,t=!1){let i="http://localhost";typeof window<"u"&&(i=window.location.origin!=="null"?window.location.origin:window.location.href),ut(i,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Ql(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=i+r),new URL(r,i)}function Mb(e,t,i="/"){return Kj(e,t,i,!1)}function Kj(e,t,i,r){let l=typeof t=="string"?Ca(t):t,c=Qi(l.pathname||"/",i);if(c==null)return null;let u=Bb(e);qj(u);let d=null;for(let m=0;d==null&&m<u.length;++m){let f=nk(c);d=ek(u[m],f,r)}return d}function Bb(e,t=[],i=[],r="",l=!1){let c=(u,d,m=l,f)=>{let v={relativePath:f===void 0?u.path||"":f,caseSensitive:u.caseSensitive===!0,childrenIndex:d,route:u};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(r)&&m)return;ut(v.relativePath.startsWith(r),`Absolute route path "${v.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(r.length)}let _=Zi([r,v.relativePath]),S=i.concat(v);u.children&&u.children.length>0&&(ut(u.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),Bb(u.children,t,S,_,m)),!(u.path==null&&!u.index)&&t.push({path:_,score:Zj(_,u.index),routesMeta:S})};return e.forEach((u,d)=>{if(u.path===""||!u.path?.includes("?"))c(u,d);else for(let m of Ob(u.path))c(u,d,!0,m)}),t}function Ob(e){let t=e.split("/");if(t.length===0)return[];let[i,...r]=t,l=i.endsWith("?"),c=i.replace(/\?$/,"");if(r.length===0)return l?[c,""]:[c];let u=Ob(r.join("/")),d=[];return d.push(...u.map(m=>m===""?c:[c,m].join("/"))),l&&d.push(...u),d.map(m=>e.startsWith("/")&&m===""?"/":m)}function qj(e){e.sort((t,i)=>t.score!==i.score?i.score-t.score:Qj(t.routesMeta.map(r=>r.childrenIndex),i.routesMeta.map(r=>r.childrenIndex)))}var Wj=/^:[\w-]+$/,Vj=3,Gj=2,Yj=1,Xj=10,Jj=-2,qy=e=>e==="*";function Zj(e,t){let i=e.split("/"),r=i.length;return i.some(qy)&&(r+=Jj),t&&(r+=Gj),i.filter(l=>!qy(l)).reduce((l,c)=>l+(Wj.test(c)?Vj:c===""?Yj:Xj),r)}function Qj(e,t){return e.length===t.length&&e.slice(0,-1).every((r,l)=>r===t[l])?e[e.length-1]-t[t.length-1]:0}function ek(e,t,i=!1){let{routesMeta:r}=e,l={},c="/",u=[];for(let d=0;d<r.length;++d){let m=r[d],f=d===r.length-1,v=c==="/"?t:t.slice(c.length)||"/",_=ru({path:m.relativePath,caseSensitive:m.caseSensitive,end:f},v),S=m.route;if(!_&&f&&i&&!r[r.length-1].route.index&&(_=ru({path:m.relativePath,caseSensitive:m.caseSensitive,end:!1},v)),!_)return null;Object.assign(l,_.params),u.push({params:l,pathname:Zi([c,_.pathname]),pathnameBase:ak(Zi([c,_.pathnameBase])),route:S}),_.pathnameBase!=="/"&&(c=Zi([c,_.pathnameBase]))}return u}function ru(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[i,r]=tk(e.path,e.caseSensitive,e.end),l=t.match(i);if(!l)return null;let c=l[0],u=c.replace(/(.)\/+$/,"$1"),d=l.slice(1);return{params:r.reduce((f,{paramName:v,isOptional:_},S)=>{if(v==="*"){let b=d[S]||"";u=c.slice(0,c.length-b.length).replace(/(.)\/+$/,"$1")}const x=d[S];return _&&!x?f[v]=void 0:f[v]=(x||"").replace(/%2F/g,"/"),f},{}),pathname:c,pathnameBase:u,pattern:e}}function tk(e,t=!1,i=!0){ni(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],l="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,d,m)=>(r.push({paramName:d,isOptional:m!=null}),m?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(r.push({paramName:"*"}),l+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):i?l+="\\/*$":e!==""&&e!=="/"&&(l+="(?:(?=\\/|$))"),[new RegExp(l,t?void 0:"i"),r]}function nk(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ni(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Qi(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let i=t.endsWith("/")?t.length-1:t.length,r=e.charAt(i);return r&&r!=="/"?null:e.slice(i)||"/"}var ik=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function sk(e,t="/"){let{pathname:i,search:r="",hash:l=""}=typeof e=="string"?Ca(e):e,c;return i?(i=i.replace(/\/\/+/g,"/"),i.startsWith("/")?c=Wy(i.substring(1),"/"):c=Wy(i,t)):c=t,{pathname:c,search:lk(r),hash:ok(l)}}function Wy(e,t){let i=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(l=>{l===".."?i.length>1&&i.pop():l!=="."&&i.push(l)}),i.length>1?i.join("/"):"/"}function Zd(e,t,i,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${i}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rk(e){return e.filter((t,i)=>i===0||t.route.path&&t.route.path.length>0)}function Wm(e){let t=rk(e);return t.map((i,r)=>r===t.length-1?i.pathname:i.pathnameBase)}function Vm(e,t,i,r=!1){let l;typeof e=="string"?l=Ca(e):(l={...e},ut(!l.pathname||!l.pathname.includes("?"),Zd("?","pathname","search",l)),ut(!l.pathname||!l.pathname.includes("#"),Zd("#","pathname","hash",l)),ut(!l.search||!l.search.includes("#"),Zd("#","search","hash",l)));let c=e===""||l.pathname==="",u=c?"/":l.pathname,d;if(u==null)d=i;else{let _=t.length-1;if(!r&&u.startsWith("..")){let S=u.split("/");for(;S[0]==="..";)S.shift(),_-=1;l.pathname=S.join("/")}d=_>=0?t[_]:"/"}let m=sk(l,d),f=u&&u!=="/"&&u.endsWith("/"),v=(c||u===".")&&i.endsWith("/");return!m.pathname.endsWith("/")&&(f||v)&&(m.pathname+="/"),m}var Zi=e=>e.join("/").replace(/\/\/+/g,"/"),ak=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),lk=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,ok=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,ck=class{constructor(e,t,i,r=!1){this.status=e,this.statusText=t||"",this.internal=r,i instanceof Error?(this.data=i.toString(),this.error=i):this.data=i}};function uk(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}function hk(e){return e.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var zb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Pb(e,t){let i=e;if(typeof i!="string"||!ik.test(i))return{absoluteURL:void 0,isExternal:!1,to:i};let r=i,l=!1;if(zb)try{let c=new URL(window.location.href),u=i.startsWith("//")?new URL(c.protocol+i):new URL(i),d=Qi(u.pathname,t);u.origin===c.origin&&d!=null?i=d+u.search+u.hash:l=!0}catch{ni(!1,`<Link to="${i}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:r,isExternal:l,to:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Hb=["POST","PUT","PATCH","DELETE"];new Set(Hb);var dk=["GET",...Hb];new Set(dk);var ja=y.createContext(null);ja.displayName="DataRouter";var bu=y.createContext(null);bu.displayName="DataRouterState";var fk=y.createContext(!1),Ib=y.createContext({isTransitioning:!1});Ib.displayName="ViewTransition";var mk=y.createContext(new Map);mk.displayName="Fetchers";var pk=y.createContext(null);pk.displayName="Await";var Pn=y.createContext(null);Pn.displayName="Navigation";var oo=y.createContext(null);oo.displayName="Location";var si=y.createContext({outlet:null,matches:[],isDataRoute:!1});si.displayName="Route";var Gm=y.createContext(null);Gm.displayName="RouteError";var Ub="REACT_ROUTER_ERROR",gk="REDIRECT",vk="ROUTE_ERROR_RESPONSE";function _k(e){if(e.startsWith(`${Ub}:${gk}:{`))try{let t=JSON.parse(e.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function yk(e){if(e.startsWith(`${Ub}:${vk}:{`))try{let t=JSON.parse(e.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new ck(t.status,t.statusText,t.data)}catch{}}function xk(e,{relative:t}={}){ut(ka(),"useHref() may be used only in the context of a <Router> component.");let{basename:i,navigator:r}=y.useContext(Pn),{hash:l,pathname:c,search:u}=co(e,{relative:t}),d=c;return i!=="/"&&(d=c==="/"?i:Zi([i,c])),r.createHref({pathname:d,search:u,hash:l})}function ka(){return y.useContext(oo)!=null}function Hn(){return ut(ka(),"useLocation() may be used only in the context of a <Router> component."),y.useContext(oo).location}var Fb="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function $b(e){y.useContext(Pn).static||y.useLayoutEffect(e)}function dt(){let{isDataRoute:e}=y.useContext(si);return e?Mk():Sk()}function Sk(){ut(ka(),"useNavigate() may be used only in the context of a <Router> component.");let e=y.useContext(ja),{basename:t,navigator:i}=y.useContext(Pn),{matches:r}=y.useContext(si),{pathname:l}=Hn(),c=JSON.stringify(Wm(r)),u=y.useRef(!1);return $b(()=>{u.current=!0}),y.useCallback((m,f={})=>{if(ni(u.current,Fb),!u.current)return;if(typeof m=="number"){i.go(m);return}let v=Vm(m,JSON.parse(c),l,f.relative==="path");e==null&&t!=="/"&&(v.pathname=v.pathname==="/"?t:Zi([t,v.pathname])),(f.replace?i.replace:i.push)(v,f.state,f)},[t,i,c,l,e])}var Kb=y.createContext(null);function Qt(){return y.useContext(Kb)}function bk(e){let t=y.useContext(si).outlet;return y.useMemo(()=>t&&y.createElement(Kb.Provider,{value:e},t),[t,e])}function es(){let{matches:e}=y.useContext(si),t=e[e.length-1];return t?t.params:{}}function co(e,{relative:t}={}){let{matches:i}=y.useContext(si),{pathname:r}=Hn(),l=JSON.stringify(Wm(i));return y.useMemo(()=>Vm(e,JSON.parse(l),r,t==="path"),[e,l,r,t])}function wk(e,t){return qb(e,t)}function qb(e,t,i,r,l){ut(ka(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=y.useContext(Pn),{matches:u}=y.useContext(si),d=u[u.length-1],m=d?d.params:{},f=d?d.pathname:"/",v=d?d.pathnameBase:"/",_=d&&d.route;{let R=_&&_.path||"";Vb(f,!_||R.endsWith("*")||R.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${R}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${R}"> to <Route path="${R==="/"?"*":`${R}/*`}">.`)}let S=Hn(),x;if(t){let R=typeof t=="string"?Ca(t):t;ut(v==="/"||R.pathname?.startsWith(v),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${R.pathname}" was given in the \`location\` prop.`),x=R}else x=S;let b=x.pathname||"/",C=b;if(v!=="/"){let R=v.replace(/^\//,"").split("/");C="/"+b.replace(/^\//,"").split("/").slice(R.length).join("/")}let T=Mb(e,{pathname:C});ni(_||T!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),ni(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let k=Ek(T&&T.map(R=>Object.assign({},R,{params:Object.assign({},m,R.params),pathname:Zi([v,c.encodeLocation?c.encodeLocation(R.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathname]),pathnameBase:R.pathnameBase==="/"?v:Zi([v,c.encodeLocation?c.encodeLocation(R.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:R.pathnameBase])})),u,i,r,l);return t&&k?y.createElement(oo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},k):k}function Ck(){let e=Lk(),t=uk(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),i=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",l={padding:"0.5rem",backgroundColor:r},c={padding:"2px 4px",backgroundColor:r},u=null;return console.error("Error handled by React Router default ErrorBoundary:",e),u=y.createElement(y.Fragment,null,y.createElement("p",null," Hey developer "),y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",y.createElement("code",{style:c},"ErrorBoundary")," or"," ",y.createElement("code",{style:c},"errorElement")," prop on your route.")),y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},t),i?y.createElement("pre",{style:l},i):null,u)}var jk=y.createElement(Ck,null),Wb=class extends y.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.onError?this.props.onError(e,t):console.error("React Router caught the following error during render",e)}render(){let e=this.state.error;if(this.context&&typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){const i=yk(e.digest);i&&(e=i)}let t=e!==void 0?y.createElement(si.Provider,{value:this.props.routeContext},y.createElement(Gm.Provider,{value:e,children:this.props.component})):this.props.children;return this.context?y.createElement(kk,{error:e},t):t}};Wb.contextType=fk;var Qd=new WeakMap;function kk({children:e,error:t}){let{basename:i}=y.useContext(Pn);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let r=_k(t.digest);if(r){let l=Qd.get(t);if(l)throw l;let c=Pb(r.location,i);if(zb&&!Qd.get(t))if(c.isExternal||r.reloadDocument)window.location.href=c.absoluteURL||c.to;else{const u=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(c.to,{replace:r.replace}));throw Qd.set(t,u),u}return y.createElement("meta",{httpEquiv:"refresh",content:`0;url=${c.absoluteURL||c.to}`})}}return e}function Nk({routeContext:e,match:t,children:i}){let r=y.useContext(ja);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),y.createElement(si.Provider,{value:e},i)}function Ek(e,t=[],i=null,r=null,l=null){if(e==null){if(!i)return null;if(i.errors)e=i.matches;else if(t.length===0&&!i.initialized&&i.matches.length>0)e=i.matches;else return null}let c=e,u=i?.errors;if(u!=null){let v=c.findIndex(_=>_.route.id&&u?.[_.route.id]!==void 0);ut(v>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(u).join(",")}`),c=c.slice(0,Math.min(c.length,v+1))}let d=!1,m=-1;if(i)for(let v=0;v<c.length;v++){let _=c[v];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(m=v),_.route.id){let{loaderData:S,errors:x}=i,b=_.route.loader&&!S.hasOwnProperty(_.route.id)&&(!x||x[_.route.id]===void 0);if(_.route.lazy||b){d=!0,m>=0?c=c.slice(0,m+1):c=[c[0]];break}}}let f=i&&r?(v,_)=>{r(v,{location:i.location,params:i.matches?.[0]?.params??{},unstable_pattern:hk(i.matches),errorInfo:_})}:void 0;return c.reduceRight((v,_,S)=>{let x,b=!1,C=null,T=null;i&&(x=u&&_.route.id?u[_.route.id]:void 0,C=_.route.errorElement||jk,d&&(m<0&&S===0?(Vb("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,T=null):m===S&&(b=!0,T=_.route.hydrateFallbackElement||null)));let k=t.concat(c.slice(0,S+1)),R=()=>{let N;return x?N=C:b?N=T:_.route.Component?N=y.createElement(_.route.Component,null):_.route.element?N=_.route.element:N=v,y.createElement(Nk,{match:_,routeContext:{outlet:v,matches:k,isDataRoute:i!=null},children:N})};return i&&(_.route.ErrorBoundary||_.route.errorElement||S===0)?y.createElement(Wb,{location:i.location,revalidation:i.revalidation,component:C,error:x,children:R(),routeContext:{outlet:null,matches:k,isDataRoute:!0},onError:f}):R()},null)}function Ym(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Tk(e){let t=y.useContext(ja);return ut(t,Ym(e)),t}function Rk(e){let t=y.useContext(bu);return ut(t,Ym(e)),t}function Dk(e){let t=y.useContext(si);return ut(t,Ym(e)),t}function Xm(e){let t=Dk(e),i=t.matches[t.matches.length-1];return ut(i.route.id,`${e} can only be used on routes that contain a unique "id"`),i.route.id}function Ak(){return Xm("useRouteId")}function Lk(){let e=y.useContext(Gm),t=Rk("useRouteError"),i=Xm("useRouteError");return e!==void 0?e:t.errors?.[i]}function Mk(){let{router:e}=Tk("useNavigate"),t=Xm("useNavigate"),i=y.useRef(!1);return $b(()=>{i.current=!0}),y.useCallback(async(l,c={})=>{ni(i.current,Fb),i.current&&(typeof l=="number"?await e.navigate(l):await e.navigate(l,{fromRouteId:t,...c}))},[e,t])}var Vy={};function Vb(e,t,i){!t&&!Vy[e]&&(Vy[e]=!0,ni(!1,i))}y.memo(Bk);function Bk({routes:e,future:t,state:i,onError:r}){return qb(e,void 0,i,r,t)}function Ok({to:e,replace:t,state:i,relative:r}){ut(ka(),"<Navigate> may be used only in the context of a <Router> component.");let{static:l}=y.useContext(Pn);ni(!l,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:c}=y.useContext(si),{pathname:u}=Hn(),d=dt(),m=Vm(e,Wm(c),u,r==="path"),f=JSON.stringify(m);return y.useEffect(()=>{d(JSON.parse(f),{replace:t,state:i,relative:r})},[d,f,r,t,i]),null}function Na(e){return bk(e.context)}function ve(e){ut(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function zk({basename:e="/",children:t=null,location:i,navigationType:r="POP",navigator:l,static:c=!1,unstable_useTransitions:u}){ut(!ka(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=e.replace(/^\/*/,"/"),m=y.useMemo(()=>({basename:d,navigator:l,static:c,unstable_useTransitions:u,future:{}}),[d,l,c,u]);typeof i=="string"&&(i=Ca(i));let{pathname:f="/",search:v="",hash:_="",state:S=null,key:x="default"}=i,b=y.useMemo(()=>{let C=Qi(f,d);return C==null?null:{location:{pathname:C,search:v,hash:_,state:S,key:x},navigationType:r}},[d,f,v,_,S,x,r]);return ni(b!=null,`<Router basename="${d}"> is not able to match the URL "${f}${v}${_}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:y.createElement(Pn.Provider,{value:m},y.createElement(oo.Provider,{children:t,value:b}))}function Gb({children:e,location:t}){return wk(Ff(e),t)}function Ff(e,t=[]){let i=[];return y.Children.forEach(e,(r,l)=>{if(!y.isValidElement(r))return;let c=[...t,l];if(r.type===y.Fragment){i.push.apply(i,Ff(r.props.children,c));return}ut(r.type===ve,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ut(!r.props.index||!r.props.children,"An index route cannot have child routes.");let u={id:r.props.id||c.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(u.children=Ff(r.props.children,c)),i.push(u)}),i}var Yc="get",Xc="application/x-www-form-urlencoded";function wu(e){return typeof HTMLElement<"u"&&e instanceof HTMLElement}function Pk(e){return wu(e)&&e.tagName.toLowerCase()==="button"}function Hk(e){return wu(e)&&e.tagName.toLowerCase()==="form"}function Ik(e){return wu(e)&&e.tagName.toLowerCase()==="input"}function Uk(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Fk(e,t){return e.button===0&&(!t||t==="_self")&&!Uk(e)}function $f(e=""){return new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,i)=>{let r=e[i];return t.concat(Array.isArray(r)?r.map(l=>[i,l]):[[i,r]])},[]))}function $k(e,t){let i=$f(e);return t&&t.forEach((r,l)=>{i.has(l)||t.getAll(l).forEach(c=>{i.append(l,c)})}),i}var Bc=null;function Kk(){if(Bc===null)try{new FormData(document.createElement("form"),0),Bc=!1}catch{Bc=!0}return Bc}var qk=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ef(e){return e!=null&&!qk.has(e)?(ni(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Xc}"`),null):e}function Wk(e,t){let i,r,l,c,u;if(Hk(e)){let d=e.getAttribute("action");r=d?Qi(d,t):null,i=e.getAttribute("method")||Yc,l=ef(e.getAttribute("enctype"))||Xc,c=new FormData(e)}else if(Pk(e)||Ik(e)&&(e.type==="submit"||e.type==="image")){let d=e.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let m=e.getAttribute("formaction")||d.getAttribute("action");if(r=m?Qi(m,t):null,i=e.getAttribute("formmethod")||d.getAttribute("method")||Yc,l=ef(e.getAttribute("formenctype"))||ef(d.getAttribute("enctype"))||Xc,c=new FormData(d,e),!Kk()){let{name:f,type:v,value:_}=e;if(v==="image"){let S=f?`${f}.`:"";c.append(`${S}x`,"0"),c.append(`${S}y`,"0")}else f&&c.append(f,_)}}else{if(wu(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');i=Yc,r=null,l=Xc,u=e}return c&&l==="text/plain"&&(u=c,c=void 0),{action:r,method:i.toLowerCase(),encType:l,formData:c,body:u}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Jm(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Vk(e,t,i,r){let l=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return i?l.pathname.endsWith("/")?l.pathname=`${l.pathname}_.${r}`:l.pathname=`${l.pathname}.${r}`:l.pathname==="/"?l.pathname=`_root.${r}`:t&&Qi(l.pathname,t)==="/"?l.pathname=`${t.replace(/\/$/,"")}/_root.${r}`:l.pathname=`${l.pathname.replace(/\/$/,"")}.${r}`,l}async function Gk(e,t){if(e.id in t)return t[e.id];try{let i=await import(e.module);return t[e.id]=i,i}catch(i){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(i),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Yk(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function Xk(e,t,i){let r=await Promise.all(e.map(async l=>{let c=t.routes[l.route.id];if(c){let u=await Gk(c,i);return u.links?u.links():[]}return[]}));return eN(r.flat(1).filter(Yk).filter(l=>l.rel==="stylesheet"||l.rel==="preload").map(l=>l.rel==="stylesheet"?{...l,rel:"prefetch",as:"style"}:{...l,rel:"prefetch"}))}function Gy(e,t,i,r,l,c){let u=(m,f)=>i[f]?m.route.id!==i[f].route.id:!0,d=(m,f)=>i[f].pathname!==m.pathname||i[f].route.path?.endsWith("*")&&i[f].params["*"]!==m.params["*"];return c==="assets"?t.filter((m,f)=>u(m,f)||d(m,f)):c==="data"?t.filter((m,f)=>{let v=r.routes[m.route.id];if(!v||!v.hasLoader)return!1;if(u(m,f)||d(m,f))return!0;if(m.route.shouldRevalidate){let _=m.route.shouldRevalidate({currentUrl:new URL(l.pathname+l.search+l.hash,window.origin),currentParams:i[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:m.params,defaultShouldRevalidate:!0});if(typeof _=="boolean")return _}return!0}):[]}function Jk(e,t,{includeHydrateFallback:i}={}){return Zk(e.map(r=>{let l=t.routes[r.route.id];if(!l)return[];let c=[l.module];return l.clientActionModule&&(c=c.concat(l.clientActionModule)),l.clientLoaderModule&&(c=c.concat(l.clientLoaderModule)),i&&l.hydrateFallbackModule&&(c=c.concat(l.hydrateFallbackModule)),l.imports&&(c=c.concat(l.imports)),c}).flat(1))}function Zk(e){return[...new Set(e)]}function Qk(e){let t={},i=Object.keys(e).sort();for(let r of i)t[r]=e[r];return t}function eN(e,t){let i=new Set;return new Set(t),e.reduce((r,l)=>{let c=JSON.stringify(Qk(l));return i.has(c)||(i.add(c),r.push({key:c,link:l})),r},[])}function Yb(){let e=y.useContext(ja);return Jm(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function tN(){let e=y.useContext(bu);return Jm(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Zm=y.createContext(void 0);Zm.displayName="FrameworkContext";function Xb(){let e=y.useContext(Zm);return Jm(e,"You must render this element inside a <HydratedRouter> element"),e}function nN(e,t){let i=y.useContext(Zm),[r,l]=y.useState(!1),[c,u]=y.useState(!1),{onFocus:d,onBlur:m,onMouseEnter:f,onMouseLeave:v,onTouchStart:_}=t,S=y.useRef(null);y.useEffect(()=>{if(e==="render"&&u(!0),e==="viewport"){let C=k=>{k.forEach(R=>{u(R.isIntersecting)})},T=new IntersectionObserver(C,{threshold:.5});return S.current&&T.observe(S.current),()=>{T.disconnect()}}},[e]),y.useEffect(()=>{if(r){let C=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(C)}}},[r]);let x=()=>{l(!0)},b=()=>{l(!1),u(!1)};return i?e!=="intent"?[c,S,{}]:[c,S,{onFocus:Tl(d,x),onBlur:Tl(m,b),onMouseEnter:Tl(f,x),onMouseLeave:Tl(v,b),onTouchStart:Tl(_,x)}]:[!1,S,{}]}function Tl(e,t){return i=>{e&&e(i),i.defaultPrevented||t(i)}}function iN({page:e,...t}){let{router:i}=Yb(),r=y.useMemo(()=>Mb(i.routes,e,i.basename),[i.routes,e,i.basename]);return r?y.createElement(rN,{page:e,matches:r,...t}):null}function sN(e){let{manifest:t,routeModules:i}=Xb(),[r,l]=y.useState([]);return y.useEffect(()=>{let c=!1;return Xk(e,t,i).then(u=>{c||l(u)}),()=>{c=!0}},[e,t,i]),r}function rN({page:e,matches:t,...i}){let r=Hn(),{future:l,manifest:c,routeModules:u}=Xb(),{basename:d}=Yb(),{loaderData:m,matches:f}=tN(),v=y.useMemo(()=>Gy(e,t,f,c,r,"data"),[e,t,f,c,r]),_=y.useMemo(()=>Gy(e,t,f,c,r,"assets"),[e,t,f,c,r]),S=y.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let C=new Set,T=!1;if(t.forEach(R=>{let N=c.routes[R.route.id];!N||!N.hasLoader||(!v.some(E=>E.route.id===R.route.id)&&R.route.id in m&&u[R.route.id]?.shouldRevalidate||N.hasClientLoader?T=!0:C.add(R.route.id))}),C.size===0)return[];let k=Vk(e,d,l.unstable_trailingSlashAwareDataRequests,"data");return T&&C.size>0&&k.searchParams.set("_routes",t.filter(R=>C.has(R.route.id)).map(R=>R.route.id).join(",")),[k.pathname+k.search]},[d,l.unstable_trailingSlashAwareDataRequests,m,r,c,v,t,e,u]),x=y.useMemo(()=>Jk(_,c),[_,c]),b=sN(_);return y.createElement(y.Fragment,null,S.map(C=>y.createElement("link",{key:C,rel:"prefetch",as:"fetch",href:C,...i})),x.map(C=>y.createElement("link",{key:C,rel:"modulepreload",href:C,...i})),b.map(({key:C,link:T})=>y.createElement("link",{key:C,nonce:i.nonce,...T,crossOrigin:T.crossOrigin??i.crossOrigin})))}function aN(...e){return t=>{e.forEach(i=>{typeof i=="function"?i(t):i!=null&&(i.current=t)})}}var lN=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{lN&&(window.__reactRouterVersion="7.13.0")}catch{}function oN({basename:e,children:t,unstable_useTransitions:i,window:r}){let l=y.useRef();l.current==null&&(l.current=Ij({window:r,v5Compat:!0}));let c=l.current,[u,d]=y.useState({action:c.action,location:c.location}),m=y.useCallback(f=>{i===!1?d(f):y.startTransition(()=>d(f))},[i]);return y.useLayoutEffect(()=>c.listen(m),[c,m]),y.createElement(zk,{basename:e,children:t,location:u.location,navigationType:u.action,navigator:c,unstable_useTransitions:i})}var Jb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Bs=y.forwardRef(function({onClick:t,discover:i="render",prefetch:r="none",relative:l,reloadDocument:c,replace:u,state:d,target:m,to:f,preventScrollReset:v,viewTransition:_,unstable_defaultShouldRevalidate:S,...x},b){let{basename:C,unstable_useTransitions:T}=y.useContext(Pn),k=typeof f=="string"&&Jb.test(f),R=Pb(f,C);f=R.to;let N=xk(f,{relative:l}),[E,z,B]=nN(r,x),I=dN(f,{replace:u,state:d,target:m,preventScrollReset:v,relative:l,viewTransition:_,unstable_defaultShouldRevalidate:S,unstable_useTransitions:T});function q(V){t&&t(V),V.defaultPrevented||I(V)}let F=y.createElement("a",{...x,...B,href:R.absoluteURL||N,onClick:R.isExternal||c?t:q,ref:aN(b,z),target:m,"data-discover":!k&&i==="render"?"true":void 0});return E&&!k?y.createElement(y.Fragment,null,F,y.createElement(iN,{page:N})):F});Bs.displayName="Link";var cN=y.forwardRef(function({"aria-current":t="page",caseSensitive:i=!1,className:r="",end:l=!1,style:c,to:u,viewTransition:d,children:m,...f},v){let _=co(u,{relative:f.relative}),S=Hn(),x=y.useContext(bu),{navigator:b,basename:C}=y.useContext(Pn),T=x!=null&&vN(_)&&d===!0,k=b.encodeLocation?b.encodeLocation(_).pathname:_.pathname,R=S.pathname,N=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;i||(R=R.toLowerCase(),N=N?N.toLowerCase():null,k=k.toLowerCase()),N&&C&&(N=Qi(N,C)||N);const E=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let z=R===k||!l&&R.startsWith(k)&&R.charAt(E)==="/",B=N!=null&&(N===k||!l&&N.startsWith(k)&&N.charAt(k.length)==="/"),I={isActive:z,isPending:B,isTransitioning:T},q=z?t:void 0,F;typeof r=="function"?F=r(I):F=[r,z?"active":null,B?"pending":null,T?"transitioning":null].filter(Boolean).join(" ");let V=typeof c=="function"?c(I):c;return y.createElement(Bs,{...f,"aria-current":q,className:F,ref:v,style:V,to:u,viewTransition:d},typeof m=="function"?m(I):m)});cN.displayName="NavLink";var uN=y.forwardRef(({discover:e="render",fetcherKey:t,navigate:i,reloadDocument:r,replace:l,state:c,method:u=Yc,action:d,onSubmit:m,relative:f,preventScrollReset:v,viewTransition:_,unstable_defaultShouldRevalidate:S,...x},b)=>{let{unstable_useTransitions:C}=y.useContext(Pn),T=pN(),k=gN(d,{relative:f}),R=u.toLowerCase()==="get"?"get":"post",N=typeof d=="string"&&Jb.test(d),E=z=>{if(m&&m(z),z.defaultPrevented)return;z.preventDefault();let B=z.nativeEvent.submitter,I=B?.getAttribute("formmethod")||u,q=()=>T(B||z.currentTarget,{fetcherKey:t,method:I,navigate:i,replace:l,state:c,relative:f,preventScrollReset:v,viewTransition:_,unstable_defaultShouldRevalidate:S});C&&i!==!1?y.startTransition(()=>q()):q()};return y.createElement("form",{ref:b,method:R,action:k,onSubmit:r?m:E,...x,"data-discover":!N&&e==="render"?"true":void 0})});uN.displayName="Form";function hN(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Zb(e){let t=y.useContext(ja);return ut(t,hN(e)),t}function dN(e,{target:t,replace:i,state:r,preventScrollReset:l,relative:c,viewTransition:u,unstable_defaultShouldRevalidate:d,unstable_useTransitions:m}={}){let f=dt(),v=Hn(),_=co(e,{relative:c});return y.useCallback(S=>{if(Fk(S,t)){S.preventDefault();let x=i!==void 0?i:Ql(v)===Ql(_),b=()=>f(e,{replace:x,state:r,preventScrollReset:l,relative:c,viewTransition:u,unstable_defaultShouldRevalidate:d});m?y.startTransition(()=>b()):b()}},[v,f,_,i,r,t,e,l,c,u,d,m])}function TB(e){ni(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=y.useRef($f(e)),i=y.useRef(!1),r=Hn(),l=y.useMemo(()=>$k(r.search,i.current?null:t.current),[r.search]),c=dt(),u=y.useCallback((d,m)=>{const f=$f(typeof d=="function"?d(new URLSearchParams(l)):d);i.current=!0,c("?"+f,m)},[c,l]);return[l,u]}var fN=0,mN=()=>`__${String(++fN)}__`;function pN(){let{router:e}=Zb("useSubmit"),{basename:t}=y.useContext(Pn),i=Ak(),r=e.fetch,l=e.navigate;return y.useCallback(async(c,u={})=>{let{action:d,method:m,encType:f,formData:v,body:_}=Wk(c,t);if(u.navigate===!1){let S=u.fetcherKey||mN();await r(S,i,u.action||d,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:v,body:_,formMethod:u.method||m,formEncType:u.encType||f,flushSync:u.flushSync})}else await l(u.action||d,{unstable_defaultShouldRevalidate:u.unstable_defaultShouldRevalidate,preventScrollReset:u.preventScrollReset,formData:v,body:_,formMethod:u.method||m,formEncType:u.encType||f,replace:u.replace,state:u.state,fromRouteId:i,flushSync:u.flushSync,viewTransition:u.viewTransition})},[r,l,t,i])}function gN(e,{relative:t}={}){let{basename:i}=y.useContext(Pn),r=y.useContext(si);ut(r,"useFormAction must be used inside a RouteContext");let[l]=r.matches.slice(-1),c={...co(e||".",{relative:t})},u=Hn();if(e==null){c.search=u.search;let d=new URLSearchParams(c.search),m=d.getAll("index");if(m.some(v=>v==="")){d.delete("index"),m.filter(_=>_).forEach(_=>d.append("index",_));let v=d.toString();c.search=v?`?${v}`:""}}return(!e||e===".")&&l.route.index&&(c.search=c.search?c.search.replace(/^\?/,"?index&"):"?index"),i!=="/"&&(c.pathname=c.pathname==="/"?i:Zi([i,c.pathname])),Ql(c)}function vN(e,{relative:t}={}){let i=y.useContext(Ib);ut(i!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Zb("useViewTransitionState"),l=co(e,{relative:t});if(!i.isTransitioning)return!1;let c=Qi(i.currentLocation.pathname,r)||i.currentLocation.pathname,u=Qi(i.nextLocation.pathname,r)||i.nextLocation.pathname;return ru(l.pathname,u)!=null||ru(l.pathname,c)!=null}const Yy="/assets/react-CHdo91hT.svg";function _N(){const[e,t]=y.useState(0);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("a",{href:"https://vite.dev",target:"_blank",children:a.jsx("img",{src:Yy,className:"logo",alt:"Vite logo"})}),a.jsx("a",{href:"https://react.dev",target:"_blank",children:a.jsx("img",{src:Yy,className:"logo react",alt:"React logo"})})]}),a.jsx("h1",{children:"Vite + React"}),a.jsxs("div",{className:"card",children:[a.jsxs("button",{onClick:()=>t(i=>i+1),children:["count is ",e]}),a.jsxs("p",{children:["Edit ",a.jsx("code",{children:"src/App.tsx"})," and save to test HMR"]})]}),a.jsx("p",{className:"read-the-docs",children:"Click on the Vite and React logos to learn more"})]})}function yN({dir:e,onDirChange:t,loading:i,onRefresh:r}){return a.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid #e5e5e5",backgroundColor:"#f9fafb",display:"flex",alignItems:"center",gap:"12px"},children:[a.jsx("h1",{style:{margin:0,fontSize:"18px",fontWeight:600},children:"Code Review"}),a.jsx("input",{type:"text",value:e,onChange:l=>t(l.target.value),placeholder:"Directory path",style:{flex:1,maxWidth:"500px",padding:"8px 12px",fontSize:"13px",border:"1px solid #d1d5db",borderRadius:"6px"}}),a.jsx("button",{onClick:r,disabled:i,style:{padding:"8px 16px",fontSize:"13px",backgroundColor:"#4CAF50",color:"white",border:"none",borderRadius:"6px",cursor:i?"not-allowed":"pointer",opacity:i?.7:1},children:i?"Loading...":"Refresh"})]})}function xN(e){const t=e.split(`
`),i=[],r=[];let l=!1;for(const c of t){if(c.startsWith("@@")){l=!0;continue}l&&(c.startsWith("-")&&!c.startsWith("---")?i.push(c.substring(1)):c.startsWith("+")&&!c.startsWith("+++")?r.push(c.substring(1)):c.startsWith("\\")||(i.push(c.startsWith(" ")?c.substring(1):c),r.push(c.startsWith(" ")?c.substring(1):c)))}return{original:i.join(`
`),modified:r.join(`
`)}}function SN(e){const t=e.split(".").pop()?.toLowerCase()||"";return{ts:"typescript",tsx:"typescript",js:"javascript",jsx:"javascript",go:"go",py:"python",rb:"ruby",rs:"rust",java:"java",c:"c",cpp:"cpp",h:"c",hpp:"cpp",css:"css",scss:"scss",html:"html",json:"json",yaml:"yaml",yml:"yaml",md:"markdown",sql:"sql",sh:"shell",bash:"shell"}[t]||"plaintext"}function bN(e){const t=new Map;for(const i of e){const r=i.path.includes("/")?i.path.substring(0,i.path.lastIndexOf("/")):"";t.has(r)||t.set(r,[]),t.get(r).push(i)}return t}function wN(e){const t=e.split(".").pop()?.toLowerCase()||"";return{ts:{color:"#3178c6",letter:"TS"},tsx:{color:"#3178c6",letter:"TSX"},js:{color:"#f7df1e",letter:"JS"},jsx:{color:"#61dafb",letter:"JSX"},go:{color:"#00add8",letter:"GO"},py:{color:"#3776ab",letter:"PY"},rs:{color:"#dea584",letter:"RS"},java:{color:"#b07219",letter:"J"},css:{color:"#563d7c",letter:"CSS"},scss:{color:"#c6538c",letter:"SCSS"},html:{color:"#e34c26",letter:"HTML"},json:{color:"#cbcb41",letter:"{ }"},yaml:{color:"#cb171e",letter:"YML"},yml:{color:"#cb171e",letter:"YML"},md:{color:"#083fa1",letter:"MD"},sql:{color:"#e38c00",letter:"SQL"},sh:{color:"#89e051",letter:"SH"}}[t]||{color:"#6b7280",letter:t.toUpperCase().slice(0,3)||"F"}}function CN(e){switch(e){case"added":return{bg:"#22c55e",color:"#fff",letter:"A"};case"deleted":return{bg:"#ef4444",color:"#fff",letter:"D"};case"renamed":return{bg:"#8b5cf6",color:"#fff",letter:"R"};default:return{bg:"#f59e0b",color:"#fff",letter:"M"}}}function jN({file:e,isSelected:t,onClick:i,indent:r,showStageButton:l,onStage:c}){const u=e.path.split("/").pop()||e.path,d=wN(e.path),m=CN(e.status),f=v=>{v.stopPropagation(),c?.(e)};return a.jsxs("div",{onClick:i,style:{padding:"4px 12px",paddingLeft:`${r}px`,cursor:"pointer",backgroundColor:t?"#dbeafe":"transparent",display:"flex",alignItems:"center",gap:"8px"},onMouseEnter:v=>{t||(v.currentTarget.style.backgroundColor="#f3f4f6")},onMouseLeave:v=>{t||(v.currentTarget.style.backgroundColor="transparent")},children:[a.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"3px",backgroundColor:d.color,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"8px",fontWeight:700,color:"#fff",flexShrink:0},children:d.letter.slice(0,2)}),a.jsx("span",{style:{fontSize:"13px",color:"#1f2937",flex:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left"},children:u}),l&&a.jsx("button",{onClick:f,style:{width:"18px",height:"18px",borderRadius:"3px",backgroundColor:"#10b981",border:"none",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:600,color:"#fff",cursor:"pointer",flexShrink:0},title:"Stage file",children:"+"}),a.jsx("div",{style:{width:"16px",height:"16px",borderRadius:"3px",backgroundColor:m.bg,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"10px",fontWeight:600,color:m.color,flexShrink:0},children:m.letter})]})}function kN(){return a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"#dcb67a",children:a.jsx("path",{d:"M1.5 2h4.3l1.2 1.5H14.5a1 1 0 011 1V13a1 1 0 01-1 1h-13a1 1 0 01-1-1V3a1 1 0 011-1z"})})}function Xy({title:e,count:t,files:i,selectedFile:r,onSelectFile:l,showStageButton:c,onStageFile:u,onStageDir:d}){const[m,f]=y.useState(!0),v=bN(i);return a.jsxs("div",{style:{borderBottom:"1px solid #e5e7eb"},children:[a.jsxs("div",{onClick:()=>f(!m),style:{padding:"8px 12px",display:"flex",alignItems:"center",gap:"6px",cursor:"pointer",backgroundColor:"#f3f4f6",userSelect:"none"},children:[a.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",style:{transform:m?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.15s ease"},children:a.jsx("path",{d:"M4 2 L8 6 L4 10",fill:"none",stroke:"#6b7280",strokeWidth:"1.5",strokeLinecap:"round"})}),a.jsx("span",{style:{fontSize:"11px",fontWeight:600,color:"#374151",letterSpacing:"0.5px"},children:e}),a.jsx("span",{style:{fontSize:"11px",color:"#6b7280",backgroundColor:"#e5e7eb",padding:"1px 6px",borderRadius:"10px",marginLeft:"auto"},children:t})]}),m&&a.jsx("div",{children:Array.from(v.entries()).map(([_,S])=>a.jsxs("div",{children:[_&&a.jsxs("div",{style:{padding:"4px 12px 4px 20px",fontSize:"11px",color:"#6b7280",display:"flex",alignItems:"center",gap:"4px"},children:[a.jsx(kN,{}),a.jsx("span",{style:{flex:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:_}),c&&d&&a.jsx("button",{onClick:x=>{x.stopPropagation(),d(_)},style:{width:"18px",height:"18px",borderRadius:"3px",backgroundColor:"#10b981",border:"none",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",fontWeight:600,color:"#fff",cursor:"pointer",flexShrink:0},title:"Stage directory",children:"+"})]}),S.map((x,b)=>a.jsx(jN,{file:x,isSelected:r===x,onClick:()=>l(x),indent:_?32:20,showStageButton:c,onStage:u},b))]},_||"root"))})]})}function NN({diffResult:e,selectedFile:t,onSelectFile:i,loading:r,onStageFile:l,onStageDir:c}){const u=e&&e.files&&e.files.length>0;return a.jsx("div",{style:{width:"280px",borderRight:"1px solid #e5e5e5",overflow:"auto",backgroundColor:"#f9fafb"},children:u?a.jsxs("div",{children:[e?.files.filter(d=>d.isStaged).length>0&&a.jsx(Xy,{title:"STAGED CHANGES",count:e.files.filter(d=>d.isStaged).length,files:e.files.filter(d=>d.isStaged),selectedFile:t,onSelectFile:i}),e?.files.filter(d=>!d.isStaged).length>0&&a.jsx(Xy,{title:"CHANGES",count:e.files.filter(d=>!d.isStaged).length,files:e.files.filter(d=>!d.isStaged),selectedFile:t,onSelectFile:i,showStageButton:!0,onStageFile:l,onStageDir:c})]}):a.jsx("div",{style:{padding:"20px",color:"#6b7280",textAlign:"center",fontSize:"13px"},children:r?"Loading...":"No changes detected"})})}function Jy(e,t){(t==null||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function EN(e){if(Array.isArray(e))return e}function TN(e,t,i){return(t=ON(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function RN(e,t){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var r,l,c,u,d=[],m=!0,f=!1;try{if(c=(i=i.call(e)).next,t!==0)for(;!(m=(r=c.call(i)).done)&&(d.push(r.value),d.length!==t);m=!0);}catch(v){f=!0,l=v}finally{try{if(!m&&i.return!=null&&(u=i.return(),Object(u)!==u))return}finally{if(f)throw l}}return d}}function DN(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zy(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),i.push.apply(i,r)}return i}function Qy(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Zy(Object(i),!0).forEach(function(r){TN(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Zy(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function AN(e,t){if(e==null)return{};var i,r,l=LN(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)i=c[r],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(l[i]=e[i])}return l}function LN(e,t){if(e==null)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.indexOf(r)!==-1)continue;i[r]=e[r]}return i}function MN(e,t){return EN(e)||RN(e,t)||zN(e,t)||DN()}function BN(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var r=i.call(e,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ON(e){var t=BN(e,"string");return typeof t=="symbol"?t:t+""}function zN(e,t){if(e){if(typeof e=="string")return Jy(e,t);var i={}.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Jy(e,t):void 0}}function PN(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ex(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),i.push.apply(i,r)}return i}function tx(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?ex(Object(i),!0).forEach(function(r){PN(e,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ex(Object(i)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(i,r))})}return e}function HN(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(r){return t.reduceRight(function(l,c){return c(l)},r)}}function Fl(e){return function t(){for(var i=this,r=arguments.length,l=new Array(r),c=0;c<r;c++)l[c]=arguments[c];return l.length>=e.length?e.apply(this,l):function(){for(var u=arguments.length,d=new Array(u),m=0;m<u;m++)d[m]=arguments[m];return t.apply(i,[].concat(l,d))}}}function au(e){return{}.toString.call(e).includes("Object")}function IN(e){return!Object.keys(e).length}function eo(e){return typeof e=="function"}function UN(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function FN(e,t){return au(t)||Os("changeType"),Object.keys(t).some(function(i){return!UN(e,i)})&&Os("changeField"),t}function $N(e){eo(e)||Os("selectorType")}function KN(e){eo(e)||au(e)||Os("handlerType"),au(e)&&Object.values(e).some(function(t){return!eo(t)})&&Os("handlersType")}function qN(e){e||Os("initialIsRequired"),au(e)||Os("initialType"),IN(e)&&Os("initialContent")}function WN(e,t){throw new Error(e[t]||e.default)}var VN={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},Os=Fl(WN)(VN),Oc={changes:FN,selector:$N,handler:KN,initial:qN};function GN(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Oc.initial(e),Oc.handler(t);var i={current:e},r=Fl(JN)(i,t),l=Fl(XN)(i),c=Fl(Oc.changes)(e),u=Fl(YN)(i);function d(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(v){return v};return Oc.selector(f),f(i.current)}function m(f){HN(r,l,c,u)(f)}return[d,m]}function YN(e,t){return eo(t)?t(e.current):t}function XN(e,t){return e.current=tx(tx({},e.current),t),t}function JN(e,t,i){return eo(t)?t(e.current):Object.keys(i).forEach(function(r){var l;return(l=t[r])===null||l===void 0?void 0:l.call(t,e.current[r])}),i}var ZN={create:GN},QN={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.55.1/min/vs"}};function e2(e){return function t(){for(var i=this,r=arguments.length,l=new Array(r),c=0;c<r;c++)l[c]=arguments[c];return l.length>=e.length?e.apply(this,l):function(){for(var u=arguments.length,d=new Array(u),m=0;m<u;m++)d[m]=arguments[m];return t.apply(i,[].concat(l,d))}}}function t2(e){return{}.toString.call(e).includes("Object")}function n2(e){return e||nx("configIsRequired"),t2(e)||nx("configType"),e.urls?(i2(),{paths:{vs:e.urls.monacoBase}}):e}function i2(){console.warn(Qb.deprecation)}function s2(e,t){throw new Error(e[t]||e.default)}var Qb={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},nx=e2(s2)(Qb),r2={config:n2},a2=function(){for(var t=arguments.length,i=new Array(t),r=0;r<t;r++)i[r]=arguments[r];return function(l){return i.reduceRight(function(c,u){return u(c)},l)}};function e0(e,t){return Object.keys(t).forEach(function(i){t[i]instanceof Object&&e[i]&&Object.assign(t[i],e0(e[i],t[i]))}),Qy(Qy({},e),t)}var l2={type:"cancelation",msg:"operation is manually canceled"};function tf(e){var t=!1,i=new Promise(function(r,l){e.then(function(c){return t?l(l2):r(c)}),e.catch(l)});return i.cancel=function(){return t=!0},i}var o2=["monaco"],c2=ZN.create({config:QN,isInitialized:!1,resolve:null,reject:null,monaco:null}),t0=MN(c2,2),uo=t0[0],Cu=t0[1];function u2(e){var t=r2.config(e),i=t.monaco,r=AN(t,o2);Cu(function(l){return{config:e0(l.config,r),monaco:i}})}function h2(){var e=uo(function(t){var i=t.monaco,r=t.isInitialized,l=t.resolve;return{monaco:i,isInitialized:r,resolve:l}});if(!e.isInitialized){if(Cu({isInitialized:!0}),e.monaco)return e.resolve(e.monaco),tf(nf);if(window.monaco&&window.monaco.editor)return n0(window.monaco),e.resolve(window.monaco),tf(nf);a2(d2,m2)(p2)}return tf(nf)}function d2(e){return document.body.appendChild(e)}function f2(e){var t=document.createElement("script");return e&&(t.src=e),t}function m2(e){var t=uo(function(r){var l=r.config,c=r.reject;return{config:l,reject:c}}),i=f2("".concat(t.config.paths.vs,"/loader.js"));return i.onload=function(){return e()},i.onerror=t.reject,i}function p2(){var e=uo(function(i){var r=i.config,l=i.resolve,c=i.reject;return{config:r,resolve:l,reject:c}}),t=window.require;t.config(e.config),t(["vs/editor/editor.main"],function(i){var r=i.m||i;n0(r),e.resolve(r)},function(i){e.reject(i)})}function n0(e){uo().monaco||Cu({monaco:e})}function g2(){return uo(function(e){var t=e.monaco;return t})}var nf=new Promise(function(e,t){return Cu({resolve:e,reject:t})}),i0={config:u2,init:h2,__getMonacoInstance:g2},v2={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},sf=v2,_2={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},y2=_2;function x2({children:e}){return fr.createElement("div",{style:y2.container},e)}var S2=x2,b2=S2;function w2({width:e,height:t,isEditorReady:i,loading:r,_ref:l,className:c,wrapperProps:u}){return fr.createElement("section",{style:{...sf.wrapper,width:e,height:t},...u},!i&&fr.createElement(b2,null,r),fr.createElement("div",{ref:l,style:{...sf.fullWidth,...!i&&sf.hide},className:c}))}var C2=w2,s0=y.memo(C2);function j2(e){y.useEffect(e,[])}var r0=j2;function k2(e,t,i=!0){let r=y.useRef(!0);y.useEffect(r.current||!i?()=>{r.current=!1}:e,t)}var Bn=k2;function Gl(){}function pa(e,t,i,r){return N2(e,r)||E2(e,t,i,r)}function N2(e,t){return e.editor.getModel(a0(e,t))}function E2(e,t,i,r){return e.editor.createModel(t,i,r?a0(e,r):void 0)}function a0(e,t){return e.Uri.parse(t)}function T2({original:e,modified:t,language:i,originalLanguage:r,modifiedLanguage:l,originalModelPath:c,modifiedModelPath:u,keepCurrentOriginalModel:d=!1,keepCurrentModifiedModel:m=!1,theme:f="light",loading:v="Loading...",options:_={},height:S="100%",width:x="100%",className:b,wrapperProps:C={},beforeMount:T=Gl,onMount:k=Gl}){let[R,N]=y.useState(!1),[E,z]=y.useState(!0),B=y.useRef(null),I=y.useRef(null),q=y.useRef(null),F=y.useRef(k),V=y.useRef(T),G=y.useRef(!1);r0(()=>{let A=i0.init();return A.then(D=>(I.current=D)&&z(!1)).catch(D=>D?.type!=="cancelation"&&console.error("Monaco initialization: error:",D)),()=>B.current?j():A.cancel()}),Bn(()=>{if(B.current&&I.current){let A=B.current.getOriginalEditor(),D=pa(I.current,e||"",r||i||"text",c||"");D!==A.getModel()&&A.setModel(D)}},[c],R),Bn(()=>{if(B.current&&I.current){let A=B.current.getModifiedEditor(),D=pa(I.current,t||"",l||i||"text",u||"");D!==A.getModel()&&A.setModel(D)}},[u],R),Bn(()=>{let A=B.current.getModifiedEditor();A.getOption(I.current.editor.EditorOption.readOnly)?A.setValue(t||""):t!==A.getValue()&&(A.executeEdits("",[{range:A.getModel().getFullModelRange(),text:t||"",forceMoveMarkers:!0}]),A.pushUndoStop())},[t],R),Bn(()=>{B.current?.getModel()?.original.setValue(e||"")},[e],R),Bn(()=>{let{original:A,modified:D}=B.current.getModel();I.current.editor.setModelLanguage(A,r||i||"text"),I.current.editor.setModelLanguage(D,l||i||"text")},[i,r,l],R),Bn(()=>{I.current?.editor.setTheme(f)},[f],R),Bn(()=>{B.current?.updateOptions(_)},[_],R);let Y=y.useCallback(()=>{if(!I.current)return;V.current(I.current);let A=pa(I.current,e||"",r||i||"text",c||""),D=pa(I.current,t||"",l||i||"text",u||"");B.current?.setModel({original:A,modified:D})},[i,t,l,e,r,c,u]),M=y.useCallback(()=>{!G.current&&q.current&&(B.current=I.current.editor.createDiffEditor(q.current,{automaticLayout:!0,..._}),Y(),I.current?.editor.setTheme(f),N(!0),G.current=!0)},[_,f,Y]);y.useEffect(()=>{R&&F.current(B.current,I.current)},[R]),y.useEffect(()=>{!E&&!R&&M()},[E,R,M]);function j(){let A=B.current?.getModel();d||A?.original?.dispose(),m||A?.modified?.dispose(),B.current?.dispose()}return fr.createElement(s0,{width:x,height:S,isEditorReady:R,loading:v,_ref:q,className:b,wrapperProps:C})}var R2=T2,D2=y.memo(R2);function A2(e){let t=y.useRef();return y.useEffect(()=>{t.current=e},[e]),t.current}var L2=A2,zc=new Map;function M2({defaultValue:e,defaultLanguage:t,defaultPath:i,value:r,language:l,path:c,theme:u="light",line:d,loading:m="Loading...",options:f={},overrideServices:v={},saveViewState:_=!0,keepCurrentModel:S=!1,width:x="100%",height:b="100%",className:C,wrapperProps:T={},beforeMount:k=Gl,onMount:R=Gl,onChange:N,onValidate:E=Gl}){let[z,B]=y.useState(!1),[I,q]=y.useState(!0),F=y.useRef(null),V=y.useRef(null),G=y.useRef(null),Y=y.useRef(R),M=y.useRef(k),j=y.useRef(),A=y.useRef(r),D=L2(c),$=y.useRef(!1),W=y.useRef(!1);r0(()=>{let P=i0.init();return P.then(H=>(F.current=H)&&q(!1)).catch(H=>H?.type!=="cancelation"&&console.error("Monaco initialization: error:",H)),()=>V.current?U():P.cancel()}),Bn(()=>{let P=pa(F.current,e||r||"",t||l||"",c||i||"");P!==V.current?.getModel()&&(_&&zc.set(D,V.current?.saveViewState()),V.current?.setModel(P),_&&V.current?.restoreViewState(zc.get(c)))},[c],z),Bn(()=>{V.current?.updateOptions(f)},[f],z),Bn(()=>{!V.current||r===void 0||(V.current.getOption(F.current.editor.EditorOption.readOnly)?V.current.setValue(r):r!==V.current.getValue()&&(W.current=!0,V.current.executeEdits("",[{range:V.current.getModel().getFullModelRange(),text:r,forceMoveMarkers:!0}]),V.current.pushUndoStop(),W.current=!1))},[r],z),Bn(()=>{let P=V.current?.getModel();P&&l&&F.current?.editor.setModelLanguage(P,l)},[l],z),Bn(()=>{d!==void 0&&V.current?.revealLine(d)},[d],z),Bn(()=>{F.current?.editor.setTheme(u)},[u],z);let ne=y.useCallback(()=>{if(!(!G.current||!F.current)&&!$.current){M.current(F.current);let P=c||i,H=pa(F.current,r||e||"",t||l||"",P||"");V.current=F.current?.editor.create(G.current,{model:H,automaticLayout:!0,...f},v),_&&V.current.restoreViewState(zc.get(P)),F.current.editor.setTheme(u),d!==void 0&&V.current.revealLine(d),B(!0),$.current=!0}},[e,t,i,r,l,c,f,v,_,u,d]);y.useEffect(()=>{z&&Y.current(V.current,F.current)},[z]),y.useEffect(()=>{!I&&!z&&ne()},[I,z,ne]),A.current=r,y.useEffect(()=>{z&&N&&(j.current?.dispose(),j.current=V.current?.onDidChangeModelContent(P=>{W.current||N(V.current.getValue(),P)}))},[z,N]),y.useEffect(()=>{if(z){let P=F.current.editor.onDidChangeMarkers(H=>{let L=V.current.getModel()?.uri;if(L&&H.find(re=>re.path===L.path)){let re=F.current.editor.getModelMarkers({resource:L});E?.(re)}});return()=>{P?.dispose()}}return()=>{}},[z,E]);function U(){j.current?.dispose(),S?_&&zc.set(c,V.current.saveViewState()):V.current.getModel()?.dispose(),V.current.dispose()}return fr.createElement(s0,{width:x,height:b,isEditorReady:z,loading:m,_ref:G,className:C,wrapperProps:T})}var B2=M2;y.memo(B2);function O2({selectedFile:e}){if(!e)return a.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:"#9ca3af",fontSize:"14px"},children:"Select a file to view diff"});const{original:t,modified:i}=xN(e.diff);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{style:{padding:"8px 16px",borderBottom:"1px solid #e5e5e5",backgroundColor:"#fff",fontSize:"13px",fontFamily:"monospace"},children:[e.path,e.isStaged&&a.jsx("span",{style:{marginLeft:"8px",padding:"2px 6px",backgroundColor:"#dcfce7",color:"#166534",borderRadius:"4px",fontSize:"11px"},children:"staged"})]}),a.jsx("div",{style:{flex:1},children:a.jsx(D2,{original:t,modified:i,language:SN(e.path),theme:"vs-dark",options:{readOnly:!0,renderSideBySide:!0,minimap:{enabled:!1},fontSize:13,lineNumbers:"on",scrollBeyondLastLine:!1}})})]})}function z2({providers:e,models:t,selectedProvider:i,selectedModel:r,onProviderChange:l,onModelChange:c}){const u=i?t.filter(d=>d.provider===i):t;return a.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center"},children:[a.jsxs("select",{value:i,onChange:d=>{l(d.target.value);const m=t.filter(f=>f.provider===d.target.value);m.length>0&&c(m[0].model)},style:{padding:"6px 10px",fontSize:"12px",border:"1px solid #d1d5db",borderRadius:"4px",backgroundColor:"#fff",minWidth:"120px"},children:[a.jsx("option",{value:"",children:"Select Provider"}),e.map(d=>a.jsx("option",{value:d.name,children:d.name},d.name))]}),a.jsxs("select",{value:r,onChange:d=>c(d.target.value),style:{padding:"6px 10px",fontSize:"12px",border:"1px solid #d1d5db",borderRadius:"4px",backgroundColor:"#fff",minWidth:"150px"},disabled:!i,children:[a.jsx("option",{value:"",children:"Select Model"}),u.map(d=>a.jsx("option",{value:d.model,children:d.displayName||d.model},`${d.provider}-${d.model}`))]})]})}function P2(e,t){const i={};return(e[e.length-1]===""?[...e,""]:e).join((i.padRight?" ":"")+","+(i.padLeft===!1?"":" ")).trim()}const H2=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,I2=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,U2={};function ix(e,t){return(U2.jsx?I2:H2).test(e)}const F2=/[ \t\n\f\r]/g;function $2(e){return typeof e=="object"?e.type==="text"?sx(e.value):!1:sx(e)}function sx(e){return e.replace(F2,"")===""}class ho{constructor(t,i,r){this.normal=i,this.property=t,r&&(this.space=r)}}ho.prototype.normal={};ho.prototype.property={};ho.prototype.space=void 0;function l0(e,t){const i={},r={};for(const l of e)Object.assign(i,l.property),Object.assign(r,l.normal);return new ho(i,r,t)}function Kf(e){return e.toLowerCase()}class Sn{constructor(t,i){this.attribute=i,this.property=t}}Sn.prototype.attribute="";Sn.prototype.booleanish=!1;Sn.prototype.boolean=!1;Sn.prototype.commaOrSpaceSeparated=!1;Sn.prototype.commaSeparated=!1;Sn.prototype.defined=!1;Sn.prototype.mustUseProperty=!1;Sn.prototype.number=!1;Sn.prototype.overloadedBoolean=!1;Sn.prototype.property="";Sn.prototype.spaceSeparated=!1;Sn.prototype.space=void 0;let K2=0;const Le=_r(),Et=_r(),qf=_r(),fe=_r(),it=_r(),_a=_r(),Ln=_r();function _r(){return 2**++K2}const Wf=Object.freeze(Object.defineProperty({__proto__:null,boolean:Le,booleanish:Et,commaOrSpaceSeparated:Ln,commaSeparated:_a,number:fe,overloadedBoolean:qf,spaceSeparated:it},Symbol.toStringTag,{value:"Module"})),rf=Object.keys(Wf);class Qm extends Sn{constructor(t,i,r,l){let c=-1;if(super(t,i),rx(this,"space",l),typeof r=="number")for(;++c<rf.length;){const u=rf[c];rx(this,rf[c],(r&Wf[u])===Wf[u])}}}Qm.prototype.defined=!0;function rx(e,t,i){i&&(e[t]=i)}function Ea(e){const t={},i={};for(const[r,l]of Object.entries(e.properties)){const c=new Qm(r,e.transform(e.attributes||{},r),l,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(c.mustUseProperty=!0),t[r]=c,i[Kf(r)]=r,i[Kf(c.attribute)]=r}return new ho(t,i,e.space)}const o0=Ea({properties:{ariaActiveDescendant:null,ariaAtomic:Et,ariaAutoComplete:null,ariaBusy:Et,ariaChecked:Et,ariaColCount:fe,ariaColIndex:fe,ariaColSpan:fe,ariaControls:it,ariaCurrent:null,ariaDescribedBy:it,ariaDetails:null,ariaDisabled:Et,ariaDropEffect:it,ariaErrorMessage:null,ariaExpanded:Et,ariaFlowTo:it,ariaGrabbed:Et,ariaHasPopup:null,ariaHidden:Et,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:it,ariaLevel:fe,ariaLive:null,ariaModal:Et,ariaMultiLine:Et,ariaMultiSelectable:Et,ariaOrientation:null,ariaOwns:it,ariaPlaceholder:null,ariaPosInSet:fe,ariaPressed:Et,ariaReadOnly:Et,ariaRelevant:null,ariaRequired:Et,ariaRoleDescription:it,ariaRowCount:fe,ariaRowIndex:fe,ariaRowSpan:fe,ariaSelected:Et,ariaSetSize:fe,ariaSort:null,ariaValueMax:fe,ariaValueMin:fe,ariaValueNow:fe,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function c0(e,t){return t in e?e[t]:t}function u0(e,t){return c0(e,t.toLowerCase())}const q2=Ea({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:_a,acceptCharset:it,accessKey:it,action:null,allow:null,allowFullScreen:Le,allowPaymentRequest:Le,allowUserMedia:Le,alt:null,as:null,async:Le,autoCapitalize:null,autoComplete:it,autoFocus:Le,autoPlay:Le,blocking:it,capture:null,charSet:null,checked:Le,cite:null,className:it,cols:fe,colSpan:null,content:null,contentEditable:Et,controls:Le,controlsList:it,coords:fe|_a,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Le,defer:Le,dir:null,dirName:null,disabled:Le,download:qf,draggable:Et,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Le,formTarget:null,headers:it,height:fe,hidden:qf,high:fe,href:null,hrefLang:null,htmlFor:it,httpEquiv:it,id:null,imageSizes:null,imageSrcSet:null,inert:Le,inputMode:null,integrity:null,is:null,isMap:Le,itemId:null,itemProp:it,itemRef:it,itemScope:Le,itemType:it,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Le,low:fe,manifest:null,max:null,maxLength:fe,media:null,method:null,min:null,minLength:fe,multiple:Le,muted:Le,name:null,nonce:null,noModule:Le,noValidate:Le,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Le,optimum:fe,pattern:null,ping:it,placeholder:null,playsInline:Le,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Le,referrerPolicy:null,rel:it,required:Le,reversed:Le,rows:fe,rowSpan:fe,sandbox:it,scope:null,scoped:Le,seamless:Le,selected:Le,shadowRootClonable:Le,shadowRootDelegatesFocus:Le,shadowRootMode:null,shape:null,size:fe,sizes:null,slot:null,span:fe,spellCheck:Et,src:null,srcDoc:null,srcLang:null,srcSet:null,start:fe,step:null,style:null,tabIndex:fe,target:null,title:null,translate:null,type:null,typeMustMatch:Le,useMap:null,value:Et,width:fe,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:it,axis:null,background:null,bgColor:null,border:fe,borderColor:null,bottomMargin:fe,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Le,declare:Le,event:null,face:null,frame:null,frameBorder:null,hSpace:fe,leftMargin:fe,link:null,longDesc:null,lowSrc:null,marginHeight:fe,marginWidth:fe,noResize:Le,noHref:Le,noShade:Le,noWrap:Le,object:null,profile:null,prompt:null,rev:null,rightMargin:fe,rules:null,scheme:null,scrolling:Et,standby:null,summary:null,text:null,topMargin:fe,valueType:null,version:null,vAlign:null,vLink:null,vSpace:fe,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Le,disableRemotePlayback:Le,prefix:null,property:null,results:fe,security:null,unselectable:null},space:"html",transform:u0}),W2=Ea({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ln,accentHeight:fe,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:fe,amplitude:fe,arabicForm:null,ascent:fe,attributeName:null,attributeType:null,azimuth:fe,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:fe,by:null,calcMode:null,capHeight:fe,className:it,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:fe,diffuseConstant:fe,direction:null,display:null,dur:null,divisor:fe,dominantBaseline:null,download:Le,dx:null,dy:null,edgeMode:null,editable:null,elevation:fe,enableBackground:null,end:null,event:null,exponent:fe,externalResourcesRequired:null,fill:null,fillOpacity:fe,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:_a,g2:_a,glyphName:_a,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:fe,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:fe,horizOriginX:fe,horizOriginY:fe,id:null,ideographic:fe,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:fe,k:fe,k1:fe,k2:fe,k3:fe,k4:fe,kernelMatrix:Ln,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:fe,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:fe,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:fe,overlineThickness:fe,paintOrder:null,panose1:null,path:null,pathLength:fe,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:it,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:fe,pointsAtY:fe,pointsAtZ:fe,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ln,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ln,rev:Ln,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ln,requiredFeatures:Ln,requiredFonts:Ln,requiredFormats:Ln,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:fe,specularExponent:fe,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:fe,strikethroughThickness:fe,string:null,stroke:null,strokeDashArray:Ln,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:fe,strokeOpacity:fe,strokeWidth:null,style:null,surfaceScale:fe,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ln,tabIndex:fe,tableValues:null,target:null,targetX:fe,targetY:fe,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ln,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:fe,underlineThickness:fe,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:fe,values:null,vAlphabetic:fe,vMathematical:fe,vectorEffect:null,vHanging:fe,vIdeographic:fe,version:null,vertAdvY:fe,vertOriginX:fe,vertOriginY:fe,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:fe,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:c0}),h0=Ea({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),d0=Ea({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:u0}),f0=Ea({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),V2={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},G2=/[A-Z]/g,ax=/-[a-z]/g,Y2=/^data[-\w.:]+$/i;function X2(e,t){const i=Kf(t);let r=t,l=Sn;if(i in e.normal)return e.property[e.normal[i]];if(i.length>4&&i.slice(0,4)==="data"&&Y2.test(t)){if(t.charAt(4)==="-"){const c=t.slice(5).replace(ax,Z2);r="data"+c.charAt(0).toUpperCase()+c.slice(1)}else{const c=t.slice(4);if(!ax.test(c)){let u=c.replace(G2,J2);u.charAt(0)!=="-"&&(u="-"+u),t="data"+u}}l=Qm}return new l(r,t)}function J2(e){return"-"+e.toLowerCase()}function Z2(e){return e.charAt(1).toUpperCase()}const Q2=l0([o0,q2,h0,d0,f0],"html"),ep=l0([o0,W2,h0,d0,f0],"svg");function eE(e){return e.join(" ").trim()}var oa={},af,lx;function tE(){if(lx)return af;lx=1;var e=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,t=/\n/g,i=/^\s*/,r=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,l=/^:\s*/,c=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,u=/^[;\s]*/,d=/^\s+|\s+$/g,m=`
`,f="/",v="*",_="",S="comment",x="declaration";function b(T,k){if(typeof T!="string")throw new TypeError("First argument must be a string");if(!T)return[];k=k||{};var R=1,N=1;function E(j){var A=j.match(t);A&&(R+=A.length);var D=j.lastIndexOf(m);N=~D?j.length-D:N+j.length}function z(){var j={line:R,column:N};return function(A){return A.position=new B(j),F(),A}}function B(j){this.start=j,this.end={line:R,column:N},this.source=k.source}B.prototype.content=T;function I(j){var A=new Error(k.source+":"+R+":"+N+": "+j);if(A.reason=j,A.filename=k.source,A.line=R,A.column=N,A.source=T,!k.silent)throw A}function q(j){var A=j.exec(T);if(A){var D=A[0];return E(D),T=T.slice(D.length),A}}function F(){q(i)}function V(j){var A;for(j=j||[];A=G();)A!==!1&&j.push(A);return j}function G(){var j=z();if(!(f!=T.charAt(0)||v!=T.charAt(1))){for(var A=2;_!=T.charAt(A)&&(v!=T.charAt(A)||f!=T.charAt(A+1));)++A;if(A+=2,_===T.charAt(A-1))return I("End of comment missing");var D=T.slice(2,A-2);return N+=2,E(D),T=T.slice(A),N+=2,j({type:S,comment:D})}}function Y(){var j=z(),A=q(r);if(A){if(G(),!q(l))return I("property missing ':'");var D=q(c),$=j({type:x,property:C(A[0].replace(e,_)),value:D?C(D[0].replace(e,_)):_});return q(u),$}}function M(){var j=[];V(j);for(var A;A=Y();)A!==!1&&(j.push(A),V(j));return j}return F(),M()}function C(T){return T?T.replace(d,_):_}return af=b,af}var ox;function nE(){if(ox)return oa;ox=1;var e=oa&&oa.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(oa,"__esModule",{value:!0}),oa.default=i;const t=e(tE());function i(r,l){let c=null;if(!r||typeof r!="string")return c;const u=(0,t.default)(r),d=typeof l=="function";return u.forEach(m=>{if(m.type!=="declaration")return;const{property:f,value:v}=m;d?l(f,v,m):v&&(c=c||{},c[f]=v)}),c}return oa}var Rl={},cx;function iE(){if(cx)return Rl;cx=1,Object.defineProperty(Rl,"__esModule",{value:!0}),Rl.camelCase=void 0;var e=/^--[a-zA-Z0-9_-]+$/,t=/-([a-z])/g,i=/^[^-]+$/,r=/^-(webkit|moz|ms|o|khtml)-/,l=/^-(ms)-/,c=function(f){return!f||i.test(f)||e.test(f)},u=function(f,v){return v.toUpperCase()},d=function(f,v){return"".concat(v,"-")},m=function(f,v){return v===void 0&&(v={}),c(f)?f:(f=f.toLowerCase(),v.reactCompat?f=f.replace(l,d):f=f.replace(r,d),f.replace(t,u))};return Rl.camelCase=m,Rl}var Dl,ux;function sE(){if(ux)return Dl;ux=1;var e=Dl&&Dl.__importDefault||function(l){return l&&l.__esModule?l:{default:l}},t=e(nE()),i=iE();function r(l,c){var u={};return!l||typeof l!="string"||(0,t.default)(l,function(d,m){d&&m&&(u[(0,i.camelCase)(d,c)]=m)}),u}return r.default=r,Dl=r,Dl}var rE=sE();const aE=Km(rE),m0=p0("end"),tp=p0("start");function p0(e){return t;function t(i){const r=i&&i.position&&i.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function lE(e){const t=tp(e),i=m0(e);if(t&&i)return{start:t,end:i}}function Yl(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?hx(e.position):"start"in e||"end"in e?hx(e):"line"in e||"column"in e?Vf(e):""}function Vf(e){return dx(e&&e.line)+":"+dx(e&&e.column)}function hx(e){return Vf(e&&e.start)+"-"+Vf(e&&e.end)}function dx(e){return e&&typeof e=="number"?e:1}class en extends Error{constructor(t,i,r){super(),typeof i=="string"&&(r=i,i=void 0);let l="",c={},u=!1;if(i&&("line"in i&&"column"in i?c={place:i}:"start"in i&&"end"in i?c={place:i}:"type"in i?c={ancestors:[i],place:i.position}:c={...i}),typeof t=="string"?l=t:!c.cause&&t&&(u=!0,l=t.message,c.cause=t),!c.ruleId&&!c.source&&typeof r=="string"){const m=r.indexOf(":");m===-1?c.ruleId=r:(c.source=r.slice(0,m),c.ruleId=r.slice(m+1))}if(!c.place&&c.ancestors&&c.ancestors){const m=c.ancestors[c.ancestors.length-1];m&&(c.place=m.position)}const d=c.place&&"start"in c.place?c.place.start:c.place;this.ancestors=c.ancestors||void 0,this.cause=c.cause||void 0,this.column=d?d.column:void 0,this.fatal=void 0,this.file="",this.message=l,this.line=d?d.line:void 0,this.name=Yl(c.place)||"1:1",this.place=c.place||void 0,this.reason=this.message,this.ruleId=c.ruleId||void 0,this.source=c.source||void 0,this.stack=u&&c.cause&&typeof c.cause.stack=="string"?c.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}en.prototype.file="";en.prototype.name="";en.prototype.reason="";en.prototype.message="";en.prototype.stack="";en.prototype.column=void 0;en.prototype.line=void 0;en.prototype.ancestors=void 0;en.prototype.cause=void 0;en.prototype.fatal=void 0;en.prototype.place=void 0;en.prototype.ruleId=void 0;en.prototype.source=void 0;const np={}.hasOwnProperty,oE=new Map,cE=/[A-Z]/g,uE=new Set(["table","tbody","thead","tfoot","tr"]),hE=new Set(["td","th"]),g0="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function dE(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const i=t.filePath||void 0;let r;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=xE(i,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=yE(i,t.jsx,t.jsxs)}const l={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:i,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?ep:Q2,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},c=v0(l,e,void 0);return c&&typeof c!="string"?c:l.create(e,l.Fragment,{children:c||void 0},void 0)}function v0(e,t,i){if(t.type==="element")return fE(e,t,i);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return mE(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return gE(e,t,i);if(t.type==="mdxjsEsm")return pE(e,t);if(t.type==="root")return vE(e,t,i);if(t.type==="text")return _E(e,t)}function fE(e,t,i){const r=e.schema;let l=r;t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(l=ep,e.schema=l),e.ancestors.push(t);const c=y0(e,t.tagName,!1),u=SE(e,t);let d=sp(e,t);return uE.has(t.tagName)&&(d=d.filter(function(m){return typeof m=="string"?!$2(m):!0})),_0(e,u,c,t),ip(u,d),e.ancestors.pop(),e.schema=r,e.create(t,c,u,i)}function mE(e,t){if(t.data&&t.data.estree&&e.evaluater){const r=t.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}to(e,t.position)}function pE(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);to(e,t.position)}function gE(e,t,i){const r=e.schema;let l=r;t.name==="svg"&&r.space==="html"&&(l=ep,e.schema=l),e.ancestors.push(t);const c=t.name===null?e.Fragment:y0(e,t.name,!0),u=bE(e,t),d=sp(e,t);return _0(e,u,c,t),ip(u,d),e.ancestors.pop(),e.schema=r,e.create(t,c,u,i)}function vE(e,t,i){const r={};return ip(r,sp(e,t)),e.create(t,e.Fragment,r,i)}function _E(e,t){return t.value}function _0(e,t,i,r){typeof i!="string"&&i!==e.Fragment&&e.passNode&&(t.node=r)}function ip(e,t){if(t.length>0){const i=t.length>1?t:t[0];i&&(e.children=i)}}function yE(e,t,i){return r;function r(l,c,u,d){const f=Array.isArray(u.children)?i:t;return d?f(c,u,d):f(c,u)}}function xE(e,t){return i;function i(r,l,c,u){const d=Array.isArray(c.children),m=tp(r);return t(l,c,u,d,{columnNumber:m?m.column-1:void 0,fileName:e,lineNumber:m?m.line:void 0},void 0)}}function SE(e,t){const i={};let r,l;for(l in t.properties)if(l!=="children"&&np.call(t.properties,l)){const c=wE(e,l,t.properties[l]);if(c){const[u,d]=c;e.tableCellAlignToStyle&&u==="align"&&typeof d=="string"&&hE.has(t.tagName)?r=d:i[u]=d}}if(r){const c=i.style||(i.style={});c[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return i}function bE(e,t){const i={};for(const r of t.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const c=r.data.estree.body[0];c.type;const u=c.expression;u.type;const d=u.properties[0];d.type,Object.assign(i,e.evaluater.evaluateExpression(d.argument))}else to(e,t.position);else{const l=r.name;let c;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const d=r.value.data.estree.body[0];d.type,c=e.evaluater.evaluateExpression(d.expression)}else to(e,t.position);else c=r.value===null?!0:r.value;i[l]=c}return i}function sp(e,t){const i=[];let r=-1;const l=e.passKeys?new Map:oE;for(;++r<t.children.length;){const c=t.children[r];let u;if(e.passKeys){const m=c.type==="element"?c.tagName:c.type==="mdxJsxFlowElement"||c.type==="mdxJsxTextElement"?c.name:void 0;if(m){const f=l.get(m)||0;u=m+"-"+f,l.set(m,f+1)}}const d=v0(e,c,u);d!==void 0&&i.push(d)}return i}function wE(e,t,i){const r=X2(e.schema,t);if(!(i==null||typeof i=="number"&&Number.isNaN(i))){if(Array.isArray(i)&&(i=r.commaSeparated?P2(i):eE(i)),r.property==="style"){let l=typeof i=="object"?i:CE(e,String(i));return e.stylePropertyNameCase==="css"&&(l=jE(l)),["style",l]}return[e.elementAttributeNameCase==="react"&&r.space?V2[r.property]||r.property:r.attribute,i]}}function CE(e,t){try{return aE(t,{reactCompat:!0})}catch(i){if(e.ignoreInvalidStyle)return{};const r=i,l=new en("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw l.file=e.filePath||void 0,l.url=g0+"#cannot-parse-style-attribute",l}}function y0(e,t,i){let r;if(!i)r={type:"Literal",value:t};else if(t.includes(".")){const l=t.split(".");let c=-1,u;for(;++c<l.length;){const d=ix(l[c])?{type:"Identifier",name:l[c]}:{type:"Literal",value:l[c]};u=u?{type:"MemberExpression",object:u,property:d,computed:!!(c&&d.type==="Literal"),optional:!1}:d}r=u}else r=ix(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(r.type==="Literal"){const l=r.value;return np.call(e.components,l)?e.components[l]:l}if(e.evaluater)return e.evaluater.evaluateExpression(r);to(e)}function to(e,t){const i=new en("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw i.file=e.filePath||void 0,i.url=g0+"#cannot-handle-mdx-estrees-without-createevaluater",i}function jE(e){const t={};let i;for(i in e)np.call(e,i)&&(t[kE(i)]=e[i]);return t}function kE(e){let t=e.replace(cE,NE);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function NE(e){return"-"+e.toLowerCase()}const lf={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},EE={};function TE(e,t){const i=EE,r=typeof i.includeImageAlt=="boolean"?i.includeImageAlt:!0,l=typeof i.includeHtml=="boolean"?i.includeHtml:!0;return x0(e,r,l)}function x0(e,t,i){if(RE(e)){if("value"in e)return e.type==="html"&&!i?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return fx(e.children,t,i)}return Array.isArray(e)?fx(e,t,i):""}function fx(e,t,i){const r=[];let l=-1;for(;++l<e.length;)r[l]=x0(e[l],t,i);return r.join("")}function RE(e){return!!(e&&typeof e=="object")}const mx=document.createElement("i");function rp(e){const t="&"+e+";";mx.innerHTML=t;const i=mx.textContent;return i.charCodeAt(i.length-1)===59&&e!=="semi"||i===t?!1:i}function Ei(e,t,i,r){const l=e.length;let c=0,u;if(t<0?t=-t>l?0:l+t:t=t>l?l:t,i=i>0?i:0,r.length<1e4)u=Array.from(r),u.unshift(t,i),e.splice(...u);else for(i&&e.splice(t,i);c<r.length;)u=r.slice(c,c+1e4),u.unshift(t,0),e.splice(...u),c+=1e4,t+=1e4}function ei(e,t){return e.length>0?(Ei(e,e.length,0,t),e):t}const px={}.hasOwnProperty;function DE(e){const t={};let i=-1;for(;++i<e.length;)AE(t,e[i]);return t}function AE(e,t){let i;for(i in t){const l=(px.call(e,i)?e[i]:void 0)||(e[i]={}),c=t[i];let u;if(c)for(u in c){px.call(l,u)||(l[u]=[]);const d=c[u];LE(l[u],Array.isArray(d)?d:d?[d]:[])}}}function LE(e,t){let i=-1;const r=[];for(;++i<t.length;)(t[i].add==="after"?e:r).push(t[i]);Ei(e,0,0,r)}function S0(e,t){const i=Number.parseInt(e,t);return i<9||i===11||i>13&&i<32||i>126&&i<160||i>55295&&i<57344||i>64975&&i<65008||(i&65535)===65535||(i&65535)===65534||i>1114111?"":String.fromCodePoint(i)}function ya(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Ci=Ps(/[A-Za-z]/),zn=Ps(/[\dA-Za-z]/),ME=Ps(/[#-'*+\--9=?A-Z^-~]/);function Gf(e){return e!==null&&(e<32||e===127)}const Yf=Ps(/\d/),BE=Ps(/[\dA-Fa-f]/),OE=Ps(/[!-/:-@[-`{-~]/);function Ee(e){return e!==null&&e<-2}function xn(e){return e!==null&&(e<0||e===32)}function We(e){return e===-2||e===-1||e===32}const zE=Ps(new RegExp("\\p{P}|\\p{S}","u")),PE=Ps(/\s/);function Ps(e){return t;function t(i){return i!==null&&i>-1&&e.test(String.fromCharCode(i))}}function Ta(e){const t=[];let i=-1,r=0,l=0;for(;++i<e.length;){const c=e.charCodeAt(i);let u="";if(c===37&&zn(e.charCodeAt(i+1))&&zn(e.charCodeAt(i+2)))l=2;else if(c<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(c))||(u=String.fromCharCode(c));else if(c>55295&&c<57344){const d=e.charCodeAt(i+1);c<56320&&d>56319&&d<57344?(u=String.fromCharCode(c,d),l=1):u=""}else u=String.fromCharCode(c);u&&(t.push(e.slice(r,i),encodeURIComponent(u)),r=i+l+1,u=""),l&&(i+=l,l=0)}return t.join("")+e.slice(r)}function st(e,t,i,r){const l=r?r-1:Number.POSITIVE_INFINITY;let c=0;return u;function u(m){return We(m)?(e.enter(i),d(m)):t(m)}function d(m){return We(m)&&c++<l?(e.consume(m),d):(e.exit(i),t(m))}}const HE={tokenize:IE};function IE(e){const t=e.attempt(this.parser.constructs.contentInitial,r,l);let i;return t;function r(d){if(d===null){e.consume(d);return}return e.enter("lineEnding"),e.consume(d),e.exit("lineEnding"),st(e,t,"linePrefix")}function l(d){return e.enter("paragraph"),c(d)}function c(d){const m=e.enter("chunkText",{contentType:"text",previous:i});return i&&(i.next=m),i=m,u(d)}function u(d){if(d===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(d);return}return Ee(d)?(e.consume(d),e.exit("chunkText"),c):(e.consume(d),u)}}const UE={tokenize:FE},gx={tokenize:$E};function FE(e){const t=this,i=[];let r=0,l,c,u;return d;function d(N){if(r<i.length){const E=i[r];return t.containerState=E[1],e.attempt(E[0].continuation,m,f)(N)}return f(N)}function m(N){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,l&&R();const E=t.events.length;let z=E,B;for(;z--;)if(t.events[z][0]==="exit"&&t.events[z][1].type==="chunkFlow"){B=t.events[z][1].end;break}k(r);let I=E;for(;I<t.events.length;)t.events[I][1].end={...B},I++;return Ei(t.events,z+1,0,t.events.slice(E)),t.events.length=I,f(N)}return d(N)}function f(N){if(r===i.length){if(!l)return S(N);if(l.currentConstruct&&l.currentConstruct.concrete)return b(N);t.interrupt=!!(l.currentConstruct&&!l._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(gx,v,_)(N)}function v(N){return l&&R(),k(r),S(N)}function _(N){return t.parser.lazy[t.now().line]=r!==i.length,u=t.now().offset,b(N)}function S(N){return t.containerState={},e.attempt(gx,x,b)(N)}function x(N){return r++,i.push([t.currentConstruct,t.containerState]),S(N)}function b(N){if(N===null){l&&R(),k(0),e.consume(N);return}return l=l||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:l,contentType:"flow",previous:c}),C(N)}function C(N){if(N===null){T(e.exit("chunkFlow"),!0),k(0),e.consume(N);return}return Ee(N)?(e.consume(N),T(e.exit("chunkFlow")),r=0,t.interrupt=void 0,d):(e.consume(N),C)}function T(N,E){const z=t.sliceStream(N);if(E&&z.push(null),N.previous=c,c&&(c.next=N),c=N,l.defineSkip(N.start),l.write(z),t.parser.lazy[N.start.line]){let B=l.events.length;for(;B--;)if(l.events[B][1].start.offset<u&&(!l.events[B][1].end||l.events[B][1].end.offset>u))return;const I=t.events.length;let q=I,F,V;for(;q--;)if(t.events[q][0]==="exit"&&t.events[q][1].type==="chunkFlow"){if(F){V=t.events[q][1].end;break}F=!0}for(k(r),B=I;B<t.events.length;)t.events[B][1].end={...V},B++;Ei(t.events,q+1,0,t.events.slice(I)),t.events.length=B}}function k(N){let E=i.length;for(;E-- >N;){const z=i[E];t.containerState=z[1],z[0].exit.call(t,e)}i.length=N}function R(){l.write([null]),c=void 0,l=void 0,t.containerState._closeFlow=void 0}}function $E(e,t,i){return st(e,e.attempt(this.parser.constructs.document,t,i),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function vx(e){if(e===null||xn(e)||PE(e))return 1;if(zE(e))return 2}function ap(e,t,i){const r=[];let l=-1;for(;++l<e.length;){const c=e[l].resolveAll;c&&!r.includes(c)&&(t=c(t,i),r.push(c))}return t}const Xf={name:"attention",resolveAll:KE,tokenize:qE};function KE(e,t){let i=-1,r,l,c,u,d,m,f,v;for(;++i<e.length;)if(e[i][0]==="enter"&&e[i][1].type==="attentionSequence"&&e[i][1]._close){for(r=i;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[i][1]).charCodeAt(0)){if((e[r][1]._close||e[i][1]._open)&&(e[i][1].end.offset-e[i][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[i][1].end.offset-e[i][1].start.offset)%3))continue;m=e[r][1].end.offset-e[r][1].start.offset>1&&e[i][1].end.offset-e[i][1].start.offset>1?2:1;const _={...e[r][1].end},S={...e[i][1].start};_x(_,-m),_x(S,m),u={type:m>1?"strongSequence":"emphasisSequence",start:_,end:{...e[r][1].end}},d={type:m>1?"strongSequence":"emphasisSequence",start:{...e[i][1].start},end:S},c={type:m>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[i][1].start}},l={type:m>1?"strong":"emphasis",start:{...u.start},end:{...d.end}},e[r][1].end={...u.start},e[i][1].start={...d.end},f=[],e[r][1].end.offset-e[r][1].start.offset&&(f=ei(f,[["enter",e[r][1],t],["exit",e[r][1],t]])),f=ei(f,[["enter",l,t],["enter",u,t],["exit",u,t],["enter",c,t]]),f=ei(f,ap(t.parser.constructs.insideSpan.null,e.slice(r+1,i),t)),f=ei(f,[["exit",c,t],["enter",d,t],["exit",d,t],["exit",l,t]]),e[i][1].end.offset-e[i][1].start.offset?(v=2,f=ei(f,[["enter",e[i][1],t],["exit",e[i][1],t]])):v=0,Ei(e,r-1,i-r+3,f),i=r+f.length-v-2;break}}for(i=-1;++i<e.length;)e[i][1].type==="attentionSequence"&&(e[i][1].type="data");return e}function qE(e,t){const i=this.parser.constructs.attentionMarkers.null,r=this.previous,l=vx(r);let c;return u;function u(m){return c=m,e.enter("attentionSequence"),d(m)}function d(m){if(m===c)return e.consume(m),d;const f=e.exit("attentionSequence"),v=vx(m),_=!v||v===2&&l||i.includes(m),S=!l||l===2&&v||i.includes(r);return f._open=!!(c===42?_:_&&(l||!S)),f._close=!!(c===42?S:S&&(v||!_)),t(m)}}function _x(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const WE={name:"autolink",tokenize:VE};function VE(e,t,i){let r=0;return l;function l(x){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(x),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),c}function c(x){return Ci(x)?(e.consume(x),u):x===64?i(x):f(x)}function u(x){return x===43||x===45||x===46||zn(x)?(r=1,d(x)):f(x)}function d(x){return x===58?(e.consume(x),r=0,m):(x===43||x===45||x===46||zn(x))&&r++<32?(e.consume(x),d):(r=0,f(x))}function m(x){return x===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(x),e.exit("autolinkMarker"),e.exit("autolink"),t):x===null||x===32||x===60||Gf(x)?i(x):(e.consume(x),m)}function f(x){return x===64?(e.consume(x),v):ME(x)?(e.consume(x),f):i(x)}function v(x){return zn(x)?_(x):i(x)}function _(x){return x===46?(e.consume(x),r=0,v):x===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(x),e.exit("autolinkMarker"),e.exit("autolink"),t):S(x)}function S(x){if((x===45||zn(x))&&r++<63){const b=x===45?S:_;return e.consume(x),b}return i(x)}}const ju={partial:!0,tokenize:GE};function GE(e,t,i){return r;function r(c){return We(c)?st(e,l,"linePrefix")(c):l(c)}function l(c){return c===null||Ee(c)?t(c):i(c)}}const b0={continuation:{tokenize:XE},exit:JE,name:"blockQuote",tokenize:YE};function YE(e,t,i){const r=this;return l;function l(u){if(u===62){const d=r.containerState;return d.open||(e.enter("blockQuote",{_container:!0}),d.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(u),e.exit("blockQuoteMarker"),c}return i(u)}function c(u){return We(u)?(e.enter("blockQuotePrefixWhitespace"),e.consume(u),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(u))}}function XE(e,t,i){const r=this;return l;function l(u){return We(u)?st(e,c,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(u):c(u)}function c(u){return e.attempt(b0,t,i)(u)}}function JE(e){e.exit("blockQuote")}const w0={name:"characterEscape",tokenize:ZE};function ZE(e,t,i){return r;function r(c){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(c),e.exit("escapeMarker"),l}function l(c){return OE(c)?(e.enter("characterEscapeValue"),e.consume(c),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):i(c)}}const C0={name:"characterReference",tokenize:QE};function QE(e,t,i){const r=this;let l=0,c,u;return d;function d(_){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(_),e.exit("characterReferenceMarker"),m}function m(_){return _===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(_),e.exit("characterReferenceMarkerNumeric"),f):(e.enter("characterReferenceValue"),c=31,u=zn,v(_))}function f(_){return _===88||_===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(_),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),c=6,u=BE,v):(e.enter("characterReferenceValue"),c=7,u=Yf,v(_))}function v(_){if(_===59&&l){const S=e.exit("characterReferenceValue");return u===zn&&!rp(r.sliceSerialize(S))?i(_):(e.enter("characterReferenceMarker"),e.consume(_),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return u(_)&&l++<c?(e.consume(_),v):i(_)}}const yx={partial:!0,tokenize:tT},xx={concrete:!0,name:"codeFenced",tokenize:eT};function eT(e,t,i){const r=this,l={partial:!0,tokenize:z};let c=0,u=0,d;return m;function m(B){return f(B)}function f(B){const I=r.events[r.events.length-1];return c=I&&I[1].type==="linePrefix"?I[2].sliceSerialize(I[1],!0).length:0,d=B,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),v(B)}function v(B){return B===d?(u++,e.consume(B),v):u<3?i(B):(e.exit("codeFencedFenceSequence"),We(B)?st(e,_,"whitespace")(B):_(B))}function _(B){return B===null||Ee(B)?(e.exit("codeFencedFence"),r.interrupt?t(B):e.check(yx,C,E)(B)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),S(B))}function S(B){return B===null||Ee(B)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),_(B)):We(B)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),st(e,x,"whitespace")(B)):B===96&&B===d?i(B):(e.consume(B),S)}function x(B){return B===null||Ee(B)?_(B):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),b(B))}function b(B){return B===null||Ee(B)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),_(B)):B===96&&B===d?i(B):(e.consume(B),b)}function C(B){return e.attempt(l,E,T)(B)}function T(B){return e.enter("lineEnding"),e.consume(B),e.exit("lineEnding"),k}function k(B){return c>0&&We(B)?st(e,R,"linePrefix",c+1)(B):R(B)}function R(B){return B===null||Ee(B)?e.check(yx,C,E)(B):(e.enter("codeFlowValue"),N(B))}function N(B){return B===null||Ee(B)?(e.exit("codeFlowValue"),R(B)):(e.consume(B),N)}function E(B){return e.exit("codeFenced"),t(B)}function z(B,I,q){let F=0;return V;function V(A){return B.enter("lineEnding"),B.consume(A),B.exit("lineEnding"),G}function G(A){return B.enter("codeFencedFence"),We(A)?st(B,Y,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):Y(A)}function Y(A){return A===d?(B.enter("codeFencedFenceSequence"),M(A)):q(A)}function M(A){return A===d?(F++,B.consume(A),M):F>=u?(B.exit("codeFencedFenceSequence"),We(A)?st(B,j,"whitespace")(A):j(A)):q(A)}function j(A){return A===null||Ee(A)?(B.exit("codeFencedFence"),I(A)):q(A)}}}function tT(e,t,i){const r=this;return l;function l(u){return u===null?i(u):(e.enter("lineEnding"),e.consume(u),e.exit("lineEnding"),c)}function c(u){return r.parser.lazy[r.now().line]?i(u):t(u)}}const of={name:"codeIndented",tokenize:iT},nT={partial:!0,tokenize:sT};function iT(e,t,i){const r=this;return l;function l(f){return e.enter("codeIndented"),st(e,c,"linePrefix",5)(f)}function c(f){const v=r.events[r.events.length-1];return v&&v[1].type==="linePrefix"&&v[2].sliceSerialize(v[1],!0).length>=4?u(f):i(f)}function u(f){return f===null?m(f):Ee(f)?e.attempt(nT,u,m)(f):(e.enter("codeFlowValue"),d(f))}function d(f){return f===null||Ee(f)?(e.exit("codeFlowValue"),u(f)):(e.consume(f),d)}function m(f){return e.exit("codeIndented"),t(f)}}function sT(e,t,i){const r=this;return l;function l(u){return r.parser.lazy[r.now().line]?i(u):Ee(u)?(e.enter("lineEnding"),e.consume(u),e.exit("lineEnding"),l):st(e,c,"linePrefix",5)(u)}function c(u){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?t(u):Ee(u)?l(u):i(u)}}const rT={name:"codeText",previous:lT,resolve:aT,tokenize:oT};function aT(e){let t=e.length-4,i=3,r,l;if((e[i][1].type==="lineEnding"||e[i][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=i;++r<t;)if(e[r][1].type==="codeTextData"){e[i][1].type="codeTextPadding",e[t][1].type="codeTextPadding",i+=2,t-=2;break}}for(r=i-1,t++;++r<=t;)l===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(l=r):(r===t||e[r][1].type==="lineEnding")&&(e[l][1].type="codeTextData",r!==l+2&&(e[l][1].end=e[r-1][1].end,e.splice(l+2,r-l-2),t-=r-l-2,r=l+2),l=void 0);return e}function lT(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function oT(e,t,i){let r=0,l,c;return u;function u(_){return e.enter("codeText"),e.enter("codeTextSequence"),d(_)}function d(_){return _===96?(e.consume(_),r++,d):(e.exit("codeTextSequence"),m(_))}function m(_){return _===null?i(_):_===32?(e.enter("space"),e.consume(_),e.exit("space"),m):_===96?(c=e.enter("codeTextSequence"),l=0,v(_)):Ee(_)?(e.enter("lineEnding"),e.consume(_),e.exit("lineEnding"),m):(e.enter("codeTextData"),f(_))}function f(_){return _===null||_===32||_===96||Ee(_)?(e.exit("codeTextData"),m(_)):(e.consume(_),f)}function v(_){return _===96?(e.consume(_),l++,v):l===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(_)):(c.type="codeTextData",f(_))}}class cT{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,i){const r=i??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,i,r){const l=i||0;this.setCursor(Math.trunc(t));const c=this.right.splice(this.right.length-l,Number.POSITIVE_INFINITY);return r&&Al(this.left,r),c.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),Al(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),Al(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const i=this.left.splice(t,Number.POSITIVE_INFINITY);Al(this.right,i.reverse())}else{const i=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);Al(this.left,i.reverse())}}}function Al(e,t){let i=0;if(t.length<1e4)e.push(...t);else for(;i<t.length;)e.push(...t.slice(i,i+1e4)),i+=1e4}function j0(e){const t={};let i=-1,r,l,c,u,d,m,f;const v=new cT(e);for(;++i<v.length;){for(;i in t;)i=t[i];if(r=v.get(i),i&&r[1].type==="chunkFlow"&&v.get(i-1)[1].type==="listItemPrefix"&&(m=r[1]._tokenizer.events,c=0,c<m.length&&m[c][1].type==="lineEndingBlank"&&(c+=2),c<m.length&&m[c][1].type==="content"))for(;++c<m.length&&m[c][1].type!=="content";)m[c][1].type==="chunkText"&&(m[c][1]._isInFirstContentOfListItem=!0,c++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,uT(v,i)),i=t[i],f=!0);else if(r[1]._container){for(c=i,l=void 0;c--;)if(u=v.get(c),u[1].type==="lineEnding"||u[1].type==="lineEndingBlank")u[0]==="enter"&&(l&&(v.get(l)[1].type="lineEndingBlank"),u[1].type="lineEnding",l=c);else if(!(u[1].type==="linePrefix"||u[1].type==="listItemIndent"))break;l&&(r[1].end={...v.get(l)[1].start},d=v.slice(l,i),d.unshift(r),v.splice(l,i-l+1,d))}}return Ei(e,0,Number.POSITIVE_INFINITY,v.slice(0)),!f}function uT(e,t){const i=e.get(t)[1],r=e.get(t)[2];let l=t-1;const c=[];let u=i._tokenizer;u||(u=r.parser[i.contentType](i.start),i._contentTypeTextTrailing&&(u._contentTypeTextTrailing=!0));const d=u.events,m=[],f={};let v,_,S=-1,x=i,b=0,C=0;const T=[C];for(;x;){for(;e.get(++l)[1]!==x;);c.push(l),x._tokenizer||(v=r.sliceStream(x),x.next||v.push(null),_&&u.defineSkip(x.start),x._isInFirstContentOfListItem&&(u._gfmTasklistFirstContentOfListItem=!0),u.write(v),x._isInFirstContentOfListItem&&(u._gfmTasklistFirstContentOfListItem=void 0)),_=x,x=x.next}for(x=i;++S<d.length;)d[S][0]==="exit"&&d[S-1][0]==="enter"&&d[S][1].type===d[S-1][1].type&&d[S][1].start.line!==d[S][1].end.line&&(C=S+1,T.push(C),x._tokenizer=void 0,x.previous=void 0,x=x.next);for(u.events=[],x?(x._tokenizer=void 0,x.previous=void 0):T.pop(),S=T.length;S--;){const k=d.slice(T[S],T[S+1]),R=c.pop();m.push([R,R+k.length-1]),e.splice(R,2,k)}for(m.reverse(),S=-1;++S<m.length;)f[b+m[S][0]]=b+m[S][1],b+=m[S][1]-m[S][0]-1;return f}const hT={resolve:fT,tokenize:mT},dT={partial:!0,tokenize:pT};function fT(e){return j0(e),e}function mT(e,t){let i;return r;function r(d){return e.enter("content"),i=e.enter("chunkContent",{contentType:"content"}),l(d)}function l(d){return d===null?c(d):Ee(d)?e.check(dT,u,c)(d):(e.consume(d),l)}function c(d){return e.exit("chunkContent"),e.exit("content"),t(d)}function u(d){return e.consume(d),e.exit("chunkContent"),i.next=e.enter("chunkContent",{contentType:"content",previous:i}),i=i.next,l}}function pT(e,t,i){const r=this;return l;function l(u){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(u),e.exit("lineEnding"),st(e,c,"linePrefix")}function c(u){if(u===null||Ee(u))return i(u);const d=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?t(u):e.interrupt(r.parser.constructs.flow,i,t)(u)}}function k0(e,t,i,r,l,c,u,d,m){const f=m||Number.POSITIVE_INFINITY;let v=0;return _;function _(k){return k===60?(e.enter(r),e.enter(l),e.enter(c),e.consume(k),e.exit(c),S):k===null||k===32||k===41||Gf(k)?i(k):(e.enter(r),e.enter(u),e.enter(d),e.enter("chunkString",{contentType:"string"}),C(k))}function S(k){return k===62?(e.enter(c),e.consume(k),e.exit(c),e.exit(l),e.exit(r),t):(e.enter(d),e.enter("chunkString",{contentType:"string"}),x(k))}function x(k){return k===62?(e.exit("chunkString"),e.exit(d),S(k)):k===null||k===60||Ee(k)?i(k):(e.consume(k),k===92?b:x)}function b(k){return k===60||k===62||k===92?(e.consume(k),x):x(k)}function C(k){return!v&&(k===null||k===41||xn(k))?(e.exit("chunkString"),e.exit(d),e.exit(u),e.exit(r),t(k)):v<f&&k===40?(e.consume(k),v++,C):k===41?(e.consume(k),v--,C):k===null||k===32||k===40||Gf(k)?i(k):(e.consume(k),k===92?T:C)}function T(k){return k===40||k===41||k===92?(e.consume(k),C):C(k)}}function N0(e,t,i,r,l,c){const u=this;let d=0,m;return f;function f(x){return e.enter(r),e.enter(l),e.consume(x),e.exit(l),e.enter(c),v}function v(x){return d>999||x===null||x===91||x===93&&!m||x===94&&!d&&"_hiddenFootnoteSupport"in u.parser.constructs?i(x):x===93?(e.exit(c),e.enter(l),e.consume(x),e.exit(l),e.exit(r),t):Ee(x)?(e.enter("lineEnding"),e.consume(x),e.exit("lineEnding"),v):(e.enter("chunkString",{contentType:"string"}),_(x))}function _(x){return x===null||x===91||x===93||Ee(x)||d++>999?(e.exit("chunkString"),v(x)):(e.consume(x),m||(m=!We(x)),x===92?S:_)}function S(x){return x===91||x===92||x===93?(e.consume(x),d++,_):_(x)}}function E0(e,t,i,r,l,c){let u;return d;function d(S){return S===34||S===39||S===40?(e.enter(r),e.enter(l),e.consume(S),e.exit(l),u=S===40?41:S,m):i(S)}function m(S){return S===u?(e.enter(l),e.consume(S),e.exit(l),e.exit(r),t):(e.enter(c),f(S))}function f(S){return S===u?(e.exit(c),m(u)):S===null?i(S):Ee(S)?(e.enter("lineEnding"),e.consume(S),e.exit("lineEnding"),st(e,f,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),v(S))}function v(S){return S===u||S===null||Ee(S)?(e.exit("chunkString"),f(S)):(e.consume(S),S===92?_:v)}function _(S){return S===u||S===92?(e.consume(S),v):v(S)}}function Xl(e,t){let i;return r;function r(l){return Ee(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),i=!0,r):We(l)?st(e,r,i?"linePrefix":"lineSuffix")(l):t(l)}}const gT={name:"definition",tokenize:_T},vT={partial:!0,tokenize:yT};function _T(e,t,i){const r=this;let l;return c;function c(x){return e.enter("definition"),u(x)}function u(x){return N0.call(r,e,d,i,"definitionLabel","definitionLabelMarker","definitionLabelString")(x)}function d(x){return l=ya(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),x===58?(e.enter("definitionMarker"),e.consume(x),e.exit("definitionMarker"),m):i(x)}function m(x){return xn(x)?Xl(e,f)(x):f(x)}function f(x){return k0(e,v,i,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(x)}function v(x){return e.attempt(vT,_,_)(x)}function _(x){return We(x)?st(e,S,"whitespace")(x):S(x)}function S(x){return x===null||Ee(x)?(e.exit("definition"),r.parser.defined.push(l),t(x)):i(x)}}function yT(e,t,i){return r;function r(d){return xn(d)?Xl(e,l)(d):i(d)}function l(d){return E0(e,c,i,"definitionTitle","definitionTitleMarker","definitionTitleString")(d)}function c(d){return We(d)?st(e,u,"whitespace")(d):u(d)}function u(d){return d===null||Ee(d)?t(d):i(d)}}const xT={name:"hardBreakEscape",tokenize:ST};function ST(e,t,i){return r;function r(c){return e.enter("hardBreakEscape"),e.consume(c),l}function l(c){return Ee(c)?(e.exit("hardBreakEscape"),t(c)):i(c)}}const bT={name:"headingAtx",resolve:wT,tokenize:CT};function wT(e,t){let i=e.length-2,r=3,l,c;return e[r][1].type==="whitespace"&&(r+=2),i-2>r&&e[i][1].type==="whitespace"&&(i-=2),e[i][1].type==="atxHeadingSequence"&&(r===i-1||i-4>r&&e[i-2][1].type==="whitespace")&&(i-=r+1===i?2:4),i>r&&(l={type:"atxHeadingText",start:e[r][1].start,end:e[i][1].end},c={type:"chunkText",start:e[r][1].start,end:e[i][1].end,contentType:"text"},Ei(e,r,i-r+1,[["enter",l,t],["enter",c,t],["exit",c,t],["exit",l,t]])),e}function CT(e,t,i){let r=0;return l;function l(v){return e.enter("atxHeading"),c(v)}function c(v){return e.enter("atxHeadingSequence"),u(v)}function u(v){return v===35&&r++<6?(e.consume(v),u):v===null||xn(v)?(e.exit("atxHeadingSequence"),d(v)):i(v)}function d(v){return v===35?(e.enter("atxHeadingSequence"),m(v)):v===null||Ee(v)?(e.exit("atxHeading"),t(v)):We(v)?st(e,d,"whitespace")(v):(e.enter("atxHeadingText"),f(v))}function m(v){return v===35?(e.consume(v),m):(e.exit("atxHeadingSequence"),d(v))}function f(v){return v===null||v===35||xn(v)?(e.exit("atxHeadingText"),d(v)):(e.consume(v),f)}}const jT=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Sx=["pre","script","style","textarea"],kT={concrete:!0,name:"htmlFlow",resolveTo:TT,tokenize:RT},NT={partial:!0,tokenize:AT},ET={partial:!0,tokenize:DT};function TT(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function RT(e,t,i){const r=this;let l,c,u,d,m;return f;function f(L){return v(L)}function v(L){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(L),_}function _(L){return L===33?(e.consume(L),S):L===47?(e.consume(L),c=!0,C):L===63?(e.consume(L),l=3,r.interrupt?t:U):Ci(L)?(e.consume(L),u=String.fromCharCode(L),T):i(L)}function S(L){return L===45?(e.consume(L),l=2,x):L===91?(e.consume(L),l=5,d=0,b):Ci(L)?(e.consume(L),l=4,r.interrupt?t:U):i(L)}function x(L){return L===45?(e.consume(L),r.interrupt?t:U):i(L)}function b(L){const re="CDATA[";return L===re.charCodeAt(d++)?(e.consume(L),d===re.length?r.interrupt?t:Y:b):i(L)}function C(L){return Ci(L)?(e.consume(L),u=String.fromCharCode(L),T):i(L)}function T(L){if(L===null||L===47||L===62||xn(L)){const re=L===47,me=u.toLowerCase();return!re&&!c&&Sx.includes(me)?(l=1,r.interrupt?t(L):Y(L)):jT.includes(u.toLowerCase())?(l=6,re?(e.consume(L),k):r.interrupt?t(L):Y(L)):(l=7,r.interrupt&&!r.parser.lazy[r.now().line]?i(L):c?R(L):N(L))}return L===45||zn(L)?(e.consume(L),u+=String.fromCharCode(L),T):i(L)}function k(L){return L===62?(e.consume(L),r.interrupt?t:Y):i(L)}function R(L){return We(L)?(e.consume(L),R):V(L)}function N(L){return L===47?(e.consume(L),V):L===58||L===95||Ci(L)?(e.consume(L),E):We(L)?(e.consume(L),N):V(L)}function E(L){return L===45||L===46||L===58||L===95||zn(L)?(e.consume(L),E):z(L)}function z(L){return L===61?(e.consume(L),B):We(L)?(e.consume(L),z):N(L)}function B(L){return L===null||L===60||L===61||L===62||L===96?i(L):L===34||L===39?(e.consume(L),m=L,I):We(L)?(e.consume(L),B):q(L)}function I(L){return L===m?(e.consume(L),m=null,F):L===null||Ee(L)?i(L):(e.consume(L),I)}function q(L){return L===null||L===34||L===39||L===47||L===60||L===61||L===62||L===96||xn(L)?z(L):(e.consume(L),q)}function F(L){return L===47||L===62||We(L)?N(L):i(L)}function V(L){return L===62?(e.consume(L),G):i(L)}function G(L){return L===null||Ee(L)?Y(L):We(L)?(e.consume(L),G):i(L)}function Y(L){return L===45&&l===2?(e.consume(L),D):L===60&&l===1?(e.consume(L),$):L===62&&l===4?(e.consume(L),P):L===63&&l===3?(e.consume(L),U):L===93&&l===5?(e.consume(L),ne):Ee(L)&&(l===6||l===7)?(e.exit("htmlFlowData"),e.check(NT,H,M)(L)):L===null||Ee(L)?(e.exit("htmlFlowData"),M(L)):(e.consume(L),Y)}function M(L){return e.check(ET,j,H)(L)}function j(L){return e.enter("lineEnding"),e.consume(L),e.exit("lineEnding"),A}function A(L){return L===null||Ee(L)?M(L):(e.enter("htmlFlowData"),Y(L))}function D(L){return L===45?(e.consume(L),U):Y(L)}function $(L){return L===47?(e.consume(L),u="",W):Y(L)}function W(L){if(L===62){const re=u.toLowerCase();return Sx.includes(re)?(e.consume(L),P):Y(L)}return Ci(L)&&u.length<8?(e.consume(L),u+=String.fromCharCode(L),W):Y(L)}function ne(L){return L===93?(e.consume(L),U):Y(L)}function U(L){return L===62?(e.consume(L),P):L===45&&l===2?(e.consume(L),U):Y(L)}function P(L){return L===null||Ee(L)?(e.exit("htmlFlowData"),H(L)):(e.consume(L),P)}function H(L){return e.exit("htmlFlow"),t(L)}}function DT(e,t,i){const r=this;return l;function l(u){return Ee(u)?(e.enter("lineEnding"),e.consume(u),e.exit("lineEnding"),c):i(u)}function c(u){return r.parser.lazy[r.now().line]?i(u):t(u)}}function AT(e,t,i){return r;function r(l){return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),e.attempt(ju,t,i)}}const LT={name:"htmlText",tokenize:MT};function MT(e,t,i){const r=this;let l,c,u;return d;function d(U){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(U),m}function m(U){return U===33?(e.consume(U),f):U===47?(e.consume(U),z):U===63?(e.consume(U),N):Ci(U)?(e.consume(U),q):i(U)}function f(U){return U===45?(e.consume(U),v):U===91?(e.consume(U),c=0,b):Ci(U)?(e.consume(U),R):i(U)}function v(U){return U===45?(e.consume(U),x):i(U)}function _(U){return U===null?i(U):U===45?(e.consume(U),S):Ee(U)?(u=_,$(U)):(e.consume(U),_)}function S(U){return U===45?(e.consume(U),x):_(U)}function x(U){return U===62?D(U):U===45?S(U):_(U)}function b(U){const P="CDATA[";return U===P.charCodeAt(c++)?(e.consume(U),c===P.length?C:b):i(U)}function C(U){return U===null?i(U):U===93?(e.consume(U),T):Ee(U)?(u=C,$(U)):(e.consume(U),C)}function T(U){return U===93?(e.consume(U),k):C(U)}function k(U){return U===62?D(U):U===93?(e.consume(U),k):C(U)}function R(U){return U===null||U===62?D(U):Ee(U)?(u=R,$(U)):(e.consume(U),R)}function N(U){return U===null?i(U):U===63?(e.consume(U),E):Ee(U)?(u=N,$(U)):(e.consume(U),N)}function E(U){return U===62?D(U):N(U)}function z(U){return Ci(U)?(e.consume(U),B):i(U)}function B(U){return U===45||zn(U)?(e.consume(U),B):I(U)}function I(U){return Ee(U)?(u=I,$(U)):We(U)?(e.consume(U),I):D(U)}function q(U){return U===45||zn(U)?(e.consume(U),q):U===47||U===62||xn(U)?F(U):i(U)}function F(U){return U===47?(e.consume(U),D):U===58||U===95||Ci(U)?(e.consume(U),V):Ee(U)?(u=F,$(U)):We(U)?(e.consume(U),F):D(U)}function V(U){return U===45||U===46||U===58||U===95||zn(U)?(e.consume(U),V):G(U)}function G(U){return U===61?(e.consume(U),Y):Ee(U)?(u=G,$(U)):We(U)?(e.consume(U),G):F(U)}function Y(U){return U===null||U===60||U===61||U===62||U===96?i(U):U===34||U===39?(e.consume(U),l=U,M):Ee(U)?(u=Y,$(U)):We(U)?(e.consume(U),Y):(e.consume(U),j)}function M(U){return U===l?(e.consume(U),l=void 0,A):U===null?i(U):Ee(U)?(u=M,$(U)):(e.consume(U),M)}function j(U){return U===null||U===34||U===39||U===60||U===61||U===96?i(U):U===47||U===62||xn(U)?F(U):(e.consume(U),j)}function A(U){return U===47||U===62||xn(U)?F(U):i(U)}function D(U){return U===62?(e.consume(U),e.exit("htmlTextData"),e.exit("htmlText"),t):i(U)}function $(U){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(U),e.exit("lineEnding"),W}function W(U){return We(U)?st(e,ne,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(U):ne(U)}function ne(U){return e.enter("htmlTextData"),u(U)}}const lp={name:"labelEnd",resolveAll:PT,resolveTo:HT,tokenize:IT},BT={tokenize:UT},OT={tokenize:FT},zT={tokenize:$T};function PT(e){let t=-1;const i=[];for(;++t<e.length;){const r=e[t][1];if(i.push(e[t]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const l=r.type==="labelImage"?4:2;r.type="data",t+=l}}return e.length!==i.length&&Ei(e,0,e.length,i),e}function HT(e,t){let i=e.length,r=0,l,c,u,d;for(;i--;)if(l=e[i][1],c){if(l.type==="link"||l.type==="labelLink"&&l._inactive)break;e[i][0]==="enter"&&l.type==="labelLink"&&(l._inactive=!0)}else if(u){if(e[i][0]==="enter"&&(l.type==="labelImage"||l.type==="labelLink")&&!l._balanced&&(c=i,l.type!=="labelLink")){r=2;break}}else l.type==="labelEnd"&&(u=i);const m={type:e[c][1].type==="labelLink"?"link":"image",start:{...e[c][1].start},end:{...e[e.length-1][1].end}},f={type:"label",start:{...e[c][1].start},end:{...e[u][1].end}},v={type:"labelText",start:{...e[c+r+2][1].end},end:{...e[u-2][1].start}};return d=[["enter",m,t],["enter",f,t]],d=ei(d,e.slice(c+1,c+r+3)),d=ei(d,[["enter",v,t]]),d=ei(d,ap(t.parser.constructs.insideSpan.null,e.slice(c+r+4,u-3),t)),d=ei(d,[["exit",v,t],e[u-2],e[u-1],["exit",f,t]]),d=ei(d,e.slice(u+1)),d=ei(d,[["exit",m,t]]),Ei(e,c,e.length,d),e}function IT(e,t,i){const r=this;let l=r.events.length,c,u;for(;l--;)if((r.events[l][1].type==="labelImage"||r.events[l][1].type==="labelLink")&&!r.events[l][1]._balanced){c=r.events[l][1];break}return d;function d(S){return c?c._inactive?_(S):(u=r.parser.defined.includes(ya(r.sliceSerialize({start:c.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(S),e.exit("labelMarker"),e.exit("labelEnd"),m):i(S)}function m(S){return S===40?e.attempt(BT,v,u?v:_)(S):S===91?e.attempt(OT,v,u?f:_)(S):u?v(S):_(S)}function f(S){return e.attempt(zT,v,_)(S)}function v(S){return t(S)}function _(S){return c._balanced=!0,i(S)}}function UT(e,t,i){return r;function r(_){return e.enter("resource"),e.enter("resourceMarker"),e.consume(_),e.exit("resourceMarker"),l}function l(_){return xn(_)?Xl(e,c)(_):c(_)}function c(_){return _===41?v(_):k0(e,u,d,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(_)}function u(_){return xn(_)?Xl(e,m)(_):v(_)}function d(_){return i(_)}function m(_){return _===34||_===39||_===40?E0(e,f,i,"resourceTitle","resourceTitleMarker","resourceTitleString")(_):v(_)}function f(_){return xn(_)?Xl(e,v)(_):v(_)}function v(_){return _===41?(e.enter("resourceMarker"),e.consume(_),e.exit("resourceMarker"),e.exit("resource"),t):i(_)}}function FT(e,t,i){const r=this;return l;function l(d){return N0.call(r,e,c,u,"reference","referenceMarker","referenceString")(d)}function c(d){return r.parser.defined.includes(ya(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(d):i(d)}function u(d){return i(d)}}function $T(e,t,i){return r;function r(c){return e.enter("reference"),e.enter("referenceMarker"),e.consume(c),e.exit("referenceMarker"),l}function l(c){return c===93?(e.enter("referenceMarker"),e.consume(c),e.exit("referenceMarker"),e.exit("reference"),t):i(c)}}const KT={name:"labelStartImage",resolveAll:lp.resolveAll,tokenize:qT};function qT(e,t,i){const r=this;return l;function l(d){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(d),e.exit("labelImageMarker"),c}function c(d){return d===91?(e.enter("labelMarker"),e.consume(d),e.exit("labelMarker"),e.exit("labelImage"),u):i(d)}function u(d){return d===94&&"_hiddenFootnoteSupport"in r.parser.constructs?i(d):t(d)}}const WT={name:"labelStartLink",resolveAll:lp.resolveAll,tokenize:VT};function VT(e,t,i){const r=this;return l;function l(u){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(u),e.exit("labelMarker"),e.exit("labelLink"),c}function c(u){return u===94&&"_hiddenFootnoteSupport"in r.parser.constructs?i(u):t(u)}}const cf={name:"lineEnding",tokenize:GT};function GT(e,t){return i;function i(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),st(e,t,"linePrefix")}}const Jc={name:"thematicBreak",tokenize:YT};function YT(e,t,i){let r=0,l;return c;function c(f){return e.enter("thematicBreak"),u(f)}function u(f){return l=f,d(f)}function d(f){return f===l?(e.enter("thematicBreakSequence"),m(f)):r>=3&&(f===null||Ee(f))?(e.exit("thematicBreak"),t(f)):i(f)}function m(f){return f===l?(e.consume(f),r++,m):(e.exit("thematicBreakSequence"),We(f)?st(e,d,"whitespace")(f):d(f))}}const yn={continuation:{tokenize:QT},exit:tR,name:"list",tokenize:ZT},XT={partial:!0,tokenize:nR},JT={partial:!0,tokenize:eR};function ZT(e,t,i){const r=this,l=r.events[r.events.length-1];let c=l&&l[1].type==="linePrefix"?l[2].sliceSerialize(l[1],!0).length:0,u=0;return d;function d(x){const b=r.containerState.type||(x===42||x===43||x===45?"listUnordered":"listOrdered");if(b==="listUnordered"?!r.containerState.marker||x===r.containerState.marker:Yf(x)){if(r.containerState.type||(r.containerState.type=b,e.enter(b,{_container:!0})),b==="listUnordered")return e.enter("listItemPrefix"),x===42||x===45?e.check(Jc,i,f)(x):f(x);if(!r.interrupt||x===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),m(x)}return i(x)}function m(x){return Yf(x)&&++u<10?(e.consume(x),m):(!r.interrupt||u<2)&&(r.containerState.marker?x===r.containerState.marker:x===41||x===46)?(e.exit("listItemValue"),f(x)):i(x)}function f(x){return e.enter("listItemMarker"),e.consume(x),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||x,e.check(ju,r.interrupt?i:v,e.attempt(XT,S,_))}function v(x){return r.containerState.initialBlankLine=!0,c++,S(x)}function _(x){return We(x)?(e.enter("listItemPrefixWhitespace"),e.consume(x),e.exit("listItemPrefixWhitespace"),S):i(x)}function S(x){return r.containerState.size=c+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(x)}}function QT(e,t,i){const r=this;return r.containerState._closeFlow=void 0,e.check(ju,l,c);function l(d){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,st(e,t,"listItemIndent",r.containerState.size+1)(d)}function c(d){return r.containerState.furtherBlankLines||!We(d)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,u(d)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(JT,t,u)(d))}function u(d){return r.containerState._closeFlow=!0,r.interrupt=void 0,st(e,e.attempt(yn,t,i),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(d)}}function eR(e,t,i){const r=this;return st(e,l,"listItemIndent",r.containerState.size+1);function l(c){const u=r.events[r.events.length-1];return u&&u[1].type==="listItemIndent"&&u[2].sliceSerialize(u[1],!0).length===r.containerState.size?t(c):i(c)}}function tR(e){e.exit(this.containerState.type)}function nR(e,t,i){const r=this;return st(e,l,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function l(c){const u=r.events[r.events.length-1];return!We(c)&&u&&u[1].type==="listItemPrefixWhitespace"?t(c):i(c)}}const bx={name:"setextUnderline",resolveTo:iR,tokenize:sR};function iR(e,t){let i=e.length,r,l,c;for(;i--;)if(e[i][0]==="enter"){if(e[i][1].type==="content"){r=i;break}e[i][1].type==="paragraph"&&(l=i)}else e[i][1].type==="content"&&e.splice(i,1),!c&&e[i][1].type==="definition"&&(c=i);const u={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[l][1].type="setextHeadingText",c?(e.splice(l,0,["enter",u,t]),e.splice(c+1,0,["exit",e[r][1],t]),e[r][1].end={...e[c][1].end}):e[r][1]=u,e.push(["exit",u,t]),e}function sR(e,t,i){const r=this;let l;return c;function c(f){let v=r.events.length,_;for(;v--;)if(r.events[v][1].type!=="lineEnding"&&r.events[v][1].type!=="linePrefix"&&r.events[v][1].type!=="content"){_=r.events[v][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||_)?(e.enter("setextHeadingLine"),l=f,u(f)):i(f)}function u(f){return e.enter("setextHeadingLineSequence"),d(f)}function d(f){return f===l?(e.consume(f),d):(e.exit("setextHeadingLineSequence"),We(f)?st(e,m,"lineSuffix")(f):m(f))}function m(f){return f===null||Ee(f)?(e.exit("setextHeadingLine"),t(f)):i(f)}}const rR={tokenize:aR};function aR(e){const t=this,i=e.attempt(ju,r,e.attempt(this.parser.constructs.flowInitial,l,st(e,e.attempt(this.parser.constructs.flow,l,e.attempt(hT,l)),"linePrefix")));return i;function r(c){if(c===null){e.consume(c);return}return e.enter("lineEndingBlank"),e.consume(c),e.exit("lineEndingBlank"),t.currentConstruct=void 0,i}function l(c){if(c===null){e.consume(c);return}return e.enter("lineEnding"),e.consume(c),e.exit("lineEnding"),t.currentConstruct=void 0,i}}const lR={resolveAll:R0()},oR=T0("string"),cR=T0("text");function T0(e){return{resolveAll:R0(e==="text"?uR:void 0),tokenize:t};function t(i){const r=this,l=this.parser.constructs[e],c=i.attempt(l,u,d);return u;function u(v){return f(v)?c(v):d(v)}function d(v){if(v===null){i.consume(v);return}return i.enter("data"),i.consume(v),m}function m(v){return f(v)?(i.exit("data"),c(v)):(i.consume(v),m)}function f(v){if(v===null)return!0;const _=l[v];let S=-1;if(_)for(;++S<_.length;){const x=_[S];if(!x.previous||x.previous.call(r,r.previous))return!0}return!1}}}function R0(e){return t;function t(i,r){let l=-1,c;for(;++l<=i.length;)c===void 0?i[l]&&i[l][1].type==="data"&&(c=l,l++):(!i[l]||i[l][1].type!=="data")&&(l!==c+2&&(i[c][1].end=i[l-1][1].end,i.splice(c+2,l-c-2),l=c+2),c=void 0);return e?e(i,r):i}}function uR(e,t){let i=0;for(;++i<=e.length;)if((i===e.length||e[i][1].type==="lineEnding")&&e[i-1][1].type==="data"){const r=e[i-1][1],l=t.sliceStream(r);let c=l.length,u=-1,d=0,m;for(;c--;){const f=l[c];if(typeof f=="string"){for(u=f.length;f.charCodeAt(u-1)===32;)d++,u--;if(u)break;u=-1}else if(f===-2)m=!0,d++;else if(f!==-1){c++;break}}if(t._contentTypeTextTrailing&&i===e.length&&(d=0),d){const f={type:i===e.length||m||d<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:c?u:r.start._bufferIndex+u,_index:r.start._index+c,line:r.end.line,column:r.end.column-d,offset:r.end.offset-d},end:{...r.end}};r.end={...f.start},r.start.offset===r.end.offset?Object.assign(r,f):(e.splice(i,0,["enter",f,t],["exit",f,t]),i+=2)}i++}return e}const hR={42:yn,43:yn,45:yn,48:yn,49:yn,50:yn,51:yn,52:yn,53:yn,54:yn,55:yn,56:yn,57:yn,62:b0},dR={91:gT},fR={[-2]:of,[-1]:of,32:of},mR={35:bT,42:Jc,45:[bx,Jc],60:kT,61:bx,95:Jc,96:xx,126:xx},pR={38:C0,92:w0},gR={[-5]:cf,[-4]:cf,[-3]:cf,33:KT,38:C0,42:Xf,60:[WE,LT],91:WT,92:[xT,w0],93:lp,95:Xf,96:rT},vR={null:[Xf,lR]},_R={null:[42,95]},yR={null:[]},xR=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:_R,contentInitial:dR,disable:yR,document:hR,flow:mR,flowInitial:fR,insideSpan:vR,string:pR,text:gR},Symbol.toStringTag,{value:"Module"}));function SR(e,t,i){let r={_bufferIndex:-1,_index:0,line:i&&i.line||1,column:i&&i.column||1,offset:i&&i.offset||0};const l={},c=[];let u=[],d=[];const m={attempt:I(z),check:I(B),consume:R,enter:N,exit:E,interrupt:I(B,{interrupt:!0})},f={code:null,containerState:{},defineSkip:C,events:[],now:b,parser:e,previous:null,sliceSerialize:S,sliceStream:x,write:_};let v=t.tokenize.call(f,m);return t.resolveAll&&c.push(t),f;function _(G){return u=ei(u,G),T(),u[u.length-1]!==null?[]:(q(t,0),f.events=ap(c,f.events,f),f.events)}function S(G,Y){return wR(x(G),Y)}function x(G){return bR(u,G)}function b(){const{_bufferIndex:G,_index:Y,line:M,column:j,offset:A}=r;return{_bufferIndex:G,_index:Y,line:M,column:j,offset:A}}function C(G){l[G.line]=G.column,V()}function T(){let G;for(;r._index<u.length;){const Y=u[r._index];if(typeof Y=="string")for(G=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===G&&r._bufferIndex<Y.length;)k(Y.charCodeAt(r._bufferIndex));else k(Y)}}function k(G){v=v(G)}function R(G){Ee(G)?(r.line++,r.column=1,r.offset+=G===-3?2:1,V()):G!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===u[r._index].length&&(r._bufferIndex=-1,r._index++)),f.previous=G}function N(G,Y){const M=Y||{};return M.type=G,M.start=b(),f.events.push(["enter",M,f]),d.push(M),M}function E(G){const Y=d.pop();return Y.end=b(),f.events.push(["exit",Y,f]),Y}function z(G,Y){q(G,Y.from)}function B(G,Y){Y.restore()}function I(G,Y){return M;function M(j,A,D){let $,W,ne,U;return Array.isArray(j)?H(j):"tokenize"in j?H([j]):P(j);function P(he){return de;function de(oe){const ye=oe!==null&&he[oe],ue=oe!==null&&he.null,Se=[...Array.isArray(ye)?ye:ye?[ye]:[],...Array.isArray(ue)?ue:ue?[ue]:[]];return H(Se)(oe)}}function H(he){return $=he,W=0,he.length===0?D:L(he[W])}function L(he){return de;function de(oe){return U=F(),ne=he,he.partial||(f.currentConstruct=he),he.name&&f.parser.constructs.disable.null.includes(he.name)?me():he.tokenize.call(Y?Object.assign(Object.create(f),Y):f,m,re,me)(oe)}}function re(he){return G(ne,U),A}function me(he){return U.restore(),++W<$.length?L($[W]):D}}}function q(G,Y){G.resolveAll&&!c.includes(G)&&c.push(G),G.resolve&&Ei(f.events,Y,f.events.length-Y,G.resolve(f.events.slice(Y),f)),G.resolveTo&&(f.events=G.resolveTo(f.events,f))}function F(){const G=b(),Y=f.previous,M=f.currentConstruct,j=f.events.length,A=Array.from(d);return{from:j,restore:D};function D(){r=G,f.previous=Y,f.currentConstruct=M,f.events.length=j,d=A,V()}}function V(){r.line in l&&r.column<2&&(r.column=l[r.line],r.offset+=l[r.line]-1)}}function bR(e,t){const i=t.start._index,r=t.start._bufferIndex,l=t.end._index,c=t.end._bufferIndex;let u;if(i===l)u=[e[i].slice(r,c)];else{if(u=e.slice(i,l),r>-1){const d=u[0];typeof d=="string"?u[0]=d.slice(r):u.shift()}c>0&&u.push(e[l].slice(0,c))}return u}function wR(e,t){let i=-1;const r=[];let l;for(;++i<e.length;){const c=e[i];let u;if(typeof c=="string")u=c;else switch(c){case-5:{u="\r";break}case-4:{u=`
`;break}case-3:{u=`\r
`;break}case-2:{u=t?" ":"	";break}case-1:{if(!t&&l)continue;u=" ";break}default:u=String.fromCharCode(c)}l=c===-2,r.push(u)}return r.join("")}function CR(e){const r={constructs:DE([xR,...(e||{}).extensions||[]]),content:l(HE),defined:[],document:l(UE),flow:l(rR),lazy:{},string:l(oR),text:l(cR)};return r;function l(c){return u;function u(d){return SR(r,c,d)}}}function jR(e){for(;!j0(e););return e}const wx=/[\0\t\n\r]/g;function kR(){let e=1,t="",i=!0,r;return l;function l(c,u,d){const m=[];let f,v,_,S,x;for(c=t+(typeof c=="string"?c.toString():new TextDecoder(u||void 0).decode(c)),_=0,t="",i&&(c.charCodeAt(0)===65279&&_++,i=void 0);_<c.length;){if(wx.lastIndex=_,f=wx.exec(c),S=f&&f.index!==void 0?f.index:c.length,x=c.charCodeAt(S),!f){t=c.slice(_);break}if(x===10&&_===S&&r)m.push(-3),r=void 0;else switch(r&&(m.push(-5),r=void 0),_<S&&(m.push(c.slice(_,S)),e+=S-_),x){case 0:{m.push(65533),e++;break}case 9:{for(v=Math.ceil(e/4)*4,m.push(-2);e++<v;)m.push(-1);break}case 10:{m.push(-4),e=1;break}default:r=!0,e=1}_=S+1}return d&&(r&&m.push(-5),t&&m.push(t),m.push(null)),m}}const NR=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function ER(e){return e.replace(NR,TR)}function TR(e,t,i){if(t)return t;if(i.charCodeAt(0)===35){const l=i.charCodeAt(1),c=l===120||l===88;return S0(i.slice(c?2:1),c?16:10)}return rp(i)||e}const D0={}.hasOwnProperty;function RR(e,t,i){return typeof t!="string"&&(i=t,t=void 0),DR(i)(jR(CR(i).document().write(kR()(e,t,!0))))}function DR(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:c(Kt),autolinkProtocol:F,autolinkEmail:F,atxHeading:c(xe),blockQuote:c(ue),characterEscape:F,characterReference:F,codeFenced:c(Se),codeFencedFenceInfo:u,codeFencedFenceMeta:u,codeIndented:c(Se,u),codeText:c(Oe,u),codeTextData:F,data:F,codeFlowValue:F,definition:c(De),definitionDestinationString:u,definitionLabelString:u,definitionTitleString:u,emphasis:c(yt),hardBreakEscape:c(di),hardBreakTrailing:c(di),htmlFlow:c(br,u),htmlFlowData:F,htmlText:c(br,u),htmlTextData:F,image:c(fi),label:u,link:c(Kt),listItem:c(Us),listItemValue:S,listOrdered:c(tn,_),listUnordered:c(tn),paragraph:c(wr),reference:L,referenceString:u,resourceDestinationString:u,resourceTitleString:u,setextHeading:c(xe),strong:c(Fs),thematicBreak:c(cn)},exit:{atxHeading:m(),atxHeadingSequence:z,autolink:m(),autolinkEmail:ye,autolinkProtocol:oe,blockQuote:m(),characterEscapeValue:V,characterReferenceMarkerHexadecimal:me,characterReferenceMarkerNumeric:me,characterReferenceValue:he,characterReference:de,codeFenced:m(T),codeFencedFence:C,codeFencedFenceInfo:x,codeFencedFenceMeta:b,codeFlowValue:V,codeIndented:m(k),codeText:m(A),codeTextData:V,data:V,definition:m(),definitionDestinationString:E,definitionLabelString:R,definitionTitleString:N,emphasis:m(),hardBreakEscape:m(Y),hardBreakTrailing:m(Y),htmlFlow:m(M),htmlFlowData:V,htmlText:m(j),htmlTextData:V,image:m($),label:ne,labelText:W,lineEnding:G,link:m(D),listItem:m(),listOrdered:m(),listUnordered:m(),paragraph:m(),referenceString:re,resourceDestinationString:U,resourceTitleString:P,resource:H,setextHeading:m(q),setextHeadingLineSequence:I,setextHeadingText:B,strong:m(),thematicBreak:m()}};A0(t,(e||{}).mdastExtensions||[]);const i={};return r;function r(ie){let pe={type:"root",children:[]};const ke={stack:[pe],tokenStack:[],config:t,enter:d,exit:f,buffer:u,resume:v,data:i},ze=[];let Ve=-1;for(;++Ve<ie.length;)if(ie[Ve][1].type==="listOrdered"||ie[Ve][1].type==="listUnordered")if(ie[Ve][0]==="enter")ze.push(Ve);else{const bn=ze.pop();Ve=l(ie,bn,Ve)}for(Ve=-1;++Ve<ie.length;){const bn=t[ie[Ve][0]];D0.call(bn,ie[Ve][1].type)&&bn[ie[Ve][1].type].call(Object.assign({sliceSerialize:ie[Ve][2].sliceSerialize},ke),ie[Ve][1])}if(ke.tokenStack.length>0){const bn=ke.tokenStack[ke.tokenStack.length-1];(bn[1]||Cx).call(ke,void 0,bn[0])}for(pe.position={start:Es(ie.length>0?ie[0][1].start:{line:1,column:1,offset:0}),end:Es(ie.length>0?ie[ie.length-2][1].end:{line:1,column:1,offset:0})},Ve=-1;++Ve<t.transforms.length;)pe=t.transforms[Ve](pe)||pe;return pe}function l(ie,pe,ke){let ze=pe-1,Ve=-1,bn=!1,Ri,nn,Dt,un;for(;++ze<=ke;){const et=ie[ze];switch(et[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{et[0]==="enter"?Ve++:Ve--,un=void 0;break}case"lineEndingBlank":{et[0]==="enter"&&(Ri&&!un&&!Ve&&!Dt&&(Dt=ze),un=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:un=void 0}if(!Ve&&et[0]==="enter"&&et[1].type==="listItemPrefix"||Ve===-1&&et[0]==="exit"&&(et[1].type==="listUnordered"||et[1].type==="listOrdered")){if(Ri){let is=ze;for(nn=void 0;is--;){const ri=ie[is];if(ri[1].type==="lineEnding"||ri[1].type==="lineEndingBlank"){if(ri[0]==="exit")continue;nn&&(ie[nn][1].type="lineEndingBlank",bn=!0),ri[1].type="lineEnding",nn=is}else if(!(ri[1].type==="linePrefix"||ri[1].type==="blockQuotePrefix"||ri[1].type==="blockQuotePrefixWhitespace"||ri[1].type==="blockQuoteMarker"||ri[1].type==="listItemIndent"))break}Dt&&(!nn||Dt<nn)&&(Ri._spread=!0),Ri.end=Object.assign({},nn?ie[nn][1].start:et[1].end),ie.splice(nn||ze,0,["exit",Ri,et[2]]),ze++,ke++}if(et[1].type==="listItemPrefix"){const is={type:"listItem",_spread:!1,start:Object.assign({},et[1].start),end:void 0};Ri=is,ie.splice(ze,0,["enter",is,et[2]]),ze++,ke++,Dt=void 0,un=!0}}}return ie[pe][1]._spread=bn,ke}function c(ie,pe){return ke;function ke(ze){d.call(this,ie(ze),ze),pe&&pe.call(this,ze)}}function u(){this.stack.push({type:"fragment",children:[]})}function d(ie,pe,ke){this.stack[this.stack.length-1].children.push(ie),this.stack.push(ie),this.tokenStack.push([pe,ke||void 0]),ie.position={start:Es(pe.start),end:void 0}}function m(ie){return pe;function pe(ke){ie&&ie.call(this,ke),f.call(this,ke)}}function f(ie,pe){const ke=this.stack.pop(),ze=this.tokenStack.pop();if(ze)ze[0].type!==ie.type&&(pe?pe.call(this,ie,ze[0]):(ze[1]||Cx).call(this,ie,ze[0]));else throw new Error("Cannot close `"+ie.type+"` ("+Yl({start:ie.start,end:ie.end})+"): its not open");ke.position.end=Es(ie.end)}function v(){return TE(this.stack.pop())}function _(){this.data.expectingFirstListItemValue=!0}function S(ie){if(this.data.expectingFirstListItemValue){const pe=this.stack[this.stack.length-2];pe.start=Number.parseInt(this.sliceSerialize(ie),10),this.data.expectingFirstListItemValue=void 0}}function x(){const ie=this.resume(),pe=this.stack[this.stack.length-1];pe.lang=ie}function b(){const ie=this.resume(),pe=this.stack[this.stack.length-1];pe.meta=ie}function C(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function T(){const ie=this.resume(),pe=this.stack[this.stack.length-1];pe.value=ie.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function k(){const ie=this.resume(),pe=this.stack[this.stack.length-1];pe.value=ie.replace(/(\r?\n|\r)$/g,"")}function R(ie){const pe=this.resume(),ke=this.stack[this.stack.length-1];ke.label=pe,ke.identifier=ya(this.sliceSerialize(ie)).toLowerCase()}function N(){const ie=this.resume(),pe=this.stack[this.stack.length-1];pe.title=ie}function E(){const ie=this.resume(),pe=this.stack[this.stack.length-1];pe.url=ie}function z(ie){const pe=this.stack[this.stack.length-1];if(!pe.depth){const ke=this.sliceSerialize(ie).length;pe.depth=ke}}function B(){this.data.setextHeadingSlurpLineEnding=!0}function I(ie){const pe=this.stack[this.stack.length-1];pe.depth=this.sliceSerialize(ie).codePointAt(0)===61?1:2}function q(){this.data.setextHeadingSlurpLineEnding=void 0}function F(ie){const ke=this.stack[this.stack.length-1].children;let ze=ke[ke.length-1];(!ze||ze.type!=="text")&&(ze=Ot(),ze.position={start:Es(ie.start),end:void 0},ke.push(ze)),this.stack.push(ze)}function V(ie){const pe=this.stack.pop();pe.value+=this.sliceSerialize(ie),pe.position.end=Es(ie.end)}function G(ie){const pe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const ke=pe.children[pe.children.length-1];ke.position.end=Es(ie.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(pe.type)&&(F.call(this,ie),V.call(this,ie))}function Y(){this.data.atHardBreak=!0}function M(){const ie=this.resume(),pe=this.stack[this.stack.length-1];pe.value=ie}function j(){const ie=this.resume(),pe=this.stack[this.stack.length-1];pe.value=ie}function A(){const ie=this.resume(),pe=this.stack[this.stack.length-1];pe.value=ie}function D(){const ie=this.stack[this.stack.length-1];if(this.data.inReference){const pe=this.data.referenceType||"shortcut";ie.type+="Reference",ie.referenceType=pe,delete ie.url,delete ie.title}else delete ie.identifier,delete ie.label;this.data.referenceType=void 0}function $(){const ie=this.stack[this.stack.length-1];if(this.data.inReference){const pe=this.data.referenceType||"shortcut";ie.type+="Reference",ie.referenceType=pe,delete ie.url,delete ie.title}else delete ie.identifier,delete ie.label;this.data.referenceType=void 0}function W(ie){const pe=this.sliceSerialize(ie),ke=this.stack[this.stack.length-2];ke.label=ER(pe),ke.identifier=ya(pe).toLowerCase()}function ne(){const ie=this.stack[this.stack.length-1],pe=this.resume(),ke=this.stack[this.stack.length-1];if(this.data.inReference=!0,ke.type==="link"){const ze=ie.children;ke.children=ze}else ke.alt=pe}function U(){const ie=this.resume(),pe=this.stack[this.stack.length-1];pe.url=ie}function P(){const ie=this.resume(),pe=this.stack[this.stack.length-1];pe.title=ie}function H(){this.data.inReference=void 0}function L(){this.data.referenceType="collapsed"}function re(ie){const pe=this.resume(),ke=this.stack[this.stack.length-1];ke.label=pe,ke.identifier=ya(this.sliceSerialize(ie)).toLowerCase(),this.data.referenceType="full"}function me(ie){this.data.characterReferenceType=ie.type}function he(ie){const pe=this.sliceSerialize(ie),ke=this.data.characterReferenceType;let ze;ke?(ze=S0(pe,ke==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):ze=rp(pe);const Ve=this.stack[this.stack.length-1];Ve.value+=ze}function de(ie){const pe=this.stack.pop();pe.position.end=Es(ie.end)}function oe(ie){V.call(this,ie);const pe=this.stack[this.stack.length-1];pe.url=this.sliceSerialize(ie)}function ye(ie){V.call(this,ie);const pe=this.stack[this.stack.length-1];pe.url="mailto:"+this.sliceSerialize(ie)}function ue(){return{type:"blockquote",children:[]}}function Se(){return{type:"code",lang:null,meta:null,value:""}}function Oe(){return{type:"inlineCode",value:""}}function De(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function yt(){return{type:"emphasis",children:[]}}function xe(){return{type:"heading",depth:0,children:[]}}function di(){return{type:"break"}}function br(){return{type:"html",value:""}}function fi(){return{type:"image",title:null,url:"",alt:null}}function Kt(){return{type:"link",title:null,url:"",children:[]}}function tn(ie){return{type:"list",ordered:ie.type==="listOrdered",start:null,spread:ie._spread,children:[]}}function Us(ie){return{type:"listItem",spread:ie._spread,checked:null,children:[]}}function wr(){return{type:"paragraph",children:[]}}function Fs(){return{type:"strong",children:[]}}function Ot(){return{type:"text",value:""}}function cn(){return{type:"thematicBreak"}}}function Es(e){return{line:e.line,column:e.column,offset:e.offset}}function A0(e,t){let i=-1;for(;++i<t.length;){const r=t[i];Array.isArray(r)?A0(e,r):AR(e,r)}}function AR(e,t){let i;for(i in t)if(D0.call(t,i))switch(i){case"canContainEols":{const r=t[i];r&&e[i].push(...r);break}case"transforms":{const r=t[i];r&&e[i].push(...r);break}case"enter":case"exit":{const r=t[i];r&&Object.assign(e[i],r);break}}}function Cx(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Yl({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Yl({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Yl({start:t.start,end:t.end})+") is still open")}function LR(e){const t=this;t.parser=i;function i(r){return RR(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function MR(e,t){const i={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,i),e.applyData(t,i)}function BR(e,t){const i={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,i),[e.applyData(t,i),{type:"text",value:`
`}]}function OR(e,t){const i=t.value?t.value+`
`:"",r={},l=t.lang?t.lang.split(/\s+/):[];l.length>0&&(r.className=["language-"+l[0]]);let c={type:"element",tagName:"code",properties:r,children:[{type:"text",value:i}]};return t.meta&&(c.data={meta:t.meta}),e.patch(t,c),c=e.applyData(t,c),c={type:"element",tagName:"pre",properties:{},children:[c]},e.patch(t,c),c}function zR(e,t){const i={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function PR(e,t){const i={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function HR(e,t){const i=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),l=Ta(r.toLowerCase()),c=e.footnoteOrder.indexOf(r);let u,d=e.footnoteCounts.get(r);d===void 0?(d=0,e.footnoteOrder.push(r),u=e.footnoteOrder.length):u=c+1,d+=1,e.footnoteCounts.set(r,d);const m={type:"element",tagName:"a",properties:{href:"#"+i+"fn-"+l,id:i+"fnref-"+l+(d>1?"-"+d:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(u)}]};e.patch(t,m);const f={type:"element",tagName:"sup",properties:{},children:[m]};return e.patch(t,f),e.applyData(t,f)}function IR(e,t){const i={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function UR(e,t){if(e.options.allowDangerousHtml){const i={type:"raw",value:t.value};return e.patch(t,i),e.applyData(t,i)}}function L0(e,t){const i=t.referenceType;let r="]";if(i==="collapsed"?r+="[]":i==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const l=e.all(t),c=l[0];c&&c.type==="text"?c.value="["+c.value:l.unshift({type:"text",value:"["});const u=l[l.length-1];return u&&u.type==="text"?u.value+=r:l.push({type:"text",value:r}),l}function FR(e,t){const i=String(t.identifier).toUpperCase(),r=e.definitionById.get(i);if(!r)return L0(e,t);const l={src:Ta(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(l.title=r.title);const c={type:"element",tagName:"img",properties:l,children:[]};return e.patch(t,c),e.applyData(t,c)}function $R(e,t){const i={src:Ta(t.url)};t.alt!==null&&t.alt!==void 0&&(i.alt=t.alt),t.title!==null&&t.title!==void 0&&(i.title=t.title);const r={type:"element",tagName:"img",properties:i,children:[]};return e.patch(t,r),e.applyData(t,r)}function KR(e,t){const i={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,i);const r={type:"element",tagName:"code",properties:{},children:[i]};return e.patch(t,r),e.applyData(t,r)}function qR(e,t){const i=String(t.identifier).toUpperCase(),r=e.definitionById.get(i);if(!r)return L0(e,t);const l={href:Ta(r.url||"")};r.title!==null&&r.title!==void 0&&(l.title=r.title);const c={type:"element",tagName:"a",properties:l,children:e.all(t)};return e.patch(t,c),e.applyData(t,c)}function WR(e,t){const i={href:Ta(t.url)};t.title!==null&&t.title!==void 0&&(i.title=t.title);const r={type:"element",tagName:"a",properties:i,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function VR(e,t,i){const r=e.all(t),l=i?GR(i):M0(t),c={},u=[];if(typeof t.checked=="boolean"){const v=r[0];let _;v&&v.type==="element"&&v.tagName==="p"?_=v:(_={type:"element",tagName:"p",properties:{},children:[]},r.unshift(_)),_.children.length>0&&_.children.unshift({type:"text",value:" "}),_.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),c.className=["task-list-item"]}let d=-1;for(;++d<r.length;){const v=r[d];(l||d!==0||v.type!=="element"||v.tagName!=="p")&&u.push({type:"text",value:`
`}),v.type==="element"&&v.tagName==="p"&&!l?u.push(...v.children):u.push(v)}const m=r[r.length-1];m&&(l||m.type!=="element"||m.tagName!=="p")&&u.push({type:"text",value:`
`});const f={type:"element",tagName:"li",properties:c,children:u};return e.patch(t,f),e.applyData(t,f)}function GR(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const i=e.children;let r=-1;for(;!t&&++r<i.length;)t=M0(i[r])}return t}function M0(e){const t=e.spread;return t??e.children.length>1}function YR(e,t){const i={},r=e.all(t);let l=-1;for(typeof t.start=="number"&&t.start!==1&&(i.start=t.start);++l<r.length;){const u=r[l];if(u.type==="element"&&u.tagName==="li"&&u.properties&&Array.isArray(u.properties.className)&&u.properties.className.includes("task-list-item")){i.className=["contains-task-list"];break}}const c={type:"element",tagName:t.ordered?"ol":"ul",properties:i,children:e.wrap(r,!0)};return e.patch(t,c),e.applyData(t,c)}function XR(e,t){const i={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function JR(e,t){const i={type:"root",children:e.wrap(e.all(t))};return e.patch(t,i),e.applyData(t,i)}function ZR(e,t){const i={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function QR(e,t){const i=e.all(t),r=i.shift(),l=[];if(r){const u={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],u),l.push(u)}if(i.length>0){const u={type:"element",tagName:"tbody",properties:{},children:e.wrap(i,!0)},d=tp(t.children[1]),m=m0(t.children[t.children.length-1]);d&&m&&(u.position={start:d,end:m}),l.push(u)}const c={type:"element",tagName:"table",properties:{},children:e.wrap(l,!0)};return e.patch(t,c),e.applyData(t,c)}function eD(e,t,i){const r=i?i.children:void 0,c=(r?r.indexOf(t):1)===0?"th":"td",u=i&&i.type==="table"?i.align:void 0,d=u?u.length:t.children.length;let m=-1;const f=[];for(;++m<d;){const _=t.children[m],S={},x=u?u[m]:void 0;x&&(S.align=x);let b={type:"element",tagName:c,properties:S,children:[]};_&&(b.children=e.all(_),e.patch(_,b),b=e.applyData(_,b)),f.push(b)}const v={type:"element",tagName:"tr",properties:{},children:e.wrap(f,!0)};return e.patch(t,v),e.applyData(t,v)}function tD(e,t){const i={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}const jx=9,kx=32;function nD(e){const t=String(e),i=/\r?\n|\r/g;let r=i.exec(t),l=0;const c=[];for(;r;)c.push(Nx(t.slice(l,r.index),l>0,!0),r[0]),l=r.index+r[0].length,r=i.exec(t);return c.push(Nx(t.slice(l),l>0,!1)),c.join("")}function Nx(e,t,i){let r=0,l=e.length;if(t){let c=e.codePointAt(r);for(;c===jx||c===kx;)r++,c=e.codePointAt(r)}if(i){let c=e.codePointAt(l-1);for(;c===jx||c===kx;)l--,c=e.codePointAt(l-1)}return l>r?e.slice(r,l):""}function iD(e,t){const i={type:"text",value:nD(String(t.value))};return e.patch(t,i),e.applyData(t,i)}function sD(e,t){const i={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,i),e.applyData(t,i)}const rD={blockquote:MR,break:BR,code:OR,delete:zR,emphasis:PR,footnoteReference:HR,heading:IR,html:UR,imageReference:FR,image:$R,inlineCode:KR,linkReference:qR,link:WR,listItem:VR,list:YR,paragraph:XR,root:JR,strong:ZR,table:QR,tableCell:tD,tableRow:eD,text:iD,thematicBreak:sD,toml:Pc,yaml:Pc,definition:Pc,footnoteDefinition:Pc};function Pc(){}const B0=-1,ku=0,Jl=1,lu=2,op=3,cp=4,up=5,hp=6,O0=7,z0=8,Ex=typeof self=="object"?self:globalThis,aD=(e,t)=>{const i=(l,c)=>(e.set(c,l),l),r=l=>{if(e.has(l))return e.get(l);const[c,u]=t[l];switch(c){case ku:case B0:return i(u,l);case Jl:{const d=i([],l);for(const m of u)d.push(r(m));return d}case lu:{const d=i({},l);for(const[m,f]of u)d[r(m)]=r(f);return d}case op:return i(new Date(u),l);case cp:{const{source:d,flags:m}=u;return i(new RegExp(d,m),l)}case up:{const d=i(new Map,l);for(const[m,f]of u)d.set(r(m),r(f));return d}case hp:{const d=i(new Set,l);for(const m of u)d.add(r(m));return d}case O0:{const{name:d,message:m}=u;return i(new Ex[d](m),l)}case z0:return i(BigInt(u),l);case"BigInt":return i(Object(BigInt(u)),l);case"ArrayBuffer":return i(new Uint8Array(u).buffer,u);case"DataView":{const{buffer:d}=new Uint8Array(u);return i(new DataView(d),u)}}return i(new Ex[c](u),l)};return r},Tx=e=>aD(new Map,e)(0),ca="",{toString:lD}={},{keys:oD}=Object,Ll=e=>{const t=typeof e;if(t!=="object"||!e)return[ku,t];const i=lD.call(e).slice(8,-1);switch(i){case"Array":return[Jl,ca];case"Object":return[lu,ca];case"Date":return[op,ca];case"RegExp":return[cp,ca];case"Map":return[up,ca];case"Set":return[hp,ca];case"DataView":return[Jl,i]}return i.includes("Array")?[Jl,i]:i.includes("Error")?[O0,i]:[lu,i]},Hc=([e,t])=>e===ku&&(t==="function"||t==="symbol"),cD=(e,t,i,r)=>{const l=(u,d)=>{const m=r.push(u)-1;return i.set(d,m),m},c=u=>{if(i.has(u))return i.get(u);let[d,m]=Ll(u);switch(d){case ku:{let v=u;switch(m){case"bigint":d=z0,v=u.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+m);v=null;break;case"undefined":return l([B0],u)}return l([d,v],u)}case Jl:{if(m){let S=u;return m==="DataView"?S=new Uint8Array(u.buffer):m==="ArrayBuffer"&&(S=new Uint8Array(u)),l([m,[...S]],u)}const v=[],_=l([d,v],u);for(const S of u)v.push(c(S));return _}case lu:{if(m)switch(m){case"BigInt":return l([m,u.toString()],u);case"Boolean":case"Number":case"String":return l([m,u.valueOf()],u)}if(t&&"toJSON"in u)return c(u.toJSON());const v=[],_=l([d,v],u);for(const S of oD(u))(e||!Hc(Ll(u[S])))&&v.push([c(S),c(u[S])]);return _}case op:return l([d,u.toISOString()],u);case cp:{const{source:v,flags:_}=u;return l([d,{source:v,flags:_}],u)}case up:{const v=[],_=l([d,v],u);for(const[S,x]of u)(e||!(Hc(Ll(S))||Hc(Ll(x))))&&v.push([c(S),c(x)]);return _}case hp:{const v=[],_=l([d,v],u);for(const S of u)(e||!Hc(Ll(S)))&&v.push(c(S));return _}}const{message:f}=u;return l([d,{name:m,message:f}],u)};return c},Rx=(e,{json:t,lossy:i}={})=>{const r=[];return cD(!(t||i),!!t,new Map,r)(e),r},ou=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?Tx(Rx(e,t)):structuredClone(e):(e,t)=>Tx(Rx(e,t));function uD(e,t){const i=[{type:"text",value:""}];return t>1&&i.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),i}function hD(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function dD(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",i=e.options.footnoteBackContent||uD,r=e.options.footnoteBackLabel||hD,l=e.options.footnoteLabel||"Footnotes",c=e.options.footnoteLabelTagName||"h2",u=e.options.footnoteLabelProperties||{className:["sr-only"]},d=[];let m=-1;for(;++m<e.footnoteOrder.length;){const f=e.footnoteById.get(e.footnoteOrder[m]);if(!f)continue;const v=e.all(f),_=String(f.identifier).toUpperCase(),S=Ta(_.toLowerCase());let x=0;const b=[],C=e.footnoteCounts.get(_);for(;C!==void 0&&++x<=C;){b.length>0&&b.push({type:"text",value:" "});let R=typeof i=="string"?i:i(m,x);typeof R=="string"&&(R={type:"text",value:R}),b.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+S+(x>1?"-"+x:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(m,x),className:["data-footnote-backref"]},children:Array.isArray(R)?R:[R]})}const T=v[v.length-1];if(T&&T.type==="element"&&T.tagName==="p"){const R=T.children[T.children.length-1];R&&R.type==="text"?R.value+=" ":T.children.push({type:"text",value:" "}),T.children.push(...b)}else v.push(...b);const k={type:"element",tagName:"li",properties:{id:t+"fn-"+S},children:e.wrap(v,!0)};e.patch(f,k),d.push(k)}if(d.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:c,properties:{...ou(u),id:"footnote-label"},children:[{type:"text",value:l}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(d,!0)},{type:"text",value:`
`}]}}const P0=(function(e){if(e==null)return gD;if(typeof e=="function")return Nu(e);if(typeof e=="object")return Array.isArray(e)?fD(e):mD(e);if(typeof e=="string")return pD(e);throw new Error("Expected function, string, or object as test")});function fD(e){const t=[];let i=-1;for(;++i<e.length;)t[i]=P0(e[i]);return Nu(r);function r(...l){let c=-1;for(;++c<t.length;)if(t[c].apply(this,l))return!0;return!1}}function mD(e){const t=e;return Nu(i);function i(r){const l=r;let c;for(c in e)if(l[c]!==t[c])return!1;return!0}}function pD(e){return Nu(t);function t(i){return i&&i.type===e}}function Nu(e){return t;function t(i,r,l){return!!(vD(i)&&e.call(this,i,typeof r=="number"?r:void 0,l||void 0))}}function gD(){return!0}function vD(e){return e!==null&&typeof e=="object"&&"type"in e}const H0=[],_D=!0,Dx=!1,yD="skip";function xD(e,t,i,r){let l;typeof t=="function"&&typeof i!="function"?(r=i,i=t):l=t;const c=P0(l),u=r?-1:1;d(e,void 0,[])();function d(m,f,v){const _=m&&typeof m=="object"?m:{};if(typeof _.type=="string"){const x=typeof _.tagName=="string"?_.tagName:typeof _.name=="string"?_.name:void 0;Object.defineProperty(S,"name",{value:"node ("+(m.type+(x?"<"+x+">":""))+")"})}return S;function S(){let x=H0,b,C,T;if((!t||c(m,f,v[v.length-1]||void 0))&&(x=SD(i(m,v)),x[0]===Dx))return x;if("children"in m&&m.children){const k=m;if(k.children&&x[0]!==yD)for(C=(r?k.children.length:-1)+u,T=v.concat(k);C>-1&&C<k.children.length;){const R=k.children[C];if(b=d(R,C,T)(),b[0]===Dx)return b;C=typeof b[1]=="number"?b[1]:C+u}}return x}}}function SD(e){return Array.isArray(e)?e:typeof e=="number"?[_D,e]:e==null?H0:[e]}function I0(e,t,i,r){let l,c,u;typeof t=="function"&&typeof i!="function"?(c=void 0,u=t,l=i):(c=t,u=i,l=r),xD(e,c,d,l);function d(m,f){const v=f[f.length-1],_=v?v.children.indexOf(m):void 0;return u(m,_,v)}}const Jf={}.hasOwnProperty,bD={};function wD(e,t){const i=t||bD,r=new Map,l=new Map,c=new Map,u={...rD,...i.handlers},d={all:f,applyData:jD,definitionById:r,footnoteById:l,footnoteCounts:c,footnoteOrder:[],handlers:u,one:m,options:i,patch:CD,wrap:ND};return I0(e,function(v){if(v.type==="definition"||v.type==="footnoteDefinition"){const _=v.type==="definition"?r:l,S=String(v.identifier).toUpperCase();_.has(S)||_.set(S,v)}}),d;function m(v,_){const S=v.type,x=d.handlers[S];if(Jf.call(d.handlers,S)&&x)return x(d,v,_);if(d.options.passThrough&&d.options.passThrough.includes(S)){if("children"in v){const{children:C,...T}=v,k=ou(T);return k.children=d.all(v),k}return ou(v)}return(d.options.unknownHandler||kD)(d,v,_)}function f(v){const _=[];if("children"in v){const S=v.children;let x=-1;for(;++x<S.length;){const b=d.one(S[x],v);if(b){if(x&&S[x-1].type==="break"&&(!Array.isArray(b)&&b.type==="text"&&(b.value=Ax(b.value)),!Array.isArray(b)&&b.type==="element")){const C=b.children[0];C&&C.type==="text"&&(C.value=Ax(C.value))}Array.isArray(b)?_.push(...b):_.push(b)}}}return _}}function CD(e,t){e.position&&(t.position=lE(e))}function jD(e,t){let i=t;if(e&&e.data){const r=e.data.hName,l=e.data.hChildren,c=e.data.hProperties;if(typeof r=="string")if(i.type==="element")i.tagName=r;else{const u="children"in i?i.children:[i];i={type:"element",tagName:r,properties:{},children:u}}i.type==="element"&&c&&Object.assign(i.properties,ou(c)),"children"in i&&i.children&&l!==null&&l!==void 0&&(i.children=l)}return i}function kD(e,t){const i=t.data||{},r="value"in t&&!(Jf.call(i,"hProperties")||Jf.call(i,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function ND(e,t){const i=[];let r=-1;for(t&&i.push({type:"text",value:`
`});++r<e.length;)r&&i.push({type:"text",value:`
`}),i.push(e[r]);return t&&e.length>0&&i.push({type:"text",value:`
`}),i}function Ax(e){let t=0,i=e.charCodeAt(t);for(;i===9||i===32;)t++,i=e.charCodeAt(t);return e.slice(t)}function Lx(e,t){const i=wD(e,t),r=i.one(e,void 0),l=dD(i),c=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return l&&c.children.push({type:"text",value:`
`},l),c}function ED(e,t){return e&&"run"in e?async function(i,r){const l=Lx(i,{file:r,...t});await e.run(l,r)}:function(i,r){return Lx(i,{file:r,...e||t})}}function Mx(e){if(e)throw e}var uf,Bx;function TD(){if(Bx)return uf;Bx=1;var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,i=Object.defineProperty,r=Object.getOwnPropertyDescriptor,l=function(f){return typeof Array.isArray=="function"?Array.isArray(f):t.call(f)==="[object Array]"},c=function(f){if(!f||t.call(f)!=="[object Object]")return!1;var v=e.call(f,"constructor"),_=f.constructor&&f.constructor.prototype&&e.call(f.constructor.prototype,"isPrototypeOf");if(f.constructor&&!v&&!_)return!1;var S;for(S in f);return typeof S>"u"||e.call(f,S)},u=function(f,v){i&&v.name==="__proto__"?i(f,v.name,{enumerable:!0,configurable:!0,value:v.newValue,writable:!0}):f[v.name]=v.newValue},d=function(f,v){if(v==="__proto__")if(e.call(f,v)){if(r)return r(f,v).value}else return;return f[v]};return uf=function m(){var f,v,_,S,x,b,C=arguments[0],T=1,k=arguments.length,R=!1;for(typeof C=="boolean"&&(R=C,C=arguments[1]||{},T=2),(C==null||typeof C!="object"&&typeof C!="function")&&(C={});T<k;++T)if(f=arguments[T],f!=null)for(v in f)_=d(C,v),S=d(f,v),C!==S&&(R&&S&&(c(S)||(x=l(S)))?(x?(x=!1,b=_&&l(_)?_:[]):b=_&&c(_)?_:{},u(C,{name:v,newValue:m(R,b,S)})):typeof S<"u"&&u(C,{name:v,newValue:S}));return C},uf}var RD=TD();const hf=Km(RD);function Zf(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function DD(){const e=[],t={run:i,use:r};return t;function i(...l){let c=-1;const u=l.pop();if(typeof u!="function")throw new TypeError("Expected function as last argument, not "+u);d(null,...l);function d(m,...f){const v=e[++c];let _=-1;if(m){u(m);return}for(;++_<l.length;)(f[_]===null||f[_]===void 0)&&(f[_]=l[_]);l=f,v?AD(v,d)(...f):u(null,...f)}}function r(l){if(typeof l!="function")throw new TypeError("Expected `middelware` to be a function, not "+l);return e.push(l),t}}function AD(e,t){let i;return r;function r(...u){const d=e.length>u.length;let m;d&&u.push(l);try{m=e.apply(this,u)}catch(f){const v=f;if(d&&i)throw v;return l(v)}d||(m&&m.then&&typeof m.then=="function"?m.then(c,l):m instanceof Error?l(m):c(m))}function l(u,...d){i||(i=!0,t(u,...d))}function c(u){l(null,u)}}const wi={basename:LD,dirname:MD,extname:BD,join:OD,sep:"/"};function LD(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');fo(e);let i=0,r=-1,l=e.length,c;if(t===void 0||t.length===0||t.length>e.length){for(;l--;)if(e.codePointAt(l)===47){if(c){i=l+1;break}}else r<0&&(c=!0,r=l+1);return r<0?"":e.slice(i,r)}if(t===e)return"";let u=-1,d=t.length-1;for(;l--;)if(e.codePointAt(l)===47){if(c){i=l+1;break}}else u<0&&(c=!0,u=l+1),d>-1&&(e.codePointAt(l)===t.codePointAt(d--)?d<0&&(r=l):(d=-1,r=u));return i===r?r=u:r<0&&(r=e.length),e.slice(i,r)}function MD(e){if(fo(e),e.length===0)return".";let t=-1,i=e.length,r;for(;--i;)if(e.codePointAt(i)===47){if(r){t=i;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function BD(e){fo(e);let t=e.length,i=-1,r=0,l=-1,c=0,u;for(;t--;){const d=e.codePointAt(t);if(d===47){if(u){r=t+1;break}continue}i<0&&(u=!0,i=t+1),d===46?l<0?l=t:c!==1&&(c=1):l>-1&&(c=-1)}return l<0||i<0||c===0||c===1&&l===i-1&&l===r+1?"":e.slice(l,i)}function OD(...e){let t=-1,i;for(;++t<e.length;)fo(e[t]),e[t]&&(i=i===void 0?e[t]:i+"/"+e[t]);return i===void 0?".":zD(i)}function zD(e){fo(e);const t=e.codePointAt(0)===47;let i=PD(e,!t);return i.length===0&&!t&&(i="."),i.length>0&&e.codePointAt(e.length-1)===47&&(i+="/"),t?"/"+i:i}function PD(e,t){let i="",r=0,l=-1,c=0,u=-1,d,m;for(;++u<=e.length;){if(u<e.length)d=e.codePointAt(u);else{if(d===47)break;d=47}if(d===47){if(!(l===u-1||c===1))if(l!==u-1&&c===2){if(i.length<2||r!==2||i.codePointAt(i.length-1)!==46||i.codePointAt(i.length-2)!==46){if(i.length>2){if(m=i.lastIndexOf("/"),m!==i.length-1){m<0?(i="",r=0):(i=i.slice(0,m),r=i.length-1-i.lastIndexOf("/")),l=u,c=0;continue}}else if(i.length>0){i="",r=0,l=u,c=0;continue}}t&&(i=i.length>0?i+"/..":"..",r=2)}else i.length>0?i+="/"+e.slice(l+1,u):i=e.slice(l+1,u),r=u-l-1;l=u,c=0}else d===46&&c>-1?c++:c=-1}return i}function fo(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const HD={cwd:ID};function ID(){return"/"}function Qf(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function UD(e){if(typeof e=="string")e=new URL(e);else if(!Qf(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return FD(e)}function FD(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const t=e.pathname;let i=-1;for(;++i<t.length;)if(t.codePointAt(i)===37&&t.codePointAt(i+1)===50){const r=t.codePointAt(i+2);if(r===70||r===102){const l=new TypeError("File URL path must not include encoded / characters");throw l.code="ERR_INVALID_FILE_URL_PATH",l}}return decodeURIComponent(t)}const df=["history","path","basename","stem","extname","dirname"];class U0{constructor(t){let i;t?Qf(t)?i={path:t}:typeof t=="string"||$D(t)?i={value:t}:i=t:i={},this.cwd="cwd"in i?"":HD.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<df.length;){const c=df[r];c in i&&i[c]!==void 0&&i[c]!==null&&(this[c]=c==="history"?[...i[c]]:i[c])}let l;for(l in i)df.includes(l)||(this[l]=i[l])}get basename(){return typeof this.path=="string"?wi.basename(this.path):void 0}set basename(t){mf(t,"basename"),ff(t,"basename"),this.path=wi.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?wi.dirname(this.path):void 0}set dirname(t){Ox(this.basename,"dirname"),this.path=wi.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?wi.extname(this.path):void 0}set extname(t){if(ff(t,"extname"),Ox(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=wi.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){Qf(t)&&(t=UD(t)),mf(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?wi.basename(this.path,this.extname):void 0}set stem(t){mf(t,"stem"),ff(t,"stem"),this.path=wi.join(this.dirname||"",t+(this.extname||""))}fail(t,i,r){const l=this.message(t,i,r);throw l.fatal=!0,l}info(t,i,r){const l=this.message(t,i,r);return l.fatal=void 0,l}message(t,i,r){const l=new en(t,i,r);return this.path&&(l.name=this.path+":"+l.name,l.file=this.path),l.fatal=!1,this.messages.push(l),l}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function ff(e,t){if(e&&e.includes(wi.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+wi.sep+"`")}function mf(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function Ox(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function $D(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const KD=(function(e){const r=this.constructor.prototype,l=r[e],c=function(){return l.apply(c,arguments)};return Object.setPrototypeOf(c,r),c}),qD={}.hasOwnProperty;class dp extends KD{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=DD()}copy(){const t=new dp;let i=-1;for(;++i<this.attachers.length;){const r=this.attachers[i];t.use(...r)}return t.data(hf(!0,{},this.namespace)),t}data(t,i){return typeof t=="string"?arguments.length===2?(vf("data",this.frozen),this.namespace[t]=i,this):qD.call(this.namespace,t)&&this.namespace[t]||void 0:t?(vf("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[i,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const l=i.call(t,...r);typeof l=="function"&&this.transformers.use(l)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const i=Ic(t),r=this.parser||this.Parser;return pf("parse",r),r(String(i),i)}process(t,i){const r=this;return this.freeze(),pf("process",this.parser||this.Parser),gf("process",this.compiler||this.Compiler),i?l(void 0,i):new Promise(l);function l(c,u){const d=Ic(t),m=r.parse(d);r.run(m,d,function(v,_,S){if(v||!_||!S)return f(v);const x=_,b=r.stringify(x,S);GD(b)?S.value=b:S.result=b,f(v,S)});function f(v,_){v||!_?u(v):c?c(_):i(void 0,_)}}}processSync(t){let i=!1,r;return this.freeze(),pf("processSync",this.parser||this.Parser),gf("processSync",this.compiler||this.Compiler),this.process(t,l),Px("processSync","process",i),r;function l(c,u){i=!0,Mx(c),r=u}}run(t,i,r){zx(t),this.freeze();const l=this.transformers;return!r&&typeof i=="function"&&(r=i,i=void 0),r?c(void 0,r):new Promise(c);function c(u,d){const m=Ic(i);l.run(t,m,f);function f(v,_,S){const x=_||t;v?d(v):u?u(x):r(void 0,x,S)}}}runSync(t,i){let r=!1,l;return this.run(t,i,c),Px("runSync","run",r),l;function c(u,d){Mx(u),l=d,r=!0}}stringify(t,i){this.freeze();const r=Ic(i),l=this.compiler||this.Compiler;return gf("stringify",l),zx(t),l(t,r)}use(t,...i){const r=this.attachers,l=this.namespace;if(vf("use",this.frozen),t!=null)if(typeof t=="function")m(t,i);else if(typeof t=="object")Array.isArray(t)?d(t):u(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function c(f){if(typeof f=="function")m(f,[]);else if(typeof f=="object")if(Array.isArray(f)){const[v,..._]=f;m(v,_)}else u(f);else throw new TypeError("Expected usable value, not `"+f+"`")}function u(f){if(!("plugins"in f)&&!("settings"in f))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");d(f.plugins),f.settings&&(l.settings=hf(!0,l.settings,f.settings))}function d(f){let v=-1;if(f!=null)if(Array.isArray(f))for(;++v<f.length;){const _=f[v];c(_)}else throw new TypeError("Expected a list of plugins, not `"+f+"`")}function m(f,v){let _=-1,S=-1;for(;++_<r.length;)if(r[_][0]===f){S=_;break}if(S===-1)r.push([f,...v]);else if(v.length>0){let[x,...b]=v;const C=r[S][1];Zf(C)&&Zf(x)&&(x=hf(!0,C,x)),r[S]=[f,x,...b]}}}}const WD=new dp().freeze();function pf(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function gf(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function vf(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function zx(e){if(!Zf(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function Px(e,t,i){if(!i)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Ic(e){return VD(e)?e:new U0(e)}function VD(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function GD(e){return typeof e=="string"||YD(e)}function YD(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const XD="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",Hx=[],Ix={allowDangerousHtml:!0},JD=/^(https?|ircs?|mailto|xmpp)$/i,ZD=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function QD(e){const t=eA(e),i=tA(e);return nA(t.runSync(t.parse(i),i),e)}function eA(e){const t=e.rehypePlugins||Hx,i=e.remarkPlugins||Hx,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...Ix}:Ix;return WD().use(LR).use(i).use(ED,r).use(t)}function tA(e){const t=e.children||"",i=new U0;return typeof t=="string"&&(i.value=t),i}function nA(e,t){const i=t.allowedElements,r=t.allowElement,l=t.components,c=t.disallowedElements,u=t.skipHtml,d=t.unwrapDisallowed,m=t.urlTransform||iA;for(const v of ZD)Object.hasOwn(t,v.from)&&(""+v.from+(v.to?"use `"+v.to+"` instead":"remove it")+XD+v.id,void 0);return I0(e,f),dE(e,{Fragment:a.Fragment,components:l,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function f(v,_,S){if(v.type==="raw"&&S&&typeof _=="number")return u?S.children.splice(_,1):S.children[_]={type:"text",value:v.value},_;if(v.type==="element"){let x;for(x in lf)if(Object.hasOwn(lf,x)&&Object.hasOwn(v.properties,x)){const b=v.properties[x],C=lf[x];(C===null||C.includes(v.tagName))&&(v.properties[x]=m(String(b||""),x,v))}}if(v.type==="element"){let x=i?!i.includes(v.tagName):c?c.includes(v.tagName):!1;if(!x&&r&&typeof _=="number"&&(x=!r(v,_,S)),x&&S&&typeof _=="number")return d&&v.children?S.children.splice(_,1,...v.children):S.children.splice(_,1),_}}}function iA(e){const t=e.indexOf(":"),i=e.indexOf("?"),r=e.indexOf("#"),l=e.indexOf("/");return t===-1||l!==-1&&t>l||i!==-1&&t>i||r!==-1&&t>r||JD.test(e.slice(0,t))?e:""}function sA({role:e,content:t,thinking:i}){const[r,l]=y.useState(!1);return a.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"flex-start",flexDirection:e==="user"?"row-reverse":"row"},children:[a.jsx("div",{style:{width:"28px",height:"28px",borderRadius:"50%",backgroundColor:e==="user"?"#3b82f6":"#10b981",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",flexShrink:0},children:e==="user"?"":""}),a.jsxs("div",{style:{maxWidth:"calc(100% - 40px)",display:"flex",flexDirection:"column",gap:"8px"},children:[e==="assistant"&&i&&a.jsxs("div",{style:{borderRadius:"8px",backgroundColor:"#fef3c7",border:"1px solid #fcd34d",overflow:"hidden"},children:[a.jsxs("button",{onClick:()=>l(!r),style:{width:"100%",padding:"8px 12px",display:"flex",alignItems:"center",gap:"6px",backgroundColor:"transparent",border:"none",cursor:"pointer",fontSize:"12px",color:"#92400e",fontWeight:500,textAlign:"left"},children:[a.jsx("span",{style:{transform:r?"rotate(90deg)":"rotate(0deg)",transition:"transform 0.2s"},children:""}),a.jsx("span",{children:" AI Thinking"}),a.jsxs("span",{style:{color:"#b45309",fontWeight:400},children:["(",i.length," chars)"]})]}),r&&a.jsx("div",{style:{padding:"8px 12px",borderTop:"1px solid #fcd34d",fontSize:"12px",lineHeight:1.5,color:"#78350f",whiteSpace:"pre-wrap",maxHeight:"200px",overflow:"auto",textAlign:"left"},children:i})]}),a.jsx("div",{style:{padding:"10px 12px",borderRadius:"8px",backgroundColor:e==="user"?"#dbeafe":"#f3f4f6",fontSize:"13px",lineHeight:1.5},children:e==="assistant"?a.jsx("div",{style:{textAlign:"left"},children:a.jsx(QD,{children:t})}):a.jsx("div",{style:{whiteSpace:"pre-wrap",textAlign:"left"},children:t})})]})]})}const _f={role:"assistant",content:`Hi! I'm your AI code review assistant. I can help you:

- **Understand** the code changes in your diff
- **Find issues** like bugs, security problems, or performance concerns
- **Suggest improvements** to make your code better
- **Explain** any part of the code you're curious about

Just ask me anything about your code changes!`};function rA({diffContext:e,provider:t,model:i,providers:r,models:l,onProviderChange:c,onModelChange:u,loading:d,hasFiles:m}){const[f,v]=y.useState([_f]),[_,S]=y.useState(""),[x,b]=y.useState(!1),C=y.useRef(null),T=y.useRef(null),[k,R]=y.useState(!0),N=()=>{k&&C.current?.scrollIntoView({behavior:"smooth"})},E=()=>{const M=T.current;if(M){const{scrollTop:j,scrollHeight:A,clientHeight:D}=M,$=A-j-D<50;R($)}};y.useEffect(()=>{N()},[f,k]);const z=async M=>{if(!M.trim()||x)return;const j=M.trim(),A=[...f,{role:"user",content:j}];v(A),b(!0),R(!0);try{const D=A.filter(H=>H!==_f),$=await fetch("/api/review/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:D,diffContext:e,provider:t,model:i})});if(!$.ok){const H=await $.json();throw new Error(H.error||"Failed to get response")}const W=$.body?.getReader(),ne=new TextDecoder;let U="",P="";if(v(H=>[...H,{role:"assistant",content:"",thinking:""}]),W)for(;;){const{done:H,value:L}=await W.read();if(H)break;const me=ne.decode(L,{stream:!0}).split(`
`);for(const he of me)if(he.startsWith("data: ")){const de=he.slice(6);if(de==="[DONE]")continue;try{const oe=JSON.parse(de);oe.content&&(oe.type==="thinking"?P+=oe.content:U+=oe.content,v(ye=>{const ue=[...ye];return ue[ue.length-1]={role:"assistant",content:U,thinking:P},ue}))}catch{}}}}catch(D){v($=>[...$,{role:"assistant",content:`Error: ${D instanceof Error?D.message:"Unknown error"}`}])}finally{b(!1)}},B=async()=>{if(!_.trim()||x)return;const M=_.trim();S(""),await z(M)},I=async()=>{await z("Review the code changes and point out any issues based on the configured rules.")},q=M=>{M.key==="Enter"&&(M.ctrlKey||M.metaKey)&&(M.preventDefault(),B())},F=()=>{v([_f]),S("")},V=r&&r.length>0,G=f.length>1,Y=x||d;return a.jsxs("div",{style:{width:"400px",borderLeft:"1px solid #e5e5e5",display:"flex",flexDirection:"column",backgroundColor:"#fff"},children:[a.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e5e5e5"},children:[a.jsxs("div",{style:{fontWeight:600,fontSize:"14px",display:"flex",alignItems:"center",gap:"8px",marginBottom:V?"10px":0},children:[a.jsx("span",{children:""}),a.jsx("span",{children:"AI Assistant"})]}),V&&a.jsxs("div",{style:{display:"flex",gap:"8px",alignItems:"center",flexWrap:"wrap"},children:[a.jsx(z2,{providers:r,models:l,selectedProvider:t,selectedModel:i,onProviderChange:c,onModelChange:u}),a.jsx("button",{onClick:I,disabled:Y||!m,style:{padding:"6px 12px",fontSize:"12px",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"4px",cursor:Y||!m?"not-allowed":"pointer",opacity:Y||!m?.7:1},children:Y?"Analyzing...":"Review Code"}),G&&a.jsx("button",{onClick:F,disabled:Y,style:{padding:"6px 12px",fontSize:"12px",backgroundColor:"#6b7280",color:"white",border:"none",borderRadius:"4px",cursor:Y?"not-allowed":"pointer",opacity:Y?.7:1},children:"Clear"})]})]}),a.jsxs("div",{ref:T,onScroll:E,style:{flex:1,overflow:"auto",padding:"12px",display:"flex",flexDirection:"column",gap:"12px"},children:[f.length===0&&a.jsx("div",{style:{color:"#9ca3af",fontSize:"13px",textAlign:"center",padding:"20px"},children:"Ask questions about the code changes..."}),f.map((M,j)=>a.jsx(sA,{role:M.role,content:M.content,thinking:M.thinking},j)),x&&a.jsx("div",{style:{color:"#6b7280",fontSize:"12px",padding:"8px"},children:"Thinking..."}),a.jsx("div",{ref:C})]}),a.jsx("div",{style:{padding:"12px",borderTop:"1px solid #e5e5e5"},children:a.jsxs("div",{style:{display:"flex",gap:"8px"},children:[a.jsx("textarea",{value:_,onChange:M=>S(M.target.value),onKeyDown:q,placeholder:"Ask about the code... (Ctrl+Enter to send)",style:{flex:1,padding:"8px 12px",fontSize:"13px",border:"1px solid #d1d5db",borderRadius:"6px",resize:"none",minHeight:"40px",maxHeight:"100px",fontFamily:"inherit"},rows:1}),a.jsx("button",{onClick:B,disabled:x||!_.trim(),style:{padding:"8px 16px",fontSize:"13px",backgroundColor:"#2196F3",color:"white",border:"none",borderRadius:"6px",cursor:x||!_.trim()?"not-allowed":"pointer",opacity:x||!_.trim()?.7:1},children:"Send"})]})})]})}async function aA(){return(await fetch("/api/review/config")).json()}async function em(e){return(await fetch("/api/review/diff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dir:e})})).json()}async function cu(e,t){const i=await fetch("/api/review/stage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e,dir:t})});if(!i.ok){const r=await i.json();throw new Error(r.error||"Failed to stage file")}}async function Ux(e,t){const i=await fetch("/api/review/unstage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e,dir:t})});if(!i.ok){const r=await i.json();throw new Error(r.error||"Failed to unstage file")}}async function lA(e){const t=await fetch("/api/review/status",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dir:e})});if(!t.ok){const i=await t.json();throw new Error(i.error||"Failed to get git status")}return t.json()}async function oA(e,t,i){const r={message:e,dir:t};i&&(r.user_name=i.name,r.user_email=i.email);const l=await fetch("/api/review/commit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!l.ok){const c=await l.json();throw new Error(c.error||"Failed to commit")}return l.json()}async function cA(e){const t=await fetch("/api/review/branches",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({dir:e})});if(!t.ok){const i=await t.json();throw new Error(i.error||"Failed to list branches")}return t.json()}async function uA(e,t){const i={dir:e};t&&(i.ssh_key=t);const r=await fetch("/api/review/fetch",{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:JSON.stringify(i)});if(!r.ok){const l=await r.json();throw new Error(l.error||"Failed to fetch")}return r}async function hA(e,t){const i={dir:e};t&&(i.ssh_key=t);const r=await fetch("/api/review/push",{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:JSON.stringify(i)});if(!r.ok){const l=await r.json();throw new Error(l.error||"Failed to push")}return r}function dA(e){const i=e.files.filter(l=>!l.isStaged).map(l=>{const c=l.totalLines>0?`${l.totalLines} lines`:"deleted";return`- ${l.path}: ${l.status} (${c})`});return(i.length>0?`File Information:
${i.join(`
`)}

`:"")+e.workingTreeDiff}function fA(){const[e,t]=y.useState(""),[i,r]=y.useState(!1),[l,c]=y.useState(null),[u,d]=y.useState(null),[m,f]=y.useState(null),[v,_]=y.useState([]),[S,x]=y.useState([]),[b,C]=y.useState(""),[T,k]=y.useState("");y.useEffect(()=>{(async()=>{try{const I=await aA();if(I.providers&&_(I.providers),I.models&&x(I.models),I.defaultProvider?C(I.defaultProvider):I.providers&&I.providers.length>0&&C(I.providers[0].name),I.defaultModel?k(I.defaultModel):I.models&&I.models.length>0&&k(I.models[0].model),I.initialDir){t(I.initialDir),r(!0);const q=await em(I.initialDir);q.error||(c(q),q.files&&q.files.length>0&&d(q.files[0]))}}catch(I){console.error("Failed to load initial config:",I)}finally{r(!1)}})()},[]);const R=async()=>{r(!0),f(null);try{const B=await em(e||void 0);B.error?(f(B.error),c(null),d(null)):(c(B),(!u||!B.files?.some(I=>I.path===u.path))&&(B.files&&B.files.length>0?d(B.files[0]):d(null)))}catch(B){f(`Failed to get diff: ${B}`)}finally{r(!1)}},N=async B=>{try{await cu(B.path,e||void 0),R()}catch(I){f(`Failed to stage file: ${I}`)}},E=async B=>{try{await cu(B,e||void 0),R()}catch(I){f(`Failed to stage directory: ${I}`)}},z=l&&l.files&&l.files.length>0;return a.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[a.jsx(yN,{dir:e,onDirChange:t,loading:i,onRefresh:R}),m&&a.jsxs("div",{style:{padding:"12px 20px",backgroundColor:"#fef2f2",borderBottom:"1px solid #fecaca",color:"#dc2626",fontSize:"13px"},children:[a.jsx("strong",{children:"Error:"})," ",m]}),a.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[a.jsx(NN,{diffResult:l,selectedFile:u,onSelectFile:d,loading:i,onStageFile:N,onStageDir:E}),a.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:a.jsx(O2,{selectedFile:u})}),a.jsx(rA,{diffContext:l?dA(l):"",provider:b,model:T,providers:v,models:S,onProviderChange:C,onModelChange:k,loading:i,hasFiles:!!z})]})]})}var F0=Object.defineProperty,mA=Object.getOwnPropertyDescriptor,pA=(e,t)=>{for(var i in t)F0(e,i,{get:t[i],enumerable:!0})},_t=(e,t,i,r)=>{for(var l=r>1?void 0:r?mA(t,i):t,c=e.length-1,u;c>=0;c--)(u=e[c])&&(l=(r?u(t,i,l):u(l))||l);return r&&l&&F0(t,i,l),l},_e=(e,t)=>(i,r)=>t(i,r,e),Fx="Terminal input",tm={get:()=>Fx,set:e=>Fx=e},$x="Too much output to announce, navigate to rows manually to read",nm={get:()=>$x,set:e=>$x=e};function gA(e){return e.replace(/\r?\n/g,"\r")}function vA(e,t){return t?"\x1B[200~"+e+"\x1B[201~":e}function _A(e,t){e.clipboardData&&e.clipboardData.setData("text/plain",t.selectionText),e.preventDefault()}function yA(e,t,i,r){if(e.stopPropagation(),e.clipboardData){let l=e.clipboardData.getData("text/plain");$0(l,t,i,r)}}function $0(e,t,i,r){e=gA(e),e=vA(e,i.decPrivateModes.bracketedPasteMode&&r.rawOptions.ignoreBracketedPasteMode!==!0),i.triggerDataEvent(e,!0),t.value=""}function K0(e,t,i){let r=i.getBoundingClientRect(),l=e.clientX-r.left-10,c=e.clientY-r.top-10;t.style.width="20px",t.style.height="20px",t.style.left=`${l}px`,t.style.top=`${c}px`,t.style.zIndex="1000",t.focus()}function Kx(e,t,i,r,l){K0(e,t,i),l&&r.rightClickSelect(e),t.value=r.selectionText,t.select()}function Ls(e){return e>65535?(e-=65536,String.fromCharCode((e>>10)+55296)+String.fromCharCode(e%1024+56320)):String.fromCharCode(e)}function Eu(e,t=0,i=e.length){let r="";for(let l=t;l<i;++l){let c=e[l];c>65535?(c-=65536,r+=String.fromCharCode((c>>10)+55296)+String.fromCharCode(c%1024+56320)):r+=String.fromCharCode(c)}return r}var xA=class{constructor(){this._interim=0}clear(){this._interim=0}decode(e,t){let i=e.length;if(!i)return 0;let r=0,l=0;if(this._interim){let c=e.charCodeAt(l++);56320<=c&&c<=57343?t[r++]=(this._interim-55296)*1024+c-56320+65536:(t[r++]=this._interim,t[r++]=c),this._interim=0}for(let c=l;c<i;++c){let u=e.charCodeAt(c);if(55296<=u&&u<=56319){if(++c>=i)return this._interim=u,r;let d=e.charCodeAt(c);56320<=d&&d<=57343?t[r++]=(u-55296)*1024+d-56320+65536:(t[r++]=u,t[r++]=d);continue}u!==65279&&(t[r++]=u)}return r}},SA=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(e,t){let i=e.length;if(!i)return 0;let r=0,l,c,u,d,m=0,f=0;if(this.interim[0]){let S=!1,x=this.interim[0];x&=(x&224)===192?31:(x&240)===224?15:7;let b=0,C;for(;(C=this.interim[++b]&63)&&b<4;)x<<=6,x|=C;let T=(this.interim[0]&224)===192?2:(this.interim[0]&240)===224?3:4,k=T-b;for(;f<k;){if(f>=i)return 0;if(C=e[f++],(C&192)!==128){f--,S=!0;break}else this.interim[b++]=C,x<<=6,x|=C&63}S||(T===2?x<128?f--:t[r++]=x:T===3?x<2048||x>=55296&&x<=57343||x===65279||(t[r++]=x):x<65536||x>1114111||(t[r++]=x)),this.interim.fill(0)}let v=i-4,_=f;for(;_<i;){for(;_<v&&!((l=e[_])&128)&&!((c=e[_+1])&128)&&!((u=e[_+2])&128)&&!((d=e[_+3])&128);)t[r++]=l,t[r++]=c,t[r++]=u,t[r++]=d,_+=4;if(l=e[_++],l<128)t[r++]=l;else if((l&224)===192){if(_>=i)return this.interim[0]=l,r;if(c=e[_++],(c&192)!==128){_--;continue}if(m=(l&31)<<6|c&63,m<128){_--;continue}t[r++]=m}else if((l&240)===224){if(_>=i)return this.interim[0]=l,r;if(c=e[_++],(c&192)!==128){_--;continue}if(_>=i)return this.interim[0]=l,this.interim[1]=c,r;if(u=e[_++],(u&192)!==128){_--;continue}if(m=(l&15)<<12|(c&63)<<6|u&63,m<2048||m>=55296&&m<=57343||m===65279)continue;t[r++]=m}else if((l&248)===240){if(_>=i)return this.interim[0]=l,r;if(c=e[_++],(c&192)!==128){_--;continue}if(_>=i)return this.interim[0]=l,this.interim[1]=c,r;if(u=e[_++],(u&192)!==128){_--;continue}if(_>=i)return this.interim[0]=l,this.interim[1]=c,this.interim[2]=u,r;if(d=e[_++],(d&192)!==128){_--;continue}if(m=(l&7)<<18|(c&63)<<12|(u&63)<<6|d&63,m<65536||m>1114111)continue;t[r++]=m}}return r}},q0="",Ms=" ",mo=class W0{constructor(){this.fg=0,this.bg=0,this.extended=new uu}static toColorRGB(t){return[t>>>16&255,t>>>8&255,t&255]}static fromColorRGB(t){return(t[0]&255)<<16|(t[1]&255)<<8|t[2]&255}clone(){let t=new W0;return t.fg=this.fg,t.bg=this.bg,t.extended=this.extended.clone(),t}isInverse(){return this.fg&67108864}isBold(){return this.fg&134217728}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:this.fg&268435456}isBlink(){return this.fg&536870912}isInvisible(){return this.fg&1073741824}isItalic(){return this.bg&67108864}isDim(){return this.bg&134217728}isStrikethrough(){return this.fg&2147483648}isProtected(){return this.bg&536870912}isOverline(){return this.bg&1073741824}getFgColorMode(){return this.fg&50331648}getBgColorMode(){return this.bg&50331648}isFgRGB(){return(this.fg&50331648)===50331648}isBgRGB(){return(this.bg&50331648)===50331648}isFgPalette(){return(this.fg&50331648)===16777216||(this.fg&50331648)===33554432}isBgPalette(){return(this.bg&50331648)===16777216||(this.bg&50331648)===33554432}isFgDefault(){return(this.fg&50331648)===0}isBgDefault(){return(this.bg&50331648)===0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(this.fg&50331648){case 16777216:case 33554432:return this.fg&255;case 50331648:return this.fg&16777215;default:return-1}}getBgColor(){switch(this.bg&50331648){case 16777216:case 33554432:return this.bg&255;case 50331648:return this.bg&16777215;default:return-1}}hasExtendedAttrs(){return this.bg&268435456}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(this.bg&268435456&&~this.extended.underlineColor)switch(this.extended.underlineColor&50331648){case 16777216:case 33554432:return this.extended.underlineColor&255;case 50331648:return this.extended.underlineColor&16777215;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return this.bg&268435456&&~this.extended.underlineColor?this.extended.underlineColor&50331648:this.getFgColorMode()}isUnderlineColorRGB(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===50331648:this.isFgRGB()}isUnderlineColorPalette(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===16777216||(this.extended.underlineColor&50331648)===33554432:this.isFgPalette()}isUnderlineColorDefault(){return this.bg&268435456&&~this.extended.underlineColor?(this.extended.underlineColor&50331648)===0:this.isFgDefault()}getUnderlineStyle(){return this.fg&268435456?this.bg&268435456?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}},uu=class V0{constructor(t=0,i=0){this._ext=0,this._urlId=0,this._ext=t,this._urlId=i}get ext(){return this._urlId?this._ext&-469762049|this.underlineStyle<<26:this._ext}set ext(t){this._ext=t}get underlineStyle(){return this._urlId?5:(this._ext&469762048)>>26}set underlineStyle(t){this._ext&=-469762049,this._ext|=t<<26&469762048}get underlineColor(){return this._ext&67108863}set underlineColor(t){this._ext&=-67108864,this._ext|=t&67108863}get urlId(){return this._urlId}set urlId(t){this._urlId=t}get underlineVariantOffset(){let t=(this._ext&3758096384)>>29;return t<0?t^4294967288:t}set underlineVariantOffset(t){this._ext&=536870911,this._ext|=t<<29&3758096384}clone(){return new V0(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}},ti=class G0 extends mo{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new uu,this.combinedData=""}static fromCharData(t){let i=new G0;return i.setFromCharData(t),i}isCombined(){return this.content&2097152}getWidth(){return this.content>>22}getChars(){return this.content&2097152?this.combinedData:this.content&2097151?Ls(this.content&2097151):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):this.content&2097151}setFromCharData(t){this.fg=t[0],this.bg=0;let i=!1;if(t[1].length>2)i=!0;else if(t[1].length===2){let r=t[1].charCodeAt(0);if(55296<=r&&r<=56319){let l=t[1].charCodeAt(1);56320<=l&&l<=57343?this.content=(r-55296)*1024+l-56320+65536|t[2]<<22:i=!0}else i=!0}else this.content=t[1].charCodeAt(0)|t[2]<<22;i&&(this.combinedData=t[1],this.content=2097152|t[2]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},qx="di$target",im="di$dependencies",yf=new Map;function bA(e){return e[im]||[]}function $t(e){if(yf.has(e))return yf.get(e);let t=function(i,r,l){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");wA(t,i,l)};return t._id=e,yf.set(e,t),t}function wA(e,t,i){t[qx]===t?t[im].push({id:e,index:i}):(t[im]=[{id:e,index:i}],t[qx]=t)}var ln=$t("BufferService"),Y0=$t("CoreMouseService"),yr=$t("CoreService"),CA=$t("CharsetService"),fp=$t("InstantiationService"),X0=$t("LogService"),on=$t("OptionsService"),J0=$t("OscLinkService"),jA=$t("UnicodeService"),po=$t("DecorationService"),sm=class{constructor(e,t,i){this._bufferService=e,this._optionsService=t,this._oscLinkService=i}provideLinks(e,t){let i=this._bufferService.buffer.lines.get(e-1);if(!i){t(void 0);return}let r=[],l=this._optionsService.rawOptions.linkHandler,c=new ti,u=i.getTrimmedLength(),d=-1,m=-1,f=!1;for(let v=0;v<u;v++)if(!(m===-1&&!i.hasContent(v))){if(i.loadCell(v,c),c.hasExtendedAttrs()&&c.extended.urlId)if(m===-1){m=v,d=c.extended.urlId;continue}else f=c.extended.urlId!==d;else m!==-1&&(f=!0);if(f||m!==-1&&v===u-1){let _=this._oscLinkService.getLinkData(d)?.uri;if(_){let S={start:{x:m+1,y:e},end:{x:v+(!f&&v===u-1?1:0),y:e}},x=!1;if(!l?.allowNonHttpProtocols)try{let b=new URL(_);["http:","https:"].includes(b.protocol)||(x=!0)}catch{x=!0}x||r.push({text:_,range:S,activate:(b,C)=>l?l.activate(b,C,S):kA(b,C),hover:(b,C)=>l?.hover?.(b,C,S),leave:(b,C)=>l?.leave?.(b,C,S)})}f=!1,c.hasExtendedAttrs()&&c.extended.urlId?(m=v,d=c.extended.urlId):(m=-1,d=-1)}}t(r)}};sm=_t([_e(0,ln),_e(1,on),_e(2,J0)],sm);function kA(e,t){if(confirm(`Do you want to navigate to ${t}?

WARNING: This link could potentially be dangerous`)){let i=window.open();if(i){try{i.opener=null}catch{}i.location.href=t}else console.warn("Opening link blocked as opener could not be cleared")}}var Tu=$t("CharSizeService"),ts=$t("CoreBrowserService"),mp=$t("MouseService"),ns=$t("RenderService"),NA=$t("SelectionService"),Z0=$t("CharacterJoinerService"),Ra=$t("ThemeService"),Q0=$t("LinkProviderService"),EA=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?Wx.isErrorNoTelemetry(e)?new Wx(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(t=>{t(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},TA=new EA;function Zc(e){RA(e)||TA.onUnexpectedError(e)}var rm="Canceled";function RA(e){return e instanceof DA?!0:e instanceof Error&&e.name===rm&&e.message===rm}var DA=class extends Error{constructor(){super(rm),this.name=this.message}};function AA(e){return new Error(`Illegal argument: ${e}`)}var Wx=class am extends Error{constructor(t){super(t),this.name="CodeExpectedError"}static fromError(t){if(t instanceof am)return t;let i=new am;return i.message=t.message,i.stack=t.stack,i}static isErrorNoTelemetry(t){return t.name==="CodeExpectedError"}},lm=class e1 extends Error{constructor(t){super(t||"An unexpected bug occurred."),Object.setPrototypeOf(this,e1.prototype)}};function Rn(e,t=0){return e[e.length-(1+t)]}var LA;(e=>{function t(c){return c<0}e.isLessThan=t;function i(c){return c<=0}e.isLessThanOrEqual=i;function r(c){return c>0}e.isGreaterThan=r;function l(c){return c===0}e.isNeitherLessOrGreaterThan=l,e.greaterThan=1,e.lessThan=-1,e.neitherLessOrGreaterThan=0})(LA||={});function MA(e,t){let i=this,r=!1,l;return function(){return r||(r=!0,t||(l=e.apply(i,arguments))),l}}var t1;(e=>{function t(E){return E&&typeof E=="object"&&typeof E[Symbol.iterator]=="function"}e.is=t;let i=Object.freeze([]);function r(){return i}e.empty=r;function*l(E){yield E}e.single=l;function c(E){return t(E)?E:l(E)}e.wrap=c;function u(E){return E||i}e.from=u;function*d(E){for(let z=E.length-1;z>=0;z--)yield E[z]}e.reverse=d;function m(E){return!E||E[Symbol.iterator]().next().done===!0}e.isEmpty=m;function f(E){return E[Symbol.iterator]().next().value}e.first=f;function v(E,z){let B=0;for(let I of E)if(z(I,B++))return!0;return!1}e.some=v;function _(E,z){for(let B of E)if(z(B))return B}e.find=_;function*S(E,z){for(let B of E)z(B)&&(yield B)}e.filter=S;function*x(E,z){let B=0;for(let I of E)yield z(I,B++)}e.map=x;function*b(E,z){let B=0;for(let I of E)yield*z(I,B++)}e.flatMap=b;function*C(...E){for(let z of E)yield*z}e.concat=C;function T(E,z,B){let I=B;for(let q of E)I=z(I,q);return I}e.reduce=T;function*k(E,z,B=E.length){for(z<0&&(z+=E.length),B<0?B+=E.length:B>E.length&&(B=E.length);z<B;z++)yield E[z]}e.slice=k;function R(E,z=Number.POSITIVE_INFINITY){let B=[];if(z===0)return[B,E];let I=E[Symbol.iterator]();for(let q=0;q<z;q++){let F=I.next();if(F.done)return[B,e.empty()];B.push(F.value)}return[B,{[Symbol.iterator](){return I}}]}e.consume=R;async function N(E){let z=[];for await(let B of E)z.push(B);return Promise.resolve(z)}e.asyncToArray=N})(t1||={});function gr(e){if(t1.is(e)){let t=[];for(let i of e)if(i)try{i.dispose()}catch(r){t.push(r)}if(t.length===1)throw t[0];if(t.length>1)throw new AggregateError(t,"Encountered errors while disposing of store");return Array.isArray(e)?[]:e}else if(e)return e.dispose(),e}function BA(...e){return ht(()=>gr(e))}function ht(e){return{dispose:MA(()=>{e()})}}var n1=class i1{constructor(){this._toDispose=new Set,this._isDisposed=!1}dispose(){this._isDisposed||(this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{gr(this._toDispose)}finally{this._toDispose.clear()}}add(t){if(!t)return t;if(t===this)throw new Error("Cannot register a disposable on itself!");return this._isDisposed?i1.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(t),t}delete(t){if(t){if(t===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(t),t.dispose()}}deleteAndLeak(t){t&&this._toDispose.has(t)&&(this._toDispose.delete(t),void 0)}};n1.DISABLE_DISPOSED_WARNING=!1;var zs=n1,Be=class{constructor(){this._store=new zs,this._store}dispose(){this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}};Be.None=Object.freeze({dispose(){}});var ba=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e}},Ji=typeof window=="object"?window:globalThis,om=class cm{constructor(t){this.element=t,this.next=cm.Undefined,this.prev=cm.Undefined}};om.Undefined=new om(void 0);var ft=om,Vx=class{constructor(){this._first=ft.Undefined,this._last=ft.Undefined,this._size=0}get size(){return this._size}isEmpty(){return this._first===ft.Undefined}clear(){let e=this._first;for(;e!==ft.Undefined;){let t=e.next;e.prev=ft.Undefined,e.next=ft.Undefined,e=t}this._first=ft.Undefined,this._last=ft.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,t){let i=new ft(e);if(this._first===ft.Undefined)this._first=i,this._last=i;else if(t){let l=this._last;this._last=i,i.prev=l,l.next=i}else{let l=this._first;this._first=i,i.next=l,l.prev=i}this._size+=1;let r=!1;return()=>{r||(r=!0,this._remove(i))}}shift(){if(this._first!==ft.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==ft.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==ft.Undefined&&e.next!==ft.Undefined){let t=e.prev;t.next=e.next,e.next.prev=t}else e.prev===ft.Undefined&&e.next===ft.Undefined?(this._first=ft.Undefined,this._last=ft.Undefined):e.next===ft.Undefined?(this._last=this._last.prev,this._last.next=ft.Undefined):e.prev===ft.Undefined&&(this._first=this._first.next,this._first.prev=ft.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==ft.Undefined;)yield e.element,e=e.next}},OA=globalThis.performance&&typeof globalThis.performance.now=="function",zA=class s1{static create(t){return new s1(t)}constructor(t){this._now=OA&&t===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}},Xt;(e=>{e.None=()=>Be.None;function t(Y,M){return _(Y,()=>{},0,void 0,!0,void 0,M)}e.defer=t;function i(Y){return(M,j=null,A)=>{let D=!1,$;return $=Y(W=>{if(!D)return $?$.dispose():D=!0,M.call(j,W)},null,A),D&&$.dispose(),$}}e.once=i;function r(Y,M,j){return f((A,D=null,$)=>Y(W=>A.call(D,M(W)),null,$),j)}e.map=r;function l(Y,M,j){return f((A,D=null,$)=>Y(W=>{M(W),A.call(D,W)},null,$),j)}e.forEach=l;function c(Y,M,j){return f((A,D=null,$)=>Y(W=>M(W)&&A.call(D,W),null,$),j)}e.filter=c;function u(Y){return Y}e.signal=u;function d(...Y){return(M,j=null,A)=>{let D=BA(...Y.map($=>$(W=>M.call(j,W))));return v(D,A)}}e.any=d;function m(Y,M,j,A){let D=j;return r(Y,$=>(D=M(D,$),D),A)}e.reduce=m;function f(Y,M){let j,A={onWillAddFirstListener(){j=Y(D.fire,D)},onDidRemoveLastListener(){j?.dispose()}},D=new ge(A);return M?.add(D),D.event}function v(Y,M){return M instanceof Array?M.push(Y):M&&M.add(Y),Y}function _(Y,M,j=100,A=!1,D=!1,$,W){let ne,U,P,H=0,L,re={leakWarningThreshold:$,onWillAddFirstListener(){ne=Y(he=>{H++,U=M(U,he),A&&!P&&(me.fire(U),U=void 0),L=()=>{let de=U;U=void 0,P=void 0,(!A||H>1)&&me.fire(de),H=0},typeof j=="number"?(clearTimeout(P),P=setTimeout(L,j)):P===void 0&&(P=0,queueMicrotask(L))})},onWillRemoveListener(){D&&H>0&&L?.()},onDidRemoveLastListener(){L=void 0,ne.dispose()}},me=new ge(re);return W?.add(me),me.event}e.debounce=_;function S(Y,M=0,j){return e.debounce(Y,(A,D)=>A?(A.push(D),A):[D],M,void 0,!0,void 0,j)}e.accumulate=S;function x(Y,M=(A,D)=>A===D,j){let A=!0,D;return c(Y,$=>{let W=A||!M($,D);return A=!1,D=$,W},j)}e.latch=x;function b(Y,M,j){return[e.filter(Y,M,j),e.filter(Y,A=>!M(A),j)]}e.split=b;function C(Y,M=!1,j=[],A){let D=j.slice(),$=Y(U=>{D?D.push(U):ne.fire(U)});A&&A.add($);let W=()=>{D?.forEach(U=>ne.fire(U)),D=null},ne=new ge({onWillAddFirstListener(){$||($=Y(U=>ne.fire(U)),A&&A.add($))},onDidAddFirstListener(){D&&(M?setTimeout(W):W())},onDidRemoveLastListener(){$&&$.dispose(),$=null}});return A&&A.add(ne),ne.event}e.buffer=C;function T(Y,M){return(j,A,D)=>{let $=M(new R);return Y(function(W){let ne=$.evaluate(W);ne!==k&&j.call(A,ne)},void 0,D)}}e.chain=T;let k=Symbol("HaltChainable");class R{constructor(){this.steps=[]}map(M){return this.steps.push(M),this}forEach(M){return this.steps.push(j=>(M(j),j)),this}filter(M){return this.steps.push(j=>M(j)?j:k),this}reduce(M,j){let A=j;return this.steps.push(D=>(A=M(A,D),A)),this}latch(M=(j,A)=>j===A){let j=!0,A;return this.steps.push(D=>{let $=j||!M(D,A);return j=!1,A=D,$?D:k}),this}evaluate(M){for(let j of this.steps)if(M=j(M),M===k)break;return M}}function N(Y,M,j=A=>A){let A=(...ne)=>W.fire(j(...ne)),D=()=>Y.on(M,A),$=()=>Y.removeListener(M,A),W=new ge({onWillAddFirstListener:D,onDidRemoveLastListener:$});return W.event}e.fromNodeEventEmitter=N;function E(Y,M,j=A=>A){let A=(...ne)=>W.fire(j(...ne)),D=()=>Y.addEventListener(M,A),$=()=>Y.removeEventListener(M,A),W=new ge({onWillAddFirstListener:D,onDidRemoveLastListener:$});return W.event}e.fromDOMEventEmitter=E;function z(Y){return new Promise(M=>i(Y)(M))}e.toPromise=z;function B(Y){let M=new ge;return Y.then(j=>{M.fire(j)},()=>{M.fire(void 0)}).finally(()=>{M.dispose()}),M.event}e.fromPromise=B;function I(Y,M){return Y(j=>M.fire(j))}e.forward=I;function q(Y,M,j){return M(j),Y(A=>M(A))}e.runAndSubscribe=q;class F{constructor(M,j){this._observable=M,this._counter=0,this._hasChanged=!1;let A={onWillAddFirstListener:()=>{M.addObserver(this)},onDidRemoveLastListener:()=>{M.removeObserver(this)}};this.emitter=new ge(A),j&&j.add(this.emitter)}beginUpdate(M){this._counter++}handlePossibleChange(M){}handleChange(M,j){this._hasChanged=!0}endUpdate(M){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function V(Y,M){return new F(Y,M).emitter.event}e.fromObservable=V;function G(Y){return(M,j,A)=>{let D=0,$=!1,W={beginUpdate(){D++},endUpdate(){D--,D===0&&(Y.reportChanges(),$&&($=!1,M.call(j)))},handlePossibleChange(){},handleChange(){$=!0}};Y.addObserver(W),Y.reportChanges();let ne={dispose(){Y.removeObserver(W)}};return A instanceof zs?A.add(ne):Array.isArray(A)&&A.push(ne),ne}}e.fromObservableLight=G})(Xt||={});var um=class hm{constructor(t){this.listenerCount=0,this.invocationCount=0,this.elapsedOverall=0,this.durations=[],this.name=`${t}_${hm._idPool++}`,hm.all.add(this)}start(t){this._stopWatch=new zA,this.listenerCount=t}stop(){if(this._stopWatch){let t=this._stopWatch.elapsed();this.durations.push(t),this.elapsedOverall+=t,this.invocationCount+=1,this._stopWatch=void 0}}};um.all=new Set,um._idPool=0;var PA=um,HA=-1,r1=class a1{constructor(t,i,r=(a1._idPool++).toString(16).padStart(3,"0")){this._errorHandler=t,this.threshold=i,this.name=r,this._warnCountdown=0}dispose(){this._stacks?.clear()}check(t,i){let r=this.threshold;if(r<=0||i<r)return;this._stacks||(this._stacks=new Map);let l=this._stacks.get(t.value)||0;if(this._stacks.set(t.value,l+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=r*.5;let[c,u]=this.getMostFrequentStack(),d=`[${this.name}] potential listener LEAK detected, having ${i} listeners already. MOST frequent listener (${u}):`;console.warn(d),console.warn(c);let m=new FA(d,c);this._errorHandler(m)}return()=>{let c=this._stacks.get(t.value)||0;this._stacks.set(t.value,c-1)}}getMostFrequentStack(){if(!this._stacks)return;let t,i=0;for(let[r,l]of this._stacks)(!t||i<l)&&(t=[r,l],i=l);return t}};r1._idPool=1;var IA=r1,UA=class l1{constructor(t){this.value=t}static create(){let t=new Error;return new l1(t.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},FA=class extends Error{constructor(e,t){super(e),this.name="ListenerLeakError",this.stack=t}},$A=class extends Error{constructor(e,t){super(e),this.name="ListenerRefusalError",this.stack=t}},KA=0,xf=class{constructor(e){this.value=e,this.id=KA++}},qA=2,WA,ge=class{constructor(e){this._size=0,this._options=e,this._leakageMon=this._options?.leakWarningThreshold?new IA(e?.onListenerError??Zc,this._options?.leakWarningThreshold??HA):void 0,this._perfMon=this._options?._profName?new PA(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){this._disposed||(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners&&(this._listeners=void 0,this._size=0),this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose())}get event(){return this._event??=(e,t,i)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let u=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(u);let d=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],m=new $A(`${u}. HINT: Stack shows most frequent listener (${d[1]}-times)`,d[0]);return(this._options?.onListenerError||Zc)(m),Be.None}if(this._disposed)return Be.None;t&&(e=e.bind(t));let r=new xf(e),l;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(r.stack=UA.create(),l=this._leakageMon.check(r.stack,this._size+1)),this._listeners?this._listeners instanceof xf?(this._deliveryQueue??=new VA,this._listeners=[this._listeners,r]):this._listeners.push(r):(this._options?.onWillAddFirstListener?.(this),this._listeners=r,this._options?.onDidAddFirstListener?.(this)),this._size++;let c=ht(()=>{l?.(),this._removeListener(r)});return i instanceof zs?i.add(c):Array.isArray(i)&&i.push(c),c},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let t=this._listeners,i=t.indexOf(e);if(i===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,t[i]=void 0;let r=this._deliveryQueue.current===this;if(this._size*qA<=t.length){let l=0;for(let c=0;c<t.length;c++)t[c]?t[l++]=t[c]:r&&(this._deliveryQueue.end--,l<this._deliveryQueue.i&&this._deliveryQueue.i--);t.length=l}}_deliver(e,t){if(!e)return;let i=this._options?.onListenerError||Zc;if(!i){e.value(t);return}try{e.value(t)}catch(r){i(r)}}_deliverQueue(e){let t=e.current._listeners;for(;e.i<e.end;)this._deliver(t[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof xf)this._deliver(this._listeners,e);else{let t=this._deliveryQueue;t.enqueue(this,e,this._listeners.length),this._deliverQueue(t)}this._perfMon?.stop()}hasListeners(){return this._size>0}},VA=class{constructor(){this.i=-1,this.end=0}enqueue(e,t,i){this.i=0,this.end=i,this.current=e,this.value=t}reset(){this.i=this.end,this.current=void 0,this.value=void 0}},dm=class{constructor(){this.mapWindowIdToZoomLevel=new Map,this._onDidChangeZoomLevel=new ge,this.onDidChangeZoomLevel=this._onDidChangeZoomLevel.event,this.mapWindowIdToZoomFactor=new Map,this._onDidChangeFullscreen=new ge,this.onDidChangeFullscreen=this._onDidChangeFullscreen.event,this.mapWindowIdToFullScreen=new Map}getZoomLevel(t){return this.mapWindowIdToZoomLevel.get(this.getWindowId(t))??0}setZoomLevel(t,i){if(this.getZoomLevel(i)===t)return;let r=this.getWindowId(i);this.mapWindowIdToZoomLevel.set(r,t),this._onDidChangeZoomLevel.fire(r)}getZoomFactor(t){return this.mapWindowIdToZoomFactor.get(this.getWindowId(t))??1}setZoomFactor(t,i){this.mapWindowIdToZoomFactor.set(this.getWindowId(i),t)}setFullscreen(t,i){if(this.isFullscreen(i)===t)return;let r=this.getWindowId(i);this.mapWindowIdToFullScreen.set(r,t),this._onDidChangeFullscreen.fire(r)}isFullscreen(t){return!!this.mapWindowIdToFullScreen.get(this.getWindowId(t))}getWindowId(t){return t.vscodeWindowId}};dm.INSTANCE=new dm;var pp=dm;function GA(e,t,i){typeof t=="string"&&(t=e.matchMedia(t)),t.addEventListener("change",i)}pp.INSTANCE.onDidChangeZoomLevel;function YA(e){return pp.INSTANCE.getZoomFactor(e)}pp.INSTANCE.onDidChangeFullscreen;var Da=typeof navigator=="object"?navigator.userAgent:"",fm=Da.indexOf("Firefox")>=0,XA=Da.indexOf("AppleWebKit")>=0,gp=Da.indexOf("Chrome")>=0,JA=!gp&&Da.indexOf("Safari")>=0;Da.indexOf("Electron/")>=0;Da.indexOf("Android")>=0;var Sf=!1;if(typeof Ji.matchMedia=="function"){let e=Ji.matchMedia("(display-mode: standalone) or (display-mode: window-controls-overlay)"),t=Ji.matchMedia("(display-mode: fullscreen)");Sf=e.matches,GA(Ji,e,({matches:i})=>{Sf&&t.matches||(Sf=i)})}var ga="en",mm=!1,pm=!1,Qc=!1,o1=!1,Uc,eu=ga,Gx=ga,ZA,Xi,mr=globalThis,Mn;typeof mr.vscode<"u"&&typeof mr.vscode.process<"u"?Mn=mr.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(Mn=process);var QA=typeof Mn?.versions?.electron=="string",e3=QA&&Mn?.type==="renderer";if(typeof Mn=="object"){mm=Mn.platform==="win32",pm=Mn.platform==="darwin",Qc=Mn.platform==="linux",Qc&&Mn.env.SNAP&&Mn.env.SNAP_REVISION,Mn.env.CI||Mn.env.BUILD_ARTIFACTSTAGINGDIRECTORY,Uc=ga,eu=ga;let e=Mn.env.VSCODE_NLS_CONFIG;if(e)try{let t=JSON.parse(e);Uc=t.userLocale,Gx=t.osLocale,eu=t.resolvedLanguage||ga,ZA=t.languagePack?.translationsConfigFile}catch{}o1=!0}else typeof navigator=="object"&&!e3?(Xi=navigator.userAgent,mm=Xi.indexOf("Windows")>=0,pm=Xi.indexOf("Macintosh")>=0,(Xi.indexOf("Macintosh")>=0||Xi.indexOf("iPad")>=0||Xi.indexOf("iPhone")>=0)&&navigator.maxTouchPoints&&navigator.maxTouchPoints>0,Qc=Xi.indexOf("Linux")>=0,Xi?.indexOf("Mobi")>=0,eu=globalThis._VSCODE_NLS_LANGUAGE||ga,Uc=navigator.language.toLowerCase(),Gx=Uc):console.error("Unable to resolve platform.");var c1=mm,ki=pm,t3=Qc,Yx=o1,Ti=Xi,Ts=eu,n3;(e=>{function t(){return Ts}e.value=t;function i(){return Ts.length===2?Ts==="en":Ts.length>=3?Ts[0]==="e"&&Ts[1]==="n"&&Ts[2]==="-":!1}e.isDefaultVariant=i;function r(){return Ts==="en"}e.isDefault=r})(n3||={});var i3=typeof mr.postMessage=="function"&&!mr.importScripts;(()=>{if(i3){let e=[];mr.addEventListener("message",i=>{if(i.data&&i.data.vscodeScheduleAsyncWork)for(let r=0,l=e.length;r<l;r++){let c=e[r];if(c.id===i.data.vscodeScheduleAsyncWork){e.splice(r,1),c.callback();return}}});let t=0;return i=>{let r=++t;e.push({id:r,callback:i}),mr.postMessage({vscodeScheduleAsyncWork:r},"*")}}return e=>setTimeout(e)})();var s3=!!(Ti&&Ti.indexOf("Chrome")>=0);Ti&&Ti.indexOf("Firefox")>=0;!s3&&Ti&&Ti.indexOf("Safari")>=0;Ti&&Ti.indexOf("Edg/")>=0;Ti&&Ti.indexOf("Android")>=0;var ua=typeof navigator=="object"?navigator:{};Yx||document.queryCommandSupported&&document.queryCommandSupported("copy")||ua&&ua.clipboard&&ua.clipboard.writeText,Yx||ua&&ua.clipboard&&ua.clipboard.readText;var vp=class{constructor(){this._keyCodeToStr=[],this._strToKeyCode=Object.create(null)}define(e,t){this._keyCodeToStr[e]=t,this._strToKeyCode[t.toLowerCase()]=e}keyCodeToStr(e){return this._keyCodeToStr[e]}strToKeyCode(e){return this._strToKeyCode[e.toLowerCase()]||0}},bf=new vp,Xx=new vp,Jx=new vp,r3=new Array(230),u1;(e=>{function t(d){return bf.keyCodeToStr(d)}e.toString=t;function i(d){return bf.strToKeyCode(d)}e.fromString=i;function r(d){return Xx.keyCodeToStr(d)}e.toUserSettingsUS=r;function l(d){return Jx.keyCodeToStr(d)}e.toUserSettingsGeneral=l;function c(d){return Xx.strToKeyCode(d)||Jx.strToKeyCode(d)}e.fromUserSettings=c;function u(d){if(d>=98&&d<=113)return null;switch(d){case 16:return"Up";case 18:return"Down";case 15:return"Left";case 17:return"Right"}return bf.keyCodeToStr(d)}e.toElectronAccelerator=u})(u1||={});var a3=class h1{constructor(t,i,r,l,c){this.ctrlKey=t,this.shiftKey=i,this.altKey=r,this.metaKey=l,this.keyCode=c}equals(t){return t instanceof h1&&this.ctrlKey===t.ctrlKey&&this.shiftKey===t.shiftKey&&this.altKey===t.altKey&&this.metaKey===t.metaKey&&this.keyCode===t.keyCode}getHashCode(){let t=this.ctrlKey?"1":"0",i=this.shiftKey?"1":"0",r=this.altKey?"1":"0",l=this.metaKey?"1":"0";return`K${t}${i}${r}${l}${this.keyCode}`}isModifierKey(){return this.keyCode===0||this.keyCode===5||this.keyCode===57||this.keyCode===6||this.keyCode===4}toKeybinding(){return new l3([this])}isDuplicateModifierCase(){return this.ctrlKey&&this.keyCode===5||this.shiftKey&&this.keyCode===4||this.altKey&&this.keyCode===6||this.metaKey&&this.keyCode===57}},l3=class{constructor(e){if(e.length===0)throw AA("chords");this.chords=e}getHashCode(){let e="";for(let t=0,i=this.chords.length;t<i;t++)t!==0&&(e+=";"),e+=this.chords[t].getHashCode();return e}equals(e){if(e===null||this.chords.length!==e.chords.length)return!1;for(let t=0;t<this.chords.length;t++)if(!this.chords[t].equals(e.chords[t]))return!1;return!0}};function o3(e){if(e.charCode){let i=String.fromCharCode(e.charCode).toUpperCase();return u1.fromString(i)}let t=e.keyCode;if(t===3)return 7;if(fm)switch(t){case 59:return 85;case 60:if(t3)return 97;break;case 61:return 86;case 107:return 109;case 109:return 111;case 173:return 88;case 224:if(ki)return 57;break}else if(XA&&(ki&&t===93||!ki&&t===92))return 57;return r3[t]||0}var c3=ki?256:2048,u3=512,h3=1024,d3=ki?2048:256,Zx=class{constructor(e){this._standardKeyboardEventBrand=!0;let t=e;this.browserEvent=t,this.target=t.target,this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,this.altGraphKey=t.getModifierState?.("AltGraph"),this.keyCode=o3(t),this.code=t.code,this.ctrlKey=this.ctrlKey||this.keyCode===5,this.altKey=this.altKey||this.keyCode===6,this.shiftKey=this.shiftKey||this.keyCode===4,this.metaKey=this.metaKey||this.keyCode===57,this._asKeybinding=this._computeKeybinding(),this._asKeyCodeChord=this._computeKeyCodeChord()}preventDefault(){this.browserEvent&&this.browserEvent.preventDefault&&this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent&&this.browserEvent.stopPropagation&&this.browserEvent.stopPropagation()}toKeyCodeChord(){return this._asKeyCodeChord}equals(e){return this._asKeybinding===e}_computeKeybinding(){let e=0;this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode);let t=0;return this.ctrlKey&&(t|=c3),this.altKey&&(t|=u3),this.shiftKey&&(t|=h3),this.metaKey&&(t|=d3),t|=e,t}_computeKeyCodeChord(){let e=0;return this.keyCode!==5&&this.keyCode!==4&&this.keyCode!==6&&this.keyCode!==57&&(e=this.keyCode),new a3(this.ctrlKey,this.shiftKey,this.altKey,this.metaKey,e)}},Qx=new WeakMap;function f3(e){if(!e.parent||e.parent===e)return null;try{let t=e.location,i=e.parent.location;if(t.origin!=="null"&&i.origin!=="null"&&t.origin!==i.origin)return null}catch{return null}return e.parent}var m3=class{static getSameOriginWindowChain(e){let t=Qx.get(e);if(!t){t=[],Qx.set(e,t);let i=e,r;do r=f3(i),r?t.push({window:new WeakRef(i),iframeElement:i.frameElement||null}):t.push({window:new WeakRef(i),iframeElement:null}),i=r;while(i)}return t.slice(0)}static getPositionOfChildWindowRelativeToAncestorWindow(e,t){if(!t||e===t)return{top:0,left:0};let i=0,r=0,l=this.getSameOriginWindowChain(e);for(let c of l){let u=c.window.deref();if(i+=u?.scrollY??0,r+=u?.scrollX??0,u===t||!c.iframeElement)break;let d=c.iframeElement.getBoundingClientRect();i+=d.top,r+=d.left}return{top:i,left:r}}},Fc=class{constructor(e,t){this.timestamp=Date.now(),this.browserEvent=t,this.leftButton=t.button===0,this.middleButton=t.button===1,this.rightButton=t.button===2,this.buttons=t.buttons,this.target=t.target,this.detail=t.detail||1,t.type==="dblclick"&&(this.detail=2),this.ctrlKey=t.ctrlKey,this.shiftKey=t.shiftKey,this.altKey=t.altKey,this.metaKey=t.metaKey,typeof t.pageX=="number"?(this.posx=t.pageX,this.posy=t.pageY):(this.posx=t.clientX+this.target.ownerDocument.body.scrollLeft+this.target.ownerDocument.documentElement.scrollLeft,this.posy=t.clientY+this.target.ownerDocument.body.scrollTop+this.target.ownerDocument.documentElement.scrollTop);let i=m3.getPositionOfChildWindowRelativeToAncestorWindow(e,t.view);this.posx-=i.left,this.posy-=i.top}preventDefault(){this.browserEvent.preventDefault()}stopPropagation(){this.browserEvent.stopPropagation()}},eS=class{constructor(e,t=0,i=0){this.browserEvent=e||null,this.target=e?e.target||e.targetNode||e.srcElement:null,this.deltaY=i,this.deltaX=t;let r=!1;if(gp){let l=navigator.userAgent.match(/Chrome\/(\d+)/);r=(l?parseInt(l[1]):123)<=122}if(e){let l=e,c=e,u=e.view?.devicePixelRatio||1;if(typeof l.wheelDeltaY<"u")r?this.deltaY=l.wheelDeltaY/(120*u):this.deltaY=l.wheelDeltaY/120;else if(typeof c.VERTICAL_AXIS<"u"&&c.axis===c.VERTICAL_AXIS)this.deltaY=-c.detail/3;else if(e.type==="wheel"){let d=e;d.deltaMode===d.DOM_DELTA_LINE?fm&&!ki?this.deltaY=-e.deltaY/3:this.deltaY=-e.deltaY:this.deltaY=-e.deltaY/40}if(typeof l.wheelDeltaX<"u")JA&&c1?this.deltaX=-(l.wheelDeltaX/120):r?this.deltaX=l.wheelDeltaX/(120*u):this.deltaX=l.wheelDeltaX/120;else if(typeof c.HORIZONTAL_AXIS<"u"&&c.axis===c.HORIZONTAL_AXIS)this.deltaX=-e.detail/3;else if(e.type==="wheel"){let d=e;d.deltaMode===d.DOM_DELTA_LINE?fm&&!ki?this.deltaX=-e.deltaX/3:this.deltaX=-e.deltaX:this.deltaX=-e.deltaX/40}this.deltaY===0&&this.deltaX===0&&e.wheelDelta&&(r?this.deltaY=e.wheelDelta/(120*u):this.deltaY=e.wheelDelta/120)}}preventDefault(){this.browserEvent?.preventDefault()}stopPropagation(){this.browserEvent?.stopPropagation()}},d1=Object.freeze(function(e,t){let i=setTimeout(e.bind(t),0);return{dispose(){clearTimeout(i)}}}),p3;(e=>{function t(i){return i===e.None||i===e.Cancelled||i instanceof g3?!0:!i||typeof i!="object"?!1:typeof i.isCancellationRequested=="boolean"&&typeof i.onCancellationRequested=="function"}e.isCancellationToken=t,e.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:Xt.None}),e.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:d1})})(p3||={});var g3=class{constructor(){this._isCancelled=!1,this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?d1:(this._emitter||(this._emitter=new ge),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},_p=class{constructor(e,t){this._isDisposed=!1,this._token=-1,typeof e=="function"&&typeof t=="number"&&this.setIfNotSet(e,t)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,t){if(this._isDisposed)throw new lm("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},t)}setIfNotSet(e,t){if(this._isDisposed)throw new lm("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},t))}},v3=class{constructor(){this.disposable=void 0,this.isDisposed=!1}cancel(){this.disposable?.dispose(),this.disposable=void 0}cancelAndSet(e,t,i=globalThis){if(this.isDisposed)throw new lm("Calling 'cancelAndSet' on a disposed IntervalTimer");this.cancel();let r=i.setInterval(()=>{e()},t);this.disposable=ht(()=>{i.clearInterval(r),this.disposable=void 0})}dispose(){this.cancel(),this.isDisposed=!0}},_3;(e=>{async function t(r){let l,c=await Promise.all(r.map(u=>u.then(d=>d,d=>{l||(l=d)})));if(typeof l<"u")throw l;return c}e.settled=t;function i(r){return new Promise(async(l,c)=>{try{await r(l,c)}catch(u){c(u)}})}e.withAsyncBody=i})(_3||={});var tS=class Zn{static fromArray(t){return new Zn(i=>{i.emitMany(t)})}static fromPromise(t){return new Zn(async i=>{i.emitMany(await t)})}static fromPromises(t){return new Zn(async i=>{await Promise.all(t.map(async r=>i.emitOne(await r)))})}static merge(t){return new Zn(async i=>{await Promise.all(t.map(async r=>{for await(let l of r)i.emitOne(l)}))})}constructor(t,i){this._state=0,this._results=[],this._error=null,this._onReturn=i,this._onStateChanged=new ge,queueMicrotask(async()=>{let r={emitOne:l=>this.emitOne(l),emitMany:l=>this.emitMany(l),reject:l=>this.reject(l)};try{await Promise.resolve(t(r)),this.resolve()}catch(l){this.reject(l)}finally{r.emitOne=void 0,r.emitMany=void 0,r.reject=void 0}})}[Symbol.asyncIterator](){let t=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(t<this._results.length)return{done:!1,value:this._results[t++]};if(this._state===1)return{done:!0,value:void 0};await Xt.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(t,i){return new Zn(async r=>{for await(let l of t)r.emitOne(i(l))})}map(t){return Zn.map(this,t)}static filter(t,i){return new Zn(async r=>{for await(let l of t)i(l)&&r.emitOne(l)})}filter(t){return Zn.filter(this,t)}static coalesce(t){return Zn.filter(t,i=>!!i)}coalesce(){return Zn.coalesce(this)}static async toPromise(t){let i=[];for await(let r of t)i.push(r);return i}toPromise(){return Zn.toPromise(this)}emitOne(t){this._state===0&&(this._results.push(t),this._onStateChanged.fire())}emitMany(t){this._state===0&&(this._results=this._results.concat(t),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(t){this._state===0&&(this._state=2,this._error=t,this._onStateChanged.fire())}};tS.EMPTY=tS.fromArray([]);var{getWindow:ji,getWindowId:y3,onDidRegisterWindow:x3}=(function(){let e=new Map,t={window:Ji,disposables:new zs};e.set(Ji.vscodeWindowId,t);let i=new ge,r=new ge,l=new ge;function c(u,d){return(typeof u=="number"?e.get(u):void 0)??(d?t:void 0)}return{onDidRegisterWindow:i.event,onWillUnregisterWindow:l.event,onDidUnregisterWindow:r.event,registerWindow(u){if(e.has(u.vscodeWindowId))return Be.None;let d=new zs,m={window:u,disposables:d.add(new zs)};return e.set(u.vscodeWindowId,m),d.add(ht(()=>{e.delete(u.vscodeWindowId),r.fire(u)})),d.add(Ne(u,Ht.BEFORE_UNLOAD,()=>{l.fire(u)})),i.fire(m),d},getWindows(){return e.values()},getWindowsCount(){return e.size},getWindowId(u){return u.vscodeWindowId},hasWindow(u){return e.has(u)},getWindowById:c,getWindow(u){let d=u;if(d?.ownerDocument?.defaultView)return d.ownerDocument.defaultView.window;let m=u;return m?.view?m.view.window:Ji},getDocument(u){return ji(u).document}}})(),S3=class{constructor(e,t,i,r){this._node=e,this._type=t,this._handler=i,this._options=r||!1,this._node.addEventListener(this._type,this._handler,this._options)}dispose(){this._handler&&(this._node.removeEventListener(this._type,this._handler,this._options),this._node=null,this._handler=null)}};function Ne(e,t,i,r){return new S3(e,t,i,r)}var nS=function(e,t,i,r){return Ne(e,t,i,r)},yp,b3=class extends v3{constructor(e){super(),this.defaultTarget=e&&ji(e)}cancelAndSet(e,t,i){return super.cancelAndSet(e,t,i??this.defaultTarget)}},iS=class{constructor(e,t=0){this._runner=e,this.priority=t,this._canceled=!1}dispose(){this._canceled=!0}execute(){if(!this._canceled)try{this._runner()}catch(e){Zc(e)}}static sort(e,t){return t.priority-e.priority}};(function(){let e=new Map,t=new Map,i=new Map,r=new Map,l=c=>{i.set(c,!1);let u=e.get(c)??[];for(t.set(c,u),e.set(c,[]),r.set(c,!0);u.length>0;)u.sort(iS.sort),u.shift().execute();r.set(c,!1)};yp=(c,u,d=0)=>{let m=y3(c),f=new iS(u,d),v=e.get(m);return v||(v=[],e.set(m,v)),v.push(f),i.get(m)||(i.set(m,!0),c.requestAnimationFrame(()=>l(m))),f}})();function w3(e){let t=e.getBoundingClientRect(),i=ji(e);return{left:t.left+i.scrollX,top:t.top+i.scrollY,width:t.width,height:t.height}}var Ht={CLICK:"click",MOUSE_DOWN:"mousedown",MOUSE_OVER:"mouseover",MOUSE_LEAVE:"mouseleave",MOUSE_WHEEL:"wheel",POINTER_UP:"pointerup",POINTER_DOWN:"pointerdown",POINTER_MOVE:"pointermove",KEY_DOWN:"keydown",KEY_UP:"keyup",BEFORE_UNLOAD:"beforeunload",CHANGE:"change",FOCUS:"focus",BLUR:"blur",INPUT:"input"},C3=class{constructor(e){this.domNode=e,this._maxWidth="",this._width="",this._height="",this._top="",this._left="",this._bottom="",this._right="",this._paddingTop="",this._paddingLeft="",this._paddingBottom="",this._paddingRight="",this._fontFamily="",this._fontWeight="",this._fontSize="",this._fontStyle="",this._fontFeatureSettings="",this._fontVariationSettings="",this._textDecoration="",this._lineHeight="",this._letterSpacing="",this._className="",this._display="",this._position="",this._visibility="",this._color="",this._backgroundColor="",this._layerHint=!1,this._contain="none",this._boxShadow=""}setMaxWidth(e){let t=_n(e);this._maxWidth!==t&&(this._maxWidth=t,this.domNode.style.maxWidth=this._maxWidth)}setWidth(e){let t=_n(e);this._width!==t&&(this._width=t,this.domNode.style.width=this._width)}setHeight(e){let t=_n(e);this._height!==t&&(this._height=t,this.domNode.style.height=this._height)}setTop(e){let t=_n(e);this._top!==t&&(this._top=t,this.domNode.style.top=this._top)}setLeft(e){let t=_n(e);this._left!==t&&(this._left=t,this.domNode.style.left=this._left)}setBottom(e){let t=_n(e);this._bottom!==t&&(this._bottom=t,this.domNode.style.bottom=this._bottom)}setRight(e){let t=_n(e);this._right!==t&&(this._right=t,this.domNode.style.right=this._right)}setPaddingTop(e){let t=_n(e);this._paddingTop!==t&&(this._paddingTop=t,this.domNode.style.paddingTop=this._paddingTop)}setPaddingLeft(e){let t=_n(e);this._paddingLeft!==t&&(this._paddingLeft=t,this.domNode.style.paddingLeft=this._paddingLeft)}setPaddingBottom(e){let t=_n(e);this._paddingBottom!==t&&(this._paddingBottom=t,this.domNode.style.paddingBottom=this._paddingBottom)}setPaddingRight(e){let t=_n(e);this._paddingRight!==t&&(this._paddingRight=t,this.domNode.style.paddingRight=this._paddingRight)}setFontFamily(e){this._fontFamily!==e&&(this._fontFamily=e,this.domNode.style.fontFamily=this._fontFamily)}setFontWeight(e){this._fontWeight!==e&&(this._fontWeight=e,this.domNode.style.fontWeight=this._fontWeight)}setFontSize(e){let t=_n(e);this._fontSize!==t&&(this._fontSize=t,this.domNode.style.fontSize=this._fontSize)}setFontStyle(e){this._fontStyle!==e&&(this._fontStyle=e,this.domNode.style.fontStyle=this._fontStyle)}setFontFeatureSettings(e){this._fontFeatureSettings!==e&&(this._fontFeatureSettings=e,this.domNode.style.fontFeatureSettings=this._fontFeatureSettings)}setFontVariationSettings(e){this._fontVariationSettings!==e&&(this._fontVariationSettings=e,this.domNode.style.fontVariationSettings=this._fontVariationSettings)}setTextDecoration(e){this._textDecoration!==e&&(this._textDecoration=e,this.domNode.style.textDecoration=this._textDecoration)}setLineHeight(e){let t=_n(e);this._lineHeight!==t&&(this._lineHeight=t,this.domNode.style.lineHeight=this._lineHeight)}setLetterSpacing(e){let t=_n(e);this._letterSpacing!==t&&(this._letterSpacing=t,this.domNode.style.letterSpacing=this._letterSpacing)}setClassName(e){this._className!==e&&(this._className=e,this.domNode.className=this._className)}toggleClassName(e,t){this.domNode.classList.toggle(e,t),this._className=this.domNode.className}setDisplay(e){this._display!==e&&(this._display=e,this.domNode.style.display=this._display)}setPosition(e){this._position!==e&&(this._position=e,this.domNode.style.position=this._position)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this.domNode.style.visibility=this._visibility)}setColor(e){this._color!==e&&(this._color=e,this.domNode.style.color=this._color)}setBackgroundColor(e){this._backgroundColor!==e&&(this._backgroundColor=e,this.domNode.style.backgroundColor=this._backgroundColor)}setLayerHinting(e){this._layerHint!==e&&(this._layerHint=e,this.domNode.style.transform=this._layerHint?"translate3d(0px, 0px, 0px)":"")}setBoxShadow(e){this._boxShadow!==e&&(this._boxShadow=e,this.domNode.style.boxShadow=e)}setContain(e){this._contain!==e&&(this._contain=e,this.domNode.style.contain=this._contain)}setAttribute(e,t){this.domNode.setAttribute(e,t)}removeAttribute(e){this.domNode.removeAttribute(e)}appendChild(e){this.domNode.appendChild(e.domNode)}removeChild(e){this.domNode.removeChild(e.domNode)}};function _n(e){return typeof e=="number"?`${e}px`:e}function Zl(e){return new C3(e)}var f1=class{constructor(){this._hooks=new zs,this._pointerMoveCallback=null,this._onStopCallback=null}dispose(){this.stopMonitoring(!1),this._hooks.dispose()}stopMonitoring(e,t){if(!this.isMonitoring())return;this._hooks.clear(),this._pointerMoveCallback=null;let i=this._onStopCallback;this._onStopCallback=null,e&&i&&i(t)}isMonitoring(){return!!this._pointerMoveCallback}startMonitoring(e,t,i,r,l){this.isMonitoring()&&this.stopMonitoring(!1),this._pointerMoveCallback=r,this._onStopCallback=l;let c=e;try{e.setPointerCapture(t),this._hooks.add(ht(()=>{try{e.releasePointerCapture(t)}catch{}}))}catch{c=ji(e)}this._hooks.add(Ne(c,Ht.POINTER_MOVE,u=>{if(u.buttons!==i){this.stopMonitoring(!0);return}u.preventDefault(),this._pointerMoveCallback(u)})),this._hooks.add(Ne(c,Ht.POINTER_UP,u=>this.stopMonitoring(!0)))}};function j3(e,t,i){let r=null,l=null;if(typeof i.value=="function"?(r="value",l=i.value,l.length!==0&&console.warn("Memoize should only be used in functions with zero parameters")):typeof i.get=="function"&&(r="get",l=i.get),!l)throw new Error("not supported");let c=`$memoize$${t}`;i[r]=function(...u){return this.hasOwnProperty(c)||Object.defineProperty(this,c,{configurable:!1,enumerable:!1,writable:!1,value:l.apply(this,u)}),this[c]}}var bi;(e=>(e.Tap="-xterm-gesturetap",e.Change="-xterm-gesturechange",e.Start="-xterm-gesturestart",e.End="-xterm-gesturesend",e.Contextmenu="-xterm-gesturecontextmenu"))(bi||={});var $l=class Zt extends Be{constructor(){super(),this.dispatched=!1,this.targets=new Vx,this.ignoreTargets=new Vx,this.activeTouches={},this.handle=null,this._lastSetTapCountTime=0,this._register(Xt.runAndSubscribe(x3,({window:t,disposables:i})=>{i.add(Ne(t.document,"touchstart",r=>this.onTouchStart(r),{passive:!1})),i.add(Ne(t.document,"touchend",r=>this.onTouchEnd(t,r))),i.add(Ne(t.document,"touchmove",r=>this.onTouchMove(r),{passive:!1}))},{window:Ji,disposables:this._store}))}static addTarget(t){if(!Zt.isTouchDevice())return Be.None;Zt.INSTANCE||(Zt.INSTANCE=new Zt);let i=Zt.INSTANCE.targets.push(t);return ht(i)}static ignoreTarget(t){if(!Zt.isTouchDevice())return Be.None;Zt.INSTANCE||(Zt.INSTANCE=new Zt);let i=Zt.INSTANCE.ignoreTargets.push(t);return ht(i)}static isTouchDevice(){return"ontouchstart"in Ji||navigator.maxTouchPoints>0}dispose(){this.handle&&(this.handle.dispose(),this.handle=null),super.dispose()}onTouchStart(t){let i=Date.now();this.handle&&(this.handle.dispose(),this.handle=null);for(let r=0,l=t.targetTouches.length;r<l;r++){let c=t.targetTouches.item(r);this.activeTouches[c.identifier]={id:c.identifier,initialTarget:c.target,initialTimeStamp:i,initialPageX:c.pageX,initialPageY:c.pageY,rollingTimestamps:[i],rollingPageX:[c.pageX],rollingPageY:[c.pageY]};let u=this.newGestureEvent(bi.Start,c.target);u.pageX=c.pageX,u.pageY=c.pageY,this.dispatchEvent(u)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}onTouchEnd(t,i){let r=Date.now(),l=Object.keys(this.activeTouches).length;for(let c=0,u=i.changedTouches.length;c<u;c++){let d=i.changedTouches.item(c);if(!this.activeTouches.hasOwnProperty(String(d.identifier))){console.warn("move of an UNKNOWN touch",d);continue}let m=this.activeTouches[d.identifier],f=Date.now()-m.initialTimeStamp;if(f<Zt.HOLD_DELAY&&Math.abs(m.initialPageX-Rn(m.rollingPageX))<30&&Math.abs(m.initialPageY-Rn(m.rollingPageY))<30){let v=this.newGestureEvent(bi.Tap,m.initialTarget);v.pageX=Rn(m.rollingPageX),v.pageY=Rn(m.rollingPageY),this.dispatchEvent(v)}else if(f>=Zt.HOLD_DELAY&&Math.abs(m.initialPageX-Rn(m.rollingPageX))<30&&Math.abs(m.initialPageY-Rn(m.rollingPageY))<30){let v=this.newGestureEvent(bi.Contextmenu,m.initialTarget);v.pageX=Rn(m.rollingPageX),v.pageY=Rn(m.rollingPageY),this.dispatchEvent(v)}else if(l===1){let v=Rn(m.rollingPageX),_=Rn(m.rollingPageY),S=Rn(m.rollingTimestamps)-m.rollingTimestamps[0],x=v-m.rollingPageX[0],b=_-m.rollingPageY[0],C=[...this.targets].filter(T=>m.initialTarget instanceof Node&&T.contains(m.initialTarget));this.inertia(t,C,r,Math.abs(x)/S,x>0?1:-1,v,Math.abs(b)/S,b>0?1:-1,_)}this.dispatchEvent(this.newGestureEvent(bi.End,m.initialTarget)),delete this.activeTouches[d.identifier]}this.dispatched&&(i.preventDefault(),i.stopPropagation(),this.dispatched=!1)}newGestureEvent(t,i){let r=document.createEvent("CustomEvent");return r.initEvent(t,!1,!0),r.initialTarget=i,r.tapCount=0,r}dispatchEvent(t){if(t.type===bi.Tap){let i=new Date().getTime(),r=0;i-this._lastSetTapCountTime>Zt.CLEAR_TAP_COUNT_TIME?r=1:r=2,this._lastSetTapCountTime=i,t.tapCount=r}else(t.type===bi.Change||t.type===bi.Contextmenu)&&(this._lastSetTapCountTime=0);if(t.initialTarget instanceof Node){for(let r of this.ignoreTargets)if(r.contains(t.initialTarget))return;let i=[];for(let r of this.targets)if(r.contains(t.initialTarget)){let l=0,c=t.initialTarget;for(;c&&c!==r;)l++,c=c.parentElement;i.push([l,r])}i.sort((r,l)=>r[0]-l[0]);for(let[r,l]of i)l.dispatchEvent(t),this.dispatched=!0}}inertia(t,i,r,l,c,u,d,m,f){this.handle=yp(t,()=>{let v=Date.now(),_=v-r,S=0,x=0,b=!0;l+=Zt.SCROLL_FRICTION*_,d+=Zt.SCROLL_FRICTION*_,l>0&&(b=!1,S=c*l*_),d>0&&(b=!1,x=m*d*_);let C=this.newGestureEvent(bi.Change);C.translationX=S,C.translationY=x,i.forEach(T=>T.dispatchEvent(C)),b||this.inertia(t,i,v,l,c,u+S,d,m,f+x)})}onTouchMove(t){let i=Date.now();for(let r=0,l=t.changedTouches.length;r<l;r++){let c=t.changedTouches.item(r);if(!this.activeTouches.hasOwnProperty(String(c.identifier))){console.warn("end of an UNKNOWN touch",c);continue}let u=this.activeTouches[c.identifier],d=this.newGestureEvent(bi.Change,u.initialTarget);d.translationX=c.pageX-Rn(u.rollingPageX),d.translationY=c.pageY-Rn(u.rollingPageY),d.pageX=c.pageX,d.pageY=c.pageY,this.dispatchEvent(d),u.rollingPageX.length>3&&(u.rollingPageX.shift(),u.rollingPageY.shift(),u.rollingTimestamps.shift()),u.rollingPageX.push(c.pageX),u.rollingPageY.push(c.pageY),u.rollingTimestamps.push(i)}this.dispatched&&(t.preventDefault(),t.stopPropagation(),this.dispatched=!1)}};$l.SCROLL_FRICTION=-.005,$l.HOLD_DELAY=700,$l.CLEAR_TAP_COUNT_TIME=400,_t([j3],$l,"isTouchDevice",1);var k3=$l,xp=class extends Be{onclick(e,t){this._register(Ne(e,Ht.CLICK,i=>t(new Fc(ji(e),i))))}onmousedown(e,t){this._register(Ne(e,Ht.MOUSE_DOWN,i=>t(new Fc(ji(e),i))))}onmouseover(e,t){this._register(Ne(e,Ht.MOUSE_OVER,i=>t(new Fc(ji(e),i))))}onmouseleave(e,t){this._register(Ne(e,Ht.MOUSE_LEAVE,i=>t(new Fc(ji(e),i))))}onkeydown(e,t){this._register(Ne(e,Ht.KEY_DOWN,i=>t(new Zx(i))))}onkeyup(e,t){this._register(Ne(e,Ht.KEY_UP,i=>t(new Zx(i))))}oninput(e,t){this._register(Ne(e,Ht.INPUT,t))}onblur(e,t){this._register(Ne(e,Ht.BLUR,t))}onfocus(e,t){this._register(Ne(e,Ht.FOCUS,t))}onchange(e,t){this._register(Ne(e,Ht.CHANGE,t))}ignoreGesture(e){return k3.ignoreTarget(e)}},sS=11,N3=class extends xp{constructor(e){super(),this._onActivate=e.onActivate,this.bgDomNode=document.createElement("div"),this.bgDomNode.className="arrow-background",this.bgDomNode.style.position="absolute",this.bgDomNode.style.width=e.bgWidth+"px",this.bgDomNode.style.height=e.bgHeight+"px",typeof e.top<"u"&&(this.bgDomNode.style.top="0px"),typeof e.left<"u"&&(this.bgDomNode.style.left="0px"),typeof e.bottom<"u"&&(this.bgDomNode.style.bottom="0px"),typeof e.right<"u"&&(this.bgDomNode.style.right="0px"),this.domNode=document.createElement("div"),this.domNode.className=e.className,this.domNode.style.position="absolute",this.domNode.style.width=sS+"px",this.domNode.style.height=sS+"px",typeof e.top<"u"&&(this.domNode.style.top=e.top+"px"),typeof e.left<"u"&&(this.domNode.style.left=e.left+"px"),typeof e.bottom<"u"&&(this.domNode.style.bottom=e.bottom+"px"),typeof e.right<"u"&&(this.domNode.style.right=e.right+"px"),this._pointerMoveMonitor=this._register(new f1),this._register(nS(this.bgDomNode,Ht.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._register(nS(this.domNode,Ht.POINTER_DOWN,t=>this._arrowPointerDown(t))),this._pointerdownRepeatTimer=this._register(new b3),this._pointerdownScheduleRepeatTimer=this._register(new _p)}_arrowPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=()=>{this._pointerdownRepeatTimer.cancelAndSet(()=>this._onActivate(),1e3/24,ji(e))};this._onActivate(),this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancelAndSet(t,200),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,i=>{},()=>{this._pointerdownRepeatTimer.cancel(),this._pointerdownScheduleRepeatTimer.cancel()}),e.preventDefault()}},E3=class gm{constructor(t,i,r,l,c,u,d){this._forceIntegerValues=t,this._scrollStateBrand=void 0,this._forceIntegerValues&&(i=i|0,r=r|0,l=l|0,c=c|0,u=u|0,d=d|0),this.rawScrollLeft=l,this.rawScrollTop=d,i<0&&(i=0),l+i>r&&(l=r-i),l<0&&(l=0),c<0&&(c=0),d+c>u&&(d=u-c),d<0&&(d=0),this.width=i,this.scrollWidth=r,this.scrollLeft=l,this.height=c,this.scrollHeight=u,this.scrollTop=d}equals(t){return this.rawScrollLeft===t.rawScrollLeft&&this.rawScrollTop===t.rawScrollTop&&this.width===t.width&&this.scrollWidth===t.scrollWidth&&this.scrollLeft===t.scrollLeft&&this.height===t.height&&this.scrollHeight===t.scrollHeight&&this.scrollTop===t.scrollTop}withScrollDimensions(t,i){return new gm(this._forceIntegerValues,typeof t.width<"u"?t.width:this.width,typeof t.scrollWidth<"u"?t.scrollWidth:this.scrollWidth,i?this.rawScrollLeft:this.scrollLeft,typeof t.height<"u"?t.height:this.height,typeof t.scrollHeight<"u"?t.scrollHeight:this.scrollHeight,i?this.rawScrollTop:this.scrollTop)}withScrollPosition(t){return new gm(this._forceIntegerValues,this.width,this.scrollWidth,typeof t.scrollLeft<"u"?t.scrollLeft:this.rawScrollLeft,this.height,this.scrollHeight,typeof t.scrollTop<"u"?t.scrollTop:this.rawScrollTop)}createScrollEvent(t,i){let r=this.width!==t.width,l=this.scrollWidth!==t.scrollWidth,c=this.scrollLeft!==t.scrollLeft,u=this.height!==t.height,d=this.scrollHeight!==t.scrollHeight,m=this.scrollTop!==t.scrollTop;return{inSmoothScrolling:i,oldWidth:t.width,oldScrollWidth:t.scrollWidth,oldScrollLeft:t.scrollLeft,width:this.width,scrollWidth:this.scrollWidth,scrollLeft:this.scrollLeft,oldHeight:t.height,oldScrollHeight:t.scrollHeight,oldScrollTop:t.scrollTop,height:this.height,scrollHeight:this.scrollHeight,scrollTop:this.scrollTop,widthChanged:r,scrollWidthChanged:l,scrollLeftChanged:c,heightChanged:u,scrollHeightChanged:d,scrollTopChanged:m}}},T3=class extends Be{constructor(e){super(),this._scrollableBrand=void 0,this._onScroll=this._register(new ge),this.onScroll=this._onScroll.event,this._smoothScrollDuration=e.smoothScrollDuration,this._scheduleAtNextAnimationFrame=e.scheduleAtNextAnimationFrame,this._state=new E3(e.forceIntegerValues,0,0,0,0,0,0),this._smoothScrolling=null}dispose(){this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),super.dispose()}setSmoothScrollDuration(e){this._smoothScrollDuration=e}validateScrollPosition(e){return this._state.withScrollPosition(e)}getScrollDimensions(){return this._state}setScrollDimensions(e,t){let i=this._state.withScrollDimensions(e,t);this._setState(i,!!this._smoothScrolling),this._smoothScrolling?.acceptScrollDimensions(this._state)}getFutureScrollPosition(){return this._smoothScrolling?this._smoothScrolling.to:this._state}getCurrentScrollPosition(){return this._state}setScrollPositionNow(e){let t=this._state.withScrollPosition(e);this._smoothScrolling&&(this._smoothScrolling.dispose(),this._smoothScrolling=null),this._setState(t,!1)}setScrollPositionSmooth(e,t){if(this._smoothScrollDuration===0)return this.setScrollPositionNow(e);if(this._smoothScrolling){e={scrollLeft:typeof e.scrollLeft>"u"?this._smoothScrolling.to.scrollLeft:e.scrollLeft,scrollTop:typeof e.scrollTop>"u"?this._smoothScrolling.to.scrollTop:e.scrollTop};let i=this._state.withScrollPosition(e);if(this._smoothScrolling.to.scrollLeft===i.scrollLeft&&this._smoothScrolling.to.scrollTop===i.scrollTop)return;let r;t?r=new aS(this._smoothScrolling.from,i,this._smoothScrolling.startTime,this._smoothScrolling.duration):r=this._smoothScrolling.combine(this._state,i,this._smoothScrollDuration),this._smoothScrolling.dispose(),this._smoothScrolling=r}else{let i=this._state.withScrollPosition(e);this._smoothScrolling=aS.start(this._state,i,this._smoothScrollDuration)}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}hasPendingScrollAnimation(){return!!this._smoothScrolling}_performSmoothScrolling(){if(!this._smoothScrolling)return;let e=this._smoothScrolling.tick(),t=this._state.withScrollPosition(e);if(this._setState(t,!0),!!this._smoothScrolling){if(e.isDone){this._smoothScrolling.dispose(),this._smoothScrolling=null;return}this._smoothScrolling.animationFrameDisposable=this._scheduleAtNextAnimationFrame(()=>{this._smoothScrolling&&(this._smoothScrolling.animationFrameDisposable=null,this._performSmoothScrolling())})}}_setState(e,t){let i=this._state;i.equals(e)||(this._state=e,this._onScroll.fire(this._state.createScrollEvent(i,t)))}},rS=class{constructor(e,t,i){this.scrollLeft=e,this.scrollTop=t,this.isDone=i}};function wf(e,t){let i=t-e;return function(r){return e+i*A3(r)}}function R3(e,t,i){return function(r){return r<i?e(r/i):t((r-i)/(1-i))}}var aS=class vm{constructor(t,i,r,l){this.from=t,this.to=i,this.duration=l,this.startTime=r,this.animationFrameDisposable=null,this._initAnimations()}_initAnimations(){this.scrollLeft=this._initAnimation(this.from.scrollLeft,this.to.scrollLeft,this.to.width),this.scrollTop=this._initAnimation(this.from.scrollTop,this.to.scrollTop,this.to.height)}_initAnimation(t,i,r){if(Math.abs(t-i)>2.5*r){let l,c;return t<i?(l=t+.75*r,c=i-.75*r):(l=t-.75*r,c=i+.75*r),R3(wf(t,l),wf(c,i),.33)}return wf(t,i)}dispose(){this.animationFrameDisposable!==null&&(this.animationFrameDisposable.dispose(),this.animationFrameDisposable=null)}acceptScrollDimensions(t){this.to=t.withScrollPosition(this.to),this._initAnimations()}tick(){return this._tick(Date.now())}_tick(t){let i=(t-this.startTime)/this.duration;if(i<1){let r=this.scrollLeft(i),l=this.scrollTop(i);return new rS(r,l,!1)}return new rS(this.to.scrollLeft,this.to.scrollTop,!0)}combine(t,i,r){return vm.start(t,i,r)}static start(t,i,r){r=r+10;let l=Date.now()-10;return new vm(t,i,l,r)}};function D3(e){return Math.pow(e,3)}function A3(e){return 1-D3(1-e)}var L3=class extends Be{constructor(e,t,i){super(),this._visibility=e,this._visibleClassName=t,this._invisibleClassName=i,this._domNode=null,this._isVisible=!1,this._isNeeded=!1,this._rawShouldBeVisible=!1,this._shouldBeVisible=!1,this._revealTimer=this._register(new _p)}setVisibility(e){this._visibility!==e&&(this._visibility=e,this._updateShouldBeVisible())}setShouldBeVisible(e){this._rawShouldBeVisible=e,this._updateShouldBeVisible()}_applyVisibilitySetting(){return this._visibility===2?!1:this._visibility===3?!0:this._rawShouldBeVisible}_updateShouldBeVisible(){let e=this._applyVisibilitySetting();this._shouldBeVisible!==e&&(this._shouldBeVisible=e,this.ensureVisibility())}setIsNeeded(e){this._isNeeded!==e&&(this._isNeeded=e,this.ensureVisibility())}setDomNode(e){this._domNode=e,this._domNode.setClassName(this._invisibleClassName),this.setShouldBeVisible(!1)}ensureVisibility(){if(!this._isNeeded){this._hide(!1);return}this._shouldBeVisible?this._reveal():this._hide(!0)}_reveal(){this._isVisible||(this._isVisible=!0,this._revealTimer.setIfNotSet(()=>{this._domNode?.setClassName(this._visibleClassName)},0))}_hide(e){this._revealTimer.cancel(),this._isVisible&&(this._isVisible=!1,this._domNode?.setClassName(this._invisibleClassName+(e?" fade":"")))}},M3=140,m1=class extends xp{constructor(e){super(),this._lazyRender=e.lazyRender,this._host=e.host,this._scrollable=e.scrollable,this._scrollByPage=e.scrollByPage,this._scrollbarState=e.scrollbarState,this._visibilityController=this._register(new L3(e.visibility,"visible scrollbar "+e.extraScrollbarClassName,"invisible scrollbar "+e.extraScrollbarClassName)),this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._pointerMoveMonitor=this._register(new f1),this._shouldRender=!0,this.domNode=Zl(document.createElement("div")),this.domNode.setAttribute("role","presentation"),this.domNode.setAttribute("aria-hidden","true"),this._visibilityController.setDomNode(this.domNode),this.domNode.setPosition("absolute"),this._register(Ne(this.domNode.domNode,Ht.POINTER_DOWN,t=>this._domNodePointerDown(t)))}_createArrow(e){let t=this._register(new N3(e));this.domNode.domNode.appendChild(t.bgDomNode),this.domNode.domNode.appendChild(t.domNode)}_createSlider(e,t,i,r){this.slider=Zl(document.createElement("div")),this.slider.setClassName("slider"),this.slider.setPosition("absolute"),this.slider.setTop(e),this.slider.setLeft(t),typeof i=="number"&&this.slider.setWidth(i),typeof r=="number"&&this.slider.setHeight(r),this.slider.setLayerHinting(!0),this.slider.setContain("strict"),this.domNode.domNode.appendChild(this.slider.domNode),this._register(Ne(this.slider.domNode,Ht.POINTER_DOWN,l=>{l.button===0&&(l.preventDefault(),this._sliderPointerDown(l))})),this.onclick(this.slider.domNode,l=>{l.leftButton&&l.stopPropagation()})}_onElementSize(e){return this._scrollbarState.setVisibleSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollSize(e){return this._scrollbarState.setScrollSize(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}_onElementScrollPosition(e){return this._scrollbarState.setScrollPosition(e)&&(this._visibilityController.setIsNeeded(this._scrollbarState.isNeeded()),this._shouldRender=!0,this._lazyRender||this.render()),this._shouldRender}beginReveal(){this._visibilityController.setShouldBeVisible(!0)}beginHide(){this._visibilityController.setShouldBeVisible(!1)}render(){this._shouldRender&&(this._shouldRender=!1,this._renderDomNode(this._scrollbarState.getRectangleLargeSize(),this._scrollbarState.getRectangleSmallSize()),this._updateSlider(this._scrollbarState.getSliderSize(),this._scrollbarState.getArrowSize()+this._scrollbarState.getSliderPosition()))}_domNodePointerDown(e){e.target===this.domNode.domNode&&this._onPointerDown(e)}delegatePointerDown(e){let t=this.domNode.domNode.getClientRects()[0].top,i=t+this._scrollbarState.getSliderPosition(),r=t+this._scrollbarState.getSliderPosition()+this._scrollbarState.getSliderSize(),l=this._sliderPointerPosition(e);i<=l&&l<=r?e.button===0&&(e.preventDefault(),this._sliderPointerDown(e)):this._onPointerDown(e)}_onPointerDown(e){let t,i;if(e.target===this.domNode.domNode&&typeof e.offsetX=="number"&&typeof e.offsetY=="number")t=e.offsetX,i=e.offsetY;else{let l=w3(this.domNode.domNode);t=e.pageX-l.left,i=e.pageY-l.top}let r=this._pointerDownRelativePosition(t,i);this._setDesiredScrollPositionNow(this._scrollByPage?this._scrollbarState.getDesiredScrollPositionFromOffsetPaged(r):this._scrollbarState.getDesiredScrollPositionFromOffset(r)),e.button===0&&(e.preventDefault(),this._sliderPointerDown(e))}_sliderPointerDown(e){if(!e.target||!(e.target instanceof Element))return;let t=this._sliderPointerPosition(e),i=this._sliderOrthogonalPointerPosition(e),r=this._scrollbarState.clone();this.slider.toggleClassName("active",!0),this._pointerMoveMonitor.startMonitoring(e.target,e.pointerId,e.buttons,l=>{let c=this._sliderOrthogonalPointerPosition(l),u=Math.abs(c-i);if(c1&&u>M3){this._setDesiredScrollPositionNow(r.getScrollPosition());return}let d=this._sliderPointerPosition(l)-t;this._setDesiredScrollPositionNow(r.getDesiredScrollPositionFromDelta(d))},()=>{this.slider.toggleClassName("active",!1),this._host.onDragEnd()}),this._host.onDragStart()}_setDesiredScrollPositionNow(e){let t={};this.writeScrollPosition(t,e),this._scrollable.setScrollPositionNow(t)}updateScrollbarSize(e){this._updateScrollbarSize(e),this._scrollbarState.setScrollbarSize(e),this._shouldRender=!0,this._lazyRender||this.render()}isNeeded(){return this._scrollbarState.isNeeded()}},p1=class _m{constructor(t,i,r,l,c,u){this._scrollbarSize=Math.round(i),this._oppositeScrollbarSize=Math.round(r),this._arrowSize=Math.round(t),this._visibleSize=l,this._scrollSize=c,this._scrollPosition=u,this._computedAvailableSize=0,this._computedIsNeeded=!1,this._computedSliderSize=0,this._computedSliderRatio=0,this._computedSliderPosition=0,this._refreshComputedValues()}clone(){return new _m(this._arrowSize,this._scrollbarSize,this._oppositeScrollbarSize,this._visibleSize,this._scrollSize,this._scrollPosition)}setVisibleSize(t){let i=Math.round(t);return this._visibleSize!==i?(this._visibleSize=i,this._refreshComputedValues(),!0):!1}setScrollSize(t){let i=Math.round(t);return this._scrollSize!==i?(this._scrollSize=i,this._refreshComputedValues(),!0):!1}setScrollPosition(t){let i=Math.round(t);return this._scrollPosition!==i?(this._scrollPosition=i,this._refreshComputedValues(),!0):!1}setScrollbarSize(t){this._scrollbarSize=Math.round(t)}setOppositeScrollbarSize(t){this._oppositeScrollbarSize=Math.round(t)}static _computeValues(t,i,r,l,c){let u=Math.max(0,r-t),d=Math.max(0,u-2*i),m=l>0&&l>r;if(!m)return{computedAvailableSize:Math.round(u),computedIsNeeded:m,computedSliderSize:Math.round(d),computedSliderRatio:0,computedSliderPosition:0};let f=Math.round(Math.max(20,Math.floor(r*d/l))),v=(d-f)/(l-r),_=c*v;return{computedAvailableSize:Math.round(u),computedIsNeeded:m,computedSliderSize:Math.round(f),computedSliderRatio:v,computedSliderPosition:Math.round(_)}}_refreshComputedValues(){let t=_m._computeValues(this._oppositeScrollbarSize,this._arrowSize,this._visibleSize,this._scrollSize,this._scrollPosition);this._computedAvailableSize=t.computedAvailableSize,this._computedIsNeeded=t.computedIsNeeded,this._computedSliderSize=t.computedSliderSize,this._computedSliderRatio=t.computedSliderRatio,this._computedSliderPosition=t.computedSliderPosition}getArrowSize(){return this._arrowSize}getScrollPosition(){return this._scrollPosition}getRectangleLargeSize(){return this._computedAvailableSize}getRectangleSmallSize(){return this._scrollbarSize}isNeeded(){return this._computedIsNeeded}getSliderSize(){return this._computedSliderSize}getSliderPosition(){return this._computedSliderPosition}getDesiredScrollPositionFromOffset(t){if(!this._computedIsNeeded)return 0;let i=t-this._arrowSize-this._computedSliderSize/2;return Math.round(i/this._computedSliderRatio)}getDesiredScrollPositionFromOffsetPaged(t){if(!this._computedIsNeeded)return 0;let i=t-this._arrowSize,r=this._scrollPosition;return i<this._computedSliderPosition?r-=this._visibleSize:r+=this._visibleSize,r}getDesiredScrollPositionFromDelta(t){if(!this._computedIsNeeded)return 0;let i=this._computedSliderPosition+t;return Math.round(i/this._computedSliderRatio)}},B3=class extends m1{constructor(e,t,i){let r=e.getScrollDimensions(),l=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new p1(t.horizontalHasArrows?t.arrowSize:0,t.horizontal===2?0:t.horizontalScrollbarSize,t.vertical===2?0:t.verticalScrollbarSize,r.width,r.scrollWidth,l.scrollLeft),visibility:t.horizontal,extraScrollbarClassName:"horizontal",scrollable:e,scrollByPage:t.scrollByPage}),t.horizontalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(Math.floor((t.horizontalScrollbarSize-t.horizontalSliderSize)/2),0,void 0,t.horizontalSliderSize)}_updateSlider(e,t){this.slider.setWidth(e),this.slider.setLeft(t)}_renderDomNode(e,t){this.domNode.setWidth(e),this.domNode.setHeight(t),this.domNode.setLeft(0),this.domNode.setBottom(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollWidth)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollLeft)||this._shouldRender,this._shouldRender=this._onElementSize(e.width)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return e}_sliderPointerPosition(e){return e.pageX}_sliderOrthogonalPointerPosition(e){return e.pageY}_updateScrollbarSize(e){this.slider.setHeight(e)}writeScrollPosition(e,t){e.scrollLeft=t}updateOptions(e){this.updateScrollbarSize(e.horizontal===2?0:e.horizontalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._visibilityController.setVisibility(e.horizontal),this._scrollByPage=e.scrollByPage}},O3=class extends m1{constructor(e,t,i){let r=e.getScrollDimensions(),l=e.getCurrentScrollPosition();if(super({lazyRender:t.lazyRender,host:i,scrollbarState:new p1(t.verticalHasArrows?t.arrowSize:0,t.vertical===2?0:t.verticalScrollbarSize,0,r.height,r.scrollHeight,l.scrollTop),visibility:t.vertical,extraScrollbarClassName:"vertical",scrollable:e,scrollByPage:t.scrollByPage}),t.verticalHasArrows)throw new Error("horizontalHasArrows is not supported in xterm.js");this._createSlider(0,Math.floor((t.verticalScrollbarSize-t.verticalSliderSize)/2),t.verticalSliderSize,void 0)}_updateSlider(e,t){this.slider.setHeight(e),this.slider.setTop(t)}_renderDomNode(e,t){this.domNode.setWidth(t),this.domNode.setHeight(e),this.domNode.setRight(0),this.domNode.setTop(0)}onDidScroll(e){return this._shouldRender=this._onElementScrollSize(e.scrollHeight)||this._shouldRender,this._shouldRender=this._onElementScrollPosition(e.scrollTop)||this._shouldRender,this._shouldRender=this._onElementSize(e.height)||this._shouldRender,this._shouldRender}_pointerDownRelativePosition(e,t){return t}_sliderPointerPosition(e){return e.pageY}_sliderOrthogonalPointerPosition(e){return e.pageX}_updateScrollbarSize(e){this.slider.setWidth(e)}writeScrollPosition(e,t){e.scrollTop=t}updateOptions(e){this.updateScrollbarSize(e.vertical===2?0:e.verticalScrollbarSize),this._scrollbarState.setOppositeScrollbarSize(0),this._visibilityController.setVisibility(e.vertical),this._scrollByPage=e.scrollByPage}},z3=500,lS=50,P3=class{constructor(e,t,i){this.timestamp=e,this.deltaX=t,this.deltaY=i,this.score=0}},ym=class{constructor(){this._capacity=5,this._memory=[],this._front=-1,this._rear=-1}isPhysicalMouseWheel(){if(this._front===-1&&this._rear===-1)return!1;let t=1,i=0,r=1,l=this._rear;do{let c=l===this._front?t:Math.pow(2,-r);if(t-=c,i+=this._memory[l].score*c,l===this._front)break;l=(this._capacity+l-1)%this._capacity,r++}while(!0);return i<=.5}acceptStandardWheelEvent(t){if(gp){let i=ji(t.browserEvent),r=YA(i);this.accept(Date.now(),t.deltaX*r,t.deltaY*r)}else this.accept(Date.now(),t.deltaX,t.deltaY)}accept(t,i,r){let l=null,c=new P3(t,i,r);this._front===-1&&this._rear===-1?(this._memory[0]=c,this._front=0,this._rear=0):(l=this._memory[this._rear],this._rear=(this._rear+1)%this._capacity,this._rear===this._front&&(this._front=(this._front+1)%this._capacity),this._memory[this._rear]=c),c.score=this._computeScore(c,l)}_computeScore(t,i){if(Math.abs(t.deltaX)>0&&Math.abs(t.deltaY)>0)return 1;let r=.5;if((!this._isAlmostInt(t.deltaX)||!this._isAlmostInt(t.deltaY))&&(r+=.25),i){let l=Math.abs(t.deltaX),c=Math.abs(t.deltaY),u=Math.abs(i.deltaX),d=Math.abs(i.deltaY),m=Math.max(Math.min(l,u),1),f=Math.max(Math.min(c,d),1),v=Math.max(l,u),_=Math.max(c,d);v%m===0&&_%f===0&&(r-=.5)}return Math.min(Math.max(r,0),1)}_isAlmostInt(t){return Math.abs(Math.round(t)-t)<.01}};ym.INSTANCE=new ym;var H3=ym,I3=class extends xp{constructor(e,t,i){super(),this._onScroll=this._register(new ge),this.onScroll=this._onScroll.event,this._onWillScroll=this._register(new ge),this.onWillScroll=this._onWillScroll.event,this._options=F3(t),this._scrollable=i,this._register(this._scrollable.onScroll(l=>{this._onWillScroll.fire(l),this._onDidScroll(l),this._onScroll.fire(l)}));let r={onMouseWheel:l=>this._onMouseWheel(l),onDragStart:()=>this._onDragStart(),onDragEnd:()=>this._onDragEnd()};this._verticalScrollbar=this._register(new O3(this._scrollable,this._options,r)),this._horizontalScrollbar=this._register(new B3(this._scrollable,this._options,r)),this._domNode=document.createElement("div"),this._domNode.className="xterm-scrollable-element "+this._options.className,this._domNode.setAttribute("role","presentation"),this._domNode.style.position="relative",this._domNode.appendChild(e),this._domNode.appendChild(this._horizontalScrollbar.domNode.domNode),this._domNode.appendChild(this._verticalScrollbar.domNode.domNode),this._options.useShadows?(this._leftShadowDomNode=Zl(document.createElement("div")),this._leftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._leftShadowDomNode.domNode),this._topShadowDomNode=Zl(document.createElement("div")),this._topShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topShadowDomNode.domNode),this._topLeftShadowDomNode=Zl(document.createElement("div")),this._topLeftShadowDomNode.setClassName("shadow"),this._domNode.appendChild(this._topLeftShadowDomNode.domNode)):(this._leftShadowDomNode=null,this._topShadowDomNode=null,this._topLeftShadowDomNode=null),this._listenOnDomNode=this._options.listenOnDomNode||this._domNode,this._mouseWheelToDispose=[],this._setListeningToMouseWheel(this._options.handleMouseWheel),this.onmouseover(this._listenOnDomNode,l=>this._onMouseOver(l)),this.onmouseleave(this._listenOnDomNode,l=>this._onMouseLeave(l)),this._hideTimeout=this._register(new _p),this._isDragging=!1,this._mouseIsOver=!1,this._shouldRender=!0,this._revealOnScroll=!0}get options(){return this._options}dispose(){this._mouseWheelToDispose=gr(this._mouseWheelToDispose),super.dispose()}getDomNode(){return this._domNode}getOverviewRulerLayoutInfo(){return{parent:this._domNode,insertBefore:this._verticalScrollbar.domNode.domNode}}delegateVerticalScrollbarPointerDown(e){this._verticalScrollbar.delegatePointerDown(e)}getScrollDimensions(){return this._scrollable.getScrollDimensions()}setScrollDimensions(e){this._scrollable.setScrollDimensions(e,!1)}updateClassName(e){this._options.className=e,ki&&(this._options.className+=" mac"),this._domNode.className="xterm-scrollable-element "+this._options.className}updateOptions(e){typeof e.handleMouseWheel<"u"&&(this._options.handleMouseWheel=e.handleMouseWheel,this._setListeningToMouseWheel(this._options.handleMouseWheel)),typeof e.mouseWheelScrollSensitivity<"u"&&(this._options.mouseWheelScrollSensitivity=e.mouseWheelScrollSensitivity),typeof e.fastScrollSensitivity<"u"&&(this._options.fastScrollSensitivity=e.fastScrollSensitivity),typeof e.scrollPredominantAxis<"u"&&(this._options.scrollPredominantAxis=e.scrollPredominantAxis),typeof e.horizontal<"u"&&(this._options.horizontal=e.horizontal),typeof e.vertical<"u"&&(this._options.vertical=e.vertical),typeof e.horizontalScrollbarSize<"u"&&(this._options.horizontalScrollbarSize=e.horizontalScrollbarSize),typeof e.verticalScrollbarSize<"u"&&(this._options.verticalScrollbarSize=e.verticalScrollbarSize),typeof e.scrollByPage<"u"&&(this._options.scrollByPage=e.scrollByPage),this._horizontalScrollbar.updateOptions(this._options),this._verticalScrollbar.updateOptions(this._options),this._options.lazyRender||this._render()}setRevealOnScroll(e){this._revealOnScroll=e}delegateScrollFromMouseWheelEvent(e){this._onMouseWheel(new eS(e))}_setListeningToMouseWheel(e){if(this._mouseWheelToDispose.length>0!==e&&(this._mouseWheelToDispose=gr(this._mouseWheelToDispose),e)){let t=i=>{this._onMouseWheel(new eS(i))};this._mouseWheelToDispose.push(Ne(this._listenOnDomNode,Ht.MOUSE_WHEEL,t,{passive:!1}))}}_onMouseWheel(e){if(e.browserEvent?.defaultPrevented)return;let t=H3.INSTANCE;t.acceptStandardWheelEvent(e);let i=!1;if(e.deltaY||e.deltaX){let l=e.deltaY*this._options.mouseWheelScrollSensitivity,c=e.deltaX*this._options.mouseWheelScrollSensitivity;this._options.scrollPredominantAxis&&(this._options.scrollYToX&&c+l===0?c=l=0:Math.abs(l)>=Math.abs(c)?c=0:l=0),this._options.flipAxes&&([l,c]=[c,l]);let u=!ki&&e.browserEvent&&e.browserEvent.shiftKey;(this._options.scrollYToX||u)&&!c&&(c=l,l=0),e.browserEvent&&e.browserEvent.altKey&&(c=c*this._options.fastScrollSensitivity,l=l*this._options.fastScrollSensitivity);let d=this._scrollable.getFutureScrollPosition(),m={};if(l){let f=lS*l,v=d.scrollTop-(f<0?Math.floor(f):Math.ceil(f));this._verticalScrollbar.writeScrollPosition(m,v)}if(c){let f=lS*c,v=d.scrollLeft-(f<0?Math.floor(f):Math.ceil(f));this._horizontalScrollbar.writeScrollPosition(m,v)}m=this._scrollable.validateScrollPosition(m),(d.scrollLeft!==m.scrollLeft||d.scrollTop!==m.scrollTop)&&(this._options.mouseWheelSmoothScroll&&t.isPhysicalMouseWheel()?this._scrollable.setScrollPositionSmooth(m):this._scrollable.setScrollPositionNow(m),i=!0)}let r=i;!r&&this._options.alwaysConsumeMouseWheel&&(r=!0),!r&&this._options.consumeMouseWheelIfScrollbarIsNeeded&&(this._verticalScrollbar.isNeeded()||this._horizontalScrollbar.isNeeded())&&(r=!0),r&&(e.preventDefault(),e.stopPropagation())}_onDidScroll(e){this._shouldRender=this._horizontalScrollbar.onDidScroll(e)||this._shouldRender,this._shouldRender=this._verticalScrollbar.onDidScroll(e)||this._shouldRender,this._options.useShadows&&(this._shouldRender=!0),this._revealOnScroll&&this._reveal(),this._options.lazyRender||this._render()}renderNow(){if(!this._options.lazyRender)throw new Error("Please use `lazyRender` together with `renderNow`!");this._render()}_render(){if(this._shouldRender&&(this._shouldRender=!1,this._horizontalScrollbar.render(),this._verticalScrollbar.render(),this._options.useShadows)){let e=this._scrollable.getCurrentScrollPosition(),t=e.scrollTop>0,i=e.scrollLeft>0,r=i?" left":"",l=t?" top":"",c=i||t?" top-left-corner":"";this._leftShadowDomNode.setClassName(`shadow${r}`),this._topShadowDomNode.setClassName(`shadow${l}`),this._topLeftShadowDomNode.setClassName(`shadow${c}${l}${r}`)}}_onDragStart(){this._isDragging=!0,this._reveal()}_onDragEnd(){this._isDragging=!1,this._hide()}_onMouseLeave(e){this._mouseIsOver=!1,this._hide()}_onMouseOver(e){this._mouseIsOver=!0,this._reveal()}_reveal(){this._verticalScrollbar.beginReveal(),this._horizontalScrollbar.beginReveal(),this._scheduleHide()}_hide(){!this._mouseIsOver&&!this._isDragging&&(this._verticalScrollbar.beginHide(),this._horizontalScrollbar.beginHide())}_scheduleHide(){!this._mouseIsOver&&!this._isDragging&&this._hideTimeout.cancelAndSet(()=>this._hide(),z3)}},U3=class extends I3{constructor(e,t,i){super(e,t,i)}setScrollPosition(e){e.reuseAnimation?this._scrollable.setScrollPositionSmooth(e,e.reuseAnimation):this._scrollable.setScrollPositionNow(e)}getScrollPosition(){return this._scrollable.getCurrentScrollPosition()}};function F3(e){let t={lazyRender:typeof e.lazyRender<"u"?e.lazyRender:!1,className:typeof e.className<"u"?e.className:"",useShadows:typeof e.useShadows<"u"?e.useShadows:!0,handleMouseWheel:typeof e.handleMouseWheel<"u"?e.handleMouseWheel:!0,flipAxes:typeof e.flipAxes<"u"?e.flipAxes:!1,consumeMouseWheelIfScrollbarIsNeeded:typeof e.consumeMouseWheelIfScrollbarIsNeeded<"u"?e.consumeMouseWheelIfScrollbarIsNeeded:!1,alwaysConsumeMouseWheel:typeof e.alwaysConsumeMouseWheel<"u"?e.alwaysConsumeMouseWheel:!1,scrollYToX:typeof e.scrollYToX<"u"?e.scrollYToX:!1,mouseWheelScrollSensitivity:typeof e.mouseWheelScrollSensitivity<"u"?e.mouseWheelScrollSensitivity:1,fastScrollSensitivity:typeof e.fastScrollSensitivity<"u"?e.fastScrollSensitivity:5,scrollPredominantAxis:typeof e.scrollPredominantAxis<"u"?e.scrollPredominantAxis:!0,mouseWheelSmoothScroll:typeof e.mouseWheelSmoothScroll<"u"?e.mouseWheelSmoothScroll:!0,arrowSize:typeof e.arrowSize<"u"?e.arrowSize:11,listenOnDomNode:typeof e.listenOnDomNode<"u"?e.listenOnDomNode:null,horizontal:typeof e.horizontal<"u"?e.horizontal:1,horizontalScrollbarSize:typeof e.horizontalScrollbarSize<"u"?e.horizontalScrollbarSize:10,horizontalSliderSize:typeof e.horizontalSliderSize<"u"?e.horizontalSliderSize:0,horizontalHasArrows:typeof e.horizontalHasArrows<"u"?e.horizontalHasArrows:!1,vertical:typeof e.vertical<"u"?e.vertical:1,verticalScrollbarSize:typeof e.verticalScrollbarSize<"u"?e.verticalScrollbarSize:10,verticalHasArrows:typeof e.verticalHasArrows<"u"?e.verticalHasArrows:!1,verticalSliderSize:typeof e.verticalSliderSize<"u"?e.verticalSliderSize:0,scrollByPage:typeof e.scrollByPage<"u"?e.scrollByPage:!1};return t.horizontalSliderSize=typeof e.horizontalSliderSize<"u"?e.horizontalSliderSize:t.horizontalScrollbarSize,t.verticalSliderSize=typeof e.verticalSliderSize<"u"?e.verticalSliderSize:t.verticalScrollbarSize,ki&&(t.className+=" mac"),t}var xm=class extends Be{constructor(e,t,i,r,l,c,u,d){super(),this._bufferService=i,this._optionsService=u,this._renderService=d,this._onRequestScrollLines=this._register(new ge),this.onRequestScrollLines=this._onRequestScrollLines.event,this._isSyncing=!1,this._isHandlingScroll=!1,this._suppressOnScrollHandler=!1;let m=this._register(new T3({forceIntegerValues:!1,smoothScrollDuration:this._optionsService.rawOptions.smoothScrollDuration,scheduleAtNextAnimationFrame:f=>yp(r.window,f)}));this._register(this._optionsService.onSpecificOptionChange("smoothScrollDuration",()=>{m.setSmoothScrollDuration(this._optionsService.rawOptions.smoothScrollDuration)})),this._scrollableElement=this._register(new U3(t,{vertical:1,horizontal:2,useShadows:!1,mouseWheelSmoothScroll:!0,...this._getChangeOptions()},m)),this._register(this._optionsService.onMultipleOptionChange(["scrollSensitivity","fastScrollSensitivity","overviewRuler"],()=>this._scrollableElement.updateOptions(this._getChangeOptions()))),this._register(l.onProtocolChange(f=>{this._scrollableElement.updateOptions({handleMouseWheel:!(f&16)})})),this._scrollableElement.setScrollDimensions({height:0,scrollHeight:0}),this._register(Xt.runAndSubscribe(c.onChangeColors,()=>{this._scrollableElement.getDomNode().style.backgroundColor=c.colors.background.css})),e.appendChild(this._scrollableElement.getDomNode()),this._register(ht(()=>this._scrollableElement.getDomNode().remove())),this._styleElement=r.mainDocument.createElement("style"),t.appendChild(this._styleElement),this._register(ht(()=>this._styleElement.remove())),this._register(Xt.runAndSubscribe(c.onChangeColors,()=>{this._styleElement.textContent=[".xterm .xterm-scrollable-element > .scrollbar > .slider {",`  background: ${c.colors.scrollbarSliderBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider:hover {",`  background: ${c.colors.scrollbarSliderHoverBackground.css};`,"}",".xterm .xterm-scrollable-element > .scrollbar > .slider.active {",`  background: ${c.colors.scrollbarSliderActiveBackground.css};`,"}"].join(`
`)})),this._register(this._bufferService.onResize(()=>this.queueSync())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._latestYDisp=void 0,this.queueSync()})),this._register(this._bufferService.onScroll(()=>this._sync())),this._register(this._scrollableElement.onScroll(f=>this._handleScroll(f)))}scrollLines(e){let t=this._scrollableElement.getScrollPosition();this._scrollableElement.setScrollPosition({reuseAnimation:!0,scrollTop:t.scrollTop+e*this._renderService.dimensions.css.cell.height})}scrollToLine(e,t){t&&(this._latestYDisp=e),this._scrollableElement.setScrollPosition({reuseAnimation:!t,scrollTop:e*this._renderService.dimensions.css.cell.height})}_getChangeOptions(){return{mouseWheelScrollSensitivity:this._optionsService.rawOptions.scrollSensitivity,fastScrollSensitivity:this._optionsService.rawOptions.fastScrollSensitivity,verticalScrollbarSize:this._optionsService.rawOptions.overviewRuler?.width||14}}queueSync(e){e!==void 0&&(this._latestYDisp=e),this._queuedAnimationFrame===void 0&&(this._queuedAnimationFrame=this._renderService.addRefreshCallback(()=>{this._queuedAnimationFrame=void 0,this._sync(this._latestYDisp)}))}_sync(e=this._bufferService.buffer.ydisp){!this._renderService||this._isSyncing||(this._isSyncing=!0,this._suppressOnScrollHandler=!0,this._scrollableElement.setScrollDimensions({height:this._renderService.dimensions.css.canvas.height,scrollHeight:this._renderService.dimensions.css.cell.height*this._bufferService.buffer.lines.length}),this._suppressOnScrollHandler=!1,e!==this._latestYDisp&&this._scrollableElement.setScrollPosition({scrollTop:e*this._renderService.dimensions.css.cell.height}),this._isSyncing=!1)}_handleScroll(e){if(!this._renderService||this._isHandlingScroll||this._suppressOnScrollHandler)return;this._isHandlingScroll=!0;let t=Math.round(e.scrollTop/this._renderService.dimensions.css.cell.height),i=t-this._bufferService.buffer.ydisp;i!==0&&(this._latestYDisp=t,this._onRequestScrollLines.fire(i)),this._isHandlingScroll=!1}};xm=_t([_e(2,ln),_e(3,ts),_e(4,Y0),_e(5,Ra),_e(6,on),_e(7,ns)],xm);var Sm=class extends Be{constructor(e,t,i,r,l){super(),this._screenElement=e,this._bufferService=t,this._coreBrowserService=i,this._decorationService=r,this._renderService=l,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this._register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this._register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this._register(this._decorationService.onDecorationRemoved(c=>this._removeDecoration(c))),this._register(ht(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(let e of this._decorationService.decorations)this._renderDecoration(e);this._dimensionsChanged=!1}_renderDecoration(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)}_createElement(e){let t=this._coreBrowserService.mainDocument.createElement("div");t.classList.add("xterm-decoration"),t.classList.toggle("xterm-decoration-top-layer",e?.options?.layer==="top"),t.style.width=`${Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,t.style.height=`${(e.options.height||1)*this._renderService.dimensions.css.cell.height}px`,t.style.top=`${(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height}px`,t.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;let i=e.options.x??0;return i&&i>this._bufferService.cols&&(t.style.display="none"),this._refreshXPosition(e,t),t}_refreshStyle(e){let t=e.marker.line-this._bufferService.buffers.active.ydisp;if(t<0||t>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{let i=this._decorationElements.get(e);i||(i=this._createElement(e),e.element=i,this._decorationElements.set(e,i),this._container.appendChild(i),e.onDispose(()=>{this._decorationElements.delete(e),i.remove()})),i.style.display=this._altBufferIsActive?"none":"block",this._altBufferIsActive||(i.style.width=`${Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,i.style.height=`${(e.options.height||1)*this._renderService.dimensions.css.cell.height}px`,i.style.top=`${t*this._renderService.dimensions.css.cell.height}px`,i.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`),e.onRenderEmitter.fire(i)}}_refreshXPosition(e,t=e.element){if(!t)return;let i=e.options.x??0;(e.options.anchor||"left")==="right"?t.style.right=i?`${i*this._renderService.dimensions.css.cell.width}px`:"":t.style.left=i?`${i*this._renderService.dimensions.css.cell.width}px`:""}_removeDecoration(e){this._decorationElements.get(e)?.remove(),this._decorationElements.delete(e),e.dispose()}};Sm=_t([_e(1,ln),_e(2,ts),_e(3,po),_e(4,ns)],Sm);var $3=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(e){if(e.options.overviewRulerOptions){for(let t of this._zones)if(t.color===e.options.overviewRulerOptions.color&&t.position===e.options.overviewRulerOptions.position){if(this._lineIntersectsZone(t,e.marker.line))return;if(this._lineAdjacentToZone(t,e.marker.line,e.options.overviewRulerOptions.position)){this._addLineToZone(t,e.marker.line);return}}if(this._zonePoolIndex<this._zonePool.length){this._zonePool[this._zonePoolIndex].color=e.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=e.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=e.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=e.marker.line,this._zones.push(this._zonePool[this._zonePoolIndex++]);return}this._zones.push({color:e.options.overviewRulerOptions.color,position:e.options.overviewRulerOptions.position,startBufferLine:e.marker.line,endBufferLine:e.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(e){this._linePadding=e}_lineIntersectsZone(e,t){return t>=e.startBufferLine&&t<=e.endBufferLine}_lineAdjacentToZone(e,t,i){return t>=e.startBufferLine-this._linePadding[i||"full"]&&t<=e.endBufferLine+this._linePadding[i||"full"]}_addLineToZone(e,t){e.startBufferLine=Math.min(e.startBufferLine,t),e.endBufferLine=Math.max(e.endBufferLine,t)}},_i={full:0,left:0,center:0,right:0},Rs={full:0,left:0,center:0,right:0},Ml={full:0,left:0,center:0,right:0},hu=class extends Be{constructor(e,t,i,r,l,c,u,d){super(),this._viewportElement=e,this._screenElement=t,this._bufferService=i,this._decorationService=r,this._renderService=l,this._optionsService=c,this._themeService=u,this._coreBrowserService=d,this._colorZoneStore=new $3,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),this._viewportElement.parentElement?.insertBefore(this._canvas,this._viewportElement),this._register(ht(()=>this._canvas?.remove()));let m=this._canvas.getContext("2d");if(m)this._ctx=m;else throw new Error("Ctx cannot be null");this._register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this._register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0))),this._register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this._register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this._register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())})),this._register(this._renderService.onRender(()=>{(!this._containerHeight||this._containerHeight!==this._screenElement.clientHeight)&&(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this._register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._register(this._optionsService.onSpecificOptionChange("overviewRuler",()=>this._queueRefresh(!0))),this._register(this._themeService.onChangeColors(()=>this._queueRefresh())),this._queueRefresh(!0)}get _width(){return this._optionsService.options.overviewRuler?.width||0}_refreshDrawConstants(){let e=Math.floor((this._canvas.width-1)/3),t=Math.ceil((this._canvas.width-1)/3);Rs.full=this._canvas.width,Rs.left=e,Rs.center=t,Rs.right=e,this._refreshDrawHeightConstants(),Ml.full=1,Ml.left=1,Ml.center=1+Rs.left,Ml.right=1+Rs.left+Rs.center}_refreshDrawHeightConstants(){_i.full=Math.round(2*this._coreBrowserService.dpr);let e=this._canvas.height/this._bufferService.buffer.lines.length,t=Math.round(Math.max(Math.min(e,12),6)*this._coreBrowserService.dpr);_i.left=t,_i.center=t,_i.right=t}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_i.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_i.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_i.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_i.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(let t of this._decorationService.decorations)this._colorZoneStore.addDecoration(t);this._ctx.lineWidth=1,this._renderRulerOutline();let e=this._colorZoneStore.zones;for(let t of e)t.position!=="full"&&this._renderColorZone(t);for(let t of e)t.position==="full"&&this._renderColorZone(t);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderRulerOutline(){this._ctx.fillStyle=this._themeService.colors.overviewRulerBorder.css,this._ctx.fillRect(0,0,1,this._canvas.height),this._optionsService.rawOptions.overviewRuler.showTopBorder&&this._ctx.fillRect(1,0,this._canvas.width-1,1),this._optionsService.rawOptions.overviewRuler.showBottomBorder&&this._ctx.fillRect(1,this._canvas.height-1,this._canvas.width-1,this._canvas.height)}_renderColorZone(e){this._ctx.fillStyle=e.color,this._ctx.fillRect(Ml[e.position||"full"],Math.round((this._canvas.height-1)*(e.startBufferLine/this._bufferService.buffers.active.lines.length)-_i[e.position||"full"]/2),Rs[e.position||"full"],Math.round((this._canvas.height-1)*((e.endBufferLine-e.startBufferLine)/this._bufferService.buffers.active.lines.length)+_i[e.position||"full"]))}_queueRefresh(e,t){this._shouldUpdateDimensions=e||this._shouldUpdateDimensions,this._shouldUpdateAnchor=t||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};hu=_t([_e(2,ln),_e(3,po),_e(4,ns),_e(5,on),_e(6,Ra),_e(7,ts)],hu);var ce;(e=>(e.NUL="\0",e.SOH="",e.STX="",e.ETX="",e.EOT="",e.ENQ="",e.ACK="",e.BEL="\x07",e.BS="\b",e.HT="	",e.LF=`
`,e.VT="\v",e.FF="\f",e.CR="\r",e.SO="",e.SI="",e.DLE="",e.DC1="",e.DC2="",e.DC3="",e.DC4="",e.NAK="",e.SYN="",e.ETB="",e.CAN="",e.EM="",e.SUB="",e.ESC="\x1B",e.FS="",e.GS="",e.RS="",e.US="",e.SP=" ",e.DEL=""))(ce||={});var tu;(e=>(e.PAD="",e.HOP="",e.BPH="",e.NBH="",e.IND="",e.NEL="",e.SSA="",e.ESA="",e.HTS="",e.HTJ="",e.VTS="",e.PLD="",e.PLU="",e.RI="",e.SS2="",e.SS3="",e.DCS="",e.PU1="",e.PU2="",e.STS="",e.CCH="",e.MW="",e.SPA="",e.EPA="",e.SOS="",e.SGCI="",e.SCI="",e.CSI="",e.ST="",e.OSC="",e.PM="",e.APC=""))(tu||={});var g1;(e=>e.ST=`${ce.ESC}\\`)(g1||={});var bm=class{constructor(e,t,i,r,l,c){this._textarea=e,this._compositionView=t,this._bufferService=i,this._optionsService=r,this._coreService=l,this._renderService=c,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(e){this._compositionView.textContent=e.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(e){if(this._isComposing||this._isSendingComposition){if(e.keyCode===20||e.keyCode===229||e.keyCode===16||e.keyCode===17||e.keyCode===18)return!1;this._finalizeComposition(!1)}return e.keyCode===229?(this._handleAnyTextareaChanges(),!1):!0}_finalizeComposition(e){if(this._compositionView.classList.remove("active"),this._isComposing=!1,e){let t={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){this._isSendingComposition=!1;let i;t.start+=this._dataAlreadySent.length,this._isComposing?i=this._textarea.value.substring(t.start,this._compositionPosition.start):i=this._textarea.value.substring(t.start),i.length>0&&this._coreService.triggerDataEvent(i,!0)}},0)}else{this._isSendingComposition=!1;let t=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(t,!0)}}_handleAnyTextareaChanges(){let e=this._textarea.value;setTimeout(()=>{if(!this._isComposing){let t=this._textarea.value,i=t.replace(e,"");this._dataAlreadySent=i,t.length>e.length?this._coreService.triggerDataEvent(i,!0):t.length<e.length?this._coreService.triggerDataEvent(`${ce.DEL}`,!0):t.length===e.length&&t!==e&&this._coreService.triggerDataEvent(t,!0)}},0)}updateCompositionElements(e){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){let t=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),i=this._renderService.dimensions.css.cell.height,r=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,l=t*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=l+"px",this._compositionView.style.top=r+"px",this._compositionView.style.height=i+"px",this._compositionView.style.lineHeight=i+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";let c=this._compositionView.getBoundingClientRect();this._textarea.style.left=l+"px",this._textarea.style.top=r+"px",this._textarea.style.width=Math.max(c.width,1)+"px",this._textarea.style.height=Math.max(c.height,1)+"px",this._textarea.style.lineHeight=c.height+"px"}e||setTimeout(()=>this.updateCompositionElements(!0),0)}}};bm=_t([_e(2,ln),_e(3,on),_e(4,yr),_e(5,ns)],bm);var It=0,Ut=0,Ft=0,vt=0,oS={css:"#00000000",rgba:0},Rt;(e=>{function t(l,c,u,d){return d!==void 0?`#${lr(l)}${lr(c)}${lr(u)}${lr(d)}`:`#${lr(l)}${lr(c)}${lr(u)}`}e.toCss=t;function i(l,c,u,d=255){return(l<<24|c<<16|u<<8|d)>>>0}e.toRgba=i;function r(l,c,u,d){return{css:e.toCss(l,c,u,d),rgba:e.toRgba(l,c,u,d)}}e.toColor=r})(Rt||={});var ot;(e=>{function t(m,f){if(vt=(f.rgba&255)/255,vt===1)return{css:f.css,rgba:f.rgba};let v=f.rgba>>24&255,_=f.rgba>>16&255,S=f.rgba>>8&255,x=m.rgba>>24&255,b=m.rgba>>16&255,C=m.rgba>>8&255;It=x+Math.round((v-x)*vt),Ut=b+Math.round((_-b)*vt),Ft=C+Math.round((S-C)*vt);let T=Rt.toCss(It,Ut,Ft),k=Rt.toRgba(It,Ut,Ft);return{css:T,rgba:k}}e.blend=t;function i(m){return(m.rgba&255)===255}e.isOpaque=i;function r(m,f,v){let _=nu.ensureContrastRatio(m.rgba,f.rgba,v);if(_)return Rt.toColor(_>>24&255,_>>16&255,_>>8&255)}e.ensureContrastRatio=r;function l(m){let f=(m.rgba|255)>>>0;return[It,Ut,Ft]=nu.toChannels(f),{css:Rt.toCss(It,Ut,Ft),rgba:f}}e.opaque=l;function c(m,f){return vt=Math.round(f*255),[It,Ut,Ft]=nu.toChannels(m.rgba),{css:Rt.toCss(It,Ut,Ft,vt),rgba:Rt.toRgba(It,Ut,Ft,vt)}}e.opacity=c;function u(m,f){return vt=m.rgba&255,c(m,vt*f/255)}e.multiplyOpacity=u;function d(m){return[m.rgba>>24&255,m.rgba>>16&255,m.rgba>>8&255]}e.toColorRGB=d})(ot||={});var mt;(e=>{let t,i;try{let l=document.createElement("canvas");l.width=1,l.height=1;let c=l.getContext("2d",{willReadFrequently:!0});c&&(t=c,t.globalCompositeOperation="copy",i=t.createLinearGradient(0,0,1,1))}catch{}function r(l){if(l.match(/#[\da-f]{3,8}/i))switch(l.length){case 4:return It=parseInt(l.slice(1,2).repeat(2),16),Ut=parseInt(l.slice(2,3).repeat(2),16),Ft=parseInt(l.slice(3,4).repeat(2),16),Rt.toColor(It,Ut,Ft);case 5:return It=parseInt(l.slice(1,2).repeat(2),16),Ut=parseInt(l.slice(2,3).repeat(2),16),Ft=parseInt(l.slice(3,4).repeat(2),16),vt=parseInt(l.slice(4,5).repeat(2),16),Rt.toColor(It,Ut,Ft,vt);case 7:return{css:l,rgba:(parseInt(l.slice(1),16)<<8|255)>>>0};case 9:return{css:l,rgba:parseInt(l.slice(1),16)>>>0}}let c=l.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(c)return It=parseInt(c[1]),Ut=parseInt(c[2]),Ft=parseInt(c[3]),vt=Math.round((c[5]===void 0?1:parseFloat(c[5]))*255),Rt.toColor(It,Ut,Ft,vt);if(!t||!i)throw new Error("css.toColor: Unsupported css format");if(t.fillStyle=i,t.fillStyle=l,typeof t.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(t.fillRect(0,0,1,1),[It,Ut,Ft,vt]=t.getImageData(0,0,1,1).data,vt!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:Rt.toRgba(It,Ut,Ft,vt),css:l}}e.toColor=r})(mt||={});var rn;(e=>{function t(r){return i(r>>16&255,r>>8&255,r&255)}e.relativeLuminance=t;function i(r,l,c){let u=r/255,d=l/255,m=c/255,f=u<=.03928?u/12.92:Math.pow((u+.055)/1.055,2.4),v=d<=.03928?d/12.92:Math.pow((d+.055)/1.055,2.4),_=m<=.03928?m/12.92:Math.pow((m+.055)/1.055,2.4);return f*.2126+v*.7152+_*.0722}e.relativeLuminance2=i})(rn||={});var nu;(e=>{function t(u,d){if(vt=(d&255)/255,vt===1)return d;let m=d>>24&255,f=d>>16&255,v=d>>8&255,_=u>>24&255,S=u>>16&255,x=u>>8&255;return It=_+Math.round((m-_)*vt),Ut=S+Math.round((f-S)*vt),Ft=x+Math.round((v-x)*vt),Rt.toRgba(It,Ut,Ft)}e.blend=t;function i(u,d,m){let f=rn.relativeLuminance(u>>8),v=rn.relativeLuminance(d>>8);if(Yi(f,v)<m){if(v<f){let x=r(u,d,m),b=Yi(f,rn.relativeLuminance(x>>8));if(b<m){let C=l(u,d,m),T=Yi(f,rn.relativeLuminance(C>>8));return b>T?x:C}return x}let _=l(u,d,m),S=Yi(f,rn.relativeLuminance(_>>8));if(S<m){let x=r(u,d,m),b=Yi(f,rn.relativeLuminance(x>>8));return S>b?_:x}return _}}e.ensureContrastRatio=i;function r(u,d,m){let f=u>>24&255,v=u>>16&255,_=u>>8&255,S=d>>24&255,x=d>>16&255,b=d>>8&255,C=Yi(rn.relativeLuminance2(S,x,b),rn.relativeLuminance2(f,v,_));for(;C<m&&(S>0||x>0||b>0);)S-=Math.max(0,Math.ceil(S*.1)),x-=Math.max(0,Math.ceil(x*.1)),b-=Math.max(0,Math.ceil(b*.1)),C=Yi(rn.relativeLuminance2(S,x,b),rn.relativeLuminance2(f,v,_));return(S<<24|x<<16|b<<8|255)>>>0}e.reduceLuminance=r;function l(u,d,m){let f=u>>24&255,v=u>>16&255,_=u>>8&255,S=d>>24&255,x=d>>16&255,b=d>>8&255,C=Yi(rn.relativeLuminance2(S,x,b),rn.relativeLuminance2(f,v,_));for(;C<m&&(S<255||x<255||b<255);)S=Math.min(255,S+Math.ceil((255-S)*.1)),x=Math.min(255,x+Math.ceil((255-x)*.1)),b=Math.min(255,b+Math.ceil((255-b)*.1)),C=Yi(rn.relativeLuminance2(S,x,b),rn.relativeLuminance2(f,v,_));return(S<<24|x<<16|b<<8|255)>>>0}e.increaseLuminance=l;function c(u){return[u>>24&255,u>>16&255,u>>8&255,u&255]}e.toChannels=c})(nu||={});function lr(e){let t=e.toString(16);return t.length<2?"0"+t:t}function Yi(e,t){return e<t?(t+.05)/(e+.05):(e+.05)/(t+.05)}var K3=class extends mo{constructor(e,t,i){super(),this.content=0,this.combinedData="",this.fg=e.fg,this.bg=e.bg,this.combinedData=t,this._width=i}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(e){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}},du=class{constructor(e){this._bufferService=e,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new ti}register(e){let t={id:this._nextCharacterJoinerId++,handler:e};return this._characterJoiners.push(t),t.id}deregister(e){for(let t=0;t<this._characterJoiners.length;t++)if(this._characterJoiners[t].id===e)return this._characterJoiners.splice(t,1),!0;return!1}getJoinedCharacters(e){if(this._characterJoiners.length===0)return[];let t=this._bufferService.buffer.lines.get(e);if(!t||t.length===0)return[];let i=[],r=t.translateToString(!0),l=0,c=0,u=0,d=t.getFg(0),m=t.getBg(0);for(let f=0;f<t.getTrimmedLength();f++)if(t.loadCell(f,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==d||this._workCell.bg!==m){if(f-l>1){let v=this._getJoinedRanges(r,u,c,t,l);for(let _=0;_<v.length;_++)i.push(v[_])}l=f,u=c,d=this._workCell.fg,m=this._workCell.bg}c+=this._workCell.getChars().length||Ms.length}if(this._bufferService.cols-l>1){let f=this._getJoinedRanges(r,u,c,t,l);for(let v=0;v<f.length;v++)i.push(f[v])}return i}_getJoinedRanges(e,t,i,r,l){let c=e.substring(t,i),u=[];try{u=this._characterJoiners[0].handler(c)}catch(d){console.error(d)}for(let d=1;d<this._characterJoiners.length;d++)try{let m=this._characterJoiners[d].handler(c);for(let f=0;f<m.length;f++)du._mergeRanges(u,m[f])}catch(m){console.error(m)}return this._stringRangesToCellRanges(u,r,l),u}_stringRangesToCellRanges(e,t,i){let r=0,l=!1,c=0,u=e[r];if(u){for(let d=i;d<this._bufferService.cols;d++){let m=t.getWidth(d),f=t.getString(d).length||Ms.length;if(m!==0){if(!l&&u[0]<=c&&(u[0]=d,l=!0),u[1]<=c){if(u[1]=d,u=e[++r],!u)break;u[0]<=c?(u[0]=d,l=!0):l=!1}c+=f}}u&&(u[1]=this._bufferService.cols)}}static _mergeRanges(e,t){let i=!1;for(let r=0;r<e.length;r++){let l=e[r];if(i){if(t[1]<=l[0])return e[r-1][1]=t[1],e;if(t[1]<=l[1])return e[r-1][1]=Math.max(t[1],l[1]),e.splice(r,1),e;e.splice(r,1),r--}else{if(t[1]<=l[0])return e.splice(r,0,t),e;if(t[1]<=l[1])return l[0]=Math.min(t[0],l[0]),e;t[0]<l[1]&&(l[0]=Math.min(t[0],l[0]),i=!0);continue}}return i?e[e.length-1][1]=t[1]:e.push(t),e}};du=_t([_e(0,ln)],du);function q3(e){return 57508<=e&&e<=57558}function W3(e){return 9472<=e&&e<=9631}function V3(e){return q3(e)||W3(e)}function G3(){return{css:{canvas:$c(),cell:$c()},device:{canvas:$c(),cell:$c(),char:{width:0,height:0,left:0,top:0}}}}function $c(){return{width:0,height:0}}var wm=class{constructor(e,t,i,r,l,c,u){this._document=e,this._characterJoinerService=t,this._optionsService=i,this._coreBrowserService=r,this._coreService=l,this._decorationService=c,this._themeService=u,this._workCell=new ti,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(e,t,i){this._selectionStart=e,this._selectionEnd=t,this._columnSelectMode=i}createRow(e,t,i,r,l,c,u,d,m,f,v){let _=[],S=this._characterJoinerService.getJoinedCharacters(t),x=this._themeService.colors,b=e.getNoBgTrimmedLength();i&&b<c+1&&(b=c+1);let C,T=0,k="",R=0,N=0,E=0,z=0,B=!1,I=0,q=!1,F=0,V=0,G=[],Y=f!==-1&&v!==-1;for(let M=0;M<b;M++){e.loadCell(M,this._workCell);let j=this._workCell.getWidth();if(j===0)continue;let A=!1,D=M>=V,$=M,W=this._workCell;if(S.length>0&&M===S[0][0]&&D){let De=S.shift(),yt=this._isCellInSelection(De[0],t);for(R=De[0]+1;R<De[1];R++)D&&=yt===this._isCellInSelection(R,t);D&&=!i||c<De[0]||c>=De[1],D?(A=!0,W=new K3(this._workCell,e.translateToString(!0,De[0],De[1]),De[1]-De[0]),$=De[1]-1,j=W.getWidth()):V=De[1]}let ne=this._isCellInSelection(M,t),U=i&&M===c,P=Y&&M>=f&&M<=v,H=!1;this._decorationService.forEachDecorationAtCell(M,t,void 0,De=>{H=!0});let L=W.getChars()||Ms;if(L===" "&&(W.isUnderline()||W.isOverline())&&(L=""),F=j*d-m.get(L,W.isBold(),W.isItalic()),!C)C=this._document.createElement("span");else if(T&&(ne&&q||!ne&&!q&&W.bg===N)&&(ne&&q&&x.selectionForeground||W.fg===E)&&W.extended.ext===z&&P===B&&F===I&&!U&&!A&&!H&&D){W.isInvisible()?k+=Ms:k+=L,T++;continue}else T&&(C.textContent=k),C=this._document.createElement("span"),T=0,k="";if(N=W.bg,E=W.fg,z=W.extended.ext,B=P,I=F,q=ne,A&&c>=M&&c<=$&&(c=M),!this._coreService.isCursorHidden&&U&&this._coreService.isCursorInitialized){if(G.push("xterm-cursor"),this._coreBrowserService.isFocused)u&&G.push("xterm-cursor-blink"),G.push(r==="bar"?"xterm-cursor-bar":r==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(l)switch(l){case"outline":G.push("xterm-cursor-outline");break;case"block":G.push("xterm-cursor-block");break;case"bar":G.push("xterm-cursor-bar");break;case"underline":G.push("xterm-cursor-underline");break}}if(W.isBold()&&G.push("xterm-bold"),W.isItalic()&&G.push("xterm-italic"),W.isDim()&&G.push("xterm-dim"),W.isInvisible()?k=Ms:k=W.getChars()||Ms,W.isUnderline()&&(G.push(`xterm-underline-${W.extended.underlineStyle}`),k===" "&&(k=""),!W.isUnderlineColorDefault()))if(W.isUnderlineColorRGB())C.style.textDecorationColor=`rgb(${mo.toColorRGB(W.getUnderlineColor()).join(",")})`;else{let De=W.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&W.isBold()&&De<8&&(De+=8),C.style.textDecorationColor=x.ansi[De].css}W.isOverline()&&(G.push("xterm-overline"),k===" "&&(k="")),W.isStrikethrough()&&G.push("xterm-strikethrough"),P&&(C.style.textDecoration="underline");let re=W.getFgColor(),me=W.getFgColorMode(),he=W.getBgColor(),de=W.getBgColorMode(),oe=!!W.isInverse();if(oe){let De=re;re=he,he=De;let yt=me;me=de,de=yt}let ye,ue,Se=!1;this._decorationService.forEachDecorationAtCell(M,t,void 0,De=>{De.options.layer!=="top"&&Se||(De.backgroundColorRGB&&(de=50331648,he=De.backgroundColorRGB.rgba>>8&16777215,ye=De.backgroundColorRGB),De.foregroundColorRGB&&(me=50331648,re=De.foregroundColorRGB.rgba>>8&16777215,ue=De.foregroundColorRGB),Se=De.options.layer==="top")}),!Se&&ne&&(ye=this._coreBrowserService.isFocused?x.selectionBackgroundOpaque:x.selectionInactiveBackgroundOpaque,he=ye.rgba>>8&16777215,de=50331648,Se=!0,x.selectionForeground&&(me=50331648,re=x.selectionForeground.rgba>>8&16777215,ue=x.selectionForeground)),Se&&G.push("xterm-decoration-top");let Oe;switch(de){case 16777216:case 33554432:Oe=x.ansi[he],G.push(`xterm-bg-${he}`);break;case 50331648:Oe=Rt.toColor(he>>16,he>>8&255,he&255),this._addStyle(C,`background-color:#${cS((he>>>0).toString(16),"0",6)}`);break;default:oe?(Oe=x.foreground,G.push("xterm-bg-257")):Oe=x.background}switch(ye||W.isDim()&&(ye=ot.multiplyOpacity(Oe,.5)),me){case 16777216:case 33554432:W.isBold()&&re<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(re+=8),this._applyMinimumContrast(C,Oe,x.ansi[re],W,ye,void 0)||G.push(`xterm-fg-${re}`);break;case 50331648:let De=Rt.toColor(re>>16&255,re>>8&255,re&255);this._applyMinimumContrast(C,Oe,De,W,ye,ue)||this._addStyle(C,`color:#${cS(re.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(C,Oe,x.foreground,W,ye,ue)||oe&&G.push("xterm-fg-257")}G.length&&(C.className=G.join(" "),G.length=0),!U&&!A&&!H&&D?T++:C.textContent=k,F!==this.defaultSpacing&&(C.style.letterSpacing=`${F}px`),_.push(C),M=$}return C&&T&&(C.textContent=k),_}_applyMinimumContrast(e,t,i,r,l,c){if(this._optionsService.rawOptions.minimumContrastRatio===1||V3(r.getCode()))return!1;let u=this._getContrastCache(r),d;if(!l&&!c&&(d=u.getColor(t.rgba,i.rgba)),d===void 0){let m=this._optionsService.rawOptions.minimumContrastRatio/(r.isDim()?2:1);d=ot.ensureContrastRatio(l||t,c||i,m),u.setColor((l||t).rgba,(c||i).rgba,d??null)}return d?(this._addStyle(e,`color:${d.css}`),!0):!1}_getContrastCache(e){return e.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(e,t){e.setAttribute("style",`${e.getAttribute("style")||""}${t};`)}_isCellInSelection(e,t){let i=this._selectionStart,r=this._selectionEnd;return!i||!r?!1:this._columnSelectMode?i[0]<=r[0]?e>=i[0]&&t>=i[1]&&e<r[0]&&t<=r[1]:e<i[0]&&t>=i[1]&&e>=r[0]&&t<=r[1]:t>i[1]&&t<r[1]||i[1]===r[1]&&t===i[1]&&e>=i[0]&&e<r[0]||i[1]<r[1]&&t===r[1]&&e<r[0]||i[1]<r[1]&&t===i[1]&&e>=i[0]}};wm=_t([_e(1,Z0),_e(2,on),_e(3,ts),_e(4,yr),_e(5,po),_e(6,Ra)],wm);function cS(e,t,i){for(;e.length<i;)e=t+e;return e}var Y3=class{constructor(e,t){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=e.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";let i=e.createElement("span");i.classList.add("xterm-char-measure-element");let r=e.createElement("span");r.classList.add("xterm-char-measure-element"),r.style.fontWeight="bold";let l=e.createElement("span");l.classList.add("xterm-char-measure-element"),l.style.fontStyle="italic";let c=e.createElement("span");c.classList.add("xterm-char-measure-element"),c.style.fontWeight="bold",c.style.fontStyle="italic",this._measureElements=[i,r,l,c],this._container.appendChild(i),this._container.appendChild(r),this._container.appendChild(l),this._container.appendChild(c),t.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(e,t,i,r){e===this._font&&t===this._fontSize&&i===this._weight&&r===this._weightBold||(this._font=e,this._fontSize=t,this._weight=i,this._weightBold=r,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${i}`,this._measureElements[1].style.fontWeight=`${r}`,this._measureElements[2].style.fontWeight=`${i}`,this._measureElements[3].style.fontWeight=`${r}`,this.clear())}get(e,t,i){let r=0;if(!t&&!i&&e.length===1&&(r=e.charCodeAt(0))<256){if(this._flat[r]!==-9999)return this._flat[r];let u=this._measure(e,0);return u>0&&(this._flat[r]=u),u}let l=e;t&&(l+="B"),i&&(l+="I");let c=this._holey.get(l);if(c===void 0){let u=0;t&&(u|=1),i&&(u|=2),c=this._measure(e,u),c>0&&this._holey.set(l,c)}return c}_measure(e,t){let i=this._measureElements[t];return i.textContent=e.repeat(32),i.offsetWidth/32}},X3=class{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(e,t,i,r=!1){if(this.selectionStart=t,this.selectionEnd=i,!t||!i||t[0]===i[0]&&t[1]===i[1]){this.clear();return}let l=e.buffers.active.ydisp,c=t[1]-l,u=i[1]-l,d=Math.max(c,0),m=Math.min(u,e.rows-1);if(d>=e.rows||m<0){this.clear();return}this.hasSelection=!0,this.columnSelectMode=r,this.viewportStartRow=c,this.viewportEndRow=u,this.viewportCappedStartRow=d,this.viewportCappedEndRow=m,this.startCol=t[0],this.endCol=i[0]}isCellSelected(e,t,i){return this.hasSelection?(i-=e.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?t>=this.startCol&&i>=this.viewportCappedStartRow&&t<this.endCol&&i<=this.viewportCappedEndRow:t<this.startCol&&i>=this.viewportCappedStartRow&&t>=this.endCol&&i<=this.viewportCappedEndRow:i>this.viewportStartRow&&i<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportEndRow&&t<this.endCol||this.viewportStartRow<this.viewportEndRow&&i===this.viewportStartRow&&t>=this.startCol):!1}};function J3(){return new X3}var Cf="xterm-dom-renderer-owner-",Jn="xterm-rows",Kc="xterm-fg-",uS="xterm-bg-",Bl="xterm-focus",qc="xterm-selection",Z3=1,Cm=class extends Be{constructor(e,t,i,r,l,c,u,d,m,f,v,_,S,x){super(),this._terminal=e,this._document=t,this._element=i,this._screenElement=r,this._viewportElement=l,this._helperContainer=c,this._linkifier2=u,this._charSizeService=m,this._optionsService=f,this._bufferService=v,this._coreService=_,this._coreBrowserService=S,this._themeService=x,this._terminalClass=Z3++,this._rowElements=[],this._selectionRenderModel=J3(),this.onRequestRedraw=this._register(new ge).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(Jn),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(qc),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=G3(),this._updateDimensions(),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._themeService.onChangeColors(b=>this._injectCss(b))),this._injectCss(this._themeService.colors),this._rowFactory=d.createInstance(wm,document),this._element.classList.add(Cf+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this._register(this._linkifier2.onShowLinkUnderline(b=>this._handleLinkHover(b))),this._register(this._linkifier2.onHideLinkUnderline(b=>this._handleLinkLeave(b))),this._register(ht(()=>{this._element.classList.remove(Cf+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new Y3(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){let e=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*e,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*e),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/e),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/e),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(let i of this._rowElements)i.style.width=`${this.dimensions.css.canvas.width}px`,i.style.height=`${this.dimensions.css.cell.height}px`,i.style.lineHeight=`${this.dimensions.css.cell.height}px`,i.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));let t=`${this._terminalSelector} .${Jn} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=t,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(e){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let t=`${this._terminalSelector} .${Jn} { pointer-events: none; color: ${e.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;t+=`${this._terminalSelector} .${Jn} .xterm-dim { color: ${ot.multiplyOpacity(e.foreground,.5).css};}`,t+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;let i=`blink_underline_${this._terminalClass}`,r=`blink_bar_${this._terminalClass}`,l=`blink_block_${this._terminalClass}`;t+=`@keyframes ${i} { 50% {  border-bottom-style: hidden; }}`,t+=`@keyframes ${r} { 50% {  box-shadow: none; }}`,t+=`@keyframes ${l} { 0% {  background-color: ${e.cursor.css};  color: ${e.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${e.cursor.css}; }}`,t+=`${this._terminalSelector} .${Jn}.${Bl} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${i} 1s step-end infinite;}${this._terminalSelector} .${Jn}.${Bl} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${r} 1s step-end infinite;}${this._terminalSelector} .${Jn}.${Bl} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${l} 1s step-end infinite;}${this._terminalSelector} .${Jn} .xterm-cursor.xterm-cursor-block { background-color: ${e.cursor.css}; color: ${e.cursorAccent.css};}${this._terminalSelector} .${Jn} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${e.cursor.css} !important; color: ${e.cursorAccent.css} !important;}${this._terminalSelector} .${Jn} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${e.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${Jn} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${e.cursor.css} inset;}${this._terminalSelector} .${Jn} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${e.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,t+=`${this._terminalSelector} .${qc} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${qc} div { position: absolute; background-color: ${e.selectionBackgroundOpaque.css};}${this._terminalSelector} .${qc} div { position: absolute; background-color: ${e.selectionInactiveBackgroundOpaque.css};}`;for(let[c,u]of e.ansi.entries())t+=`${this._terminalSelector} .${Kc}${c} { color: ${u.css}; }${this._terminalSelector} .${Kc}${c}.xterm-dim { color: ${ot.multiplyOpacity(u,.5).css}; }${this._terminalSelector} .${uS}${c} { background-color: ${u.css}; }`;t+=`${this._terminalSelector} .${Kc}257 { color: ${ot.opaque(e.background).css}; }${this._terminalSelector} .${Kc}257.xterm-dim { color: ${ot.multiplyOpacity(ot.opaque(e.background),.5).css}; }${this._terminalSelector} .${uS}257 { background-color: ${e.foreground.css}; }`,this._themeStyleElement.textContent=t}_setDefaultSpacing(){let e=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${e}px`,this._rowFactory.defaultSpacing=e}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(e,t){for(let i=this._rowElements.length;i<=t;i++){let r=this._document.createElement("div");this._rowContainer.appendChild(r),this._rowElements.push(r)}for(;this._rowElements.length>t;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(e,t){this._refreshRowElements(e,t),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(Bl),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(Bl),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(e,t,i){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(e,t,i),this.renderRows(0,this._bufferService.rows-1),!e||!t||(this._selectionRenderModel.update(this._terminal,e,t,i),!this._selectionRenderModel.hasSelection))return;let r=this._selectionRenderModel.viewportStartRow,l=this._selectionRenderModel.viewportEndRow,c=this._selectionRenderModel.viewportCappedStartRow,u=this._selectionRenderModel.viewportCappedEndRow,d=this._document.createDocumentFragment();if(i){let m=e[0]>t[0];d.appendChild(this._createSelectionElement(c,m?t[0]:e[0],m?e[0]:t[0],u-c+1))}else{let m=r===c?e[0]:0,f=c===l?t[0]:this._bufferService.cols;d.appendChild(this._createSelectionElement(c,m,f));let v=u-c-1;if(d.appendChild(this._createSelectionElement(c+1,0,this._bufferService.cols,v)),c!==u){let _=l===u?t[0]:this._bufferService.cols;d.appendChild(this._createSelectionElement(u,0,_))}}this._selectionContainer.appendChild(d)}_createSelectionElement(e,t,i,r=1){let l=this._document.createElement("div"),c=t*this.dimensions.css.cell.width,u=this.dimensions.css.cell.width*(i-t);return c+u>this.dimensions.css.canvas.width&&(u=this.dimensions.css.canvas.width-c),l.style.height=`${r*this.dimensions.css.cell.height}px`,l.style.top=`${e*this.dimensions.css.cell.height}px`,l.style.left=`${c}px`,l.style.width=`${u}px`,l}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(let e of this._rowElements)e.replaceChildren()}renderRows(e,t){let i=this._bufferService.buffer,r=i.ybase+i.y,l=Math.min(i.x,this._bufferService.cols-1),c=this._coreService.decPrivateModes.cursorBlink??this._optionsService.rawOptions.cursorBlink,u=this._coreService.decPrivateModes.cursorStyle??this._optionsService.rawOptions.cursorStyle,d=this._optionsService.rawOptions.cursorInactiveStyle;for(let m=e;m<=t;m++){let f=m+i.ydisp,v=this._rowElements[m],_=i.lines.get(f);if(!v||!_)break;v.replaceChildren(...this._rowFactory.createRow(_,f,f===r,u,d,l,c,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${Cf}${this._terminalClass}`}_handleLinkHover(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!0)}_handleLinkLeave(e){this._setCellUnderline(e.x1,e.x2,e.y1,e.y2,e.cols,!1)}_setCellUnderline(e,t,i,r,l,c){i<0&&(e=0),r<0&&(t=0);let u=this._bufferService.rows-1;i=Math.max(Math.min(i,u),0),r=Math.max(Math.min(r,u),0),l=Math.min(l,this._bufferService.cols);let d=this._bufferService.buffer,m=d.ybase+d.y,f=Math.min(d.x,l-1),v=this._optionsService.rawOptions.cursorBlink,_=this._optionsService.rawOptions.cursorStyle,S=this._optionsService.rawOptions.cursorInactiveStyle;for(let x=i;x<=r;++x){let b=x+d.ydisp,C=this._rowElements[x],T=d.lines.get(b);if(!C||!T)break;C.replaceChildren(...this._rowFactory.createRow(T,b,b===m,_,S,f,v,this.dimensions.css.cell.width,this._widthCache,c?x===i?e:0:-1,c?(x===r?t:l)-1:-1))}}};Cm=_t([_e(7,fp),_e(8,Tu),_e(9,on),_e(10,ln),_e(11,yr),_e(12,ts),_e(13,Ra)],Cm);var jm=class extends Be{constructor(e,t,i){super(),this._optionsService=i,this.width=0,this.height=0,this._onCharSizeChange=this._register(new ge),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this._register(new e4(this._optionsService))}catch{this._measureStrategy=this._register(new Q3(e,t,this._optionsService))}this._register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){let e=this._measureStrategy.measure();(e.width!==this.width||e.height!==this.height)&&(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};jm=_t([_e(2,on)],jm);var v1=class extends Be{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(e,t){e!==void 0&&e>0&&t!==void 0&&t>0&&(this._result.width=e,this._result.height=t)}},Q3=class extends v1{constructor(e,t,i){super(),this._document=e,this._parentElement=t,this._optionsService=i,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}},e4=class extends v1{constructor(e){super(),this._optionsService=e,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");let t=this._ctx.measureText("W");if(!("width"in t&&"fontBoundingBoxAscent"in t&&"fontBoundingBoxDescent"in t))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;let e=this._ctx.measureText("W");return this._validateAndSet(e.width,e.fontBoundingBoxAscent+e.fontBoundingBoxDescent),this._result}},t4=class extends Be{constructor(e,t,i){super(),this._textarea=e,this._window=t,this.mainDocument=i,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=this._register(new n4(this._window)),this._onDprChange=this._register(new ge),this.onDprChange=this._onDprChange.event,this._onWindowChange=this._register(new ge),this.onWindowChange=this._onWindowChange.event,this._register(this.onWindowChange(r=>this._screenDprMonitor.setWindow(r))),this._register(Xt.forward(this._screenDprMonitor.onDprChange,this._onDprChange)),this._register(Ne(this._textarea,"focus",()=>this._isFocused=!0)),this._register(Ne(this._textarea,"blur",()=>this._isFocused=!1))}get window(){return this._window}set window(e){this._window!==e&&(this._window=e,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}},n4=class extends Be{constructor(e){super(),this._parentWindow=e,this._windowResizeListener=this._register(new ba),this._onDprChange=this._register(new ge),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this._register(ht(()=>this.clearListener()))}setWindow(e){this._parentWindow=e,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=Ne(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){this._outerListener&&(this._resolutionMediaMatchList?.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){!this._resolutionMediaMatchList||!this._outerListener||(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}},i4=class extends Be{constructor(){super(),this.linkProviders=[],this._register(ht(()=>this.linkProviders.length=0))}registerLinkProvider(e){return this.linkProviders.push(e),{dispose:()=>{let t=this.linkProviders.indexOf(e);t!==-1&&this.linkProviders.splice(t,1)}}}};function Sp(e,t,i){let r=i.getBoundingClientRect(),l=e.getComputedStyle(i),c=parseInt(l.getPropertyValue("padding-left")),u=parseInt(l.getPropertyValue("padding-top"));return[t.clientX-r.left-c,t.clientY-r.top-u]}function s4(e,t,i,r,l,c,u,d,m){if(!c)return;let f=Sp(e,t,i);if(f)return f[0]=Math.ceil((f[0]+(m?u/2:0))/u),f[1]=Math.ceil(f[1]/d),f[0]=Math.min(Math.max(f[0],1),r+(m?1:0)),f[1]=Math.min(Math.max(f[1],1),l),f}var km=class{constructor(e,t){this._renderService=e,this._charSizeService=t}getCoords(e,t,i,r,l){return s4(window,e,t,i,r,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,l)}getMouseReportCoords(e,t){let i=Sp(window,e,t);if(this._charSizeService.hasValidSize)return i[0]=Math.min(Math.max(i[0],0),this._renderService.dimensions.css.canvas.width-1),i[1]=Math.min(Math.max(i[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(i[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(i[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(i[0]),y:Math.floor(i[1])}}};km=_t([_e(0,ns),_e(1,Tu)],km);var r4=class{constructor(e,t){this._renderCallback=e,this._coreBrowserService=t,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(e){return this._refreshCallbacks.push(e),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(e,t,i){this._rowCount=i,e=e!==void 0?e:0,t=t!==void 0?t:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,e):e,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,t):t,!this._animationFrame&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0){this._runRefreshCallbacks();return}let e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(let e of this._refreshCallbacks)e(0);this._refreshCallbacks=[]}},_1={};pA(_1,{getSafariVersion:()=>l4,isChromeOS:()=>b1,isFirefox:()=>y1,isIpad:()=>o4,isIphone:()=>c4,isLegacyEdge:()=>a4,isLinux:()=>bp,isMac:()=>fu,isNode:()=>Ru,isSafari:()=>x1,isWindows:()=>S1});var Ru=typeof process<"u"&&"title"in process,go=Ru?"node":navigator.userAgent,vo=Ru?"node":navigator.platform,y1=go.includes("Firefox"),a4=go.includes("Edge"),x1=/^((?!chrome|android).)*safari/i.test(go);function l4(){if(!x1)return 0;let e=go.match(/Version\/(\d+)/);return e===null||e.length<2?0:parseInt(e[1])}var fu=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(vo),o4=vo==="iPad",c4=vo==="iPhone",S1=["Windows","Win16","Win32","WinCE"].includes(vo),bp=vo.indexOf("Linux")>=0,b1=/\bCrOS\b/.test(go),w1=class{constructor(){this._tasks=[],this._i=0}enqueue(e){this._tasks.push(e),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(e){this._idleCallback=void 0;let t=0,i=0,r=e.timeRemaining(),l=0;for(;this._i<this._tasks.length;){if(t=performance.now(),this._tasks[this._i]()||this._i++,t=Math.max(1,performance.now()-t),i=Math.max(t,i),l=e.timeRemaining(),i*1.5>l){r-t<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(r-t))}ms`),this._start();return}r=l}this.clear()}},u4=class extends w1{_requestCallback(e){return setTimeout(()=>e(this._createDeadline(16)))}_cancelCallback(e){clearTimeout(e)}_createDeadline(e){let t=performance.now()+e;return{timeRemaining:()=>Math.max(0,t-performance.now())}}},h4=class extends w1{_requestCallback(e){return requestIdleCallback(e)}_cancelCallback(e){cancelIdleCallback(e)}},mu=!Ru&&"requestIdleCallback"in window?h4:u4,d4=class{constructor(){this._queue=new mu}set(e){this._queue.clear(),this._queue.enqueue(e)}flush(){this._queue.flush()}},Nm=class extends Be{constructor(e,t,i,r,l,c,u,d,m){super(),this._rowCount=e,this._optionsService=i,this._charSizeService=r,this._coreService=l,this._coreBrowserService=d,this._renderer=this._register(new ba),this._pausedResizeTask=new d4,this._observerDisposable=this._register(new ba),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this._register(new ge),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this._register(new ge),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this._register(new ge),this.onRender=this._onRender.event,this._onRefreshRequest=this._register(new ge),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new r4((f,v)=>this._renderRows(f,v),this._coreBrowserService),this._register(this._renderDebouncer),this._syncOutputHandler=new f4(this._coreBrowserService,this._coreService,()=>this._fullRefresh()),this._register(ht(()=>this._syncOutputHandler.dispose())),this._register(this._coreBrowserService.onDprChange(()=>this.handleDevicePixelRatioChange())),this._register(u.onResize(()=>this._fullRefresh())),this._register(u.buffers.onBufferActivate(()=>this._renderer.value?.clear())),this._register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this._register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this._register(c.onDecorationRegistered(()=>this._fullRefresh())),this._register(c.onDecorationRemoved(()=>this._fullRefresh())),this._register(this._optionsService.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(u.cols,u.rows),this._fullRefresh()})),this._register(this._optionsService.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(u.buffer.y,u.buffer.y,!0))),this._register(m.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(this._coreBrowserService.window,t),this._register(this._coreBrowserService.onWindowChange(f=>this._registerIntersectionObserver(f,t)))}get dimensions(){return this._renderer.value.dimensions}_registerIntersectionObserver(e,t){if("IntersectionObserver"in e){let i=new e.IntersectionObserver(r=>this._handleIntersectionChange(r[r.length-1]),{threshold:0});i.observe(t),this._observerDisposable.value=ht(()=>i.disconnect())}}_handleIntersectionChange(e){this._isPaused=e.isIntersecting===void 0?e.intersectionRatio===0:!e.isIntersecting,!this._isPaused&&!this._charSizeService.hasValidSize&&this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(e,t,i=!1){if(this._isPaused){this._needsFullRefresh=!0;return}if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(e,t);return}let r=this._syncOutputHandler.flush();r&&(e=Math.min(e,r.start),t=Math.max(t,r.end)),i||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(e,t,this._rowCount)}_renderRows(e,t){if(this._renderer.value){if(this._coreService.decPrivateModes.synchronizedOutput){this._syncOutputHandler.bufferRows(e,t);return}e=Math.min(e,this._rowCount-1),t=Math.min(t,this._rowCount-1),this._renderer.value.renderRows(e,t),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:e,end:t}),this._onRender.fire({start:e,end:t}),this._isNextRenderRedrawOnly=!0}}resize(e,t){this._rowCount=t,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(e){this._renderer.value=e,this._renderer.value&&(this._renderer.value.onRequestRedraw(t=>this.refreshRows(t.start,t.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(e){return this._renderDebouncer.addRefreshCallback(e)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){this._renderer.value&&(this._renderer.value.clearTextureAtlas?.(),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(e,t){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.value?.handleResize(e,t)):this._renderer.value.handleResize(e,t),this._fullRefresh())}handleCharSizeChanged(){this._renderer.value?.handleCharSizeChanged()}handleBlur(){this._renderer.value?.handleBlur()}handleFocus(){this._renderer.value?.handleFocus()}handleSelectionChanged(e,t,i){this._selectionState.start=e,this._selectionState.end=t,this._selectionState.columnSelectMode=i,this._renderer.value?.handleSelectionChanged(e,t,i)}handleCursorMove(){this._renderer.value?.handleCursorMove()}clear(){this._renderer.value?.clear()}};Nm=_t([_e(2,on),_e(3,Tu),_e(4,yr),_e(5,po),_e(6,ln),_e(7,ts),_e(8,Ra)],Nm);var f4=class{constructor(e,t,i){this._coreBrowserService=e,this._coreService=t,this._onTimeout=i,this._start=0,this._end=0,this._isBuffering=!1}bufferRows(e,t){this._isBuffering?(this._start=Math.min(this._start,e),this._end=Math.max(this._end,t)):(this._start=e,this._end=t,this._isBuffering=!0),this._timeout===void 0&&(this._timeout=this._coreBrowserService.window.setTimeout(()=>{this._timeout=void 0,this._coreService.decPrivateModes.synchronizedOutput=!1,this._onTimeout()},1e3))}flush(){if(this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0),!this._isBuffering)return;let e={start:this._start,end:this._end};return this._isBuffering=!1,e}dispose(){this._timeout!==void 0&&(this._coreBrowserService.window.clearTimeout(this._timeout),this._timeout=void 0)}};function m4(e,t,i,r){let l=i.buffer.x,c=i.buffer.y;if(!i.buffer.hasScrollback)return v4(l,c,e,t,i,r)+Du(c,t,i,r)+_4(l,c,e,t,i,r);let u;if(c===t)return u=l>e?"D":"C",io(Math.abs(l-e),no(u,r));u=c>t?"D":"C";let d=Math.abs(c-t),m=g4(c>t?e:l,i)+(d-1)*i.cols+1+p4(c>t?l:e);return io(m,no(u,r))}function p4(e,t){return e-1}function g4(e,t){return t.cols-e}function v4(e,t,i,r,l,c){return Du(t,r,l,c).length===0?"":io(j1(e,t,e,t-vr(t,l),!1,l).length,no("D",c))}function Du(e,t,i,r){let l=e-vr(e,i),c=t-vr(t,i),u=Math.abs(l-c)-y4(e,t,i);return io(u,no(C1(e,t),r))}function _4(e,t,i,r,l,c){let u;Du(t,r,l,c).length>0?u=r-vr(r,l):u=t;let d=r,m=x4(e,t,i,r,l,c);return io(j1(e,u,i,d,m==="C",l).length,no(m,c))}function y4(e,t,i){let r=0,l=e-vr(e,i),c=t-vr(t,i);for(let u=0;u<Math.abs(l-c);u++){let d=C1(e,t)==="A"?-1:1;i.buffer.lines.get(l+d*u)?.isWrapped&&r++}return r}function vr(e,t){let i=0,r=t.buffer.lines.get(e),l=r?.isWrapped;for(;l&&e>=0&&e<t.rows;)i++,r=t.buffer.lines.get(--e),l=r?.isWrapped;return i}function x4(e,t,i,r,l,c){let u;return Du(i,r,l,c).length>0?u=r-vr(r,l):u=t,e<i&&u<=r||e>=i&&u<r?"C":"D"}function C1(e,t){return e>t?"A":"B"}function j1(e,t,i,r,l,c){let u=e,d=t,m="";for(;(u!==i||d!==r)&&d>=0&&d<c.buffer.lines.length;)u+=l?1:-1,l&&u>c.cols-1?(m+=c.buffer.translateBufferLineToString(d,!1,e,u),u=0,e=0,d++):!l&&u<0&&(m+=c.buffer.translateBufferLineToString(d,!1,0,e+1),u=c.cols-1,e=u,d--);return m+c.buffer.translateBufferLineToString(d,!1,e,u)}function no(e,t){let i=t?"O":"[";return ce.ESC+i+e}function io(e,t){e=Math.floor(e);let i="";for(let r=0;r<e;r++)i+=t;return i}var S4=class{constructor(e){this._bufferService=e,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:!this.selectionEnd||!this.selectionStart?this.selectionStart:this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){let e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?e%this._bufferService.cols===0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)-1]:[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[e,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){let e=this.selectionStart[0]+this.selectionStartLength;return e>this._bufferService.cols?[e%this._bufferService.cols,this.selectionStart[1]+Math.floor(e/this._bufferService.cols)]:[Math.max(e,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){let e=this.selectionStart,t=this.selectionEnd;return!e||!t?!1:e[1]>t[1]||e[1]===t[1]&&e[0]>t[0]}handleTrim(e){return this.selectionStart&&(this.selectionStart[1]-=e),this.selectionEnd&&(this.selectionEnd[1]-=e),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}};function hS(e,t){if(e.start.y>e.end.y)throw new Error(`Buffer range end (${e.end.x}, ${e.end.y}) cannot be before start (${e.start.x}, ${e.start.y})`);return t*(e.end.y-e.start.y)+(e.end.x-e.start.x+1)}var jf=50,b4=15,w4=50,C4=500,j4="",k4=new RegExp(j4,"g"),Em=class extends Be{constructor(e,t,i,r,l,c,u,d,m){super(),this._element=e,this._screenElement=t,this._linkifier=i,this._bufferService=r,this._coreService=l,this._mouseService=c,this._optionsService=u,this._renderService=d,this._coreBrowserService=m,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new ti,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this._register(new ge),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this._register(new ge),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this._register(new ge),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this._register(new ge),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=f=>this._handleMouseMove(f),this._mouseUpListener=f=>this._handleMouseUp(f),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(f=>this._handleTrim(f)),this._register(this._bufferService.buffers.onBufferActivate(f=>this._handleBufferActivate(f))),this.enable(),this._model=new S4(this._bufferService),this._activeSelectionMode=0,this._register(ht(()=>{this._removeMouseDownListeners()})),this._register(this._bufferService.onResize(f=>{f.rowsChanged&&this.clearSelection()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){let e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;return!e||!t?!1:e[0]!==t[0]||e[1]!==t[1]}get selectionText(){let e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd;if(!e||!t)return"";let i=this._bufferService.buffer,r=[];if(this._activeSelectionMode===3){if(e[0]===t[0])return"";let l=e[0]<t[0]?e[0]:t[0],c=e[0]<t[0]?t[0]:e[0];for(let u=e[1];u<=t[1];u++){let d=i.translateBufferLineToString(u,!0,l,c);r.push(d)}}else{let l=e[1]===t[1]?t[0]:void 0;r.push(i.translateBufferLineToString(e[1],!0,e[0],l));for(let c=e[1]+1;c<=t[1]-1;c++){let u=i.lines.get(c),d=i.translateBufferLineToString(c,!0);u?.isWrapped?r[r.length-1]+=d:r.push(d)}if(e[1]!==t[1]){let c=i.lines.get(t[1]),u=i.translateBufferLineToString(t[1],!0,0,t[0]);c&&c.isWrapped?r[r.length-1]+=u:r.push(u)}}return r.map(l=>l.replace(k4," ")).join(S1?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(e){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),bp&&e&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(e){let t=this._getMouseBufferCoords(e),i=this._model.finalSelectionStart,r=this._model.finalSelectionEnd;return!i||!r||!t?!1:this._areCoordsInSelection(t,i,r)}isCellInSelection(e,t){let i=this._model.finalSelectionStart,r=this._model.finalSelectionEnd;return!i||!r?!1:this._areCoordsInSelection([e,t],i,r)}_areCoordsInSelection(e,t,i){return e[1]>t[1]&&e[1]<i[1]||t[1]===i[1]&&e[1]===t[1]&&e[0]>=t[0]&&e[0]<i[0]||t[1]<i[1]&&e[1]===i[1]&&e[0]<i[0]||t[1]<i[1]&&e[1]===t[1]&&e[0]>=t[0]}_selectWordAtCursor(e,t){let i=this._linkifier.currentLink?.link?.range;if(i)return this._model.selectionStart=[i.start.x-1,i.start.y-1],this._model.selectionStartLength=hS(i,this._bufferService.cols),this._model.selectionEnd=void 0,!0;let r=this._getMouseBufferCoords(e);return r?(this._selectWordAt(r,t),this._model.selectionEnd=void 0,!0):!1}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(e,t){this._model.clearSelection(),e=Math.max(e,0),t=Math.min(t,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,e],this._model.selectionEnd=[this._bufferService.cols,t],this.refresh(),this._onSelectionChange.fire()}_handleTrim(e){this._model.handleTrim(e)&&this.refresh()}_getMouseBufferCoords(e){let t=this._mouseService.getCoords(e,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(t)return t[0]--,t[1]--,t[1]+=this._bufferService.buffer.ydisp,t}_getMouseEventScrollAmount(e){let t=Sp(this._coreBrowserService.window,e,this._screenElement)[1],i=this._renderService.dimensions.css.canvas.height;return t>=0&&t<=i?0:(t>i&&(t-=i),t=Math.min(Math.max(t,-jf),jf),t/=jf,t/Math.abs(t)+Math.round(t*(b4-1)))}shouldForceSelection(e){return fu?e.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:e.shiftKey}handleMouseDown(e){if(this._mouseDownTimeStamp=e.timeStamp,!(e.button===2&&this.hasSelection)&&e.button===0){if(!this._enabled){if(!this.shouldForceSelection(e))return;e.stopPropagation()}e.preventDefault(),this._dragScrollAmount=0,this._enabled&&e.shiftKey?this._handleIncrementalClick(e):e.detail===1?this._handleSingleClick(e):e.detail===2?this._handleDoubleClick(e):e.detail===3&&this._handleTripleClick(e),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),w4)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(e){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(e))}_handleSingleClick(e){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(e)?3:0,this._model.selectionStart=this._getMouseBufferCoords(e),!this._model.selectionStart)return;this._model.selectionEnd=void 0;let t=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);t&&t.length!==this._model.selectionStart[0]&&t.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(e){this._selectWordAtCursor(e,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(e){let t=this._getMouseBufferCoords(e);t&&(this._activeSelectionMode=2,this._selectLineAt(t[1]))}shouldColumnSelect(e){return e.altKey&&!(fu&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(e){if(e.stopImmediatePropagation(),!this._model.selectionStart)return;let t=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(e),!this._model.selectionEnd){this.refresh(!0);return}this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(e),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));let i=this._bufferService.buffer;if(this._model.selectionEnd[1]<i.lines.length){let r=i.lines.get(this._model.selectionEnd[1]);r&&r.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}(!t||t[0]!==this._model.selectionEnd[0]||t[1]!==this._model.selectionEnd[1])&&this.refresh(!0)}_dragScroll(){if(!(!this._model.selectionEnd||!this._model.selectionStart)&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});let e=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(e.ydisp+this._bufferService.rows,e.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=e.ydisp),this.refresh()}}_handleMouseUp(e){let t=e.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&t<C4&&e.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){let i=this._mouseService.getCoords(e,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(i&&i[0]!==void 0&&i[1]!==void 0){let r=m4(i[0]-1,i[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(r,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){let e=this._model.finalSelectionStart,t=this._model.finalSelectionEnd,i=!!e&&!!t&&(e[0]!==t[0]||e[1]!==t[1]);if(!i){this._oldHasSelection&&this._fireOnSelectionChange(e,t,i);return}!e||!t||(!this._oldSelectionStart||!this._oldSelectionEnd||e[0]!==this._oldSelectionStart[0]||e[1]!==this._oldSelectionStart[1]||t[0]!==this._oldSelectionEnd[0]||t[1]!==this._oldSelectionEnd[1])&&this._fireOnSelectionChange(e,t,i)}_fireOnSelectionChange(e,t,i){this._oldSelectionStart=e,this._oldSelectionEnd=t,this._oldHasSelection=i,this._onSelectionChange.fire()}_handleBufferActivate(e){this.clearSelection(),this._trimListener.dispose(),this._trimListener=e.activeBuffer.lines.onTrim(t=>this._handleTrim(t))}_convertViewportColToCharacterIndex(e,t){let i=t;for(let r=0;t>=r;r++){let l=e.loadCell(r,this._workCell).getChars().length;this._workCell.getWidth()===0?i--:l>1&&t!==r&&(i+=l-1)}return i}setSelection(e,t,i){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[e,t],this._model.selectionStartLength=i,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(e){this._isClickInSelection(e)||(this._selectWordAtCursor(e,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(e,t,i=!0,r=!0){if(e[0]>=this._bufferService.cols)return;let l=this._bufferService.buffer,c=l.lines.get(e[1]);if(!c)return;let u=l.translateBufferLineToString(e[1],!1),d=this._convertViewportColToCharacterIndex(c,e[0]),m=d,f=e[0]-d,v=0,_=0,S=0,x=0;if(u.charAt(d)===" "){for(;d>0&&u.charAt(d-1)===" ";)d--;for(;m<u.length&&u.charAt(m+1)===" ";)m++}else{let T=e[0],k=e[0];c.getWidth(T)===0&&(v++,T--),c.getWidth(k)===2&&(_++,k++);let R=c.getString(k).length;for(R>1&&(x+=R-1,m+=R-1);T>0&&d>0&&!this._isCharWordSeparator(c.loadCell(T-1,this._workCell));){c.loadCell(T-1,this._workCell);let N=this._workCell.getChars().length;this._workCell.getWidth()===0?(v++,T--):N>1&&(S+=N-1,d-=N-1),d--,T--}for(;k<c.length&&m+1<u.length&&!this._isCharWordSeparator(c.loadCell(k+1,this._workCell));){c.loadCell(k+1,this._workCell);let N=this._workCell.getChars().length;this._workCell.getWidth()===2?(_++,k++):N>1&&(x+=N-1,m+=N-1),m++,k++}}m++;let b=d+f-v+S,C=Math.min(this._bufferService.cols,m-d+v+_-S-x);if(!(!t&&u.slice(d,m).trim()==="")){if(i&&b===0&&c.getCodePoint(0)!==32){let T=l.lines.get(e[1]-1);if(T&&c.isWrapped&&T.getCodePoint(this._bufferService.cols-1)!==32){let k=this._getWordAt([this._bufferService.cols-1,e[1]-1],!1,!0,!1);if(k){let R=this._bufferService.cols-k.start;b-=R,C+=R}}}if(r&&b+C===this._bufferService.cols&&c.getCodePoint(this._bufferService.cols-1)!==32){let T=l.lines.get(e[1]+1);if(T?.isWrapped&&T.getCodePoint(0)!==32){let k=this._getWordAt([0,e[1]+1],!1,!1,!0);k&&(C+=k.length)}}return{start:b,length:C}}}_selectWordAt(e,t){let i=this._getWordAt(e,t);if(i){for(;i.start<0;)i.start+=this._bufferService.cols,e[1]--;this._model.selectionStart=[i.start,e[1]],this._model.selectionStartLength=i.length}}_selectToWordAt(e){let t=this._getWordAt(e,!0);if(t){let i=e[1];for(;t.start<0;)t.start+=this._bufferService.cols,i--;if(!this._model.areSelectionValuesReversed())for(;t.start+t.length>this._bufferService.cols;)t.length-=this._bufferService.cols,i++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?t.start:t.start+t.length,i]}}_isCharWordSeparator(e){return e.getWidth()===0?!1:this._optionsService.rawOptions.wordSeparator.indexOf(e.getChars())>=0}_selectLineAt(e){let t=this._bufferService.buffer.getWrappedRangeForLine(e),i={start:{x:0,y:t.first},end:{x:this._bufferService.cols-1,y:t.last}};this._model.selectionStart=[0,t.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=hS(i,this._bufferService.cols)}};Em=_t([_e(3,ln),_e(4,yr),_e(5,mp),_e(6,on),_e(7,ns),_e(8,ts)],Em);var dS=class{constructor(){this._data={}}set(e,t,i){this._data[e]||(this._data[e]={}),this._data[e][t]=i}get(e,t){return this._data[e]?this._data[e][t]:void 0}clear(){this._data={}}},fS=class{constructor(){this._color=new dS,this._css=new dS}setCss(e,t,i){this._css.set(e,t,i)}getCss(e,t){return this._css.get(e,t)}setColor(e,t,i){this._color.set(e,t,i)}getColor(e,t){return this._color.get(e,t)}clear(){this._color.clear(),this._css.clear()}},Lt=Object.freeze((()=>{let e=[mt.toColor("#2e3436"),mt.toColor("#cc0000"),mt.toColor("#4e9a06"),mt.toColor("#c4a000"),mt.toColor("#3465a4"),mt.toColor("#75507b"),mt.toColor("#06989a"),mt.toColor("#d3d7cf"),mt.toColor("#555753"),mt.toColor("#ef2929"),mt.toColor("#8ae234"),mt.toColor("#fce94f"),mt.toColor("#729fcf"),mt.toColor("#ad7fa8"),mt.toColor("#34e2e2"),mt.toColor("#eeeeec")],t=[0,95,135,175,215,255];for(let i=0;i<216;i++){let r=t[i/36%6|0],l=t[i/6%6|0],c=t[i%6];e.push({css:Rt.toCss(r,l,c),rgba:Rt.toRgba(r,l,c)})}for(let i=0;i<24;i++){let r=8+i*10;e.push({css:Rt.toCss(r,r,r),rgba:Rt.toRgba(r,r,r)})}return e})()),ur=mt.toColor("#ffffff"),Kl=mt.toColor("#000000"),mS=mt.toColor("#ffffff"),pS=Kl,Ol={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117},N4=ur,Tm=class extends Be{constructor(e){super(),this._optionsService=e,this._contrastCache=new fS,this._halfContrastCache=new fS,this._onChangeColors=this._register(new ge),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:ur,background:Kl,cursor:mS,cursorAccent:pS,selectionForeground:void 0,selectionBackgroundTransparent:Ol,selectionBackgroundOpaque:ot.blend(Kl,Ol),selectionInactiveBackgroundTransparent:Ol,selectionInactiveBackgroundOpaque:ot.blend(Kl,Ol),scrollbarSliderBackground:ot.opacity(ur,.2),scrollbarSliderHoverBackground:ot.opacity(ur,.4),scrollbarSliderActiveBackground:ot.opacity(ur,.5),overviewRulerBorder:ur,ansi:Lt.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this._register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this._register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(e={}){let t=this._colors;if(t.foreground=Qe(e.foreground,ur),t.background=Qe(e.background,Kl),t.cursor=ot.blend(t.background,Qe(e.cursor,mS)),t.cursorAccent=ot.blend(t.background,Qe(e.cursorAccent,pS)),t.selectionBackgroundTransparent=Qe(e.selectionBackground,Ol),t.selectionBackgroundOpaque=ot.blend(t.background,t.selectionBackgroundTransparent),t.selectionInactiveBackgroundTransparent=Qe(e.selectionInactiveBackground,t.selectionBackgroundTransparent),t.selectionInactiveBackgroundOpaque=ot.blend(t.background,t.selectionInactiveBackgroundTransparent),t.selectionForeground=e.selectionForeground?Qe(e.selectionForeground,oS):void 0,t.selectionForeground===oS&&(t.selectionForeground=void 0),ot.isOpaque(t.selectionBackgroundTransparent)&&(t.selectionBackgroundTransparent=ot.opacity(t.selectionBackgroundTransparent,.3)),ot.isOpaque(t.selectionInactiveBackgroundTransparent)&&(t.selectionInactiveBackgroundTransparent=ot.opacity(t.selectionInactiveBackgroundTransparent,.3)),t.scrollbarSliderBackground=Qe(e.scrollbarSliderBackground,ot.opacity(t.foreground,.2)),t.scrollbarSliderHoverBackground=Qe(e.scrollbarSliderHoverBackground,ot.opacity(t.foreground,.4)),t.scrollbarSliderActiveBackground=Qe(e.scrollbarSliderActiveBackground,ot.opacity(t.foreground,.5)),t.overviewRulerBorder=Qe(e.overviewRulerBorder,N4),t.ansi=Lt.slice(),t.ansi[0]=Qe(e.black,Lt[0]),t.ansi[1]=Qe(e.red,Lt[1]),t.ansi[2]=Qe(e.green,Lt[2]),t.ansi[3]=Qe(e.yellow,Lt[3]),t.ansi[4]=Qe(e.blue,Lt[4]),t.ansi[5]=Qe(e.magenta,Lt[5]),t.ansi[6]=Qe(e.cyan,Lt[6]),t.ansi[7]=Qe(e.white,Lt[7]),t.ansi[8]=Qe(e.brightBlack,Lt[8]),t.ansi[9]=Qe(e.brightRed,Lt[9]),t.ansi[10]=Qe(e.brightGreen,Lt[10]),t.ansi[11]=Qe(e.brightYellow,Lt[11]),t.ansi[12]=Qe(e.brightBlue,Lt[12]),t.ansi[13]=Qe(e.brightMagenta,Lt[13]),t.ansi[14]=Qe(e.brightCyan,Lt[14]),t.ansi[15]=Qe(e.brightWhite,Lt[15]),e.extendedAnsi){let i=Math.min(t.ansi.length-16,e.extendedAnsi.length);for(let r=0;r<i;r++)t.ansi[r+16]=Qe(e.extendedAnsi[r],Lt[r+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(e){this._restoreColor(e),this._onChangeColors.fire(this.colors)}_restoreColor(e){if(e===void 0){for(let t=0;t<this._restoreColors.ansi.length;++t)this._colors.ansi[t]=this._restoreColors.ansi[t];return}switch(e){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[e]=this._restoreColors.ansi[e]}}modifyColors(e){e(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};Tm=_t([_e(0,on)],Tm);function Qe(e,t){if(e!==void 0)try{return mt.toColor(e)}catch{}return t}var E4=class{constructor(...e){this._entries=new Map;for(let[t,i]of e)this.set(t,i)}set(e,t){let i=this._entries.get(e);return this._entries.set(e,t),i}forEach(e){for(let[t,i]of this._entries.entries())e(t,i)}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}},T4=class{constructor(){this._services=new E4,this._services.set(fp,this)}setService(e,t){this._services.set(e,t)}getService(e){return this._services.get(e)}createInstance(e,...t){let i=bA(e).sort((c,u)=>c.index-u.index),r=[];for(let c of i){let u=this._services.get(c.id);if(!u)throw new Error(`[createInstance] ${e.name} depends on UNKNOWN service ${c.id._id}.`);r.push(u)}let l=i.length>0?i[0].index:t.length;if(t.length!==l)throw new Error(`[createInstance] First service dependency of ${e.name} at position ${l+1} conflicts with ${t.length} static arguments`);return new e(...t,...r)}},R4={trace:0,debug:1,info:2,warn:3,error:4,off:5},D4="xterm.js: ",Rm=class extends Be{constructor(e){super(),this._optionsService=e,this._logLevel=5,this._updateLogLevel(),this._register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}get logLevel(){return this._logLevel}_updateLogLevel(){this._logLevel=R4[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(e){for(let t=0;t<e.length;t++)typeof e[t]=="function"&&(e[t]=e[t]())}_log(e,t,i){this._evalLazyOptionalParams(i),e.call(console,(this._optionsService.options.logger?"":D4)+t,...i)}trace(e,...t){this._logLevel<=0&&this._log(this._optionsService.options.logger?.trace.bind(this._optionsService.options.logger)??console.log,e,t)}debug(e,...t){this._logLevel<=1&&this._log(this._optionsService.options.logger?.debug.bind(this._optionsService.options.logger)??console.log,e,t)}info(e,...t){this._logLevel<=2&&this._log(this._optionsService.options.logger?.info.bind(this._optionsService.options.logger)??console.info,e,t)}warn(e,...t){this._logLevel<=3&&this._log(this._optionsService.options.logger?.warn.bind(this._optionsService.options.logger)??console.warn,e,t)}error(e,...t){this._logLevel<=4&&this._log(this._optionsService.options.logger?.error.bind(this._optionsService.options.logger)??console.error,e,t)}};Rm=_t([_e(0,on)],Rm);var gS=class extends Be{constructor(e){super(),this._maxLength=e,this.onDeleteEmitter=this._register(new ge),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this._register(new ge),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this._register(new ge),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(e){if(this._maxLength===e)return;let t=new Array(e);for(let i=0;i<Math.min(e,this.length);i++)t[i]=this._array[this._getCyclicIndex(i)];this._array=t,this._maxLength=e,this._startIndex=0}get length(){return this._length}set length(e){if(e>this._length)for(let t=this._length;t<e;t++)this._array[t]=void 0;this._length=e}get(e){return this._array[this._getCyclicIndex(e)]}set(e,t){this._array[this._getCyclicIndex(e)]=t}push(e){this._array[this._getCyclicIndex(this._length)]=e,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(e,t,...i){if(t){for(let r=e;r<this._length-t;r++)this._array[this._getCyclicIndex(r)]=this._array[this._getCyclicIndex(r+t)];this._length-=t,this.onDeleteEmitter.fire({index:e,amount:t})}for(let r=this._length-1;r>=e;r--)this._array[this._getCyclicIndex(r+i.length)]=this._array[this._getCyclicIndex(r)];for(let r=0;r<i.length;r++)this._array[this._getCyclicIndex(e+r)]=i[r];if(i.length&&this.onInsertEmitter.fire({index:e,amount:i.length}),this._length+i.length>this._maxLength){let r=this._length+i.length-this._maxLength;this._startIndex+=r,this._length=this._maxLength,this.onTrimEmitter.fire(r)}else this._length+=i.length}trimStart(e){e>this._length&&(e=this._length),this._startIndex+=e,this._length-=e,this.onTrimEmitter.fire(e)}shiftElements(e,t,i){if(!(t<=0)){if(e<0||e>=this._length)throw new Error("start argument out of range");if(e+i<0)throw new Error("Cannot shift elements in list beyond index 0");if(i>0){for(let l=t-1;l>=0;l--)this.set(e+l+i,this.get(e+l));let r=e+t+i-this._length;if(r>0)for(this._length+=r;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let r=0;r<t;r++)this.set(e+r+i,this.get(e+r))}}_getCyclicIndex(e){return(this._startIndex+e)%this._maxLength}},Me=3,Tt=Object.freeze(new mo),Wc=0,kf=2,ql=class k1{constructor(t,i,r=!1){this.isWrapped=r,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(t*Me);let l=i||ti.fromCharData([0,q0,1,0]);for(let c=0;c<t;++c)this.setCell(c,l);this.length=t}get(t){let i=this._data[t*Me+0],r=i&2097151;return[this._data[t*Me+1],i&2097152?this._combined[t]:r?Ls(r):"",i>>22,i&2097152?this._combined[t].charCodeAt(this._combined[t].length-1):r]}set(t,i){this._data[t*Me+1]=i[0],i[1].length>1?(this._combined[t]=i[1],this._data[t*Me+0]=t|2097152|i[2]<<22):this._data[t*Me+0]=i[1].charCodeAt(0)|i[2]<<22}getWidth(t){return this._data[t*Me+0]>>22}hasWidth(t){return this._data[t*Me+0]&12582912}getFg(t){return this._data[t*Me+1]}getBg(t){return this._data[t*Me+2]}hasContent(t){return this._data[t*Me+0]&4194303}getCodePoint(t){let i=this._data[t*Me+0];return i&2097152?this._combined[t].charCodeAt(this._combined[t].length-1):i&2097151}isCombined(t){return this._data[t*Me+0]&2097152}getString(t){let i=this._data[t*Me+0];return i&2097152?this._combined[t]:i&2097151?Ls(i&2097151):""}isProtected(t){return this._data[t*Me+2]&536870912}loadCell(t,i){return Wc=t*Me,i.content=this._data[Wc+0],i.fg=this._data[Wc+1],i.bg=this._data[Wc+2],i.content&2097152&&(i.combinedData=this._combined[t]),i.bg&268435456&&(i.extended=this._extendedAttrs[t]),i}setCell(t,i){i.content&2097152&&(this._combined[t]=i.combinedData),i.bg&268435456&&(this._extendedAttrs[t]=i.extended),this._data[t*Me+0]=i.content,this._data[t*Me+1]=i.fg,this._data[t*Me+2]=i.bg}setCellFromCodepoint(t,i,r,l){l.bg&268435456&&(this._extendedAttrs[t]=l.extended),this._data[t*Me+0]=i|r<<22,this._data[t*Me+1]=l.fg,this._data[t*Me+2]=l.bg}addCodepointToCell(t,i,r){let l=this._data[t*Me+0];l&2097152?this._combined[t]+=Ls(i):l&2097151?(this._combined[t]=Ls(l&2097151)+Ls(i),l&=-2097152,l|=2097152):l=i|1<<22,r&&(l&=-12582913,l|=r<<22),this._data[t*Me+0]=l}insertCells(t,i,r){if(t%=this.length,t&&this.getWidth(t-1)===2&&this.setCellFromCodepoint(t-1,0,1,r),i<this.length-t){let l=new ti;for(let c=this.length-t-i-1;c>=0;--c)this.setCell(t+i+c,this.loadCell(t+c,l));for(let c=0;c<i;++c)this.setCell(t+c,r)}else for(let l=t;l<this.length;++l)this.setCell(l,r);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,r)}deleteCells(t,i,r){if(t%=this.length,i<this.length-t){let l=new ti;for(let c=0;c<this.length-t-i;++c)this.setCell(t+c,this.loadCell(t+i+c,l));for(let c=this.length-i;c<this.length;++c)this.setCell(c,r)}else for(let l=t;l<this.length;++l)this.setCell(l,r);t&&this.getWidth(t-1)===2&&this.setCellFromCodepoint(t-1,0,1,r),this.getWidth(t)===0&&!this.hasContent(t)&&this.setCellFromCodepoint(t,0,1,r)}replaceCells(t,i,r,l=!1){if(l){for(t&&this.getWidth(t-1)===2&&!this.isProtected(t-1)&&this.setCellFromCodepoint(t-1,0,1,r),i<this.length&&this.getWidth(i-1)===2&&!this.isProtected(i)&&this.setCellFromCodepoint(i,0,1,r);t<i&&t<this.length;)this.isProtected(t)||this.setCell(t,r),t++;return}for(t&&this.getWidth(t-1)===2&&this.setCellFromCodepoint(t-1,0,1,r),i<this.length&&this.getWidth(i-1)===2&&this.setCellFromCodepoint(i,0,1,r);t<i&&t<this.length;)this.setCell(t++,r)}resize(t,i){if(t===this.length)return this._data.length*4*kf<this._data.buffer.byteLength;let r=t*Me;if(t>this.length){if(this._data.buffer.byteLength>=r*4)this._data=new Uint32Array(this._data.buffer,0,r);else{let l=new Uint32Array(r);l.set(this._data),this._data=l}for(let l=this.length;l<t;++l)this.setCell(l,i)}else{this._data=this._data.subarray(0,r);let l=Object.keys(this._combined);for(let u=0;u<l.length;u++){let d=parseInt(l[u],10);d>=t&&delete this._combined[d]}let c=Object.keys(this._extendedAttrs);for(let u=0;u<c.length;u++){let d=parseInt(c[u],10);d>=t&&delete this._extendedAttrs[d]}}return this.length=t,r*4*kf<this._data.buffer.byteLength}cleanupMemory(){if(this._data.length*4*kf<this._data.buffer.byteLength){let t=new Uint32Array(this._data.length);return t.set(this._data),this._data=t,1}return 0}fill(t,i=!1){if(i){for(let r=0;r<this.length;++r)this.isProtected(r)||this.setCell(r,t);return}this._combined={},this._extendedAttrs={};for(let r=0;r<this.length;++r)this.setCell(r,t)}copyFrom(t){this.length!==t.length?this._data=new Uint32Array(t._data):this._data.set(t._data),this.length=t.length,this._combined={};for(let i in t._combined)this._combined[i]=t._combined[i];this._extendedAttrs={};for(let i in t._extendedAttrs)this._extendedAttrs[i]=t._extendedAttrs[i];this.isWrapped=t.isWrapped}clone(){let t=new k1(0);t._data=new Uint32Array(this._data),t.length=this.length;for(let i in this._combined)t._combined[i]=this._combined[i];for(let i in this._extendedAttrs)t._extendedAttrs[i]=this._extendedAttrs[i];return t.isWrapped=this.isWrapped,t}getTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(this._data[t*Me+0]&4194303)return t+(this._data[t*Me+0]>>22);return 0}getNoBgTrimmedLength(){for(let t=this.length-1;t>=0;--t)if(this._data[t*Me+0]&4194303||this._data[t*Me+2]&50331648)return t+(this._data[t*Me+0]>>22);return 0}copyCellsFrom(t,i,r,l,c){let u=t._data;if(c)for(let m=l-1;m>=0;m--){for(let f=0;f<Me;f++)this._data[(r+m)*Me+f]=u[(i+m)*Me+f];u[(i+m)*Me+2]&268435456&&(this._extendedAttrs[r+m]=t._extendedAttrs[i+m])}else for(let m=0;m<l;m++){for(let f=0;f<Me;f++)this._data[(r+m)*Me+f]=u[(i+m)*Me+f];u[(i+m)*Me+2]&268435456&&(this._extendedAttrs[r+m]=t._extendedAttrs[i+m])}let d=Object.keys(t._combined);for(let m=0;m<d.length;m++){let f=parseInt(d[m],10);f>=i&&(this._combined[f-i+r]=t._combined[f])}}translateToString(t,i,r,l){i=i??0,r=r??this.length,t&&(r=Math.min(r,this.getTrimmedLength())),l&&(l.length=0);let c="";for(;i<r;){let u=this._data[i*Me+0],d=u&2097151,m=u&2097152?this._combined[i]:d?Ls(d):Ms;if(c+=m,l)for(let f=0;f<m.length;++f)l.push(i);i+=u>>22||1}return l&&l.push(i),c}};function A4(e,t,i,r,l,c){let u=[];for(let d=0;d<e.length-1;d++){let m=d,f=e.get(++m);if(!f.isWrapped)continue;let v=[e.get(d)];for(;m<e.length&&f.isWrapped;)v.push(f),f=e.get(++m);if(!c&&r>=d&&r<m){d+=v.length-1;continue}let _=0,S=so(v,_,t),x=1,b=0;for(;x<v.length;){let T=so(v,x,t),k=T-b,R=i-S,N=Math.min(k,R);v[_].copyCellsFrom(v[x],b,S,N,!1),S+=N,S===i&&(_++,S=0),b+=N,b===T&&(x++,b=0),S===0&&_!==0&&v[_-1].getWidth(i-1)===2&&(v[_].copyCellsFrom(v[_-1],i-1,S++,1,!1),v[_-1].setCell(i-1,l))}v[_].replaceCells(S,i,l);let C=0;for(let T=v.length-1;T>0&&(T>_||v[T].getTrimmedLength()===0);T--)C++;C>0&&(u.push(d+v.length-C),u.push(C)),d+=v.length-1}return u}function L4(e,t){let i=[],r=0,l=t[r],c=0;for(let u=0;u<e.length;u++)if(l===u){let d=t[++r];e.onDeleteEmitter.fire({index:u-c,amount:d}),u+=d-1,c+=d,l=t[++r]}else i.push(u);return{layout:i,countRemoved:c}}function M4(e,t){let i=[];for(let r=0;r<t.length;r++)i.push(e.get(t[r]));for(let r=0;r<i.length;r++)e.set(r,i[r]);e.length=t.length}function B4(e,t,i){let r=[],l=e.map((m,f)=>so(e,f,t)).reduce((m,f)=>m+f),c=0,u=0,d=0;for(;d<l;){if(l-d<i){r.push(l-d);break}c+=i;let m=so(e,u,t);c>m&&(c-=m,u++);let f=e[u].getWidth(c-1)===2;f&&c--;let v=f?i-1:i;r.push(v),d+=v}return r}function so(e,t,i){if(t===e.length-1)return e[t].getTrimmedLength();let r=!e[t].hasContent(i-1)&&e[t].getWidth(i-1)===1,l=e[t+1].getWidth(0)===2;return r&&l?i-1:i}var N1=class E1{constructor(t){this.line=t,this.isDisposed=!1,this._disposables=[],this._id=E1._nextId++,this._onDispose=this.register(new ge),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),gr(this._disposables),this._disposables.length=0)}register(t){return this._disposables.push(t),t}};N1._nextId=1;var O4=N1,Bt={},hr=Bt.B;Bt[0]={"`":"",a:"",b:"",c:"",d:"",e:"",f:"",g:"",h:"",i:"",j:"",k:"",l:"",m:"",n:"",o:"",p:"",q:"",r:"",s:"",t:"",u:"",v:"",w:"",x:"",y:"",z:"","{":"","|":"","}":"","~":""};Bt.A={"#":""};Bt.B=void 0;Bt[4]={"#":"","@":"","[":"ij","\\":"","]":"|","{":"","|":"f","}":"","~":""};Bt.C=Bt[5]={"[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Bt.R={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""};Bt.Q={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Bt.K={"@":"","[":"","\\":"","]":"","{":"","|":"","}":"","~":""};Bt.Y={"#":"","@":"","[":"","\\":"","]":"","`":"","{":"","|":"","}":"","~":""};Bt.E=Bt[6]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Bt.Z={"#":"","@":"","[":"","\\":"","]":"","{":"","|":"","}":""};Bt.H=Bt[7]={"@":"","[":"","\\":"","]":"","^":"","`":"","{":"","|":"","}":"","~":""};Bt["="]={"#":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":""};var vS=4294967295,_S=class{constructor(e,t,i){this._hasScrollback=e,this._optionsService=t,this._bufferService=i,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=Tt.clone(),this.savedCharset=hr,this.markers=[],this._nullCell=ti.fromCharData([0,q0,1,0]),this._whitespaceCell=ti.fromCharData([0,Ms,1,32]),this._isClearing=!1,this._memoryCleanupQueue=new mu,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new gS(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(e){return e?(this._nullCell.fg=e.fg,this._nullCell.bg=e.bg,this._nullCell.extended=e.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new uu),this._nullCell}getWhitespaceCell(e){return e?(this._whitespaceCell.fg=e.fg,this._whitespaceCell.bg=e.bg,this._whitespaceCell.extended=e.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new uu),this._whitespaceCell}getBlankLine(e,t){return new ql(this._bufferService.cols,this.getNullCell(e),t)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){let e=this.ybase+this.y-this.ydisp;return e>=0&&e<this._rows}_getCorrectBufferLength(e){if(!this._hasScrollback)return e;let t=e+this._optionsService.rawOptions.scrollback;return t>vS?vS:t}fillViewportRows(e){if(this.lines.length===0){e===void 0&&(e=Tt);let t=this._rows;for(;t--;)this.lines.push(this.getBlankLine(e))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new gS(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(e,t){let i=this.getNullCell(Tt),r=0,l=this._getCorrectBufferLength(t);if(l>this.lines.maxLength&&(this.lines.maxLength=l),this.lines.length>0){if(this._cols<e)for(let u=0;u<this.lines.length;u++)r+=+this.lines.get(u).resize(e,i);let c=0;if(this._rows<t)for(let u=this._rows;u<t;u++)this.lines.length<t+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new ql(e,i)):this.ybase>0&&this.lines.length<=this.ybase+this.y+c+1?(this.ybase--,c++,this.ydisp>0&&this.ydisp--):this.lines.push(new ql(e,i)));else for(let u=this._rows;u>t;u--)this.lines.length>t+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(l<this.lines.maxLength){let u=this.lines.length-l;u>0&&(this.lines.trimStart(u),this.ybase=Math.max(this.ybase-u,0),this.ydisp=Math.max(this.ydisp-u,0),this.savedY=Math.max(this.savedY-u,0)),this.lines.maxLength=l}this.x=Math.min(this.x,e-1),this.y=Math.min(this.y,t-1),c&&(this.y+=c),this.savedX=Math.min(this.savedX,e-1),this.scrollTop=0}if(this.scrollBottom=t-1,this._isReflowEnabled&&(this._reflow(e,t),this._cols>e))for(let c=0;c<this.lines.length;c++)r+=+this.lines.get(c).resize(e,i);this._cols=e,this._rows=t,this._memoryCleanupQueue.clear(),r>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let e=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,e=!1);let t=0;for(;this._memoryCleanupPosition<this.lines.length;)if(t+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),t>100)return!0;return e}get _isReflowEnabled(){let e=this._optionsService.rawOptions.windowsPty;return e&&e.buildNumber?this._hasScrollback&&e.backend==="conpty"&&e.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(e,t){this._cols!==e&&(e>this._cols?this._reflowLarger(e,t):this._reflowSmaller(e,t))}_reflowLarger(e,t){let i=this._optionsService.rawOptions.reflowCursorLine,r=A4(this.lines,this._cols,e,this.ybase+this.y,this.getNullCell(Tt),i);if(r.length>0){let l=L4(this.lines,r);M4(this.lines,l.layout),this._reflowLargerAdjustViewport(e,t,l.countRemoved)}}_reflowLargerAdjustViewport(e,t,i){let r=this.getNullCell(Tt),l=i;for(;l-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<t&&this.lines.push(new ql(e,r))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-i,0)}_reflowSmaller(e,t){let i=this._optionsService.rawOptions.reflowCursorLine,r=this.getNullCell(Tt),l=[],c=0;for(let u=this.lines.length-1;u>=0;u--){let d=this.lines.get(u);if(!d||!d.isWrapped&&d.getTrimmedLength()<=e)continue;let m=[d];for(;d.isWrapped&&u>0;)d=this.lines.get(--u),m.unshift(d);if(!i){let N=this.ybase+this.y;if(N>=u&&N<u+m.length)continue}let f=m[m.length-1].getTrimmedLength(),v=B4(m,this._cols,e),_=v.length-m.length,S;this.ybase===0&&this.y!==this.lines.length-1?S=Math.max(0,this.y-this.lines.maxLength+_):S=Math.max(0,this.lines.length-this.lines.maxLength+_);let x=[];for(let N=0;N<_;N++){let E=this.getBlankLine(Tt,!0);x.push(E)}x.length>0&&(l.push({start:u+m.length+c,newLines:x}),c+=x.length),m.push(...x);let b=v.length-1,C=v[b];C===0&&(b--,C=v[b]);let T=m.length-_-1,k=f;for(;T>=0;){let N=Math.min(k,C);if(m[b]===void 0)break;if(m[b].copyCellsFrom(m[T],k-N,C-N,N,!0),C-=N,C===0&&(b--,C=v[b]),k-=N,k===0){T--;let E=Math.max(T,0);k=so(m,E,this._cols)}}for(let N=0;N<m.length;N++)v[N]<e&&m[N].setCell(v[N],r);let R=_-S;for(;R-- >0;)this.ybase===0?this.y<t-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+c)-t&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+_,this.ybase+t-1)}if(l.length>0){let u=[],d=[];for(let C=0;C<this.lines.length;C++)d.push(this.lines.get(C));let m=this.lines.length,f=m-1,v=0,_=l[v];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+c);let S=0;for(let C=Math.min(this.lines.maxLength-1,m+c-1);C>=0;C--)if(_&&_.start>f+S){for(let T=_.newLines.length-1;T>=0;T--)this.lines.set(C--,_.newLines[T]);C++,u.push({index:f+1,amount:_.newLines.length}),S+=_.newLines.length,_=l[++v]}else this.lines.set(C,d[f--]);let x=0;for(let C=u.length-1;C>=0;C--)u[C].index+=x,this.lines.onInsertEmitter.fire(u[C]),x+=u[C].amount;let b=Math.max(0,m+c-this.lines.maxLength);b>0&&this.lines.onTrimEmitter.fire(b)}}translateBufferLineToString(e,t,i=0,r){let l=this.lines.get(e);return l?l.translateToString(t,i,r):""}getWrappedRangeForLine(e){let t=e,i=e;for(;t>0&&this.lines.get(t).isWrapped;)t--;for(;i+1<this.lines.length&&this.lines.get(i+1).isWrapped;)i++;return{first:t,last:i}}setupTabStops(e){for(e!=null?this.tabs[e]||(e=this.prevStop(e)):(this.tabs={},e=0);e<this._cols;e+=this._optionsService.rawOptions.tabStopWidth)this.tabs[e]=!0}prevStop(e){for(e==null&&(e=this.x);!this.tabs[--e]&&e>0;);return e>=this._cols?this._cols-1:e<0?0:e}nextStop(e){for(e==null&&(e=this.x);!this.tabs[++e]&&e<this._cols;);return e>=this._cols?this._cols-1:e<0?0:e}clearMarkers(e){this._isClearing=!0;for(let t=0;t<this.markers.length;t++)this.markers[t].line===e&&(this.markers[t].dispose(),this.markers.splice(t--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let e=0;e<this.markers.length;e++)this.markers[e].dispose();this.markers.length=0,this._isClearing=!1}addMarker(e){let t=new O4(e);return this.markers.push(t),t.register(this.lines.onTrim(i=>{t.line-=i,t.line<0&&t.dispose()})),t.register(this.lines.onInsert(i=>{t.line>=i.index&&(t.line+=i.amount)})),t.register(this.lines.onDelete(i=>{t.line>=i.index&&t.line<i.index+i.amount&&t.dispose(),t.line>i.index&&(t.line-=i.amount)})),t.register(t.onDispose(()=>this._removeMarker(t))),t}_removeMarker(e){this._isClearing||this.markers.splice(this.markers.indexOf(e),1)}},z4=class extends Be{constructor(e,t){super(),this._optionsService=e,this._bufferService=t,this._onBufferActivate=this._register(new ge),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this._register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this._register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new _S(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new _S(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(e){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(e),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(e,t){this._normal.resize(e,t),this._alt.resize(e,t),this.setupTabStops(e)}setupTabStops(e){this._normal.setupTabStops(e),this._alt.setupTabStops(e)}},T1=2,R1=1,Dm=class extends Be{constructor(e){super(),this.isUserScrolling=!1,this._onResize=this._register(new ge),this.onResize=this._onResize.event,this._onScroll=this._register(new ge),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,T1),this.rows=Math.max(e.rawOptions.rows||0,R1),this.buffers=this._register(new z4(e,this)),this._register(this.buffers.onBufferActivate(t=>{this._onScroll.fire(t.activeBuffer.ydisp)}))}get buffer(){return this.buffers.active}resize(e,t){let i=this.cols!==e,r=this.rows!==t;this.cols=e,this.rows=t,this.buffers.resize(e,t),this._onResize.fire({cols:e,rows:t,colsChanged:i,rowsChanged:r})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,t=!1){let i=this.buffer,r;r=this._cachedBlankLine,(!r||r.length!==this.cols||r.getFg(0)!==e.fg||r.getBg(0)!==e.bg)&&(r=i.getBlankLine(e,t),this._cachedBlankLine=r),r.isWrapped=t;let l=i.ybase+i.scrollTop,c=i.ybase+i.scrollBottom;if(i.scrollTop===0){let u=i.lines.isFull;c===i.lines.length-1?u?i.lines.recycle().copyFrom(r):i.lines.push(r.clone()):i.lines.splice(c+1,0,r.clone()),u?this.isUserScrolling&&(i.ydisp=Math.max(i.ydisp-1,0)):(i.ybase++,this.isUserScrolling||i.ydisp++)}else{let u=c-l+1;i.lines.shiftElements(l+1,u-1,-1),i.lines.set(c,r.clone())}this.isUserScrolling||(i.ydisp=i.ybase),this._onScroll.fire(i.ydisp)}scrollLines(e,t){let i=this.buffer;if(e<0){if(i.ydisp===0)return;this.isUserScrolling=!0}else e+i.ydisp>=i.ybase&&(this.isUserScrolling=!1);let r=i.ydisp;i.ydisp=Math.max(Math.min(i.ydisp+e,i.ybase),0),r!==i.ydisp&&(t||this._onScroll.fire(i.ydisp))}};Dm=_t([_e(0,on)],Dm);var ha={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnEraseInDisplay:!1,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},reflowCursorLine:!1,rescaleOverlappingGlyphs:!1,rightClickSelectsWord:fu,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRuler:{}},P4=["normal","bold","100","200","300","400","500","600","700","800","900"],H4=class extends Be{constructor(e){super(),this._onOptionChange=this._register(new ge),this.onOptionChange=this._onOptionChange.event;let t={...ha};for(let i in e)if(i in t)try{let r=e[i];t[i]=this._sanitizeAndValidateOption(i,r)}catch(r){console.error(r)}this.rawOptions=t,this.options={...t},this._setupOptions(),this._register(ht(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(e,t){return this.onOptionChange(i=>{i===e&&t(this.rawOptions[e])})}onMultipleOptionChange(e,t){return this.onOptionChange(i=>{e.indexOf(i)!==-1&&t()})}_setupOptions(){let e=i=>{if(!(i in ha))throw new Error(`No option with key "${i}"`);return this.rawOptions[i]},t=(i,r)=>{if(!(i in ha))throw new Error(`No option with key "${i}"`);r=this._sanitizeAndValidateOption(i,r),this.rawOptions[i]!==r&&(this.rawOptions[i]=r,this._onOptionChange.fire(i))};for(let i in this.rawOptions){let r={get:e.bind(this,i),set:t.bind(this,i)};Object.defineProperty(this.options,i,r)}}_sanitizeAndValidateOption(e,t){switch(e){case"cursorStyle":if(t||(t=ha[e]),!I4(t))throw new Error(`"${t}" is not a valid value for ${e}`);break;case"wordSeparator":t||(t=ha[e]);break;case"fontWeight":case"fontWeightBold":if(typeof t=="number"&&1<=t&&t<=1e3)break;t=P4.includes(t)?t:ha[e];break;case"cursorWidth":t=Math.floor(t);case"lineHeight":case"tabStopWidth":if(t<1)throw new Error(`${e} cannot be less than 1, value: ${t}`);break;case"minimumContrastRatio":t=Math.max(1,Math.min(21,Math.round(t*10)/10));break;case"scrollback":if(t=Math.min(t,4294967295),t<0)throw new Error(`${e} cannot be less than 0, value: ${t}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(t<=0)throw new Error(`${e} cannot be less than or equal to 0, value: ${t}`);break;case"rows":case"cols":if(!t&&t!==0)throw new Error(`${e} must be numeric, value: ${t}`);break;case"windowsPty":t=t??{};break}return t}};function I4(e){return e==="block"||e==="underline"||e==="bar"}function Wl(e,t=5){if(typeof e!="object")return e;let i=Array.isArray(e)?[]:{};for(let r in e)i[r]=t<=1?e[r]:e[r]&&Wl(e[r],t-1);return i}var yS=Object.freeze({insertMode:!1}),xS=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,cursorBlink:void 0,cursorStyle:void 0,origin:!1,reverseWraparound:!1,sendFocus:!1,synchronizedOutput:!1,wraparound:!0}),Am=class extends Be{constructor(e,t,i){super(),this._bufferService=e,this._logService=t,this._optionsService=i,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this._register(new ge),this.onData=this._onData.event,this._onUserInput=this._register(new ge),this.onUserInput=this._onUserInput.event,this._onBinary=this._register(new ge),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this._register(new ge),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=Wl(yS),this.decPrivateModes=Wl(xS)}reset(){this.modes=Wl(yS),this.decPrivateModes=Wl(xS)}triggerDataEvent(e,t=!1){if(this._optionsService.rawOptions.disableStdin)return;let i=this._bufferService.buffer;t&&this._optionsService.rawOptions.scrollOnUserInput&&i.ybase!==i.ydisp&&this._onRequestScrollToBottom.fire(),t&&this._onUserInput.fire(),this._logService.debug(`sending data "${e}"`),this._logService.trace("sending data (codes)",()=>e.split("").map(r=>r.charCodeAt(0))),this._onData.fire(e)}triggerBinaryEvent(e){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${e}"`),this._logService.trace("sending binary (codes)",()=>e.split("").map(t=>t.charCodeAt(0))),this._onBinary.fire(e))}};Am=_t([_e(0,ln),_e(1,X0),_e(2,on)],Am);var SS={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:e=>e.button===4||e.action!==1?!1:(e.ctrl=!1,e.alt=!1,e.shift=!1,!0)},VT200:{events:19,restrict:e=>e.action!==32},DRAG:{events:23,restrict:e=>!(e.action===32&&e.button===3)},ANY:{events:31,restrict:e=>!0}};function Nf(e,t){let i=(e.ctrl?16:0)|(e.shift?4:0)|(e.alt?8:0);return e.button===4?(i|=64,i|=e.action):(i|=e.button&3,e.button&4&&(i|=64),e.button&8&&(i|=128),e.action===32?i|=32:e.action===0&&!t&&(i|=3)),i}var Ef=String.fromCharCode,bS={DEFAULT:e=>{let t=[Nf(e,!1)+32,e.col+32,e.row+32];return t[0]>255||t[1]>255||t[2]>255?"":`\x1B[M${Ef(t[0])}${Ef(t[1])}${Ef(t[2])}`},SGR:e=>{let t=e.action===0&&e.button!==4?"m":"M";return`\x1B[<${Nf(e,!0)};${e.col};${e.row}${t}`},SGR_PIXELS:e=>{let t=e.action===0&&e.button!==4?"m":"M";return`\x1B[<${Nf(e,!0)};${e.x};${e.y}${t}`}},Lm=class extends Be{constructor(e,t,i){super(),this._bufferService=e,this._coreService=t,this._optionsService=i,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._wheelPartialScroll=0,this._onProtocolChange=this._register(new ge),this.onProtocolChange=this._onProtocolChange.event;for(let r of Object.keys(SS))this.addProtocol(r,SS[r]);for(let r of Object.keys(bS))this.addEncoding(r,bS[r]);this.reset()}addProtocol(e,t){this._protocols[e]=t}addEncoding(e,t){this._encodings[e]=t}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(e){if(!this._protocols[e])throw new Error(`unknown protocol "${e}"`);this._activeProtocol=e,this._onProtocolChange.fire(this._protocols[e].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(e){if(!this._encodings[e])throw new Error(`unknown encoding "${e}"`);this._activeEncoding=e}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null,this._wheelPartialScroll=0}consumeWheelEvent(e,t,i){if(e.deltaY===0||e.shiftKey||t===void 0||i===void 0)return 0;let r=t/i,l=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(l/=r+0,Math.abs(e.deltaY)<50&&(l*=.3),this._wheelPartialScroll+=l,l=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(l*=this._bufferService.rows),l}_applyScrollModifier(e,t){return t.altKey||t.ctrlKey||t.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}triggerMouseEvent(e){if(e.col<0||e.col>=this._bufferService.cols||e.row<0||e.row>=this._bufferService.rows||e.button===4&&e.action===32||e.button===3&&e.action!==32||e.button!==4&&(e.action===2||e.action===3)||(e.col++,e.row++,e.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,e,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(e))return!1;let t=this._encodings[this._activeEncoding](e);return t&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(t):this._coreService.triggerDataEvent(t,!0)),this._lastEvent=e,!0}explainEvents(e){return{down:!!(e&1),up:!!(e&2),drag:!!(e&4),move:!!(e&8),wheel:!!(e&16)}}_equalEvents(e,t,i){if(i){if(e.x!==t.x||e.y!==t.y)return!1}else if(e.col!==t.col||e.row!==t.row)return!1;return!(e.button!==t.button||e.action!==t.action||e.ctrl!==t.ctrl||e.alt!==t.alt||e.shift!==t.shift)}};Lm=_t([_e(0,ln),_e(1,yr),_e(2,on)],Lm);var Tf=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],U4=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]],Mt;function F4(e,t){let i=0,r=t.length-1,l;if(e<t[0][0]||e>t[r][1])return!1;for(;r>=i;)if(l=i+r>>1,e>t[l][1])i=l+1;else if(e<t[l][0])r=l-1;else return!0;return!1}var $4=class{constructor(){if(this.version="6",!Mt){Mt=new Uint8Array(65536),Mt.fill(1),Mt[0]=0,Mt.fill(0,1,32),Mt.fill(0,127,160),Mt.fill(2,4352,4448),Mt[9001]=2,Mt[9002]=2,Mt.fill(2,11904,42192),Mt[12351]=1,Mt.fill(2,44032,55204),Mt.fill(2,63744,64256),Mt.fill(2,65040,65050),Mt.fill(2,65072,65136),Mt.fill(2,65280,65377),Mt.fill(2,65504,65511);for(let e=0;e<Tf.length;++e)Mt.fill(0,Tf[e][0],Tf[e][1]+1)}}wcwidth(e){return e<32?0:e<127?1:e<65536?Mt[e]:F4(e,U4)?0:e>=131072&&e<=196605||e>=196608&&e<=262141?2:1}charProperties(e,t){let i=this.wcwidth(e),r=i===0&&t!==0;if(r){let l=dr.extractWidth(t);l===0?r=!1:l>i&&(i=l)}return dr.createPropertyValue(0,i,r)}},dr=class iu{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new ge,this.onChange=this._onChange.event;let t=new $4;this.register(t),this._active=t.version,this._activeProvider=t}static extractShouldJoin(t){return(t&1)!==0}static extractWidth(t){return t>>1&3}static extractCharKind(t){return t>>3}static createPropertyValue(t,i,r=!1){return(t&16777215)<<3|(i&3)<<1|(r?1:0)}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(t){if(!this._providers[t])throw new Error(`unknown Unicode version "${t}"`);this._active=t,this._activeProvider=this._providers[t],this._onChange.fire(t)}register(t){this._providers[t.version]=t}wcwidth(t){return this._activeProvider.wcwidth(t)}getStringCellWidth(t){let i=0,r=0,l=t.length;for(let c=0;c<l;++c){let u=t.charCodeAt(c);if(55296<=u&&u<=56319){if(++c>=l)return i+this.wcwidth(u);let f=t.charCodeAt(c);56320<=f&&f<=57343?u=(u-55296)*1024+f-56320+65536:i+=this.wcwidth(f)}let d=this.charProperties(u,r),m=iu.extractWidth(d);iu.extractShouldJoin(d)&&(m-=iu.extractWidth(r)),i+=m,r=d}return i}charProperties(t,i){return this._activeProvider.charProperties(t,i)}},K4=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(e){this.glevel=e,this.charset=this._charsets[e]}setgCharset(e,t){this._charsets[e]=t,this.glevel===e&&(this.charset=t)}};function wS(e){let t=e.buffer.lines.get(e.buffer.ybase+e.buffer.y-1)?.get(e.cols-1),i=e.buffer.lines.get(e.buffer.ybase+e.buffer.y);i&&t&&(i.isWrapped=t[3]!==0&&t[3]!==32)}var zl=2147483647,q4=256,D1=class Mm{constructor(t=32,i=32){if(this.maxLength=t,this.maxSubParamsLength=i,i>q4)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(t),this.length=0,this._subParams=new Int32Array(i),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(t),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(t){let i=new Mm;if(!t.length)return i;for(let r=Array.isArray(t[0])?1:0;r<t.length;++r){let l=t[r];if(Array.isArray(l))for(let c=0;c<l.length;++c)i.addSubParam(l[c]);else i.addParam(l)}return i}clone(){let t=new Mm(this.maxLength,this.maxSubParamsLength);return t.params.set(this.params),t.length=this.length,t._subParams.set(this._subParams),t._subParamsLength=this._subParamsLength,t._subParamsIdx.set(this._subParamsIdx),t._rejectDigits=this._rejectDigits,t._rejectSubDigits=this._rejectSubDigits,t._digitIsSub=this._digitIsSub,t}toArray(){let t=[];for(let i=0;i<this.length;++i){t.push(this.params[i]);let r=this._subParamsIdx[i]>>8,l=this._subParamsIdx[i]&255;l-r>0&&t.push(Array.prototype.slice.call(this._subParams,r,l))}return t}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(t){if(this._digitIsSub=!1,this.length>=this.maxLength){this._rejectDigits=!0;return}if(t<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=t>zl?zl:t}addSubParam(t){if(this._digitIsSub=!0,!!this.length){if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength){this._rejectSubDigits=!0;return}if(t<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=t>zl?zl:t,this._subParamsIdx[this.length-1]++}}hasSubParams(t){return(this._subParamsIdx[t]&255)-(this._subParamsIdx[t]>>8)>0}getSubParams(t){let i=this._subParamsIdx[t]>>8,r=this._subParamsIdx[t]&255;return r-i>0?this._subParams.subarray(i,r):null}getSubParamsAll(){let t={};for(let i=0;i<this.length;++i){let r=this._subParamsIdx[i]>>8,l=this._subParamsIdx[i]&255;l-r>0&&(t[i]=this._subParams.slice(r,l))}return t}addDigit(t){let i;if(this._rejectDigits||!(i=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;let r=this._digitIsSub?this._subParams:this.params,l=r[i-1];r[i-1]=~l?Math.min(l*10+t,zl):t}},Pl=[],W4=class{constructor(){this._state=0,this._active=Pl,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(e,t){this._handlers[e]===void 0&&(this._handlers[e]=[]);let i=this._handlers[e];return i.push(t),{dispose:()=>{let r=i.indexOf(t);r!==-1&&i.splice(r,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=Pl}reset(){if(this._state===2)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].end(!1);this._stack.paused=!1,this._active=Pl,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||Pl,!this._active.length)this._handlerFb(this._id,"START");else for(let e=this._active.length-1;e>=0;e--)this._active[e].start()}_put(e,t,i){if(!this._active.length)this._handlerFb(this._id,"PUT",Eu(e,t,i));else for(let r=this._active.length-1;r>=0;r--)this._active[r].put(e,t,i)}start(){this.reset(),this._state=1}put(e,t,i){if(this._state!==3){if(this._state===1)for(;t<i;){let r=e[t++];if(r===59){this._state=2,this._start();break}if(r<48||57<r){this._state=3;return}this._id===-1&&(this._id=0),this._id=this._id*10+r-48}this._state===2&&i-t>0&&this._put(e,t,i)}}end(e,t=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),!this._active.length)this._handlerFb(this._id,"END",e);else{let i=!1,r=this._active.length-1,l=!1;if(this._stack.paused&&(r=this._stack.loopPosition-1,i=t,l=this._stack.fallThrough,this._stack.paused=!1),!l&&i===!1){for(;r>=0&&(i=this._active[r].end(e),i!==!0);r--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!1,i;r--}for(;r>=0;r--)if(i=this._active[r].end(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!0,i}this._active=Pl,this._id=-1,this._state=0}}},Dn=class{constructor(e){this._handler=e,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(e,t,i){this._hitLimit||(this._data+=Eu(e,t,i),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}end(e){let t=!1;if(this._hitLimit)t=!1;else if(e&&(t=this._handler(this._data),t instanceof Promise))return t.then(i=>(this._data="",this._hitLimit=!1,i));return this._data="",this._hitLimit=!1,t}},Hl=[],V4=class{constructor(){this._handlers=Object.create(null),this._active=Hl,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=Hl}registerHandler(e,t){this._handlers[e]===void 0&&(this._handlers[e]=[]);let i=this._handlers[e];return i.push(t),{dispose:()=>{let r=i.indexOf(t);r!==-1&&i.splice(r,1)}}}clearHandler(e){this._handlers[e]&&delete this._handlers[e]}setHandlerFallback(e){this._handlerFb=e}reset(){if(this._active.length)for(let e=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;e>=0;--e)this._active[e].unhook(!1);this._stack.paused=!1,this._active=Hl,this._ident=0}hook(e,t){if(this.reset(),this._ident=e,this._active=this._handlers[e]||Hl,!this._active.length)this._handlerFb(this._ident,"HOOK",t);else for(let i=this._active.length-1;i>=0;i--)this._active[i].hook(t)}put(e,t,i){if(!this._active.length)this._handlerFb(this._ident,"PUT",Eu(e,t,i));else for(let r=this._active.length-1;r>=0;r--)this._active[r].put(e,t,i)}unhook(e,t=!0){if(!this._active.length)this._handlerFb(this._ident,"UNHOOK",e);else{let i=!1,r=this._active.length-1,l=!1;if(this._stack.paused&&(r=this._stack.loopPosition-1,i=t,l=this._stack.fallThrough,this._stack.paused=!1),!l&&i===!1){for(;r>=0&&(i=this._active[r].unhook(e),i!==!0);r--)if(i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!1,i;r--}for(;r>=0;r--)if(i=this._active[r].unhook(!1),i instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=r,this._stack.fallThrough=!0,i}this._active=Hl,this._ident=0}},Vl=new D1;Vl.addParam(0);var CS=class{constructor(e){this._handler=e,this._data="",this._params=Vl,this._hitLimit=!1}hook(e){this._params=e.length>1||e.params[0]?e.clone():Vl,this._data="",this._hitLimit=!1}put(e,t,i){this._hitLimit||(this._data+=Eu(e,t,i),this._data.length>1e7&&(this._data="",this._hitLimit=!0))}unhook(e){let t=!1;if(this._hitLimit)t=!1;else if(e&&(t=this._handler(this._data,this._params),t instanceof Promise))return t.then(i=>(this._params=Vl,this._data="",this._hitLimit=!1,i));return this._params=Vl,this._data="",this._hitLimit=!1,t}},G4=class{constructor(e){this.table=new Uint8Array(e)}setDefault(e,t){this.table.fill(e<<4|t)}add(e,t,i,r){this.table[t<<8|e]=i<<4|r}addMany(e,t,i,r){for(let l=0;l<e.length;l++)this.table[t<<8|e[l]]=i<<4|r}},Qn=160,Y4=(function(){let e=new G4(4095),t=Array.apply(null,Array(256)).map((d,m)=>m),i=(d,m)=>t.slice(d,m),r=i(32,127),l=i(0,24);l.push(25),l.push.apply(l,i(28,32));let c=i(0,14),u;e.setDefault(1,0),e.addMany(r,0,2,0);for(u in c)e.addMany([24,26,153,154],u,3,0),e.addMany(i(128,144),u,3,0),e.addMany(i(144,152),u,3,0),e.add(156,u,0,0),e.add(27,u,11,1),e.add(157,u,4,8),e.addMany([152,158,159],u,0,7),e.add(155,u,11,3),e.add(144,u,11,9);return e.addMany(l,0,3,0),e.addMany(l,1,3,1),e.add(127,1,0,1),e.addMany(l,8,0,8),e.addMany(l,3,3,3),e.add(127,3,0,3),e.addMany(l,4,3,4),e.add(127,4,0,4),e.addMany(l,6,3,6),e.addMany(l,5,3,5),e.add(127,5,0,5),e.addMany(l,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(r,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(i(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(r,7,0,7),e.addMany(l,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(i(64,127),3,7,0),e.addMany(i(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(i(48,60),4,8,4),e.addMany(i(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(i(32,64),6,0,6),e.add(127,6,0,6),e.addMany(i(64,127),6,0,0),e.addMany(i(32,48),3,9,5),e.addMany(i(32,48),5,9,5),e.addMany(i(48,64),5,0,6),e.addMany(i(64,127),5,7,0),e.addMany(i(32,48),4,9,5),e.addMany(i(32,48),1,9,2),e.addMany(i(32,48),2,9,2),e.addMany(i(48,127),2,10,0),e.addMany(i(48,80),1,10,0),e.addMany(i(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(i(96,127),1,10,0),e.add(80,1,11,9),e.addMany(l,9,0,9),e.add(127,9,0,9),e.addMany(i(28,32),9,0,9),e.addMany(i(32,48),9,9,12),e.addMany(i(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(l,11,0,11),e.addMany(i(32,128),11,0,11),e.addMany(i(28,32),11,0,11),e.addMany(l,10,0,10),e.add(127,10,0,10),e.addMany(i(28,32),10,0,10),e.addMany(i(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(i(32,48),10,9,12),e.addMany(l,12,0,12),e.add(127,12,0,12),e.addMany(i(28,32),12,0,12),e.addMany(i(32,48),12,9,12),e.addMany(i(48,64),12,0,11),e.addMany(i(64,127),12,12,13),e.addMany(i(64,127),10,12,13),e.addMany(i(64,127),9,12,13),e.addMany(l,13,13,13),e.addMany(r,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(Qn,0,2,0),e.add(Qn,8,5,8),e.add(Qn,6,0,6),e.add(Qn,11,0,11),e.add(Qn,13,13,13),e})(),X4=class extends Be{constructor(e=Y4){super(),this._transitions=e,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new D1,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(t,i,r)=>{},this._executeHandlerFb=t=>{},this._csiHandlerFb=(t,i)=>{},this._escHandlerFb=t=>{},this._errorHandlerFb=t=>t,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this._register(ht(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this._register(new W4),this._dcsParser=this._register(new V4),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(e,t=[64,126]){let i=0;if(e.prefix){if(e.prefix.length>1)throw new Error("only one byte as prefix supported");if(i=e.prefix.charCodeAt(0),i&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(e.intermediates){if(e.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let l=0;l<e.intermediates.length;++l){let c=e.intermediates.charCodeAt(l);if(32>c||c>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=c}}if(e.final.length!==1)throw new Error("final must be a single byte");let r=e.final.charCodeAt(0);if(t[0]>r||r>t[1])throw new Error(`final must be in range ${t[0]} .. ${t[1]}`);return i<<=8,i|=r,i}identToString(e){let t=[];for(;e;)t.push(String.fromCharCode(e&255)),e>>=8;return t.reverse().join("")}setPrintHandler(e){this._printHandler=e}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(e,t){let i=this._identifier(e,[48,126]);this._escHandlers[i]===void 0&&(this._escHandlers[i]=[]);let r=this._escHandlers[i];return r.push(t),{dispose:()=>{let l=r.indexOf(t);l!==-1&&r.splice(l,1)}}}clearEscHandler(e){this._escHandlers[this._identifier(e,[48,126])]&&delete this._escHandlers[this._identifier(e,[48,126])]}setEscHandlerFallback(e){this._escHandlerFb=e}setExecuteHandler(e,t){this._executeHandlers[e.charCodeAt(0)]=t}clearExecuteHandler(e){this._executeHandlers[e.charCodeAt(0)]&&delete this._executeHandlers[e.charCodeAt(0)]}setExecuteHandlerFallback(e){this._executeHandlerFb=e}registerCsiHandler(e,t){let i=this._identifier(e);this._csiHandlers[i]===void 0&&(this._csiHandlers[i]=[]);let r=this._csiHandlers[i];return r.push(t),{dispose:()=>{let l=r.indexOf(t);l!==-1&&r.splice(l,1)}}}clearCsiHandler(e){this._csiHandlers[this._identifier(e)]&&delete this._csiHandlers[this._identifier(e)]}setCsiHandlerFallback(e){this._csiHandlerFb=e}registerDcsHandler(e,t){return this._dcsParser.registerHandler(this._identifier(e),t)}clearDcsHandler(e){this._dcsParser.clearHandler(this._identifier(e))}setDcsHandlerFallback(e){this._dcsParser.setHandlerFallback(e)}registerOscHandler(e,t){return this._oscParser.registerHandler(e,t)}clearOscHandler(e){this._oscParser.clearHandler(e)}setOscHandlerFallback(e){this._oscParser.setHandlerFallback(e)}setErrorHandler(e){this._errorHandler=e}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(e,t,i,r,l){this._parseStack.state=e,this._parseStack.handlers=t,this._parseStack.handlerPos=i,this._parseStack.transition=r,this._parseStack.chunkPos=l}parse(e,t,i){let r=0,l=0,c=0,u;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,c=this._parseStack.chunkPos+1;else{if(i===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");let d=this._parseStack.handlers,m=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(i===!1&&m>-1){for(;m>=0&&(u=d[m](this._params),u!==!0);m--)if(u instanceof Promise)return this._parseStack.handlerPos=m,u}this._parseStack.handlers=[];break;case 4:if(i===!1&&m>-1){for(;m>=0&&(u=d[m](),u!==!0);m--)if(u instanceof Promise)return this._parseStack.handlerPos=m,u}this._parseStack.handlers=[];break;case 6:if(r=e[this._parseStack.chunkPos],u=this._dcsParser.unhook(r!==24&&r!==26,i),u)return u;r===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(r=e[this._parseStack.chunkPos],u=this._oscParser.end(r!==24&&r!==26,i),u)return u;r===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break}this._parseStack.state=0,c=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=this._parseStack.transition&15}for(let d=c;d<t;++d){switch(r=e[d],l=this._transitions.table[this.currentState<<8|(r<160?r:Qn)],l>>4){case 2:for(let S=d+1;;++S){if(S>=t||(r=e[S])<32||r>126&&r<Qn){this._printHandler(e,d,S),d=S-1;break}if(++S>=t||(r=e[S])<32||r>126&&r<Qn){this._printHandler(e,d,S),d=S-1;break}if(++S>=t||(r=e[S])<32||r>126&&r<Qn){this._printHandler(e,d,S),d=S-1;break}if(++S>=t||(r=e[S])<32||r>126&&r<Qn){this._printHandler(e,d,S),d=S-1;break}}break;case 3:this._executeHandlers[r]?this._executeHandlers[r]():this._executeHandlerFb(r),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:d,code:r,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:let m=this._csiHandlers[this._collect<<8|r],f=m?m.length-1:-1;for(;f>=0&&(u=m[f](this._params),u!==!0);f--)if(u instanceof Promise)return this._preserveStack(3,m,f,l,d),u;f<0&&this._csiHandlerFb(this._collect<<8|r,this._params),this.precedingJoinState=0;break;case 8:do switch(r){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(r-48)}while(++d<t&&(r=e[d])>47&&r<60);d--;break;case 9:this._collect<<=8,this._collect|=r;break;case 10:let v=this._escHandlers[this._collect<<8|r],_=v?v.length-1:-1;for(;_>=0&&(u=v[_](),u!==!0);_--)if(u instanceof Promise)return this._preserveStack(4,v,_,l,d),u;_<0&&this._escHandlerFb(this._collect<<8|r),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|r,this._params);break;case 13:for(let S=d+1;;++S)if(S>=t||(r=e[S])===24||r===26||r===27||r>127&&r<Qn){this._dcsParser.put(e,d,S),d=S-1;break}break;case 14:if(u=this._dcsParser.unhook(r!==24&&r!==26),u)return this._preserveStack(6,[],0,l,d),u;r===27&&(l|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let S=d+1;;S++)if(S>=t||(r=e[S])<32||r>127&&r<Qn){this._oscParser.put(e,d,S),d=S-1;break}break;case 6:if(u=this._oscParser.end(r!==24&&r!==26),u)return this._preserveStack(5,[],0,l,d),u;r===27&&(l|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break}this.currentState=l&15}}},J4=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,Z4=/^[\da-f]+$/;function jS(e){if(!e)return;let t=e.toLowerCase();if(t.indexOf("rgb:")===0){t=t.slice(4);let i=J4.exec(t);if(i){let r=i[1]?15:i[4]?255:i[7]?4095:65535;return[Math.round(parseInt(i[1]||i[4]||i[7]||i[10],16)/r*255),Math.round(parseInt(i[2]||i[5]||i[8]||i[11],16)/r*255),Math.round(parseInt(i[3]||i[6]||i[9]||i[12],16)/r*255)]}}else if(t.indexOf("#")===0&&(t=t.slice(1),Z4.exec(t)&&[3,6,9,12].includes(t.length))){let i=t.length/3,r=[0,0,0];for(let l=0;l<3;++l){let c=parseInt(t.slice(i*l,i*l+i),16);r[l]=i===1?c<<4:i===2?c:i===3?c>>4:c>>8}return r}}function Rf(e,t){let i=e.toString(16),r=i.length<2?"0"+i:i;switch(t){case 4:return i[0];case 8:return r;case 12:return(r+r).slice(0,3);default:return r+r}}function Q4(e,t=16){let[i,r,l]=e;return`rgb:${Rf(i,t)}/${Rf(r,t)}/${Rf(l,t)}`}var eL={"(":0,")":1,"*":2,"+":3,"-":1,".":2},Ds=131072,kS=10;function NS(e,t){if(e>24)return t.setWinLines||!1;switch(e){case 1:return!!t.restoreWin;case 2:return!!t.minimizeWin;case 3:return!!t.setWinPosition;case 4:return!!t.setWinSizePixels;case 5:return!!t.raiseWin;case 6:return!!t.lowerWin;case 7:return!!t.refreshWin;case 8:return!!t.setWinSizeChars;case 9:return!!t.maximizeWin;case 10:return!!t.fullscreenWin;case 11:return!!t.getWinState;case 13:return!!t.getWinPosition;case 14:return!!t.getWinSizePixels;case 15:return!!t.getScreenSizePixels;case 16:return!!t.getCellSizePixels;case 18:return!!t.getWinSizeChars;case 19:return!!t.getScreenSizeChars;case 20:return!!t.getIconTitle;case 21:return!!t.getWinTitle;case 22:return!!t.pushTitle;case 23:return!!t.popTitle;case 24:return!!t.setWinLines}return!1}var ES=5e3,TS=0,tL=class extends Be{constructor(e,t,i,r,l,c,u,d,m=new X4){super(),this._bufferService=e,this._charsetService=t,this._coreService=i,this._logService=r,this._optionsService=l,this._oscLinkService=c,this._coreMouseService=u,this._unicodeService=d,this._parser=m,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new xA,this._utf8Decoder=new SA,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=Tt.clone(),this._eraseAttrDataInternal=Tt.clone(),this._onRequestBell=this._register(new ge),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this._register(new ge),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this._register(new ge),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this._register(new ge),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this._register(new ge),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this._register(new ge),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this._register(new ge),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this._register(new ge),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this._register(new ge),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this._register(new ge),this.onLineFeed=this._onLineFeed.event,this._onScroll=this._register(new ge),this.onScroll=this._onScroll.event,this._onTitleChange=this._register(new ge),this.onTitleChange=this._onTitleChange.event,this._onColor=this._register(new ge),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this._register(this._parser),this._dirtyRowTracker=new Bm(this._bufferService),this._activeBuffer=this._bufferService.buffer,this._register(this._bufferService.buffers.onBufferActivate(f=>this._activeBuffer=f.activeBuffer)),this._parser.setCsiHandlerFallback((f,v)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(f),params:v.toArray()})}),this._parser.setEscHandlerFallback(f=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(f)})}),this._parser.setExecuteHandlerFallback(f=>{this._logService.debug("Unknown EXECUTE code: ",{code:f})}),this._parser.setOscHandlerFallback((f,v,_)=>{this._logService.debug("Unknown OSC code: ",{identifier:f,action:v,data:_})}),this._parser.setDcsHandlerFallback((f,v,_)=>{v==="HOOK"&&(_=_.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(f),action:v,payload:_})}),this._parser.setPrintHandler((f,v,_)=>this.print(f,v,_)),this._parser.registerCsiHandler({final:"@"},f=>this.insertChars(f)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},f=>this.scrollLeft(f)),this._parser.registerCsiHandler({final:"A"},f=>this.cursorUp(f)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},f=>this.scrollRight(f)),this._parser.registerCsiHandler({final:"B"},f=>this.cursorDown(f)),this._parser.registerCsiHandler({final:"C"},f=>this.cursorForward(f)),this._parser.registerCsiHandler({final:"D"},f=>this.cursorBackward(f)),this._parser.registerCsiHandler({final:"E"},f=>this.cursorNextLine(f)),this._parser.registerCsiHandler({final:"F"},f=>this.cursorPrecedingLine(f)),this._parser.registerCsiHandler({final:"G"},f=>this.cursorCharAbsolute(f)),this._parser.registerCsiHandler({final:"H"},f=>this.cursorPosition(f)),this._parser.registerCsiHandler({final:"I"},f=>this.cursorForwardTab(f)),this._parser.registerCsiHandler({final:"J"},f=>this.eraseInDisplay(f,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},f=>this.eraseInDisplay(f,!0)),this._parser.registerCsiHandler({final:"K"},f=>this.eraseInLine(f,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},f=>this.eraseInLine(f,!0)),this._parser.registerCsiHandler({final:"L"},f=>this.insertLines(f)),this._parser.registerCsiHandler({final:"M"},f=>this.deleteLines(f)),this._parser.registerCsiHandler({final:"P"},f=>this.deleteChars(f)),this._parser.registerCsiHandler({final:"S"},f=>this.scrollUp(f)),this._parser.registerCsiHandler({final:"T"},f=>this.scrollDown(f)),this._parser.registerCsiHandler({final:"X"},f=>this.eraseChars(f)),this._parser.registerCsiHandler({final:"Z"},f=>this.cursorBackwardTab(f)),this._parser.registerCsiHandler({final:"`"},f=>this.charPosAbsolute(f)),this._parser.registerCsiHandler({final:"a"},f=>this.hPositionRelative(f)),this._parser.registerCsiHandler({final:"b"},f=>this.repeatPrecedingCharacter(f)),this._parser.registerCsiHandler({final:"c"},f=>this.sendDeviceAttributesPrimary(f)),this._parser.registerCsiHandler({prefix:">",final:"c"},f=>this.sendDeviceAttributesSecondary(f)),this._parser.registerCsiHandler({final:"d"},f=>this.linePosAbsolute(f)),this._parser.registerCsiHandler({final:"e"},f=>this.vPositionRelative(f)),this._parser.registerCsiHandler({final:"f"},f=>this.hVPosition(f)),this._parser.registerCsiHandler({final:"g"},f=>this.tabClear(f)),this._parser.registerCsiHandler({final:"h"},f=>this.setMode(f)),this._parser.registerCsiHandler({prefix:"?",final:"h"},f=>this.setModePrivate(f)),this._parser.registerCsiHandler({final:"l"},f=>this.resetMode(f)),this._parser.registerCsiHandler({prefix:"?",final:"l"},f=>this.resetModePrivate(f)),this._parser.registerCsiHandler({final:"m"},f=>this.charAttributes(f)),this._parser.registerCsiHandler({final:"n"},f=>this.deviceStatus(f)),this._parser.registerCsiHandler({prefix:"?",final:"n"},f=>this.deviceStatusPrivate(f)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},f=>this.softReset(f)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},f=>this.setCursorStyle(f)),this._parser.registerCsiHandler({final:"r"},f=>this.setScrollRegion(f)),this._parser.registerCsiHandler({final:"s"},f=>this.saveCursor(f)),this._parser.registerCsiHandler({final:"t"},f=>this.windowOptions(f)),this._parser.registerCsiHandler({final:"u"},f=>this.restoreCursor(f)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},f=>this.insertColumns(f)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},f=>this.deleteColumns(f)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},f=>this.selectProtected(f)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},f=>this.requestMode(f,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},f=>this.requestMode(f,!1)),this._parser.setExecuteHandler(ce.BEL,()=>this.bell()),this._parser.setExecuteHandler(ce.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(ce.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(ce.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(ce.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(ce.BS,()=>this.backspace()),this._parser.setExecuteHandler(ce.HT,()=>this.tab()),this._parser.setExecuteHandler(ce.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(ce.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(tu.IND,()=>this.index()),this._parser.setExecuteHandler(tu.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(tu.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new Dn(f=>(this.setTitle(f),this.setIconName(f),!0))),this._parser.registerOscHandler(1,new Dn(f=>this.setIconName(f))),this._parser.registerOscHandler(2,new Dn(f=>this.setTitle(f))),this._parser.registerOscHandler(4,new Dn(f=>this.setOrReportIndexedColor(f))),this._parser.registerOscHandler(8,new Dn(f=>this.setHyperlink(f))),this._parser.registerOscHandler(10,new Dn(f=>this.setOrReportFgColor(f))),this._parser.registerOscHandler(11,new Dn(f=>this.setOrReportBgColor(f))),this._parser.registerOscHandler(12,new Dn(f=>this.setOrReportCursorColor(f))),this._parser.registerOscHandler(104,new Dn(f=>this.restoreIndexedColor(f))),this._parser.registerOscHandler(110,new Dn(f=>this.restoreFgColor(f))),this._parser.registerOscHandler(111,new Dn(f=>this.restoreBgColor(f))),this._parser.registerOscHandler(112,new Dn(f=>this.restoreCursorColor(f))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(let f in Bt)this._parser.registerEscHandler({intermediates:"(",final:f},()=>this.selectCharset("("+f)),this._parser.registerEscHandler({intermediates:")",final:f},()=>this.selectCharset(")"+f)),this._parser.registerEscHandler({intermediates:"*",final:f},()=>this.selectCharset("*"+f)),this._parser.registerEscHandler({intermediates:"+",final:f},()=>this.selectCharset("+"+f)),this._parser.registerEscHandler({intermediates:"-",final:f},()=>this.selectCharset("-"+f)),this._parser.registerEscHandler({intermediates:".",final:f},()=>this.selectCharset("."+f)),this._parser.registerEscHandler({intermediates:"/",final:f},()=>this.selectCharset("/"+f));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(f=>(this._logService.error("Parsing error: ",f),f)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new CS((f,v)=>this.requestStatusString(f,v)))}getAttrData(){return this._curAttrData}_preserveStack(e,t,i,r){this._parseStack.paused=!0,this._parseStack.cursorStartX=e,this._parseStack.cursorStartY=t,this._parseStack.decodedLength=i,this._parseStack.position=r}_logSlowResolvingAsync(e){this._logService.logLevel<=3&&Promise.race([e,new Promise((t,i)=>setTimeout(()=>i("#SLOW_TIMEOUT"),ES))]).catch(t=>{if(t!=="#SLOW_TIMEOUT")throw t;console.warn(`async parser handler taking longer than ${ES} ms`)})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(e,t){let i,r=this._activeBuffer.x,l=this._activeBuffer.y,c=0,u=this._parseStack.paused;if(u){if(i=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,t))return this._logSlowResolvingAsync(i),i;r=this._parseStack.cursorStartX,l=this._parseStack.cursorStartY,this._parseStack.paused=!1,e.length>Ds&&(c=this._parseStack.position+Ds)}if(this._logService.logLevel<=1&&this._logService.debug(`parsing data ${typeof e=="string"?` "${e}"`:` "${Array.prototype.map.call(e,f=>String.fromCharCode(f)).join("")}"`}`),this._logService.logLevel===0&&this._logService.trace("parsing data (codes)",typeof e=="string"?e.split("").map(f=>f.charCodeAt(0)):e),this._parseBuffer.length<e.length&&this._parseBuffer.length<Ds&&(this._parseBuffer=new Uint32Array(Math.min(e.length,Ds))),u||this._dirtyRowTracker.clearRange(),e.length>Ds)for(let f=c;f<e.length;f+=Ds){let v=f+Ds<e.length?f+Ds:e.length,_=typeof e=="string"?this._stringDecoder.decode(e.substring(f,v),this._parseBuffer):this._utf8Decoder.decode(e.subarray(f,v),this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,_))return this._preserveStack(r,l,_,f),this._logSlowResolvingAsync(i),i}else if(!u){let f=typeof e=="string"?this._stringDecoder.decode(e,this._parseBuffer):this._utf8Decoder.decode(e,this._parseBuffer);if(i=this._parser.parse(this._parseBuffer,f))return this._preserveStack(r,l,f,0),this._logSlowResolvingAsync(i),i}(this._activeBuffer.x!==r||this._activeBuffer.y!==l)&&this._onCursorMove.fire();let d=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),m=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);m<this._bufferService.rows&&this._onRequestRefreshRows.fire({start:Math.min(m,this._bufferService.rows-1),end:Math.min(d,this._bufferService.rows-1)})}print(e,t,i){let r,l,c=this._charsetService.charset,u=this._optionsService.rawOptions.screenReaderMode,d=this._bufferService.cols,m=this._coreService.decPrivateModes.wraparound,f=this._coreService.modes.insertMode,v=this._curAttrData,_=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&i-t>0&&_.getWidth(this._activeBuffer.x-1)===2&&_.setCellFromCodepoint(this._activeBuffer.x-1,0,1,v);let S=this._parser.precedingJoinState;for(let x=t;x<i;++x){if(r=e[x],r<127&&c){let k=c[String.fromCharCode(r)];k&&(r=k.charCodeAt(0))}let b=this._unicodeService.charProperties(r,S);l=dr.extractWidth(b);let C=dr.extractShouldJoin(b),T=C?dr.extractWidth(S):0;if(S=b,u&&this._onA11yChar.fire(Ls(r)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+l-T>d){if(m){let k=_,R=this._activeBuffer.x-T;for(this._activeBuffer.x=T,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),_=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),T>0&&_ instanceof ql&&_.copyCellsFrom(k,R,0,T,!1);R<d;)k.setCellFromCodepoint(R++,0,1,v)}else if(this._activeBuffer.x=d-1,l===2)continue}if(C&&this._activeBuffer.x){let k=_.getWidth(this._activeBuffer.x-1)?1:2;_.addCodepointToCell(this._activeBuffer.x-k,r,l);for(let R=l-T;--R>=0;)_.setCellFromCodepoint(this._activeBuffer.x++,0,0,v);continue}if(f&&(_.insertCells(this._activeBuffer.x,l-T,this._activeBuffer.getNullCell(v)),_.getWidth(d-1)===2&&_.setCellFromCodepoint(d-1,0,1,v)),_.setCellFromCodepoint(this._activeBuffer.x++,r,l,v),l>0)for(;--l;)_.setCellFromCodepoint(this._activeBuffer.x++,0,0,v)}this._parser.precedingJoinState=S,this._activeBuffer.x<d&&i-t>0&&_.getWidth(this._activeBuffer.x)===0&&!_.hasContent(this._activeBuffer.x)&&_.setCellFromCodepoint(this._activeBuffer.x,0,1,v),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(e,t){return e.final==="t"&&!e.prefix&&!e.intermediates?this._parser.registerCsiHandler(e,i=>NS(i.params[0],this._optionsService.rawOptions.windowOptions)?t(i):!0):this._parser.registerCsiHandler(e,t)}registerDcsHandler(e,t){return this._parser.registerDcsHandler(e,new CS(t))}registerEscHandler(e,t){return this._parser.registerEscHandler(e,t)}registerOscHandler(e,t){return this._parser.registerOscHandler(e,new Dn(t))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)?.isWrapped){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;let e=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);e.hasWidth(this._activeBuffer.x)&&!e.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let e=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-e),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(e=this._bufferService.cols-1){this._activeBuffer.x=Math.min(e,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(e,t){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=e,this._activeBuffer.y=this._activeBuffer.scrollTop+t):(this._activeBuffer.x=e,this._activeBuffer.y=t),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(e,t){this._restrictCursor(),this._setCursor(this._activeBuffer.x+e,this._activeBuffer.y+t)}cursorUp(e){let t=this._activeBuffer.y-this._activeBuffer.scrollTop;return t>=0?this._moveCursor(0,-Math.min(t,e.params[0]||1)):this._moveCursor(0,-(e.params[0]||1)),!0}cursorDown(e){let t=this._activeBuffer.scrollBottom-this._activeBuffer.y;return t>=0?this._moveCursor(0,Math.min(t,e.params[0]||1)):this._moveCursor(0,e.params[0]||1),!0}cursorForward(e){return this._moveCursor(e.params[0]||1,0),!0}cursorBackward(e){return this._moveCursor(-(e.params[0]||1),0),!0}cursorNextLine(e){return this.cursorDown(e),this._activeBuffer.x=0,!0}cursorPrecedingLine(e){return this.cursorUp(e),this._activeBuffer.x=0,!0}cursorCharAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(e){return this._setCursor(e.length>=2?(e.params[1]||1)-1:0,(e.params[0]||1)-1),!0}charPosAbsolute(e){return this._setCursor((e.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(e){return this._moveCursor(e.params[0]||1,0),!0}linePosAbsolute(e){return this._setCursor(this._activeBuffer.x,(e.params[0]||1)-1),!0}vPositionRelative(e){return this._moveCursor(0,e.params[0]||1),!0}hVPosition(e){return this.cursorPosition(e),!0}tabClear(e){let t=e.params[0];return t===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:t===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(e){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let t=e.params[0]||1;for(;t--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(e){let t=e.params[0];return t===1&&(this._curAttrData.bg|=536870912),(t===2||t===0)&&(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(e,t,i,r=!1,l=!1){let c=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);c.replaceCells(t,i,this._activeBuffer.getNullCell(this._eraseAttrData()),l),r&&(c.isWrapped=!1)}_resetBufferLine(e,t=!1){let i=this._activeBuffer.lines.get(this._activeBuffer.ybase+e);i&&(i.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),t),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+e),i.isWrapped=!1)}eraseInDisplay(e,t=!1){this._restrictCursor(this._bufferService.cols);let i;switch(e.params[0]){case 0:for(i=this._activeBuffer.y,this._dirtyRowTracker.markDirty(i),this._eraseInBufferLine(i++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,t);i<this._bufferService.rows;i++)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(i);break;case 1:for(i=this._activeBuffer.y,this._dirtyRowTracker.markDirty(i),this._eraseInBufferLine(i,0,this._activeBuffer.x+1,!0,t),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(i+1).isWrapped=!1);i--;)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(0);break;case 2:if(this._optionsService.rawOptions.scrollOnEraseInDisplay){for(i=this._bufferService.rows,this._dirtyRowTracker.markRangeDirty(0,i-1);i--&&!this._activeBuffer.lines.get(this._activeBuffer.ybase+i)?.getTrimmedLength(););for(;i>=0;i--)this._bufferService.scroll(this._eraseAttrData())}else{for(i=this._bufferService.rows,this._dirtyRowTracker.markDirty(i-1);i--;)this._resetBufferLine(i,t);this._dirtyRowTracker.markDirty(0)}break;case 3:let r=this._activeBuffer.lines.length-this._bufferService.rows;r>0&&(this._activeBuffer.lines.trimStart(r),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-r,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-r,0),this._onScroll.fire(0));break}return!0}eraseInLine(e,t=!1){switch(this._restrictCursor(this._bufferService.cols),e.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,t);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,t);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,t);break}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let i=this._activeBuffer.ybase+this._activeBuffer.y,r=this._bufferService.rows-1-this._activeBuffer.scrollBottom,l=this._bufferService.rows-1+this._activeBuffer.ybase-r+1;for(;t--;)this._activeBuffer.lines.splice(l-1,1),this._activeBuffer.lines.splice(i,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(e){this._restrictCursor();let t=e.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let i=this._activeBuffer.ybase+this._activeBuffer.y,r;for(r=this._bufferService.rows-1-this._activeBuffer.scrollBottom,r=this._bufferService.rows-1+this._activeBuffer.ybase-r;t--;)this._activeBuffer.lines.splice(i,1),this._activeBuffer.lines.splice(r,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(e){this._restrictCursor();let t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.insertCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(e){this._restrictCursor();let t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.deleteCells(this._activeBuffer.x,e.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(e){let t=e.params[0]||1;for(;t--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(Tt));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){let r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.deleteCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),r.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){let r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.insertCells(0,t,this._activeBuffer.getNullCell(this._eraseAttrData())),r.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){let r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.insertCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),r.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(e){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;let t=e.params[0]||1;for(let i=this._activeBuffer.scrollTop;i<=this._activeBuffer.scrollBottom;++i){let r=this._activeBuffer.lines.get(this._activeBuffer.ybase+i);r.deleteCells(this._activeBuffer.x,t,this._activeBuffer.getNullCell(this._eraseAttrData())),r.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(e){this._restrictCursor();let t=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return t&&(t.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(e.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(e){let t=this._parser.precedingJoinState;if(!t)return!0;let i=e.params[0]||1,r=dr.extractWidth(t),l=this._activeBuffer.x-r,c=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(l),u=new Uint32Array(c.length*i),d=0;for(let f=0;f<c.length;){let v=c.codePointAt(f)||0;u[d++]=v,f+=v>65535?2:1}let m=d;for(let f=1;f<i;++f)u.copyWithin(m,0,d),m+=d;return this.print(u,0,m),!0}sendDeviceAttributesPrimary(e){return e.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(ce.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(ce.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(e){return e.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(ce.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(ce.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(e.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(ce.ESC+"[>83;40003;0c")),!0}_is(e){return(this._optionsService.rawOptions.termName+"").indexOf(e)===0}setMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0;break}return!0}setModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,hr),this._charsetService.setgCharset(1,hr),this._charsetService.setgCharset(2,hr),this._charsetService.setgCharset(3,hr);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!0;break}return!0}resetMode(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1;break}return!0}resetModePrivate(e){for(let t=0;t<e.length;t++)switch(e.params[t]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),e.params[t]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(void 0),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1;break;case 2026:this._coreService.decPrivateModes.synchronizedOutput=!1,this._onRequestRefreshRows.fire(void 0);break}return!0}requestMode(e,t){let i;(C=>(C[C.NOT_RECOGNIZED=0]="NOT_RECOGNIZED",C[C.SET=1]="SET",C[C.RESET=2]="RESET",C[C.PERMANENTLY_SET=3]="PERMANENTLY_SET",C[C.PERMANENTLY_RESET=4]="PERMANENTLY_RESET"))(i||={});let r=this._coreService.decPrivateModes,{activeProtocol:l,activeEncoding:c}=this._coreMouseService,u=this._coreService,{buffers:d,cols:m}=this._bufferService,{active:f,alt:v}=d,_=this._optionsService.rawOptions,S=(C,T)=>(u.triggerDataEvent(`${ce.ESC}[${t?"":"?"}${C};${T}$y`),!0),x=C=>C?1:2,b=e.params[0];return t?b===2?S(b,4):b===4?S(b,x(u.modes.insertMode)):b===12?S(b,3):b===20?S(b,x(_.convertEol)):S(b,0):b===1?S(b,x(r.applicationCursorKeys)):b===3?S(b,_.windowOptions.setWinLines?m===80?2:m===132?1:0:0):b===6?S(b,x(r.origin)):b===7?S(b,x(r.wraparound)):b===8?S(b,3):b===9?S(b,x(l==="X10")):b===12?S(b,x(_.cursorBlink)):b===25?S(b,x(!u.isCursorHidden)):b===45?S(b,x(r.reverseWraparound)):b===66?S(b,x(r.applicationKeypad)):b===67?S(b,4):b===1e3?S(b,x(l==="VT200")):b===1002?S(b,x(l==="DRAG")):b===1003?S(b,x(l==="ANY")):b===1004?S(b,x(r.sendFocus)):b===1005?S(b,4):b===1006?S(b,x(c==="SGR")):b===1015?S(b,4):b===1016?S(b,x(c==="SGR_PIXELS")):b===1048?S(b,1):b===47||b===1047||b===1049?S(b,x(f===v)):b===2004?S(b,x(r.bracketedPasteMode)):b===2026?S(b,x(r.synchronizedOutput)):S(b,0)}_updateAttrColor(e,t,i,r,l){return t===2?(e|=50331648,e&=-16777216,e|=mo.fromColorRGB([i,r,l])):t===5&&(e&=-50331904,e|=33554432|i&255),e}_extractColor(e,t,i){let r=[0,0,-1,0,0,0],l=0,c=0;do{if(r[c+l]=e.params[t+c],e.hasSubParams(t+c)){let u=e.getSubParams(t+c),d=0;do r[1]===5&&(l=1),r[c+d+1+l]=u[d];while(++d<u.length&&d+c+1+l<r.length);break}if(r[1]===5&&c+l>=2||r[1]===2&&c+l>=5)break;r[1]&&(l=1)}while(++c+t<e.length&&c+l<r.length);for(let u=2;u<r.length;++u)r[u]===-1&&(r[u]=0);switch(r[0]){case 38:i.fg=this._updateAttrColor(i.fg,r[1],r[3],r[4],r[5]);break;case 48:i.bg=this._updateAttrColor(i.bg,r[1],r[3],r[4],r[5]);break;case 58:i.extended=i.extended.clone(),i.extended.underlineColor=this._updateAttrColor(i.extended.underlineColor,r[1],r[3],r[4],r[5])}return c}_processUnderline(e,t){t.extended=t.extended.clone(),(!~e||e>5)&&(e=1),t.extended.underlineStyle=e,t.fg|=268435456,e===0&&(t.fg&=-268435457),t.updateExtended()}_processSGR0(e){e.fg=Tt.fg,e.bg=Tt.bg,e.extended=e.extended.clone(),e.extended.underlineStyle=0,e.extended.underlineColor&=-67108864,e.updateExtended()}charAttributes(e){if(e.length===1&&e.params[0]===0)return this._processSGR0(this._curAttrData),!0;let t=e.length,i,r=this._curAttrData;for(let l=0;l<t;l++)i=e.params[l],i>=30&&i<=37?(r.fg&=-50331904,r.fg|=16777216|i-30):i>=40&&i<=47?(r.bg&=-50331904,r.bg|=16777216|i-40):i>=90&&i<=97?(r.fg&=-50331904,r.fg|=16777216|i-90|8):i>=100&&i<=107?(r.bg&=-50331904,r.bg|=16777216|i-100|8):i===0?this._processSGR0(r):i===1?r.fg|=134217728:i===3?r.bg|=67108864:i===4?(r.fg|=268435456,this._processUnderline(e.hasSubParams(l)?e.getSubParams(l)[0]:1,r)):i===5?r.fg|=536870912:i===7?r.fg|=67108864:i===8?r.fg|=1073741824:i===9?r.fg|=2147483648:i===2?r.bg|=134217728:i===21?this._processUnderline(2,r):i===22?(r.fg&=-134217729,r.bg&=-134217729):i===23?r.bg&=-67108865:i===24?(r.fg&=-268435457,this._processUnderline(0,r)):i===25?r.fg&=-536870913:i===27?r.fg&=-67108865:i===28?r.fg&=-1073741825:i===29?r.fg&=2147483647:i===39?(r.fg&=-67108864,r.fg|=Tt.fg&16777215):i===49?(r.bg&=-67108864,r.bg|=Tt.bg&16777215):i===38||i===48||i===58?l+=this._extractColor(e,l,r):i===53?r.bg|=1073741824:i===55?r.bg&=-1073741825:i===59?(r.extended=r.extended.clone(),r.extended.underlineColor=-1,r.updateExtended()):i===100?(r.fg&=-67108864,r.fg|=Tt.fg&16777215,r.bg&=-67108864,r.bg|=Tt.bg&16777215):this._logService.debug("Unknown SGR attribute: %d.",i);return!0}deviceStatus(e){switch(e.params[0]){case 5:this._coreService.triggerDataEvent(`${ce.ESC}[0n`);break;case 6:let t=this._activeBuffer.y+1,i=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${ce.ESC}[${t};${i}R`);break}return!0}deviceStatusPrivate(e){if(e.params[0]===6){let t=this._activeBuffer.y+1,i=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${ce.ESC}[?${t};${i}R`)}return!0}softReset(e){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=Tt.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(e){let t=e.length===0?1:e.params[0];if(t===0)this._coreService.decPrivateModes.cursorStyle=void 0,this._coreService.decPrivateModes.cursorBlink=void 0;else{switch(t){case 1:case 2:this._coreService.decPrivateModes.cursorStyle="block";break;case 3:case 4:this._coreService.decPrivateModes.cursorStyle="underline";break;case 5:case 6:this._coreService.decPrivateModes.cursorStyle="bar";break}let i=t%2===1;this._coreService.decPrivateModes.cursorBlink=i}return!0}setScrollRegion(e){let t=e.params[0]||1,i;return(e.length<2||(i=e.params[1])>this._bufferService.rows||i===0)&&(i=this._bufferService.rows),i>t&&(this._activeBuffer.scrollTop=t-1,this._activeBuffer.scrollBottom=i-1,this._setCursor(0,0)),!0}windowOptions(e){if(!NS(e.params[0],this._optionsService.rawOptions.windowOptions))return!0;let t=e.length>1?e.params[1]:0;switch(e.params[0]){case 14:t!==2&&this._onRequestWindowsOptionsReport.fire(0);break;case 16:this._onRequestWindowsOptionsReport.fire(1);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${ce.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:(t===0||t===2)&&(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>kS&&this._windowTitleStack.shift()),(t===0||t===1)&&(this._iconNameStack.push(this._iconName),this._iconNameStack.length>kS&&this._iconNameStack.shift());break;case 23:(t===0||t===2)&&this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),(t===0||t===1)&&this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop());break}return!0}saveCursor(e){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(e){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(e){return this._windowTitle=e,this._onTitleChange.fire(e),!0}setIconName(e){return this._iconName=e,!0}setOrReportIndexedColor(e){let t=[],i=e.split(";");for(;i.length>1;){let r=i.shift(),l=i.shift();if(/^\d+$/.exec(r)){let c=parseInt(r);if(RS(c))if(l==="?")t.push({type:0,index:c});else{let u=jS(l);u&&t.push({type:1,index:c,color:u})}}}return t.length&&this._onColor.fire(t),!0}setHyperlink(e){let t=e.indexOf(";");if(t===-1)return!0;let i=e.slice(0,t).trim(),r=e.slice(t+1);return r?this._createHyperlink(i,r):i.trim()?!1:this._finishHyperlink()}_createHyperlink(e,t){this._getCurrentLinkId()&&this._finishHyperlink();let i=e.split(":"),r,l=i.findIndex(c=>c.startsWith("id="));return l!==-1&&(r=i[l].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:r,uri:t}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(e,t){let i=e.split(";");for(let r=0;r<i.length&&!(t>=this._specialColors.length);++r,++t)if(i[r]==="?")this._onColor.fire([{type:0,index:this._specialColors[t]}]);else{let l=jS(i[r]);l&&this._onColor.fire([{type:1,index:this._specialColors[t],color:l}])}return!0}setOrReportFgColor(e){return this._setOrReportSpecialColor(e,0)}setOrReportBgColor(e){return this._setOrReportSpecialColor(e,1)}setOrReportCursorColor(e){return this._setOrReportSpecialColor(e,2)}restoreIndexedColor(e){if(!e)return this._onColor.fire([{type:2}]),!0;let t=[],i=e.split(";");for(let r=0;r<i.length;++r)if(/^\d+$/.exec(i[r])){let l=parseInt(i[r]);RS(l)&&t.push({type:2,index:l})}return t.length&&this._onColor.fire(t),!0}restoreFgColor(e){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(e){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(e){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,hr),!0}selectCharset(e){return e.length!==2?(this.selectDefaultCharset(),!0):(e[0]==="/"||this._charsetService.setgCharset(eL[e[0]],Bt[e[1]]||hr),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){let e=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,e,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=Tt.clone(),this._eraseAttrDataInternal=Tt.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=this._curAttrData.bg&67108863,this._eraseAttrDataInternal}setgLevel(e){return this._charsetService.setgLevel(e),!0}screenAlignmentPattern(){let e=new ti;e.content=1<<22|69,e.fg=this._curAttrData.fg,e.bg=this._curAttrData.bg,this._setCursor(0,0);for(let t=0;t<this._bufferService.rows;++t){let i=this._activeBuffer.ybase+this._activeBuffer.y+t,r=this._activeBuffer.lines.get(i);r&&(r.fill(e),r.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(e,t){let i=u=>(this._coreService.triggerDataEvent(`${ce.ESC}${u}${ce.ESC}\\`),!0),r=this._bufferService.buffer,l=this._optionsService.rawOptions;return i(e==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:e==='"p'?'P1$r61;1"p':e==="r"?`P1$r${r.scrollTop+1};${r.scrollBottom+1}r`:e==="m"?"P1$r0m":e===" q"?`P1$r${{block:2,underline:4,bar:6}[l.cursorStyle]-(l.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(e,t){this._dirtyRowTracker.markRangeDirty(e,t)}},Bm=class{constructor(e){this._bufferService=e,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(e){e<this.start?this.start=e:e>this.end&&(this.end=e)}markRangeDirty(e,t){e>t&&(TS=e,e=t,t=TS),e<this.start&&(this.start=e),t>this.end&&(this.end=t)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};Bm=_t([_e(0,ln)],Bm);function RS(e){return 0<=e&&e<256}var nL=5e7,DS=12,iL=50,sL=class extends Be{constructor(e){super(),this._action=e,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this._register(new ge),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(e,t){if(t!==void 0&&this._syncCalls>t){this._syncCalls=0;return}if(this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;this._isSyncWriting=!0;let i;for(;i=this._writeBuffer.shift();){this._action(i);let r=this._callbacks.shift();r&&r()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(e,t){if(this._pendingData>nL)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput){this._didUserInput=!1,this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t),this._innerWrite();return}setTimeout(()=>this._innerWrite())}this._pendingData+=e.length,this._writeBuffer.push(e),this._callbacks.push(t)}_innerWrite(e=0,t=!0){let i=e||performance.now();for(;this._writeBuffer.length>this._bufferOffset;){let r=this._writeBuffer[this._bufferOffset],l=this._action(r,t);if(l){let u=d=>performance.now()-i>=DS?setTimeout(()=>this._innerWrite(0,d)):this._innerWrite(i,d);l.catch(d=>(queueMicrotask(()=>{throw d}),Promise.resolve(!1))).then(u);return}let c=this._callbacks[this._bufferOffset];if(c&&c(),this._bufferOffset++,this._pendingData-=r.length,performance.now()-i>=DS)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>iL&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}},Om=class{constructor(e){this._bufferService=e,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(e){let t=this._bufferService.buffer;if(e.id===void 0){let d=t.addMarker(t.ybase+t.y),m={data:e,id:this._nextId++,lines:[d]};return d.onDispose(()=>this._removeMarkerFromLink(m,d)),this._dataByLinkId.set(m.id,m),m.id}let i=e,r=this._getEntryIdKey(i),l=this._entriesWithId.get(r);if(l)return this.addLineToLink(l.id,t.ybase+t.y),l.id;let c=t.addMarker(t.ybase+t.y),u={id:this._nextId++,key:this._getEntryIdKey(i),data:i,lines:[c]};return c.onDispose(()=>this._removeMarkerFromLink(u,c)),this._entriesWithId.set(u.key,u),this._dataByLinkId.set(u.id,u),u.id}addLineToLink(e,t){let i=this._dataByLinkId.get(e);if(i&&i.lines.every(r=>r.line!==t)){let r=this._bufferService.buffer.addMarker(t);i.lines.push(r),r.onDispose(()=>this._removeMarkerFromLink(i,r))}}getLinkData(e){return this._dataByLinkId.get(e)?.data}_getEntryIdKey(e){return`${e.id};;${e.uri}`}_removeMarkerFromLink(e,t){let i=e.lines.indexOf(t);i!==-1&&(e.lines.splice(i,1),e.lines.length===0&&(e.data.id!==void 0&&this._entriesWithId.delete(e.key),this._dataByLinkId.delete(e.id)))}};Om=_t([_e(0,ln)],Om);var AS=!1,rL=class extends Be{constructor(e){super(),this._windowsWrappingHeuristics=this._register(new ba),this._onBinary=this._register(new ge),this.onBinary=this._onBinary.event,this._onData=this._register(new ge),this.onData=this._onData.event,this._onLineFeed=this._register(new ge),this.onLineFeed=this._onLineFeed.event,this._onResize=this._register(new ge),this.onResize=this._onResize.event,this._onWriteParsed=this._register(new ge),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this._register(new ge),this._instantiationService=new T4,this.optionsService=this._register(new H4(e)),this._instantiationService.setService(on,this.optionsService),this._bufferService=this._register(this._instantiationService.createInstance(Dm)),this._instantiationService.setService(ln,this._bufferService),this._logService=this._register(this._instantiationService.createInstance(Rm)),this._instantiationService.setService(X0,this._logService),this.coreService=this._register(this._instantiationService.createInstance(Am)),this._instantiationService.setService(yr,this.coreService),this.coreMouseService=this._register(this._instantiationService.createInstance(Lm)),this._instantiationService.setService(Y0,this.coreMouseService),this.unicodeService=this._register(this._instantiationService.createInstance(dr)),this._instantiationService.setService(jA,this.unicodeService),this._charsetService=this._instantiationService.createInstance(K4),this._instantiationService.setService(CA,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(Om),this._instantiationService.setService(J0,this._oscLinkService),this._inputHandler=this._register(new tL(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this._register(Xt.forward(this._inputHandler.onLineFeed,this._onLineFeed)),this._register(this._inputHandler),this._register(Xt.forward(this._bufferService.onResize,this._onResize)),this._register(Xt.forward(this.coreService.onData,this._onData)),this._register(Xt.forward(this.coreService.onBinary,this._onBinary)),this._register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom(!0))),this._register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this._register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this._register(this._bufferService.onScroll(()=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this._register(new sL((t,i)=>this._inputHandler.parse(t,i))),this._register(Xt.forward(this._writeBuffer.onWriteParsed,this._onWriteParsed))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this._register(new ge),this._onScroll.event(e=>{this._onScrollApi?.fire(e.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(e){for(let t in e)this.optionsService.options[t]=e[t]}write(e,t){this._writeBuffer.write(e,t)}writeSync(e,t){this._logService.logLevel<=3&&!AS&&(this._logService.warn("writeSync is unreliable and will be removed soon."),AS=!0),this._writeBuffer.writeSync(e,t)}input(e,t=!0){this.coreService.triggerDataEvent(e,t)}resize(e,t){isNaN(e)||isNaN(t)||(e=Math.max(e,T1),t=Math.max(t,R1),this._bufferService.resize(e,t))}scroll(e,t=!1){this._bufferService.scroll(e,t)}scrollLines(e,t){this._bufferService.scrollLines(e,t)}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(e){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(e){let t=e-this._bufferService.buffer.ydisp;t!==0&&this.scrollLines(t)}registerEscHandler(e,t){return this._inputHandler.registerEscHandler(e,t)}registerDcsHandler(e,t){return this._inputHandler.registerDcsHandler(e,t)}registerCsiHandler(e,t){return this._inputHandler.registerCsiHandler(e,t)}registerOscHandler(e,t){return this._inputHandler.registerOscHandler(e,t)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let e=!1,t=this.optionsService.rawOptions.windowsPty;t&&t.buildNumber!==void 0&&t.buildNumber!==void 0?e=t.backend==="conpty"&&t.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(e=!0),e?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){let e=[];e.push(this.onLineFeed(wS.bind(null,this._bufferService))),e.push(this.registerCsiHandler({final:"H"},()=>(wS(this._bufferService),!1))),this._windowsWrappingHeuristics.value=ht(()=>{for(let t of e)t.dispose()})}}},aL={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};function lL(e,t,i,r){let l={type:0,cancel:!1,key:void 0},c=(e.shiftKey?1:0)|(e.altKey?2:0)|(e.ctrlKey?4:0)|(e.metaKey?8:0);switch(e.keyCode){case 0:e.key==="UIKeyInputUpArrow"?t?l.key=ce.ESC+"OA":l.key=ce.ESC+"[A":e.key==="UIKeyInputLeftArrow"?t?l.key=ce.ESC+"OD":l.key=ce.ESC+"[D":e.key==="UIKeyInputRightArrow"?t?l.key=ce.ESC+"OC":l.key=ce.ESC+"[C":e.key==="UIKeyInputDownArrow"&&(t?l.key=ce.ESC+"OB":l.key=ce.ESC+"[B");break;case 8:l.key=e.ctrlKey?"\b":ce.DEL,e.altKey&&(l.key=ce.ESC+l.key);break;case 9:if(e.shiftKey){l.key=ce.ESC+"[Z";break}l.key=ce.HT,l.cancel=!0;break;case 13:l.key=e.altKey?ce.ESC+ce.CR:ce.CR,l.cancel=!0;break;case 27:l.key=ce.ESC,e.altKey&&(l.key=ce.ESC+ce.ESC),l.cancel=!0;break;case 37:if(e.metaKey)break;c?l.key=ce.ESC+"[1;"+(c+1)+"D":t?l.key=ce.ESC+"OD":l.key=ce.ESC+"[D";break;case 39:if(e.metaKey)break;c?l.key=ce.ESC+"[1;"+(c+1)+"C":t?l.key=ce.ESC+"OC":l.key=ce.ESC+"[C";break;case 38:if(e.metaKey)break;c?l.key=ce.ESC+"[1;"+(c+1)+"A":t?l.key=ce.ESC+"OA":l.key=ce.ESC+"[A";break;case 40:if(e.metaKey)break;c?l.key=ce.ESC+"[1;"+(c+1)+"B":t?l.key=ce.ESC+"OB":l.key=ce.ESC+"[B";break;case 45:!e.shiftKey&&!e.ctrlKey&&(l.key=ce.ESC+"[2~");break;case 46:c?l.key=ce.ESC+"[3;"+(c+1)+"~":l.key=ce.ESC+"[3~";break;case 36:c?l.key=ce.ESC+"[1;"+(c+1)+"H":t?l.key=ce.ESC+"OH":l.key=ce.ESC+"[H";break;case 35:c?l.key=ce.ESC+"[1;"+(c+1)+"F":t?l.key=ce.ESC+"OF":l.key=ce.ESC+"[F";break;case 33:e.shiftKey?l.type=2:e.ctrlKey?l.key=ce.ESC+"[5;"+(c+1)+"~":l.key=ce.ESC+"[5~";break;case 34:e.shiftKey?l.type=3:e.ctrlKey?l.key=ce.ESC+"[6;"+(c+1)+"~":l.key=ce.ESC+"[6~";break;case 112:c?l.key=ce.ESC+"[1;"+(c+1)+"P":l.key=ce.ESC+"OP";break;case 113:c?l.key=ce.ESC+"[1;"+(c+1)+"Q":l.key=ce.ESC+"OQ";break;case 114:c?l.key=ce.ESC+"[1;"+(c+1)+"R":l.key=ce.ESC+"OR";break;case 115:c?l.key=ce.ESC+"[1;"+(c+1)+"S":l.key=ce.ESC+"OS";break;case 116:c?l.key=ce.ESC+"[15;"+(c+1)+"~":l.key=ce.ESC+"[15~";break;case 117:c?l.key=ce.ESC+"[17;"+(c+1)+"~":l.key=ce.ESC+"[17~";break;case 118:c?l.key=ce.ESC+"[18;"+(c+1)+"~":l.key=ce.ESC+"[18~";break;case 119:c?l.key=ce.ESC+"[19;"+(c+1)+"~":l.key=ce.ESC+"[19~";break;case 120:c?l.key=ce.ESC+"[20;"+(c+1)+"~":l.key=ce.ESC+"[20~";break;case 121:c?l.key=ce.ESC+"[21;"+(c+1)+"~":l.key=ce.ESC+"[21~";break;case 122:c?l.key=ce.ESC+"[23;"+(c+1)+"~":l.key=ce.ESC+"[23~";break;case 123:c?l.key=ce.ESC+"[24;"+(c+1)+"~":l.key=ce.ESC+"[24~";break;default:if(e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey)e.keyCode>=65&&e.keyCode<=90?l.key=String.fromCharCode(e.keyCode-64):e.keyCode===32?l.key=ce.NUL:e.keyCode>=51&&e.keyCode<=55?l.key=String.fromCharCode(e.keyCode-51+27):e.keyCode===56?l.key=ce.DEL:e.keyCode===219?l.key=ce.ESC:e.keyCode===220?l.key=ce.FS:e.keyCode===221&&(l.key=ce.GS);else if((!i||r)&&e.altKey&&!e.metaKey){let u=aL[e.keyCode]?.[e.shiftKey?1:0];if(u)l.key=ce.ESC+u;else if(e.keyCode>=65&&e.keyCode<=90){let d=e.ctrlKey?e.keyCode-64:e.keyCode+32,m=String.fromCharCode(d);e.shiftKey&&(m=m.toUpperCase()),l.key=ce.ESC+m}else if(e.keyCode===32)l.key=ce.ESC+(e.ctrlKey?ce.NUL:" ");else if(e.key==="Dead"&&e.code.startsWith("Key")){let d=e.code.slice(3,4);e.shiftKey||(d=d.toLowerCase()),l.key=ce.ESC+d,l.cancel=!0}}else i&&!e.altKey&&!e.ctrlKey&&!e.shiftKey&&e.metaKey?e.keyCode===65&&(l.type=1):e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.keyCode>=48&&e.key.length===1?l.key=e.key:e.key&&e.ctrlKey&&(e.key==="_"&&(l.key=ce.US),e.key==="@"&&(l.key=ce.NUL));break}return l}var bt=0,oL=class{constructor(e){this._getKey=e,this._array=[],this._insertedValues=[],this._flushInsertedTask=new mu,this._isFlushingInserted=!1,this._deletedIndices=[],this._flushDeletedTask=new mu,this._isFlushingDeleted=!1}clear(){this._array.length=0,this._insertedValues.length=0,this._flushInsertedTask.clear(),this._isFlushingInserted=!1,this._deletedIndices.length=0,this._flushDeletedTask.clear(),this._isFlushingDeleted=!1}insert(e){this._flushCleanupDeleted(),this._insertedValues.length===0&&this._flushInsertedTask.enqueue(()=>this._flushInserted()),this._insertedValues.push(e)}_flushInserted(){let e=this._insertedValues.sort((l,c)=>this._getKey(l)-this._getKey(c)),t=0,i=0,r=new Array(this._array.length+this._insertedValues.length);for(let l=0;l<r.length;l++)i>=this._array.length||this._getKey(e[t])<=this._getKey(this._array[i])?(r[l]=e[t],t++):r[l]=this._array[i++];this._array=r,this._insertedValues.length=0}_flushCleanupInserted(){!this._isFlushingInserted&&this._insertedValues.length>0&&this._flushInsertedTask.flush()}delete(e){if(this._flushCleanupInserted(),this._array.length===0)return!1;let t=this._getKey(e);if(t===void 0||(bt=this._search(t),bt===-1)||this._getKey(this._array[bt])!==t)return!1;do if(this._array[bt]===e)return this._deletedIndices.length===0&&this._flushDeletedTask.enqueue(()=>this._flushDeleted()),this._deletedIndices.push(bt),!0;while(++bt<this._array.length&&this._getKey(this._array[bt])===t);return!1}_flushDeleted(){this._isFlushingDeleted=!0;let e=this._deletedIndices.sort((l,c)=>l-c),t=0,i=new Array(this._array.length-e.length),r=0;for(let l=0;l<this._array.length;l++)e[t]===l?t++:i[r++]=this._array[l];this._array=i,this._deletedIndices.length=0,this._isFlushingDeleted=!1}_flushCleanupDeleted(){!this._isFlushingDeleted&&this._deletedIndices.length>0&&this._flushDeletedTask.flush()}*getKeyIterator(e){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(bt=this._search(e),!(bt<0||bt>=this._array.length)&&this._getKey(this._array[bt])===e))do yield this._array[bt];while(++bt<this._array.length&&this._getKey(this._array[bt])===e)}forEachByKey(e,t){if(this._flushCleanupInserted(),this._flushCleanupDeleted(),this._array.length!==0&&(bt=this._search(e),!(bt<0||bt>=this._array.length)&&this._getKey(this._array[bt])===e))do t(this._array[bt]);while(++bt<this._array.length&&this._getKey(this._array[bt])===e)}values(){return this._flushCleanupInserted(),this._flushCleanupDeleted(),[...this._array].values()}_search(e){let t=0,i=this._array.length-1;for(;i>=t;){let r=t+i>>1,l=this._getKey(this._array[r]);if(l>e)i=r-1;else if(l<e)t=r+1;else{for(;r>0&&this._getKey(this._array[r-1])===e;)r--;return r}}return t}},Df=0,LS=0,cL=class extends Be{constructor(){super(),this._decorations=new oL(e=>e?.marker.line),this._onDecorationRegistered=this._register(new ge),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this._register(new ge),this.onDecorationRemoved=this._onDecorationRemoved.event,this._register(ht(()=>this.reset()))}get decorations(){return this._decorations.values()}registerDecoration(e){if(e.marker.isDisposed)return;let t=new uL(e);if(t){let i=t.marker.onDispose(()=>t.dispose()),r=t.onDispose(()=>{r.dispose(),t&&(this._decorations.delete(t)&&this._onDecorationRemoved.fire(t),i.dispose())});this._decorations.insert(t),this._onDecorationRegistered.fire(t)}return t}reset(){for(let e of this._decorations.values())e.dispose();this._decorations.clear()}*getDecorationsAtCell(e,t,i){let r=0,l=0;for(let c of this._decorations.getKeyIterator(t))r=c.options.x??0,l=r+(c.options.width??1),e>=r&&e<l&&(!i||(c.options.layer??"bottom")===i)&&(yield c)}forEachDecorationAtCell(e,t,i,r){this._decorations.forEachByKey(t,l=>{Df=l.options.x??0,LS=Df+(l.options.width??1),e>=Df&&e<LS&&(!i||(l.options.layer??"bottom")===i)&&r(l)})}},uL=class extends zs{constructor(e){super(),this.options=e,this.onRenderEmitter=this.add(new ge),this.onRender=this.onRenderEmitter.event,this._onDispose=this.add(new ge),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=e.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=mt.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=mt.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}},hL=1e3,dL=class{constructor(e,t=hL){this._renderCallback=e,this._debounceThresholdMS=t,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(e,t,i){this._rowCount=i,e=e!==void 0?e:0,t=t!==void 0?t:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,e):e,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,t):t;let r=performance.now();if(r-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=r,this._innerRefresh();else if(!this._additionalRefreshRequested){let l=r-this._lastRefreshMs,c=this._debounceThresholdMS-l;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=performance.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},c)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;let e=Math.max(this._rowStart,0),t=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(e,t)}},MS=20,pu=class extends Be{constructor(e,t,i,r){super(),this._terminal=e,this._coreBrowserService=i,this._renderService=r,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="";let l=this._coreBrowserService.mainDocument;this._accessibilityContainer=l.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=l.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let c=0;c<this._terminal.rows;c++)this._rowElements[c]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[c]);if(this._topBoundaryFocusListener=c=>this._handleBoundaryFocus(c,0),this._bottomBoundaryFocusListener=c=>this._handleBoundaryFocus(c,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=l.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this._register(new dL(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this._register(this._terminal.onResize(c=>this._handleResize(c.rows))),this._register(this._terminal.onRender(c=>this._refreshRows(c.start,c.end))),this._register(this._terminal.onScroll(()=>this._refreshRows())),this._register(this._terminal.onA11yChar(c=>this._handleChar(c))),this._register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this._register(this._terminal.onA11yTab(c=>this._handleTab(c))),this._register(this._terminal.onKey(c=>this._handleKey(c.key))),this._register(this._terminal.onBlur(()=>this._clearLiveRegion())),this._register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._register(Ne(l,"selectionchange",()=>this._handleSelectionChange())),this._register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRowsDimensions(),this._refreshRows(),this._register(ht(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(e){for(let t=0;t<e;t++)this._handleChar(" ")}_handleChar(e){this._liveRegionLineCount<MS+1&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==e&&(this._charsToAnnounce+=e):this._charsToAnnounce+=e,e===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===MS+1&&(this._liveRegion.textContent+=nm.get())))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(e){this._clearLiveRegion(),new RegExp("\\p{Control}","u").test(e)||this._charsToConsume.push(e)}_refreshRows(e,t){this._liveRegionDebouncer.refresh(e,t,this._terminal.rows)}_renderRows(e,t){let i=this._terminal.buffer,r=i.lines.length.toString();for(let l=e;l<=t;l++){let c=i.lines.get(i.ydisp+l),u=[],d=c?.translateToString(!0,void 0,void 0,u)||"",m=(i.ydisp+l+1).toString(),f=this._rowElements[l];f&&(d.length===0?(f.textContent="",this._rowColumns.set(f,[0,1])):(f.textContent=d,this._rowColumns.set(f,u)),f.setAttribute("aria-posinset",m),f.setAttribute("aria-setsize",r),this._alignRowWidth(f))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(e,t){let i=e.target,r=this._rowElements[t===0?1:this._rowElements.length-2],l=i.getAttribute("aria-posinset"),c=t===0?"1":`${this._terminal.buffer.lines.length}`;if(l===c||e.relatedTarget!==r)return;let u,d;if(t===0?(u=i,d=this._rowElements.pop(),this._rowContainer.removeChild(d)):(u=this._rowElements.shift(),d=i,this._rowContainer.removeChild(u)),u.removeEventListener("focus",this._topBoundaryFocusListener),d.removeEventListener("focus",this._bottomBoundaryFocusListener),t===0){let m=this._createAccessibilityTreeNode();this._rowElements.unshift(m),this._rowContainer.insertAdjacentElement("afterbegin",m)}else{let m=this._createAccessibilityTreeNode();this._rowElements.push(m),this._rowContainer.appendChild(m)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(t===0?-1:1),this._rowElements[t===0?1:this._rowElements.length-2].focus(),e.preventDefault(),e.stopImmediatePropagation()}_handleSelectionChange(){if(this._rowElements.length===0)return;let e=this._coreBrowserService.mainDocument.getSelection();if(!e)return;if(e.isCollapsed){this._rowContainer.contains(e.anchorNode)&&this._terminal.clearSelection();return}if(!e.anchorNode||!e.focusNode){console.error("anchorNode and/or focusNode are null");return}let t={node:e.anchorNode,offset:e.anchorOffset},i={node:e.focusNode,offset:e.focusOffset};if((t.node.compareDocumentPosition(i.node)&Node.DOCUMENT_POSITION_PRECEDING||t.node===i.node&&t.offset>i.offset)&&([t,i]=[i,t]),t.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(t={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(t.node))return;let r=this._rowElements.slice(-1)[0];if(i.node.compareDocumentPosition(r)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(i={node:r,offset:r.textContent?.length??0}),!this._rowContainer.contains(i.node))return;let l=({node:d,offset:m})=>{let f=d instanceof Text?d.parentNode:d,v=parseInt(f?.getAttribute("aria-posinset"),10)-1;if(isNaN(v))return console.warn("row is invalid. Race condition?"),null;let _=this._rowColumns.get(f);if(!_)return console.warn("columns is null. Race condition?"),null;let S=m<_.length?_[m]:_.slice(-1)[0]+1;return S>=this._terminal.cols&&(++v,S=0),{row:v,column:S}},c=l(t),u=l(i);if(!(!c||!u)){if(c.row>u.row||c.row===u.row&&c.column>=u.column)throw new Error("invalid range");this._terminal.select(c.column,c.row,(u.row-c.row)*this._terminal.cols-c.column+u.column)}}_handleResize(e){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let t=this._rowContainer.children.length;t<this._terminal.rows;t++)this._rowElements[t]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[t]);for(;this._rowElements.length>e;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){let e=this._coreBrowserService.mainDocument.createElement("div");return e.setAttribute("role","listitem"),e.tabIndex=-1,this._refreshRowDimensions(e),e}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){Object.assign(this._accessibilityContainer.style,{width:`${this._renderService.dimensions.css.canvas.width}px`,fontSize:`${this._terminal.options.fontSize}px`}),this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let e=0;e<this._terminal.rows;e++)this._refreshRowDimensions(this._rowElements[e]),this._alignRowWidth(this._rowElements[e])}}_refreshRowDimensions(e){e.style.height=`${this._renderService.dimensions.css.cell.height}px`}_alignRowWidth(e){e.style.transform="";let t=e.getBoundingClientRect().width,i=this._rowColumns.get(e)?.slice(-1)?.[0];if(!i)return;let r=i*this._renderService.dimensions.css.cell.width;e.style.transform=`scaleX(${r/t})`}};pu=_t([_e(1,fp),_e(2,ts),_e(3,ns)],pu);var zm=class extends Be{constructor(e,t,i,r,l){super(),this._element=e,this._mouseService=t,this._renderService=i,this._bufferService=r,this._linkProviderService=l,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this._register(new ge),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this._register(new ge),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this._register(ht(()=>{gr(this._linkCacheDisposables),this._linkCacheDisposables.length=0,this._lastMouseEvent=void 0,this._activeProviderReplies?.clear()})),this._register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this._register(Ne(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this._register(Ne(this._element,"mousemove",this._handleMouseMove.bind(this))),this._register(Ne(this._element,"mousedown",this._handleMouseDown.bind(this))),this._register(Ne(this._element,"mouseup",this._handleMouseUp.bind(this)))}get currentLink(){return this._currentLink}_handleMouseMove(e){this._lastMouseEvent=e;let t=this._positionFromMouseEvent(e,this._element,this._mouseService);if(!t)return;this._isMouseOut=!1;let i=e.composedPath();for(let r=0;r<i.length;r++){let l=i[r];if(l.classList.contains("xterm"))break;if(l.classList.contains("xterm-hover"))return}(!this._lastBufferCell||t.x!==this._lastBufferCell.x||t.y!==this._lastBufferCell.y)&&(this._handleHover(t),this._lastBufferCell=t)}_handleHover(e){if(this._activeLine!==e.y||this._wasResized){this._clearCurrentLink(),this._askForLink(e,!1),this._wasResized=!1;return}this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}_askForLink(e,t){(!this._activeProviderReplies||!t)&&(this._activeProviderReplies?.forEach(r=>{r?.forEach(l=>{l.link.dispose&&l.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=e.y);let i=!1;for(let[r,l]of this._linkProviderService.linkProviders.entries())t?this._activeProviderReplies?.get(r)&&(i=this._checkLinkProviderResult(r,e,i)):l.provideLinks(e.y,c=>{if(this._isMouseOut)return;let u=c?.map(d=>({link:d}));this._activeProviderReplies?.set(r,u),i=this._checkLinkProviderResult(r,e,i),this._activeProviderReplies?.size===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(e.y,this._activeProviderReplies)})}_removeIntersectingLinks(e,t){let i=new Set;for(let r=0;r<t.size;r++){let l=t.get(r);if(l)for(let c=0;c<l.length;c++){let u=l[c],d=u.link.range.start.y<e?0:u.link.range.start.x,m=u.link.range.end.y>e?this._bufferService.cols:u.link.range.end.x;for(let f=d;f<=m;f++){if(i.has(f)){l.splice(c--,1);break}i.add(f)}}}}_checkLinkProviderResult(e,t,i){if(!this._activeProviderReplies)return i;let r=this._activeProviderReplies.get(e),l=!1;for(let c=0;c<e;c++)(!this._activeProviderReplies.has(c)||this._activeProviderReplies.get(c))&&(l=!0);if(!l&&r){let c=r.find(u=>this._linkAtPosition(u.link,t));c&&(i=!0,this._handleNewLink(c))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!i)for(let c=0;c<this._activeProviderReplies.size;c++){let u=this._activeProviderReplies.get(c)?.find(d=>this._linkAtPosition(d.link,t));if(u){i=!0,this._handleNewLink(u);break}}return i}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(e){if(!this._currentLink)return;let t=this._positionFromMouseEvent(e,this._element,this._mouseService);t&&this._mouseDownLink&&fL(this._mouseDownLink.link,this._currentLink.link)&&this._linkAtPosition(this._currentLink.link,t)&&this._currentLink.link.activate(e,this._currentLink.link.text)}_clearCurrentLink(e,t){!this._currentLink||!this._lastMouseEvent||(!e||!t||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=t)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,gr(this._linkCacheDisposables),this._linkCacheDisposables.length=0)}_handleNewLink(e){if(!this._lastMouseEvent)return;let t=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);t&&this._linkAtPosition(e.link,t)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:e.link.decorations===void 0?!0:e.link.decorations.underline,pointerCursor:e.link.decorations===void 0?!0:e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:()=>this._currentLink?.state?.decorations.pointerCursor,set:i=>{this._currentLink?.state&&this._currentLink.state.decorations.pointerCursor!==i&&(this._currentLink.state.decorations.pointerCursor=i,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",i))}},underline:{get:()=>this._currentLink?.state?.decorations.underline,set:i=>{this._currentLink?.state&&this._currentLink?.state?.decorations.underline!==i&&(this._currentLink.state.decorations.underline=i,this._currentLink.state.isHovered&&this._fireUnderlineEvent(e.link,i))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(i=>{if(!this._currentLink)return;let r=i.start===0?0:i.start+1+this._bufferService.buffer.ydisp,l=this._bufferService.buffer.ydisp+1+i.end;if(this._currentLink.link.range.start.y>=r&&this._currentLink.link.range.end.y<=l&&(this._clearCurrentLink(r,l),this._lastMouseEvent)){let c=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);c&&this._askForLink(c,!1)}})))}_linkHover(e,t,i){this._currentLink?.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),t.hover&&t.hover(i,t.text)}_fireUnderlineEvent(e,t){let i=e.range,r=this._bufferService.buffer.ydisp,l=this._createLinkUnderlineEvent(i.start.x-1,i.start.y-r-1,i.end.x,i.end.y-r-1,void 0);(t?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(l)}_linkLeave(e,t,i){this._currentLink?.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(t,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),t.leave&&t.leave(i,t.text)}_linkAtPosition(e,t){let i=e.range.start.y*this._bufferService.cols+e.range.start.x,r=e.range.end.y*this._bufferService.cols+e.range.end.x,l=t.y*this._bufferService.cols+t.x;return i<=l&&l<=r}_positionFromMouseEvent(e,t,i){let r=i.getCoords(e,t,this._bufferService.cols,this._bufferService.rows);if(r)return{x:r[0],y:r[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(e,t,i,r,l){return{x1:e,y1:t,x2:i,y2:r,cols:this._bufferService.cols,fg:l}}};zm=_t([_e(1,mp),_e(2,ns),_e(3,ln),_e(4,Q0)],zm);function fL(e,t){return e.text===t.text&&e.range.start.x===t.range.start.x&&e.range.start.y===t.range.start.y&&e.range.end.x===t.range.end.x&&e.range.end.y===t.range.end.y}var mL=class extends rL{constructor(e={}){super(e),this._linkifier=this._register(new ba),this.browser=_1,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this._register(new ba),this._onCursorMove=this._register(new ge),this.onCursorMove=this._onCursorMove.event,this._onKey=this._register(new ge),this.onKey=this._onKey.event,this._onRender=this._register(new ge),this.onRender=this._onRender.event,this._onSelectionChange=this._register(new ge),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this._register(new ge),this.onTitleChange=this._onTitleChange.event,this._onBell=this._register(new ge),this.onBell=this._onBell.event,this._onFocus=this._register(new ge),this._onBlur=this._register(new ge),this._onA11yCharEmitter=this._register(new ge),this._onA11yTabEmitter=this._register(new ge),this._onWillOpen=this._register(new ge),this._setup(),this._decorationService=this._instantiationService.createInstance(cL),this._instantiationService.setService(po,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(i4),this._instantiationService.setService(Q0,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(sm)),this._register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this._register(this._inputHandler.onRequestRefreshRows(t=>this.refresh(t?.start??0,t?.end??this.rows-1))),this._register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this._register(this._inputHandler.onRequestReset(()=>this.reset())),this._register(this._inputHandler.onRequestWindowsOptionsReport(t=>this._reportWindowsOptions(t))),this._register(this._inputHandler.onColor(t=>this._handleColorEvent(t))),this._register(Xt.forward(this._inputHandler.onCursorMove,this._onCursorMove)),this._register(Xt.forward(this._inputHandler.onTitleChange,this._onTitleChange)),this._register(Xt.forward(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this._register(Xt.forward(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this._register(this._bufferService.onResize(t=>this._afterResize(t.cols,t.rows))),this._register(ht(()=>{this._customKeyEventHandler=void 0,this.element?.parentNode?.removeChild(this.element)}))}get linkifier(){return this._linkifier.value}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(e){if(this._themeService)for(let t of e){let i,r="";switch(t.index){case 256:i="foreground",r="10";break;case 257:i="background",r="11";break;case 258:i="cursor",r="12";break;default:i="ansi",r="4;"+t.index}switch(t.type){case 0:let l=ot.toColorRGB(i==="ansi"?this._themeService.colors.ansi[t.index]:this._themeService.colors[i]);this.coreService.triggerDataEvent(`${ce.ESC}]${r};${Q4(l)}${g1.ST}`);break;case 1:if(i==="ansi")this._themeService.modifyColors(c=>c.ansi[t.index]=Rt.toColor(...t.color));else{let c=i;this._themeService.modifyColors(u=>u[c]=Rt.toColor(...t.color))}break;case 2:this._themeService.restoreColor(t.index);break}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(e){e?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(pu,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(e){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(ce.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){return this.textarea?.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(ce.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;let e=this.buffer.ybase+this.buffer.y,t=this.buffer.lines.get(e);if(!t)return;let i=Math.min(this.buffer.x,this.cols-1),r=this._renderService.dimensions.css.cell.height,l=t.getWidth(i),c=this._renderService.dimensions.css.cell.width*l,u=this.buffer.y*this._renderService.dimensions.css.cell.height,d=i*this._renderService.dimensions.css.cell.width;this.textarea.style.left=d+"px",this.textarea.style.top=u+"px",this.textarea.style.width=c+"px",this.textarea.style.height=r+"px",this.textarea.style.lineHeight=r+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this._register(Ne(this.element,"copy",t=>{this.hasSelection()&&_A(t,this._selectionService)}));let e=t=>yA(t,this.textarea,this.coreService,this.optionsService);this._register(Ne(this.textarea,"paste",e)),this._register(Ne(this.element,"paste",e)),y1?this._register(Ne(this.element,"mousedown",t=>{t.button===2&&Kx(t,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this._register(Ne(this.element,"contextmenu",t=>{Kx(t,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),bp&&this._register(Ne(this.element,"auxclick",t=>{t.button===1&&K0(t,this.textarea,this.screenElement)}))}_bindKeys(){this._register(Ne(this.textarea,"keyup",e=>this._keyUp(e),!0)),this._register(Ne(this.textarea,"keydown",e=>this._keyDown(e),!0)),this._register(Ne(this.textarea,"keypress",e=>this._keyPress(e),!0)),this._register(Ne(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this._register(Ne(this.textarea,"compositionupdate",e=>this._compositionHelper.compositionupdate(e))),this._register(Ne(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this._register(Ne(this.textarea,"input",e=>this._inputEvent(e),!0)),this._register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(e){if(!e)throw new Error("Terminal requires a parent element.");if(e.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this.element?.ownerDocument.defaultView&&this._coreBrowserService){this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView);return}this._document=e.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),e.appendChild(this.element);let t=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),t.appendChild(this._viewportElement),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._register(Ne(this.screenElement,"mousemove",l=>this.updateCursorStyle(l))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),t.appendChild(this.screenElement);let i=this.textarea=this._document.createElement("textarea");this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",tm.get()),b1||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._register(this.optionsService.onSpecificOptionChange("disableStdin",()=>i.readOnly=this.optionsService.rawOptions.disableStdin)),this.textarea.readOnly=this.optionsService.rawOptions.disableStdin,this._coreBrowserService=this._register(this._instantiationService.createInstance(t4,this.textarea,e.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(ts,this._coreBrowserService),this._register(Ne(this.textarea,"focus",l=>this._handleTextAreaFocus(l))),this._register(Ne(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(jm,this._document,this._helperContainer),this._instantiationService.setService(Tu,this._charSizeService),this._themeService=this._instantiationService.createInstance(Tm),this._instantiationService.setService(Ra,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(du),this._instantiationService.setService(Z0,this._characterJoinerService),this._renderService=this._register(this._instantiationService.createInstance(Nm,this.rows,this.screenElement)),this._instantiationService.setService(ns,this._renderService),this._register(this._renderService.onRenderedViewportChange(l=>this._onRender.fire(l))),this.onResize(l=>this._renderService.resize(l.cols,l.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(bm,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(km),this._instantiationService.setService(mp,this._mouseService);let r=this._linkifier.value=this._register(this._instantiationService.createInstance(zm,this.screenElement));this.element.appendChild(t);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this._register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this._register(this.onBlur(()=>this._renderService.handleBlur())),this._register(this.onFocus(()=>this._renderService.handleFocus())),this._viewport=this._register(this._instantiationService.createInstance(xm,this.element,this.screenElement)),this._register(this._viewport.onRequestScrollLines(l=>{super.scrollLines(l,!1),this.refresh(0,this.rows-1)})),this._selectionService=this._register(this._instantiationService.createInstance(Em,this.element,this.screenElement,r)),this._instantiationService.setService(NA,this._selectionService),this._register(this._selectionService.onRequestScrollLines(l=>this.scrollLines(l.amount,l.suppressScrollEvent))),this._register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this._register(this._selectionService.onRequestRedraw(l=>this._renderService.handleSelectionChanged(l.start,l.end,l.columnSelectMode))),this._register(this._selectionService.onLinuxMouseSelection(l=>{this.textarea.value=l,this.textarea.focus(),this.textarea.select()})),this._register(Xt.any(this._onScroll.event,this._inputHandler.onScroll)(()=>{this._selectionService.refresh(),this._viewport?.queueSync()})),this._register(this._instantiationService.createInstance(Sm,this.screenElement)),this._register(Ne(this.element,"mousedown",l=>this._selectionService.handleMouseDown(l))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(pu,this)),this._register(this.optionsService.onSpecificOptionChange("screenReaderMode",l=>this._handleScreenReaderModeOptionChange(l))),this.options.overviewRuler.width&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(hu,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRuler",l=>{!this._overviewRulerRenderer&&l&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this._register(this._instantiationService.createInstance(hu,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(Cm,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){let e=this,t=this.element;function i(c){let u=e._mouseService.getMouseReportCoords(c,e.screenElement);if(!u)return!1;let d,m;switch(c.overrideType||c.type){case"mousemove":m=32,c.buttons===void 0?(d=3,c.button!==void 0&&(d=c.button<3?c.button:3)):d=c.buttons&1?0:c.buttons&4?1:c.buttons&2?2:3;break;case"mouseup":m=0,d=c.button<3?c.button:3;break;case"mousedown":m=1,d=c.button<3?c.button:3;break;case"wheel":if(e._customWheelEventHandler&&e._customWheelEventHandler(c)===!1)return!1;let f=c.deltaY;if(f===0||e.coreMouseService.consumeWheelEvent(c,e._renderService?.dimensions?.device?.cell?.height,e._coreBrowserService?.dpr)===0)return!1;m=f<0?0:1,d=4;break;default:return!1}return m===void 0||d===void 0||d>4?!1:e.coreMouseService.triggerMouseEvent({col:u.col,row:u.row,x:u.x,y:u.y,button:d,action:m,ctrl:c.ctrlKey,alt:c.altKey,shift:c.shiftKey})}let r={mouseup:null,wheel:null,mousedrag:null,mousemove:null},l={mouseup:c=>(i(c),c.buttons||(this._document.removeEventListener("mouseup",r.mouseup),r.mousedrag&&this._document.removeEventListener("mousemove",r.mousedrag)),this.cancel(c)),wheel:c=>(i(c),this.cancel(c,!0)),mousedrag:c=>{c.buttons&&i(c)},mousemove:c=>{c.buttons||i(c)}};this._register(this.coreMouseService.onProtocolChange(c=>{c?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(c)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),c&8?r.mousemove||(t.addEventListener("mousemove",l.mousemove),r.mousemove=l.mousemove):(t.removeEventListener("mousemove",r.mousemove),r.mousemove=null),c&16?r.wheel||(t.addEventListener("wheel",l.wheel,{passive:!1}),r.wheel=l.wheel):(t.removeEventListener("wheel",r.wheel),r.wheel=null),c&2?r.mouseup||(r.mouseup=l.mouseup):(this._document.removeEventListener("mouseup",r.mouseup),r.mouseup=null),c&4?r.mousedrag||(r.mousedrag=l.mousedrag):(this._document.removeEventListener("mousemove",r.mousedrag),r.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this._register(Ne(t,"mousedown",c=>{if(c.preventDefault(),this.focus(),!(!this.coreMouseService.areMouseEventsActive||this._selectionService.shouldForceSelection(c)))return i(c),r.mouseup&&this._document.addEventListener("mouseup",r.mouseup),r.mousedrag&&this._document.addEventListener("mousemove",r.mousedrag),this.cancel(c)})),this._register(Ne(t,"wheel",c=>{if(!r.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(c)===!1)return!1;if(!this.buffer.hasScrollback){if(c.deltaY===0)return!1;if(e.coreMouseService.consumeWheelEvent(c,e._renderService?.dimensions?.device?.cell?.height,e._coreBrowserService?.dpr)===0)return this.cancel(c,!0);let u=ce.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(c.deltaY<0?"A":"B");return this.coreService.triggerDataEvent(u,!0),this.cancel(c,!0)}}},{passive:!1}))}refresh(e,t){this._renderService?.refreshRows(e,t)}updateCursorStyle(e){this._selectionService?.shouldColumnSelect(e)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(e,t){this._viewport?this._viewport.scrollLines(e):super.scrollLines(e,t),this.refresh(0,this.rows-1)}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(e){e&&this._viewport?this._viewport.scrollToLine(this.buffer.ybase,!0):this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(e){let t=e-this._bufferService.buffer.ydisp;t!==0&&this.scrollLines(t)}paste(e){$0(e,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(e){this._customKeyEventHandler=e}attachCustomWheelEventHandler(e){this._customWheelEventHandler=e}registerLinkProvider(e){return this._linkProviderService.registerLinkProvider(e)}registerCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");let t=this._characterJoinerService.register(e);return this.refresh(0,this.rows-1),t}deregisterCharacterJoiner(e){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(e)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(e){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+e)}registerDecoration(e){return this._decorationService.registerDecoration(e)}hasSelection(){return this._selectionService?this._selectionService.hasSelection:!1}select(e,t,i){this._selectionService.setSelection(e,t,i)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(!(!this._selectionService||!this._selectionService.hasSelection))return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){this._selectionService?.clearSelection()}selectAll(){this._selectionService?.selectAll()}selectLines(e,t){this._selectionService?.selectLines(e,t)}_keyDown(e){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)return!1;let t=this.browser.isMac&&this.options.macOptionIsMeta&&e.altKey;if(!t&&!this._compositionHelper.keydown(e))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(!0),!1;!t&&(e.key==="Dead"||e.key==="AltGraph")&&(this._unprocessedDeadKey=!0);let i=lL(e,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(e),i.type===3||i.type===2){let r=this.rows-1;return this.scrollLines(i.type===2?-r:r),this.cancel(e,!0)}if(i.type===1&&this.selectAll(),this._isThirdLevelShift(this.browser,e)||(i.cancel&&this.cancel(e,!0),!i.key)||e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey&&e.key.length===1&&e.key.charCodeAt(0)>=65&&e.key.charCodeAt(0)<=90)return!0;if(this._unprocessedDeadKey)return this._unprocessedDeadKey=!1,!0;if((i.key===ce.ETX||i.key===ce.CR)&&(this.textarea.value=""),this._onKey.fire({key:i.key,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(i.key,!0),!this.optionsService.rawOptions.screenReaderMode||e.altKey||e.ctrlKey)return this.cancel(e,!0);this._keyDownHandled=!0}_isThirdLevelShift(e,t){let i=e.isMac&&!this.options.macOptionIsMeta&&t.altKey&&!t.ctrlKey&&!t.metaKey||e.isWindows&&t.altKey&&t.ctrlKey&&!t.metaKey||e.isWindows&&t.getModifierState("AltGraph");return t.type==="keypress"?i:i&&(!t.keyCode||t.keyCode>47)}_keyUp(e){this._keyDownSeen=!1,!(this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)&&(pL(e)||this.focus(),this.updateCursorStyle(e),this._keyPressHandled=!1)}_keyPress(e){let t;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(e)===!1)return!1;if(this.cancel(e),e.charCode)t=e.charCode;else if(e.which===null||e.which===void 0)t=e.keyCode;else if(e.which!==0&&e.charCode!==0)t=e.which;else return!1;return!t||(e.altKey||e.ctrlKey||e.metaKey)&&!this._isThirdLevelShift(this.browser,e)?!1:(t=String.fromCharCode(t),this._onKey.fire({key:t,domEvent:e}),this._showCursor(),this.coreService.triggerDataEvent(t,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,!0)}_inputEvent(e){if(e.data&&e.inputType==="insertText"&&(!e.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;let t=e.data;return this.coreService.triggerDataEvent(t,!0),this.cancel(e),!0}return!1}resize(e,t){if(e===this.cols&&t===this.rows){this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure();return}super.resize(e,t)}_afterResize(e,t){this._charSizeService?.measure()}clear(){if(!(this.buffer.ybase===0&&this.buffer.y===0)){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let e=1;e<this.rows;e++)this.buffer.lines.push(this.buffer.getBlankLine(Tt));this._onScroll.fire({position:this.buffer.ydisp}),this.refresh(0,this.rows-1)}}reset(){this.options.rows=this.rows,this.options.cols=this.cols;let e=this._customKeyEventHandler;this._setup(),super.reset(),this._selectionService?.reset(),this._decorationService.reset(),this._customKeyEventHandler=e,this.refresh(0,this.rows-1)}clearTextureAtlas(){this._renderService?.clearTextureAtlas()}_reportFocus(){this.element?.classList.contains("focus")?this.coreService.triggerDataEvent(ce.ESC+"[I"):this.coreService.triggerDataEvent(ce.ESC+"[O")}_reportWindowsOptions(e){if(this._renderService)switch(e){case 0:let t=this._renderService.dimensions.css.canvas.width.toFixed(0),i=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${ce.ESC}[4;${i};${t}t`);break;case 1:let r=this._renderService.dimensions.css.cell.width.toFixed(0),l=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${ce.ESC}[6;${l};${r}t`);break}}cancel(e,t){if(!(!this.options.cancelEvents&&!t))return e.preventDefault(),e.stopPropagation(),!1}};function pL(e){return e.keyCode===16||e.keyCode===17||e.keyCode===18}var gL=class{constructor(){this._addons=[]}dispose(){for(let e=this._addons.length-1;e>=0;e--)this._addons[e].instance.dispose()}loadAddon(e,t){let i={instance:t,dispose:t.dispose,isDisposed:!1};this._addons.push(i),t.dispose=()=>this._wrappedAddonDispose(i),t.activate(e)}_wrappedAddonDispose(e){if(e.isDisposed)return;let t=-1;for(let i=0;i<this._addons.length;i++)if(this._addons[i]===e){t=i;break}if(t===-1)throw new Error("Could not dispose an addon that has not been loaded");e.isDisposed=!0,e.dispose.apply(e.instance),this._addons.splice(t,1)}},vL=class{constructor(e){this._line=e}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(e,t){if(!(e<0||e>=this._line.length))return t?(this._line.loadCell(e,t),t):this._line.loadCell(e,new ti)}translateToString(e,t,i){return this._line.translateToString(e,t,i)}},BS=class{constructor(e,t){this._buffer=e,this.type=t}init(e){return this._buffer=e,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(e){let t=this._buffer.lines.get(e);if(t)return new vL(t)}getNullCell(){return new ti}},_L=class extends Be{constructor(e){super(),this._core=e,this._onBufferChange=this._register(new ge),this.onBufferChange=this._onBufferChange.event,this._normal=new BS(this._core.buffers.normal,"normal"),this._alternate=new BS(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}},yL=class{constructor(e){this._core=e}registerCsiHandler(e,t){return this._core.registerCsiHandler(e,i=>t(i.toArray()))}addCsiHandler(e,t){return this.registerCsiHandler(e,t)}registerDcsHandler(e,t){return this._core.registerDcsHandler(e,(i,r)=>t(i,r.toArray()))}addDcsHandler(e,t){return this.registerDcsHandler(e,t)}registerEscHandler(e,t){return this._core.registerEscHandler(e,t)}addEscHandler(e,t){return this.registerEscHandler(e,t)}registerOscHandler(e,t){return this._core.registerOscHandler(e,t)}addOscHandler(e,t){return this.registerOscHandler(e,t)}},xL=class{constructor(e){this._core=e}register(e){this._core.unicodeService.register(e)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(e){this._core.unicodeService.activeVersion=e}},SL=["cols","rows"],yi=0,wp=class extends Be{constructor(e){super(),this._core=this._register(new mL(e)),this._addonManager=this._register(new gL),this._publicOptions={...this._core.options};let t=r=>this._core.options[r],i=(r,l)=>{this._checkReadonlyOptions(r),this._core.options[r]=l};for(let r in this._core.options){let l={get:t.bind(this,r),set:i.bind(this,r)};Object.defineProperty(this._publicOptions,r,l)}}_checkReadonlyOptions(e){if(SL.includes(e))throw new Error(`Option "${e}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new yL(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new xL(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this._register(new _L(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){let e=this._core.coreService.decPrivateModes,t="none";switch(this._core.coreMouseService.activeProtocol){case"X10":t="x10";break;case"VT200":t="vt200";break;case"DRAG":t="drag";break;case"ANY":t="any";break}return{applicationCursorKeysMode:e.applicationCursorKeys,applicationKeypadMode:e.applicationKeypad,bracketedPasteMode:e.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:t,originMode:e.origin,reverseWraparoundMode:e.reverseWraparound,sendFocusMode:e.sendFocus,synchronizedOutputMode:e.synchronizedOutput,wraparoundMode:e.wraparound}}get options(){return this._publicOptions}set options(e){for(let t in e)this._publicOptions[t]=e[t]}blur(){this._core.blur()}focus(){this._core.focus()}input(e,t=!0){this._core.input(e,t)}resize(e,t){this._verifyIntegers(e,t),this._core.resize(e,t)}open(e){this._core.open(e)}attachCustomKeyEventHandler(e){this._core.attachCustomKeyEventHandler(e)}attachCustomWheelEventHandler(e){this._core.attachCustomWheelEventHandler(e)}registerLinkProvider(e){return this._core.registerLinkProvider(e)}registerCharacterJoiner(e){return this._checkProposedApi(),this._core.registerCharacterJoiner(e)}deregisterCharacterJoiner(e){this._checkProposedApi(),this._core.deregisterCharacterJoiner(e)}registerMarker(e=0){return this._verifyIntegers(e),this._core.registerMarker(e)}registerDecoration(e){return this._checkProposedApi(),this._verifyPositiveIntegers(e.x??0,e.width??0,e.height??0),this._core.registerDecoration(e)}hasSelection(){return this._core.hasSelection()}select(e,t,i){this._verifyIntegers(e,t,i),this._core.select(e,t,i)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(e,t){this._verifyIntegers(e,t),this._core.selectLines(e,t)}dispose(){super.dispose()}scrollLines(e){this._verifyIntegers(e),this._core.scrollLines(e)}scrollPages(e){this._verifyIntegers(e),this._core.scrollPages(e)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(e){this._verifyIntegers(e),this._core.scrollToLine(e)}clear(){this._core.clear()}write(e,t){this._core.write(e,t)}writeln(e,t){this._core.write(e),this._core.write(`\r
`,t)}paste(e){this._core.paste(e)}refresh(e,t){this._verifyIntegers(e,t),this._core.refresh(e,t)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(e){this._addonManager.loadAddon(this,e)}static get strings(){return{get promptLabel(){return tm.get()},set promptLabel(e){tm.set(e)},get tooMuchOutput(){return nm.get()},set tooMuchOutput(e){nm.set(e)}}}_verifyIntegers(...e){for(yi of e)if(yi===1/0||isNaN(yi)||yi%1!==0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...e){for(yi of e)if(yi&&(yi===1/0||isNaN(yi)||yi%1!==0||yi<0))throw new Error("This API only accepts positive integers")}};var bL=2,wL=1,Cp=class{activate(e){this._terminal=e}dispose(){}fit(){let e=this.proposeDimensions();if(!e||!this._terminal||isNaN(e.cols)||isNaN(e.rows))return;let t=this._terminal._core;(this._terminal.rows!==e.rows||this._terminal.cols!==e.cols)&&(t._renderService.clear(),this._terminal.resize(e.cols,e.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;let e=this._terminal._core._renderService.dimensions;if(e.css.cell.width===0||e.css.cell.height===0)return;let t=this._terminal.options.scrollback===0?0:this._terminal.options.overviewRuler?.width||14,i=window.getComputedStyle(this._terminal.element.parentElement),r=parseInt(i.getPropertyValue("height")),l=Math.max(0,parseInt(i.getPropertyValue("width"))),c=window.getComputedStyle(this._terminal.element),u={top:parseInt(c.getPropertyValue("padding-top")),bottom:parseInt(c.getPropertyValue("padding-bottom")),right:parseInt(c.getPropertyValue("padding-right")),left:parseInt(c.getPropertyValue("padding-left"))},d=u.top+u.bottom,m=u.right+u.left,f=r-d,v=l-m-t;return{cols:Math.max(bL,Math.floor(v/e.css.cell.width)),rows:Math.max(wL,Math.floor(f/e.css.cell.height))}}};function rt(e){const t=y.useRef(e);return y.useEffect(()=>{t.current=e},[e]),t}const CL={background:"#1e1e1e",foreground:"#d4d4d4",cursor:"#d4d4d4",cursorAccent:"#1e1e1e",selectionBackground:"#264f78",black:"#000000",red:"#cd3131",green:"#0dbc79",yellow:"#e5e510",blue:"#2472c8",magenta:"#bc3fbc",cyan:"#11a8cd",white:"#e5e5e5",brightBlack:"#666666",brightRed:"#f14c4c",brightGreen:"#23d18b",brightYellow:"#f5f543",brightBlue:"#3b8eea",brightMagenta:"#d670d6",brightCyan:"#29b8db",brightWhite:"#ffffff"};function A1(e,t={}){const[i,r]=y.useState(!1),l=y.useRef(null),c=y.useRef(null),u=y.useRef(null),d=y.useRef(null),m=y.useRef(null),f=y.useRef(!1),v=rt(t),_=y.useRef(null);return _.current=()=>{if(m.current?.(),m.current=null,!l.current)return;let T=!1,k=!1;const{theme:R=CL,fontSize:N=14,fontFamily:E='Monaco, Menlo, "Ubuntu Mono", Consolas, monospace',cwd:z,name:B,initialCommand:I,sessionId:q}=v.current,F=new wp({cursorBlink:!0,fontSize:N,fontFamily:E,theme:R,allowProposedApi:!0,scrollback:1e4}),V=new Cp;F.loadAddon(V),F.open(l.current),V.fit(),c.current=F,u.current=V;const G=l.current.querySelector(".xterm-viewport");let Y=0,M=0,j=!1;const A=de=>{de.touches.length===1&&(Y=de.touches[0].clientY,M=G?.scrollTop??0,j=!1)},D=de=>{if(de.touches.length!==1||!G)return;const oe=Y-de.touches[0].clientY;!j&&Math.abs(oe)>5&&(j=!0),j&&(G.scrollTop=M+oe)},$=()=>{j=!1};G&&(G.addEventListener("touchstart",A,{passive:!0}),G.addEventListener("touchmove",D,{passive:!0}),G.addEventListener("touchend",$,{passive:!0}));const W=window.location.protocol==="https:"?"wss:":"ws:",ne=new URLSearchParams;q&&ne.set("session_id",q),z&&ne.set("cwd",z),B&&ne.set("name",B);const U=ne.toString(),P=`${W}//${window.location.host}/api/terminal${U?"?"+U:""}`,H=new WebSocket(P);H.binaryType="arraybuffer",d.current=H;const L=!!q,re=()=>{if(H.readyState!==WebSocket.OPEN)return;const de=V.proposeDimensions();de&&H.send(JSON.stringify({type:"resize",cols:de.cols,rows:de.rows}))};H.onopen=()=>{T||(r(!0),setTimeout(()=>{T||(V.fit(),re(),!L&&I&&setTimeout(()=>{T||H.send(I+`
`)},300))},100))},H.onmessage=de=>{if(!T)if(de.data instanceof ArrayBuffer)F.write(new TextDecoder().decode(de.data));else{const oe=de.data;try{const ye=JSON.parse(oe);if(ye.type==="session_id"&&ye.session_id){v.current.onSessionId?.(ye.session_id);return}}catch{}F.write(oe)}},H.onerror=()=>{T||(F.writeln(`\r
\x1B[31mConnection error\x1B[0m`),r(!1))},H.onclose=()=>{if(T)return;F.writeln(`\r
\x1B[33mConnection closed\x1B[0m`),F.writeln("\x1B[90m[Press any key to close]\x1B[0m"),r(!1);const de=F.onKey(()=>{de.dispose(),v.current.onCloseRequest?.()})},F.onData(de=>{if(H.readyState===WebSocket.OPEN){if(k=!0,f.current&&de.length===1){f.current=!1,v.current.onCtrlModeConsumed?.();const oe=de.charCodeAt(0);if(oe>=97&&oe<=122){H.send(String.fromCharCode(oe-96));return}if(oe>=65&&oe<=90){H.send(String.fromCharCode(oe-64));return}}H.send(de)}});const me=()=>{u.current?.fit(),re()};window.addEventListener("resize",me);let he=null;l.current&&(he=new IntersectionObserver(de=>{de[0]?.isIntersecting&&H.readyState===WebSocket.OPEN&&setTimeout(()=>{T||(V.fit(),re())},50)},{threshold:.1}),he.observe(l.current)),F.focus(),m.current=()=>{T=!0,window.removeEventListener("resize",me),he?.disconnect(),G&&(G.removeEventListener("touchstart",A),G.removeEventListener("touchmove",D),G.removeEventListener("touchend",$));const de=!q&&!k;H.readyState===WebSocket.OPEN?H.close(de?4e3:1e3):H.readyState===WebSocket.CONNECTING&&(H.onopen=()=>{H.close(de?4e3:1e3)},H.onerror=()=>{H.close()}),d.current=null,F.dispose(),c.current=null,u.current=null}},y.useEffect(()=>(_.current?.(),()=>{m.current?.(),m.current=null}),[]),{terminalRef:l,connected:i,sendKey:T=>{d.current?.readyState===WebSocket.OPEN&&(d.current.send(T),c.current?.focus())},focus:()=>{c.current?.focus()},reconnect:()=>{_.current?.()},fit:()=>{if(u.current&&d.current?.readyState===WebSocket.OPEN){u.current.fit();const T=u.current.proposeDimensions();T&&d.current.send(JSON.stringify({type:"resize",cols:T.cols,rows:T.rows}))}},ctrlModeRef:f}}function jL({isOpen:e,onClose:t}){const{terminalRef:i,connected:r}=A1();return e?a.jsx("div",{className:"terminal-overlay",children:a.jsxs("div",{className:"terminal-container",children:[a.jsxs("div",{className:"terminal-header",children:[a.jsx("span",{className:"terminal-title",children:"Terminal"}),a.jsx("span",{className:`terminal-status ${r?"connected":"disconnected"}`,children:r?" Connected":" Disconnected"}),a.jsx("button",{className:"terminal-close",onClick:t,children:""})]}),a.jsx("div",{className:"terminal-content",ref:i})]})}):null}const OS=[{path:"/v1",label:"Code Review"},{path:"/v1/home",label:"Home"},{path:"/v1/gen",label:"Generator"}];function kL(){const[e,t]=y.useState(!1),[i,r]=y.useState(!1),l=Hn(),c=()=>{t(!e)},u=()=>{t(!1)},d=()=>{r(!i),u()};return a.jsxs(a.Fragment,{children:[a.jsxs("nav",{className:"top-nav",children:[a.jsx("div",{className:"nav-brand",children:a.jsxs(Bs,{to:"/v1",className:"brand-link",children:[a.jsx("img",{src:"/ai-critic.svg",alt:"AI Critic",className:"brand-logo"}),a.jsx("span",{className:"brand-text",children:"AI Critic"})]})}),a.jsx("div",{className:"nav-links desktop-only",children:OS.map(m=>a.jsx(Bs,{to:m.path,className:`nav-link ${l.pathname===m.path?"active":""}`,children:m.label},m.path))}),a.jsxs("div",{className:"nav-actions",children:[a.jsxs("button",{className:"terminal-btn",onClick:d,title:"Open Terminal",children:[a.jsx(NL,{}),a.jsx("span",{className:"btn-text",children:"Terminal"})]}),a.jsx("button",{className:"menu-btn mobile-only",onClick:c,"aria-label":"Toggle menu",children:e?a.jsx(TL,{}):a.jsx(EL,{})})]}),e&&a.jsx("div",{className:"mobile-menu",children:OS.map(m=>a.jsx(Bs,{to:m.path,className:`mobile-nav-link ${l.pathname===m.path?"active":""}`,onClick:u,children:m.label},m.path))})]}),a.jsx(jL,{isOpen:i,onClose:()=>r(!1)})]})}function NL(){return a.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("polyline",{points:"4 17 10 11 4 5"}),a.jsx("line",{x1:"12",y1:"19",x2:"20",y2:"19"})]})}function EL(){return a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),a.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),a.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}function TL(){return a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})}function RL({children:e,hideNav:t=!1}){return a.jsxs("div",{className:"app-layout",children:[!t&&a.jsx(kL,{}),a.jsx("main",{className:"app-main",children:e})]})}class L1 extends fr.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,i){console.error("ErrorBoundary caught an error:",t,i)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:a.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"#e2e8f0",background:"#1e293b",border:"1px solid #ef4444",borderRadius:"8px",margin:"16px"},children:[a.jsx("div",{style:{fontSize:"20px",fontWeight:600,marginBottom:"12px",color:"#ef4444"},children:" Something went wrong"}),a.jsx("div",{style:{fontSize:"14px",marginBottom:"16px",color:"#94a3b8"},children:"An error occurred while rendering this component"}),this.state.error&&a.jsx("div",{style:{padding:"12px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:"6px",fontSize:"12px",color:"#fca5a5",textAlign:"left",wordBreak:"break-word",whiteSpace:"pre-wrap"},children:this.state.error.toString()}),a.jsx("button",{onClick:()=>window.location.reload(),style:{marginTop:"16px",padding:"10px 20px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:"6px",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"Reload Page"}),a.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null}),style:{marginTop:"16px",marginLeft:"10px",padding:"10px 20px",background:"#1e293b",color:"#e2e8f0",border:"1px solid #334155",borderRadius:"6px",fontSize:"14px",fontWeight:600,cursor:"pointer"},children:"Dismiss"})]}):this.props.children}}async function DL(){return(await fetch("/api/ports/diagnostics")).json()}async function M1(e){return await(await fetch(`/api/ports/logs?port=${e}`)).json()??[]}async function AL(e){return await(await fetch(`/api/domains/health-logs?domain=${encodeURIComponent(e)}`)).json()??[]}async function B1(){return await(await fetch("/api/ports/providers")).json()??[]}async function LL(e){const t=await fetch("/api/ports",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const i=await t.text();throw new Error(i)}}async function ML(e){const t=await fetch(`/api/ports?port=${e}`,{method:"DELETE"});if(!t.ok){const i=await t.text();throw new Error(i)}}async function BL(){const e=await fetch("/api/ports/mapping-names");if(!e.ok)throw new Error(`HTTP ${e.status}: ${e.statusText}`);return await e.json()}async function OL(e){const t=await fetch("/api/ports/mapping-names",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const i=await t.text();throw new Error(i)}}const su={Active:"active",Connecting:"connecting"},an={Localtunnel:"localtunnel",CloudflareTunnel:"cloudflare_tunnel",CloudflareOwned:"cloudflare_owned"};function zL(){const[e,t]=y.useState([]),[i,r]=y.useState([]),[l,c]=y.useState(!0),[u,d]=y.useState(null),m=rt(e),f=y.useRef(null);y.useEffect(()=>{B1().then(S=>r(S)).catch(()=>{})},[]),y.useEffect(()=>{let S=null,x=1e3,b=!1;function C(){b||(S=new EventSource("/api/ports/events"),S.onmessage=T=>{try{const k=JSON.parse(T.data);t(k),d(null),c(!1),x=1e3}catch{}},S.onerror=()=>{S?.close(),S=null,b||(f.current=setTimeout(C,x),x=Math.min(x*2,3e4),d("Connection lost, reconnecting"))})}return C(),()=>{b=!0,S?.close(),f.current&&clearTimeout(f.current)}},[]);const v=y.useCallback(async S=>{await LL(S)},[]),_=y.useCallback(async S=>{await ML(S),t(m.current.filter(x=>x.localPort!==S))},[m]);return{ports:e,providers:i,loading:l,error:u,addPort:v,removePort:_}}function PL(){const[e,t]=y.useState([]),[i,r]=y.useState(!0),[l,c]=y.useState(null),u=y.useRef(null);return y.useEffect(()=>{const d=new EventSource("/api/ports/local/events");return u.current=d,d.onmessage=m=>{try{const f=JSON.parse(m.data);if(f.error){c(f.error),r(!1),f.fatal&&d.close();return}t(f??[]),c(null),r(!1)}catch{}},d.onerror=()=>{i&&!l&&c("Connection lost, retrying...")},()=>{d.close(),u.current=null}},[]),{ports:e,loading:i,error:l}}async function HL(){const t=await(await fetch("/api/projects")).json();return Array.isArray(t)?t:[]}async function IL(e){await fetch(`/api/projects?id=${e}`,{method:"DELETE"})}async function UL(e){const t=await fetch("/api/projects",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),i=await t.json();if(!t.ok)throw new Error(i.error||"Failed to add project");return i}async function zS(e,t){const i=await fetch(`/api/projects?id=${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok){const r=await i.json();throw new Error(r.error||"Failed to update project")}return i.json()}const gu={Fetch:"fetch",Pull:"pull",Push:"push"};async function FL(e,t){return fetch(`/api/git/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})}async function $L(e,t,i){const r={dir:t};return i&&(r.ssh_key=i),fetch(`/api/review/${e}`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:JSON.stringify(r)})}async function KL(e){console.log("[fetchTodos] Loading todos for project:",e);try{const t=await fetch(`/api/projects/todos?project_id=${e}`);if(!t.ok)return console.warn("[fetchTodos] Failed to fetch todos, status:",t.status),[];const i=await t.json();return console.log("[fetchTodos] Received data:",i),Array.isArray(i)?i:[]}catch(t){return console.error("[fetchTodos] Error:",t),[]}}async function qL(e,t){console.log("[addTodo] Adding todo for project:",e,"text:",t);try{const i=await fetch(`/api/projects/todos?project_id=${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})});if(!i.ok){const l=await i.json();throw new Error(l.error||"Failed to add todo")}const r=await i.json();return console.log("[addTodo] Added todo successfully:",r),r}catch(i){throw console.error("[addTodo] Error:",i),i}}async function PS(e,t,i){console.log("[updateTodo] Updating todo:",t,"for project:",e,"updates:",i);try{const r=await fetch(`/api/projects/todos?project_id=${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:t,...i})});if(!r.ok){const c=await r.json();throw new Error(c.error||"Failed to update todo")}const l=await r.json();return console.log("[updateTodo] Updated todo successfully:",l),l}catch(r){throw console.error("[updateTodo] Error:",r),r}}async function WL(e,t){console.log("[deleteTodo] Deleting todo:",t,"for project:",e);try{const i=await fetch(`/api/projects/todos?project_id=${e}&todo_id=${t}`,{method:"DELETE"});if(!i.ok){const r=await i.json();throw new Error(r.error||"Failed to delete todo")}console.log("[deleteTodo] Deleted todo successfully")}catch(i){throw console.error("[deleteTodo] Error:",i),i}}const ci={Starting:"starting",Running:"running",Error:"error"};async function O1(){const t=await(await fetch("/api/agents")).json();return Array.isArray(t)?t:[]}async function jp(e,t){const i=new URLSearchParams,r=i.toString()?`/api/agents/sessions?${i}`:"/api/agents/sessions",c=await(await fetch(r)).json();return c.sessions&&Array.isArray(c.sessions)?c.sessions:Array.isArray(c)?c:[]}async function VL(e,t,i){const r={agent_id:e,project_dir:t};i&&(r.api_key=i);const l=await fetch("/api/agents/sessions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!l.ok){const c=await l.text();throw new Error(c||"Failed to launch agent")}return l.json()}async function z1(e){await fetch(`/api/agents/sessions?id=${encodeURIComponent(e)}`,{method:"DELETE"})}function ui(e){return`/api/agents/sessions/${e}/proxy`}async function GL(e,t=1,i=50){const r=new URLSearchParams({page:t.toString(),page_size:i.toString()});return(await fetch(`${ui(e)}/session?${r}`)).json()}async function HS(e,t){const i={};return t&&(i.model=`${t.providerID}/${t.modelID}`),(await fetch(`${ui(e)}/session`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)})).json()}async function P1(e){return(await fetch(`${ui(e)}/config`)).json()}async function H1(e,t){const i=await fetch(`${ui(e)}/config`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok){const l=await i.text();throw new Error(l||"Failed to update config")}const r=await i.json().catch(()=>null);if(r&&r.success===!1){const l=Array.isArray(r.error)?r.error.map(c=>c.message).join("; "):String(r.error||"Failed to update config");throw new Error(l)}}async function I1(e){return(await fetch(`${ui(e)}/config/providers`)).json()}async function U1(e,t){const r=await(await fetch(`${ui(e)}/session/${t}/message`)).json();return Array.isArray(r)?r:[]}async function YL(e,t,i,r){const l={parts:[{type:"text",text:i}]};r&&(l.model=r),await fetch(`${ui(e)}/session/${t}/prompt_async`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})}function XL(e){return`${ui(e)}/event`}async function JL(e){return(await fetch(`${ui(e)}/settings`)).json()}async function ZL(e,t){return(await fetch(`${ui(e)}/settings`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json()}async function QL(e){const i=await(await fetch(`${ui(e)}/templates`)).json();return Array.isArray(i)?i:[]}async function eM(e){return(await fetch(`/api/agents/config?agent_id=${encodeURIComponent(e)}`)).json()}async function IS(e,t){const i=await fetch(`/api/agents/config?agent_id=${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({binary_path:t})});if(!i.ok){const r=await i.text();throw new Error(r||"Failed to update agent config")}}async function US(e){return(await fetch(`/api/agents/effective-path?agent_id=${encodeURIComponent(e)}`)).json()}async function kp(){return(await fetch("/api/agents/opencode/settings")).json()}async function tM(e){const t=await fetch("/api/agents/opencode/settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const i=await t.text();throw new Error(i||"Failed to update settings")}}async function FS(){return(await fetch("/api/agents/opencode/web-status")).json()}function nM(e){return fetch("/api/agents/opencode/web-server/control",{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:JSON.stringify({action:e})})}function iM(e,t,i){const r=new URLSearchParams;t&&r.set("session_id",t),i!==void 0&&i>0&&r.set("log_index",i.toString());const l=r.toString(),c="/api/agents/opencode/web-server/domain-map/stream"+(l?`?${l}`:"");return fetch(c,{method:t?"GET":"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream"},body:t?void 0:JSON.stringify({provider:e})})}async function sM(){const e=await fetch("/api/agents/opencode/web-server/domain-map",{method:"DELETE"});if(!e.ok){const t=await e.text();throw new Error(t||"Failed to unmap domain")}return e.json()}async function F1(){return(await fetch("/api/agents/opencode/auth")).json()}const $1=y.createContext(null);function In(){const e=y.useContext($1);if(!e)throw new Error("useV2Context must be used within V2Provider");return e}function rM({children:e}){const[t,i]=y.useState([]),[r,l]=y.useState(!0),c=()=>{HL().then(j=>{i(j),l(!1)}).catch(()=>l(!1))};y.useEffect(()=>{c()},[]);const[u,d]=y.useState(null),m=zL(),f=PL(),[v,_]=y.useState(null),[S,x]=y.useState(!0),b=()=>{x(!0),DL().then(j=>{_(j),x(!1)}).catch(()=>x(!1))};y.useEffect(()=>{b()},[]);const[C,T]=y.useState([]),[k,R]=y.useState(!0),[N,E]=y.useState({}),[z,B]=y.useState(""),I=(j,A)=>{E(D=>{const $={...D};return A?$[j]=A:delete $[j],$})},q=()=>{R(!0),O1().then(j=>{T(j),R(!1)}).catch(()=>R(!1))};y.useEffect(()=>{q()},[]);const[F,V]=y.useState({}),G=y.useCallback((j,A)=>{V(D=>({...D,[j]:[...D[j]||[],A]}))},[]),Y=y.useCallback(j=>{const A=F[j]||[];if(A.length===0)return;const D=A[A.length-1];return V($=>({...$,[j]:($[j]||[]).slice(0,-1)})),D},[F]),M=y.useCallback(j=>{V(A=>({...A,[j]:[]}))},[]);return a.jsx($1.Provider,{value:{projectsList:t,projectsLoading:r,fetchProjects:c,currentProject:u,setCurrentProject:d,portForwards:m,localPorts:f,diagnostics:v,diagnosticsLoading:S,refreshDiagnostics:b,agents:C,agentsLoading:k,refreshAgents:q,agentSessions:N,setAgentSession:I,agentLaunchError:z,setAgentLaunchError:B,tabHistories:F,pushTabHistory:G,popTabHistory:Y,clearTabHistory:M},children:e})}const nt={Home:"home",Agent:"agent",Terminal:"terminal",Ports:"ports",Files:"files"};function aM(){return a.jsxs("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"3",y1:"12",x2:"21",y2:"12"}),a.jsx("line",{x1:"3",y1:"6",x2:"21",y2:"6"}),a.jsx("line",{x1:"3",y1:"18",x2:"21",y2:"18"})]})}function Au(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"12",cy:"12",r:"3"}),a.jsx("path",{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"})]})}function lM(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"}),a.jsx("circle",{cx:"12",cy:"7",r:"4"})]})}function oM(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),a.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})}function cM(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"10",rx:"2"}),a.jsx("circle",{cx:"12",cy:"5",r:"2"}),a.jsx("path",{d:"M12 7v4"}),a.jsx("line",{x1:"8",y1:"16",x2:"8",y2:"16"}),a.jsx("line",{x1:"16",y1:"16",x2:"16",y2:"16"})]})}function ro(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("polyline",{points:"4 17 10 11 4 5"}),a.jsx("line",{x1:"12",y1:"19",x2:"20",y2:"19"})]})}function uM(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"}),a.jsx("path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"})]})}function hM(){return a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})})}function _o(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),a.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})}function Np(){return a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:a.jsx("polyline",{points:"15 18 9 12 15 6"})})}function dM(){return a.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",className:"mcc-empty-icon",children:[a.jsx("path",{d:"M12 2a4 4 0 0 1 4 4v2a4 4 0 0 1-8 0V6a4 4 0 0 1 4-4z"}),a.jsx("path",{d:"M16 14H8a4 4 0 0 0-4 4v2h16v-2a4 4 0 0 0-4-4z"}),a.jsx("circle",{cx:"9",cy:"7",r:"1",fill:"currentColor"}),a.jsx("circle",{cx:"15",cy:"7",r:"1",fill:"currentColor"})]})}function K1(){return a.jsx("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})})}function fM(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("circle",{cx:"18",cy:"18",r:"3"}),a.jsx("circle",{cx:"6",cy:"6",r:"3"}),a.jsx("path",{d:"M13 6h3a2 2 0 0 1 2 2v7"}),a.jsx("line",{x1:"6",y1:"9",x2:"6",y2:"21"})]})}function mM(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M9 11l3 3L22 4"}),a.jsx("path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"})]})}function q1({size:e=20,className:t,style:i}={}){return a.jsxs("svg",{width:e,height:e,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,style:i,children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"17 8 12 3 7 8"}),a.jsx("line",{x1:"12",y1:"3",x2:"12",y2:"15"})]})}function pM(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),a.jsx("polyline",{points:"7 10 12 15 17 10"}),a.jsx("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]})}function gM(){return a.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),a.jsx("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]})}function vu(){return a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"})})}function vM(){return a.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"currentColor",children:a.jsx("path",{d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})})}function _M(){return a.jsxs("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",style:{marginRight:4,flexShrink:0},children:[a.jsx("rect",{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"}),a.jsx("path",{d:"M7 11V7a5 5 0 0 1 10 0v4"})]})}function yM(){return a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[a.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),a.jsx("polyline",{points:"14 2 14 8 20 8"}),a.jsx("line",{x1:"16",y1:"13",x2:"8",y2:"13"}),a.jsx("line",{x1:"16",y1:"17",x2:"8",y2:"17"}),a.jsx("polyline",{points:"10 9 9 9 8 9"})]})}function Il({icon:e,label:t,active:i,onClick:r}){return a.jsxs("button",{className:`mcc-nav-btn ${i?"active":""}`,onClick:r,children:[e,a.jsx("span",{children:t})]})}function xM({projects:e,currentProject:t,onProjectSelect:i}){const[r,l]=y.useState(!1),c=y.useRef(null);y.useEffect(()=>{if(!r)return;const d=m=>{c.current&&!c.current.contains(m.target)&&l(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[r]);const u=d=>{i(d),l(!1)};return a.jsxs("div",{className:"mcc-project-dropdown",ref:c,children:[a.jsxs("div",{className:"mcc-project-current",onClick:()=>l(!r),children:[a.jsx("span",{className:"mcc-project-name",children:t?t.name:"No Project"}),a.jsx("span",{className:"mcc-project-chevron",children:""})]}),r&&a.jsx("div",{className:"mcc-project-menu",children:e.map(d=>a.jsxs("button",{className:`mcc-project-option${t?.id===d.id?" mcc-project-option-active":""}`,onClick:()=>u(d),children:[a.jsx("span",{className:"mcc-project-option-name",children:d.name}),a.jsx("span",{className:"mcc-project-option-path",children:d.dir})]},d.id))})]})}async function SM(e,t){const i=new URLSearchParams;e&&i.set("page",e.toString()),t&&i.set("page_size",t.toString());const r=i.toString()?`/api/terminal/sessions?${i}`:"/api/terminal/sessions",c=await(await fetch(r)).json();return c.sessions&&Array.isArray(c.sessions)?c.sessions:Array.isArray(c)?c:[]}async function bM(e){await fetch(`/api/terminal/sessions?id=${encodeURIComponent(e)}`,{method:"DELETE"})}function wM(e){const t=new Set(e);let i=1;for(;t.has(`Terminal ${i}`);)i++;return`Terminal ${i}`}function CM(e={}){const{loadSessions:t,defaultCwd:i}=e,[r,l]=y.useState([]),[c,u]=y.useState(null),[d,m]=y.useState(!!t),[f,v]=y.useState(null),_=y.useRef(!1),S=()=>{_.current||!t||(_.current=!0,m(!0),t().then(k=>{if(k.length===0){const R={id:`term-${Date.now()}`,name:"Terminal 1",cwd:i};l([R]),u(R.id)}else{const R=k.map(N=>({id:`term-${N.id}`,name:N.name,cwd:N.cwd,sessionId:N.id}));l(R),u(R[0].id)}m(!1)}).catch(k=>{v(k?.message||"Failed to load sessions");const R={id:`term-${Date.now()}`,name:"Terminal 1",cwd:i};l([R]),u(R.id),m(!1)}))};if(!t&&!_.current&&(_.current=!0,r.length===0)){const k={id:`term-${Date.now()}`,name:"Terminal 1",cwd:i};l([k]),u(k.id)}return{tabs:r,activeTabId:c,loading:d,error:f,setActiveTabId:u,createTab:k=>{const R=`term-${Date.now()}`,N=k?.name||wM(r.map(z=>z.name)),E={id:R,name:N,cwd:k?.cwd||i,initialCommand:k?.initialCommand,autoFocus:k?.autoFocus};l(z=>[...z,E]),u(R)},closeTab:k=>{l(R=>{const N=R.find(z=>z.id===k);N?.sessionId&&bM(N.sessionId).catch(()=>{});const E=R.filter(z=>z.id!==k);if(E.length===0){const z={id:`term-${Date.now()}`,name:"Terminal 1",cwd:i};return u(z.id),[z]}if(c===k){const z=R.findIndex(I=>I.id===k),B=E[Math.min(z,E.length-1)];u(B.id)}return E})},setTabSessionId:(k,R)=>{l(N=>N.map(E=>E.id===k?{...E,sessionId:R}:E))},clearAutoFocus:k=>{l(R=>R.map(N=>N.id===k?{...N,autoFocus:!1}:N))},ensureLoaded:S}}const jM={background:"#0f172a",foreground:"#e2e8f0",cursor:"#60a5fa",cursorAccent:"#0f172a",selectionBackground:"#334155",black:"#0f172a",red:"#ef4444",green:"#22c55e",yellow:"#eab308",blue:"#3b82f6",magenta:"#a855f7",cyan:"#06b6d4",white:"#f1f5f9",brightBlack:"#475569",brightRed:"#f87171",brightGreen:"#4ade80",brightYellow:"#facc15",brightBlue:"#60a5fa",brightMagenta:"#c084fc",brightCyan:"#22d3ee",brightWhite:"#ffffff"},kM=y.forwardRef(function({id:t,isActive:i,cwd:r,name:l,initialCommand:c,sessionId:u,autoFocus:d,onConnectionChange:m,onReconnectRef:f,onSessionId:v,onCloseTab:_,onAutoFocusHandled:S},x){const[b,C]=y.useState(!1),T=y.useRef(!1),{terminalRef:k,connected:R,sendKey:N,reconnect:E,fit:z,focus:B,ctrlModeRef:I}=A1(!0,{theme:jM,cwd:r,name:l,initialCommand:c,sessionId:u,onSessionId:v,onCloseRequest:_,onCtrlModeConsumed:()=>C(!1)});y.useImperativeHandle(x,()=>({fit:()=>setTimeout(()=>z(),50),focus:B}));const q=rt(m),F=y.useRef(null),V=rt(S);i&&F.current!==R&&(F.current=R,q.current(R),R&&d&&!T.current&&(T.current=!0,B(),V.current()));const G=rt(f),Y=rt(E);i&&G.current(Y.current);const M=y.useRef(null),j=()=>{const de=!I.current;I.current=de,C(de),de&&setTimeout(()=>M.current?.focus(),0)},A=de=>{I.current=!1,C(!1);const oe=de.toLowerCase().charCodeAt(0);oe>=97&&oe<=122&&N(String.fromCharCode(oe-96)),B()},D=()=>N("\x1B"),$=()=>N(""),W=()=>N(""),ne=()=>N(""),U=()=>N("\f"),P=()=>N("	"),H=()=>N("\x1B[A"),L=()=>N("\x1B[B"),re=()=>N("\x1B[D"),me=()=>N("\x1B[C"),he=async()=>{try{const de=await navigator.clipboard.readText();de&&N(de)}catch(de){console.error("Failed to paste from clipboard:",de)}};return a.jsxs("div",{className:`terminal-instance ${i?"active":""}`,"data-terminal-id":t,children:[a.jsx("div",{className:"terminal-instance-content",ref:k}),a.jsxs("div",{className:"terminal-instance-shortcuts",children:[a.jsx("button",{className:"term-shortcut-btn",onClick:P,children:"Tab"}),a.jsx("button",{className:"term-shortcut-btn",onClick:re,children:""}),a.jsx("button",{className:"term-shortcut-btn",onClick:me,children:""}),a.jsx("button",{className:"term-shortcut-btn",onClick:H,children:""}),a.jsx("button",{className:"term-shortcut-btn",onClick:L,children:""}),a.jsx("button",{className:`term-shortcut-btn ${b?"active":""}`,onClick:j,children:"Ctrl"}),a.jsx("input",{ref:M,className:"term-ctrl-hidden-input",type:"text",maxLength:1,autoCapitalize:"none",autoCorrect:"off",autoComplete:"off",onInput:de=>{const oe=de.target.value;oe.length>0&&(A(oe),de.target.value="")},onBlur:()=>{I.current=!1,C(!1)}}),a.jsx("button",{className:"term-shortcut-btn",onClick:D,children:"Esc"}),a.jsx("button",{className:"term-shortcut-btn",onClick:$,children:"^C"}),a.jsx("button",{className:"term-shortcut-btn",onClick:W,children:"^A"}),a.jsx("button",{className:"term-shortcut-btn",onClick:ne,children:"^R"}),a.jsx("button",{className:"term-shortcut-btn",onClick:U,children:"^L"}),a.jsx("button",{className:"term-shortcut-btn",onClick:he,children:"Paste"})]})]})}),NM=y.forwardRef(function({isVisible:t,loadSessions:i},r){const{currentProject:l}=In(),[c,u]=y.useState(!1),{tabs:d,activeTabId:m,loading:f,error:v,setActiveTabId:_,createTab:S,closeTab:x,setTabSessionId:b,clearAutoFocus:C,ensureLoaded:T}=CM({loadSessions:i,defaultCwd:l?.dir});y.useEffect(()=>{t&&T()},[t]);const[k,R]=y.useState(!1),N=y.useRef(null),E=y.useRef({}),z=rt(m);y.useImperativeHandle(r,()=>({createTab:S,openTab:(I,q,F)=>{S({name:I,cwd:q,initialCommand:F})},fitActive:()=>{const I=z.current;I&&E.current[I]?.fit()}}));const B=()=>{S()};return f?a.jsx("div",{className:"terminal-manager",children:a.jsxs("div",{className:"terminal-manager-header",children:[a.jsx("div",{className:"terminal-tabs-container",children:a.jsx("div",{className:"terminal-tab-item active",children:a.jsx("span",{className:"terminal-tab-name",children:"Loading..."})})}),a.jsxs("div",{className:"terminal-connection-status disconnected",children:[a.jsx("span",{className:"status-dot",children:""}),a.jsx("span",{className:"status-text",children:"Loading"})]})]})}):d.length===0?a.jsxs("div",{className:"terminal-manager",children:[a.jsxs("div",{className:"terminal-manager-header",children:[a.jsx("div",{className:"terminal-tabs-container",children:a.jsx("button",{className:"terminal-tab-add",onClick:B,title:"New Terminal",children:"+ New Terminal"})}),a.jsxs("div",{className:"terminal-connection-status disconnected",children:[a.jsx("span",{className:"status-dot",children:""}),a.jsx("span",{className:"status-text",children:"No terminals"})]})]}),a.jsxs("div",{className:"terminal-empty-state",children:[v?a.jsxs("p",{className:"terminal-error",children:["Error: ",v]}):a.jsx("p",{children:"No terminal sessions"}),a.jsx("button",{className:"terminal-empty-state-btn",onClick:B,children:"Create New Terminal"})]})]}):a.jsxs("div",{className:`terminal-manager ${c?"zen-mode":""}`,children:[a.jsxs("div",{className:"terminal-manager-header",children:[a.jsxs("div",{className:"terminal-tabs-container",children:[d.map(I=>a.jsxs("div",{className:`terminal-tab-item ${m===I.id?"active":""}`,onClick:()=>{_(I.id),E.current[I.id]?.fit()},children:[a.jsx("span",{className:"terminal-tab-name",children:I.name}),d.length>1&&a.jsx("button",{className:"terminal-tab-close",onClick:q=>{q.stopPropagation(),x(I.id)},children:""})]},I.id)),a.jsx("button",{className:"terminal-tab-add",onClick:B,children:"+"})]}),k?a.jsxs("div",{className:"terminal-connection-status connected",children:[a.jsx("span",{className:"status-dot",children:""}),a.jsx("span",{className:"status-text",children:"Connected"})]}):a.jsxs("button",{className:"terminal-connection-status disconnected clickable",onClick:()=>N.current?.(),title:"Click to reconnect",children:[a.jsx("span",{className:"status-dot",children:""}),a.jsx("span",{className:"status-text",children:"Reconnect"})]}),a.jsx("button",{className:"terminal-zen-btn",onClick:()=>u(!c),title:c?"Exit Zen Mode":"Enter Zen Mode",children:c?"Exit Zen":"Zen"})]}),a.jsx("div",{className:"terminal-instances-container",children:d.map(I=>a.jsx(kM,{ref:q=>{E.current[I.id]=q},id:I.id,isActive:m===I.id,cwd:I.cwd,name:I.name,initialCommand:I.initialCommand,sessionId:I.sessionId,autoFocus:I.autoFocus,onConnectionChange:R,onReconnectRef:q=>{m===I.id&&(N.current=q)},onSessionId:q=>b(I.id,q),onCloseTab:()=>x(I.id),onAutoFocusHandled:()=>C(I.id)},I.id))})]})});function $S(){const e=es(),t=dt(),i=Hn(),r=e.projectName||"",l=r?`/project/${encodeURIComponent(r)}/`:"/",c=i.pathname.startsWith(l)?i.pathname.slice(l.length):"",u=c.indexOf("/"),d=(u<0?c:c.slice(0,u))||nt.Home,m=u<0?"":c.slice(u+1),{projectsList:f,projectsLoading:v,currentProject:_,setCurrentProject:S}=In(),x=y.useRef(null);y.useEffect(()=>{if(!r||v||_)return;const q=f.find(F=>F.name===r);q&&S(q)},[r,v,f]),y.useEffect(()=>{const q=i.state;q?.sshConnect&&q?.command&&x.current&&(d!==nt.Terminal&&t(C(nt.Terminal)),setTimeout(()=>{x.current?.openTab(q.serverName||"SSH Connection",void 0,q.command)},100),t(i.pathname,{replace:!0,state:{}}))},[i.state,d]);const b=rt(_),C=(q,F)=>{const V=b.current;if(V){const G=`/project/${encodeURIComponent(V.name)}`;return q===nt.Home&&!F?`${G}/home`:F?`${G}/${q}/${F}`:`${G}/${q}`}return q===nt.Home&&!F?"/":F?`/${q}/${F}`:`/${q}`},T=y.useRef({}),k=rt(d),R=rt(m);y.useEffect(()=>{m&&(T.current[d]=m)},[d,m]);const N=q=>{S(q);const F=T.current[d],V=`/project/${encodeURIComponent(q.name)}`;d===nt.Home&&!F?t(`${V}/home`):t(F?`${V}/${d}/${F}`:`${V}/${d}`)},E=q=>{const F=R.current;F&&(T.current[k.current]=F);const V=T.current[q];t(C(q,V||void 0))},[z,B]=y.useState(!1),I=q=>{B(!1),t(q)};return a.jsxs("div",{className:"mcc",children:[a.jsxs("div",{className:"mcc-topbar",children:[a.jsx("button",{className:"mcc-menu-btn",onClick:()=>B(!z),children:a.jsx(aM,{})}),a.jsx(xM,{projects:f,currentProject:_,onProjectSelect:N}),a.jsx("button",{className:"mcc-profile-btn",children:a.jsx(lM,{})})]}),a.jsx("div",{className:`mcc-drawer-overlay${z?" mcc-drawer-overlay--open":""}`,onClick:()=>B(!1)}),a.jsxs("div",{className:`mcc-drawer${z?" mcc-drawer--open":""}`,children:[a.jsxs("div",{className:"mcc-drawer-header",children:[a.jsx("span",{className:"mcc-drawer-title",children:"Menu"}),a.jsx("button",{className:"mcc-drawer-close",onClick:()=>B(!1),children:a.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),a.jsxs("nav",{className:"mcc-drawer-nav",children:[a.jsxs("button",{className:"mcc-drawer-item",onClick:()=>I(C(nt.Home,"settings")),children:[a.jsx(Au,{}),a.jsx("span",{children:"Settings"})]}),a.jsxs("button",{className:"mcc-drawer-item",onClick:()=>I(C(nt.Home,"settings/logs")),children:[a.jsx(yM,{}),a.jsx("span",{children:"Logs"})]})]})]}),a.jsx("div",{className:"mcc-content",children:a.jsxs("div",{className:"mcc-content-inner",children:[a.jsx("div",{className:"mcc-terminal-wrapper",style:{display:d===nt.Terminal?"flex":"none",flex:1,height:"100%",overflow:"hidden"},children:a.jsx(NM,{ref:x,isVisible:d===nt.Terminal,loadSessions:SM})}),a.jsx("div",{className:"mcc-tab-content",style:{display:d===nt.Terminal?"none":"flex",flexDirection:"column",flex:1,minHeight:0,overflow:"auto"},children:a.jsx(Na,{context:{onSelectProject:N}})})]})}),a.jsxs("div",{className:"mcc-bottomnav",children:[a.jsx(Il,{icon:a.jsx(oM,{}),label:"Home",active:d===nt.Home,onClick:()=>E(nt.Home)}),a.jsx(Il,{icon:a.jsx(cM,{}),label:"Agent",active:d===nt.Agent,onClick:()=>E(nt.Agent)}),a.jsx(Il,{icon:a.jsx(ro,{}),label:"Terminal",active:d===nt.Terminal,onClick:()=>E(nt.Terminal)}),a.jsx(Il,{icon:a.jsx(uM,{}),label:"Ports",active:d===nt.Ports,onClick:()=>E(nt.Ports)}),a.jsx(Il,{icon:a.jsx(hM,{}),label:"Files",active:d===nt.Files,onClick:()=>E(nt.Files)})]})]})}const va={Authenticated:"authenticated",Unauthenticated:"unauthenticated",NotInitialized:"not_initialized"};async function EM(){const e=await fetch("/api/auth/check");return e.ok?va.Authenticated:e.status===401?(await e.json().catch(()=>({}))).error==="not_initialized"?va.NotInitialized:va.Unauthenticated:va.Authenticated}async function TM(e){return fetch("/api/auth/setup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({credential:e})})}async function RM(e,t){return fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})})}async function W1(){const e=await fetch("/api/auth/credentials/generate",{method:"POST"});if(!e.ok){const i=await e.json().catch(()=>({}));throw new Error(i.error||"Failed to generate credential")}return(await e.json()).credential}async function DM(e){const t=await fetch("/api/auth/credentials/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:e})});if(!t.ok){const i=await t.json().catch(()=>({}));throw new Error(i.error||"Failed to add credential")}}async function Pm(){const e=await fetch("/api/auth/credentials");if(!e.ok)throw new Error("Failed to fetch credentials");return(await e.json()).credentials||[]}async function AM(e,t){const i=await fetch("/api/ssh-keys/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({host:e,private_key:t})});if(!i.ok){const r=await i.json().catch(()=>({}));throw new Error(r.output||r.error||"SSH test failed")}return i}async function LM(){return(await fetch("/api/github/oauth-config")).json()}async function MM(e,t){return fetch("/api/github/oauth-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:e,client_secret:t})})}async function BM(e){return(await fetch("/api/github/oauth-token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e})})).json()}async function OM(e){const i=await(await fetch("/api/github/repos",{headers:{Authorization:`token ${e}`}})).json();return Array.isArray(i)?i:[]}async function Ep(e){return fetch("/api/github/clone",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}function zM({onLoginSuccess:e}){const[t,i]=y.useState(""),[r,l]=y.useState(""),[c,u]=y.useState(""),[d,m]=y.useState(!1),f=async v=>{if(v.preventDefault(),!t.trim()||!r.trim()){u("Username and password are required");return}m(!0),u("");try{const _=await RM(t.trim(),r.trim()),S=await _.json();if(!_.ok){u(S.error||"Login failed"),m(!1);return}e()}catch(_){u(String(_)),m(!1)}};return a.jsx("div",{className:"mcc-login",children:a.jsxs("div",{className:"mcc-login-card",children:[a.jsx("h1",{className:"mcc-login-title",children:"AI Critic"}),a.jsx("p",{className:"mcc-login-subtitle",children:"Sign in to continue"}),a.jsxs("form",{onSubmit:f,className:"mcc-login-form",children:[a.jsxs("div",{className:"mcc-login-field",children:[a.jsx("label",{htmlFor:"username",children:"Username"}),a.jsx("input",{id:"username",type:"text",placeholder:"Enter username",value:t,onChange:v=>i(v.target.value),autoComplete:"username",autoFocus:!0})]}),a.jsxs("div",{className:"mcc-login-field",children:[a.jsx("label",{htmlFor:"password",children:"Password"}),a.jsx("input",{id:"password",type:"password",placeholder:"Enter password",value:r,onChange:v=>l(v.target.value),autoComplete:"current-password"})]}),c&&a.jsx("div",{className:"mcc-login-error",children:c}),a.jsx("button",{type:"submit",className:"mcc-login-btn",disabled:d,children:d?"Signing in...":"Sign In"})]})]})})}function PM({onSetupComplete:e}){const[t,i]=y.useState(""),[r,l]=y.useState(!1),[c,u]=y.useState(""),[d,m]=y.useState(!1),[f,v]=y.useState(!1),_=async()=>{v(!0),u("");try{const b=await W1();i(b),l(!1)}catch(b){u(b instanceof Error?b.message:String(b))}v(!1)},S=async()=>{try{await navigator.clipboard.writeText(t),l(!0),setTimeout(()=>l(!1),2e3)}catch{u("Failed to copy to clipboard")}},x=async()=>{if(!t.trim()){u("Please enter or generate a credential first");return}m(!0),u("");try{const b=await TM(t.trim()),C=await b.json();if(!b.ok){u(C.error||"Setup failed"),m(!1);return}e()}catch(b){u(String(b)),m(!1)}};return a.jsx("div",{className:"mcc-setup",children:a.jsxs("div",{className:"mcc-setup-card",children:[a.jsx("h1",{className:"mcc-setup-title",children:"AI Critic"}),a.jsx("p",{className:"mcc-setup-subtitle",children:"Server is not initialized yet. Set up an initial credential to secure your server."}),a.jsxs("div",{className:"mcc-setup-actions",children:[a.jsxs("div",{className:"mcc-setup-credential",children:[a.jsx("label",{className:"mcc-setup-label",children:"Credential"}),a.jsx("input",{type:"text",className:"mcc-setup-credential-input",placeholder:"Enter a credential or click Generate...",value:t,onChange:b=>{i(b.target.value),l(!1)}}),a.jsxs("div",{className:"mcc-setup-credential-btns",children:[a.jsx("button",{type:"button",className:"mcc-setup-btn mcc-setup-btn-generate",onClick:_,disabled:f,children:f?"Generating...":"Generate Random"}),t&&a.jsx("button",{type:"button",className:"mcc-setup-btn mcc-setup-btn-copy",onClick:S,children:r?"Copied!":"Copy"})]})]}),c&&a.jsx("div",{className:"mcc-setup-error",children:c}),t&&a.jsx("div",{className:"mcc-setup-note",children:"Save this credential before confirming. You will need it to log in."}),a.jsx("button",{type:"button",className:"mcc-setup-btn mcc-setup-btn-confirm",onClick:x,disabled:d||!t.trim(),children:d?"Setting up...":"Confirm & Continue"})]})]})})}async function Hs(e,t){const i=e.body?.getReader();if(!i)return t.onError({text:"Failed to read response stream",error:!0}),!1;const r=new TextDecoder;let l="",c=!1;for(;;){const{done:u,value:d}=await i.read();if(u)break;l+=r.decode(d,{stream:!0});const m=l.split(`
`);l=m.pop()||"";for(const f of m)if(f.startsWith("data: "))try{const v=JSON.parse(f.slice(6));v.type==="log"?t.onLog({text:v.message}):v.type==="error"?t.onError({text:v.message,error:!0}):v.type==="done"?(c=!0,t.onDone(v.message,v)):t.onCustom&&t.onCustom(v)}catch{}}return c}function Is(e){const[t,i]=y.useState(!1),[r,l]=y.useState([]),[c,u]=y.useState(!1),[d,m]=y.useState(null);return[{running:t,logs:r,result:d,showLogs:c},{run:async x=>{i(!0),m(null),l([]),u(!0);try{const b=await x();await Hs(b,{onLog:C=>l(T=>[...T,C]),onError:C=>l(T=>[...T,C]),onDone:(C,T)=>{const k=T.success===void 0||T.success==="true",R={ok:k,message:C||(k?"Completed successfully":"Failed")};m(R),e?.(R)}})}catch(b){const T={ok:!1,message:b instanceof Error?b.message:"Action failed"};m(T),e?.(T)}finally{i(!1)}},reset:()=>{i(!1),l([]),u(!1),m(null)}}]}const V1="ai-critic-ssh-keys";function hi(){try{const e=localStorage.getItem(V1);return e?JSON.parse(e):[]}catch{return[]}}function _u(e){localStorage.setItem(V1,JSON.stringify(e))}const Hm="ai-critic-github-token";function Aa(){return localStorage.getItem(Hm)||""}function yu(e){e?localStorage.setItem(Hm,e):localStorage.removeItem(Hm)}const G1="ai-critic-git-user-config";function La(){try{const e=localStorage.getItem(G1);return e?JSON.parse(e):{name:"",email:""}}catch{return{name:"",email:""}}}function Tp(e){localStorage.setItem(G1,JSON.stringify(e))}const HM=Object.freeze(Object.defineProperty({__proto__:null,loadGitHubToken:Aa,loadGitUserConfig:La,loadSSHKeys:hi,saveGitHubToken:yu,saveGitUserConfig:Tp,saveSSHKeys:_u},Symbol.toStringTag,{value:"Module"}));function Y1(e){return e?e.ssh_key_id?hi().some(r=>r.id===e.ssh_key_id)?{hasSSHKey:!0,isKeyAvailable:!0,message:""}:{hasSSHKey:!0,isKeyAvailable:!1,message:"Configured SSH key not found. Please reconfigure in project settings."}:{hasSSHKey:!1,isKeyAvailable:!1,message:"SSH key required for this operation. Configure in project settings."}:{hasSSHKey:!1,isKeyAvailable:!1,message:"No project selected"}}function IM(e){return y.useMemo(()=>Y1(e),[e?.ssh_key_id,e?.use_ssh])}function X1(e,t=50){const i=y.useRef(null),r=y.useRef(!0);return y.useEffect(()=>{const l=i.current;if(!l)return;const c=()=>{const{scrollTop:u,scrollHeight:d,clientHeight:m}=l;r.current=d-u-m<=t};return l.addEventListener("scroll",c,{passive:!0}),()=>l.removeEventListener("scroll",c)},[t]),y.useEffect(()=>{if(!r.current)return;const l=i.current;l&&requestAnimationFrame(()=>{l.scrollTop=l.scrollHeight})},e),i}function ii({lines:e,emptyMessage:t="No logs yet...",pending:i,pendingMessage:r="Loading...",maxHeight:l=200,className:c}){const u=X1([e,i],20),d=e.length===0&&!i;return a.jsx("div",{className:`mcc-log-viewer ${c||""}`,ref:u,style:{maxHeight:l},children:d?a.jsx("div",{className:"mcc-log-viewer-empty",children:t}):a.jsxs(a.Fragment,{children:[e.map((m,f)=>a.jsx("div",{className:`mcc-log-viewer-line ${m.error?"mcc-log-viewer-line-error":""}`,children:m.text},f)),i&&a.jsxs("div",{className:"mcc-log-viewer-line mcc-log-viewer-pending",children:[a.jsx("span",{className:"mcc-log-viewer-spinner"}),r]})]})})}function UM({label:e,runningLabel:t,onClick:i,running:r,className:l="",disabled:c=!1,icon:u}){return a.jsx("button",{className:`streaming-action-button ${l}`,onClick:i,disabled:c||r,children:r?t:a.jsxs(a.Fragment,{children:[e,u&&a.jsx("span",{className:"streaming-action-button-icon",children:u})]})})}function xr({state:e,pendingMessage:t="Running...",maxHeight:i=150}){const{running:r,logs:l,result:c,showLogs:u}=e;return a.jsxs(a.Fragment,{children:[u&&l.length>0&&a.jsx("div",{className:"streaming-action-logs",children:a.jsx(ii,{lines:l,pending:r,pendingMessage:t,maxHeight:i})}),c&&a.jsx("div",{className:`streaming-action-result ${c.ok?"success":"error"}`,children:c.message})]})}let Af=null;class Ma extends Error{constructor(){super("Server encryption keys not available. Run: go run ./script/crypto/gen"),this.name="EncryptionNotAvailableError"}}async function FM(){if(Af)return Af;const e=await fetch("/api/encrypt/public-key");if(!e.ok)throw new Error("Failed to fetch encryption public key");const i=(await e.json()).public_key;if(!i)throw new Ma;const r=i.replace(/-----BEGIN PUBLIC KEY-----/,"").replace(/-----END PUBLIC KEY-----/,"").replace(/\s/g,""),l=atob(r),c=new Uint8Array(l.length);for(let d=0;d<l.length;d++)c[d]=l.charCodeAt(d);const u=await crypto.subtle.importKey("spki",c.buffer,{name:"RSA-OAEP",hash:"SHA-256"},!1,["encrypt"]);return Af=u,u}async function Ba(e){const t=await FM(),i=190,l=new TextEncoder().encode(e),c=[];for(let u=0;u<l.length;u+=i){const d=l.slice(u,u+i),m=await crypto.subtle.encrypt({name:"RSA-OAEP"},t,d),f=btoa(String.fromCharCode(...new Uint8Array(m)));c.push(f)}return c.join(".")}async function Rp(e){if(!e)return;const{loadSSHKeys:t}=await Lb(async()=>{const{loadSSHKeys:l}=await Promise.resolve().then(()=>HM);return{loadSSHKeys:l}},[]),r=t().find(l=>l.id===e);if(r)return Ba(r.privateKey)}const wa=({message:e="SSH key required for this operation. Configure in project settings.",style:t})=>a.jsx("div",{style:{fontSize:"13px",color:"#f59e0b",padding:"10px 14px",background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.3)",borderRadius:8,marginBottom:12,...t},children:e});async function $M(){const e=await fetch("/api/tools");if(!e.ok)throw new Error("Failed to fetch tools");return e.json()}async function J1(e){const t=await fetch(`/api/tools/install?name=${encodeURIComponent(e)}`,{method:"POST"});if(!t.ok){const i=await t.text();throw new Error(i||"Failed to install tool")}return t}const KM=()=>{const[e,t]=y.useState(null),[i,r]=y.useState(!0),[l,c]=y.useState(null),u=async()=>{r(!0),c(null);try{const m=await fetch("/api/tools/path-info");if(console.log("Path info API response:",m.status,m.statusText),!m.ok)throw new Error(`HTTP error! status: ${m.status}`);const f=await m.json();console.log("Path info data:",f),t(f)}catch(m){console.error("Path info fetch error:",m),c(m instanceof Error?m.message:"Failed to fetch")}finally{r(!1)}};if(y.useEffect(()=>{u()},[]),i)return a.jsx("div",{style:{padding:16,color:"var(--mcc-text-secondary)"},children:"Loading path info..."});if(l)return a.jsxs("div",{style:{padding:16,color:"var(--mcc-error-color)"},children:["Error: ",l]});if(!e)return null;const d=m=>m?m.split(":"):[];return a.jsxs("div",{style:{padding:"16px",backgroundColor:"var(--mcc-bg-card)",borderRadius:"8px",marginBottom:"16px",border:"1px solid var(--mcc-border-color)"},children:[a.jsx("h2",{style:{marginTop:0,marginBottom:"16px",color:"var(--mcc-text-primary)"},children:"Effective Path"}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("strong",{style:{color:"var(--mcc-text-primary)"},children:"1. System PATH:"}),a.jsx("div",{style:{backgroundColor:"var(--mcc-bg-secondary)",padding:"8px",borderRadius:"4px",fontFamily:"monospace",fontSize:"12px",maxHeight:"100px",overflowY:"auto",color:"var(--mcc-text-primary)"},children:d(e.system_path).map((m,f)=>a.jsx("div",{children:m},f))})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("strong",{style:{color:"var(--mcc-text-primary)"},children:"2. User Configured Paths:"}),a.jsx("div",{style:{backgroundColor:"var(--mcc-bg-secondary)",padding:"8px",borderRadius:"4px",fontFamily:"monospace",fontSize:"12px",color:"var(--mcc-text-primary)"},children:e.user_paths&&e.user_paths.length>0?e.user_paths.map((m,f)=>a.jsx("div",{children:m},f)):a.jsx("em",{style:{color:"var(--mcc-text-muted)"},children:"No user paths configured"})})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("strong",{style:{color:"var(--mcc-text-primary)"},children:"3. Extra Paths (npm, node, etc.):"}),a.jsx("div",{style:{backgroundColor:"var(--mcc-bg-secondary)",padding:"8px",borderRadius:"4px",fontFamily:"monospace",fontSize:"12px",maxHeight:"150px",overflowY:"auto",color:"var(--mcc-text-primary)"},children:e.extra_paths&&e.extra_paths.length>0?e.extra_paths.map((m,f)=>a.jsx("div",{children:m},f)):a.jsx("em",{style:{color:"var(--mcc-text-muted)"},children:"No extra paths"})})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("strong",{style:{color:"var(--mcc-text-primary)"},children:"4. First Pass (System + User + Extra):"}),a.jsx("div",{style:{backgroundColor:"#1e3a5f",padding:"8px",borderRadius:"4px",fontFamily:"monospace",fontSize:"12px",maxHeight:"100px",overflowY:"auto",color:"var(--mcc-text-primary)"},children:d(e.first_pass_path).map((m,f)=>a.jsx("div",{children:m},f))})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("strong",{style:{color:"var(--mcc-text-primary)"},children:"5. Second Pass (Prioritized by Node Version):"}),a.jsx("div",{style:{backgroundColor:"#3d2a1e",padding:"8px",borderRadius:"4px",fontFamily:"monospace",fontSize:"12px",maxHeight:"100px",overflowY:"auto",color:"var(--mcc-text-primary)"},children:d(e.second_pass_path).map((m,f)=>a.jsx("div",{children:m},f))})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("strong",{style:{color:"var(--mcc-text-primary)"},children:"6. Final PATH:"}),a.jsx("div",{style:{backgroundColor:"#1a3d2e",padding:"8px",borderRadius:"4px",fontFamily:"monospace",fontSize:"12px",maxHeight:"100px",overflowY:"auto",border:"2px solid var(--mcc-success-color)",color:"var(--mcc-text-primary)"},children:d(e.final_path).map((m,f)=>a.jsx("div",{children:m},f))})]}),e.node_installations&&e.node_installations.length>0&&a.jsxs("div",{style:{marginTop:"16px",padding:"12px",backgroundColor:"var(--mcc-bg-secondary)",borderRadius:"4px",border:"1px solid var(--mcc-accent-color)"},children:[a.jsx("h4",{style:{marginTop:0,marginBottom:"12px",color:"var(--mcc-accent-color)"},children:"Discovered Node Installations"}),a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"13px"},children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"var(--mcc-bg-card)"},children:[a.jsx("th",{style:{padding:"8px",textAlign:"left",borderBottom:"2px solid var(--mcc-border-color)",color:"var(--mcc-text-primary)"},children:"Version"}),a.jsx("th",{style:{padding:"8px",textAlign:"left",borderBottom:"2px solid var(--mcc-border-color)",color:"var(--mcc-text-primary)"},children:"Directory"}),a.jsx("th",{style:{padding:"8px",textAlign:"left",borderBottom:"2px solid var(--mcc-border-color)",color:"var(--mcc-text-primary)"},children:"Full Path"})]})}),a.jsx("tbody",{children:e.node_installations.map((m,f)=>a.jsxs("tr",{style:{backgroundColor:f%2===0?"var(--mcc-bg-card)":"var(--mcc-bg-secondary)"},children:[a.jsx("td",{style:{padding:"8px",borderBottom:"1px solid var(--mcc-border-color)",fontFamily:"monospace",color:"var(--mcc-text-primary)"},children:a.jsx("strong",{children:m.version})}),a.jsx("td",{style:{padding:"8px",borderBottom:"1px solid var(--mcc-border-color)",fontSize:"12px",color:"var(--mcc-text-secondary)"},children:m.dir}),a.jsx("td",{style:{padding:"8px",borderBottom:"1px solid var(--mcc-border-color)",fontFamily:"monospace",fontSize:"11px",color:"var(--mcc-text-muted)"},children:m.path})]},f))})]})]}),a.jsx("div",{style:{marginTop:"20px",textAlign:"center"},children:a.jsx("button",{onClick:u,disabled:i,style:{padding:"12px 32px",backgroundColor:i?"var(--mcc-text-muted)":"var(--mcc-accent-color)",color:"white",border:"none",borderRadius:"4px",cursor:i?"not-allowed":"pointer",fontSize:"14px",fontWeight:"bold",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},children:i?"Loading...":"Refresh Path Info"})})]})};function KS(){const e=dt(),[t,i]=y.useState(null),[r,l]=y.useState(!0),[c,u]=y.useState(null),d=(v=!0)=>{v&&l(!0),u(null),$M().then(_=>{i(_),l(!1)}).catch(_=>{u(_.message),l(!1)})};y.useEffect(()=>{d()},[]);const m=t?.tools.filter(v=>v.installed).length??0,f=t?.tools.length??0;return a.jsxs("div",{className:"diagnose-view",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(".."),children:""}),a.jsx("h2",{children:"System Diagnostics"})]}),r?a.jsx("div",{className:"diagnose-loading",children:"Checking installed tools..."}):c?a.jsxs("div",{className:"diagnose-error",children:["Error: ",c]}):t?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"diagnose-summary",children:[a.jsx("div",{className:"diagnose-summary-icon",children:m===f?"":m>0?"":""}),a.jsxs("div",{className:"diagnose-summary-text",children:[a.jsxs("span",{className:"diagnose-summary-count",children:[m,"/",f]}),a.jsx("span",{className:"diagnose-summary-label",children:"tools installed"})]}),a.jsx("div",{className:"diagnose-os-badge",children:t.os==="darwin"?"macOS":t.os==="linux"?"Linux":t.os==="windows"?"Windows":t.os})]}),a.jsx("div",{className:"diagnose-tools-list",children:t.tools.map(v=>a.jsx(qM,{tool:v,os:t.os,onInstalled:()=>d(!1)},v.name))}),a.jsx("div",{className:"diagnose-path-section",children:a.jsx(KM,{})}),a.jsx("button",{className:"diagnose-refresh-btn",onClick:()=>d(),children:"Refresh"})]}):null]})}function qM({tool:e,os:t,onInstalled:i}){const r=dt(),[l,c]=y.useState(!1),[u,d]=y.useState(!1),[m,f]=y.useState([]),[v,_]=y.useState(!1),[S,x]=y.useState(!1),b=()=>{switch(t){case"darwin":return e.install_macos;case"linux":return e.install_linux;case"windows":return e.install_windows;default:return e.install_linux}},C=async k=>{k.stopPropagation(),d(!0),f([]),_(!1),x(!1),c(!0);try{const R=await J1(e.name);await Hs(R,{onLog:N=>f(E=>[...E,N]),onError:N=>{f(E=>[...E,N]),x(!0)},onDone:N=>{f(E=>[...E,{text:N}]),_(!0),i()}})}catch(R){f(N=>[...N,{text:String(R),error:!0}]),x(!0)}d(!1)},T=m.length>0;return a.jsxs("div",{className:`diagnose-tool-card ${e.installed?"installed":"not-installed"}`,children:[a.jsxs("div",{className:"diagnose-tool-header",onClick:()=>c(!l),children:[a.jsx("span",{className:"diagnose-tool-status",children:e.installed?"":u?a.jsx("span",{className:"diagnose-tool-spinner"}):""}),a.jsx("span",{className:"diagnose-tool-name",children:e.name}),e.installed&&e.version&&a.jsx("span",{className:"diagnose-tool-version",children:e.version}),!e.installed&&e.auto_install_cmd&&a.jsx("button",{className:"diagnose-tool-install-btn",onClick:C,disabled:u,children:u?"Installing...":"Install"}),e.installed&&e.settings_path&&a.jsx("button",{className:"diagnose-tool-settings-btn",onClick:k=>{k.stopPropagation(),r(e.settings_path)},children:"Settings"}),a.jsx("span",{className:`diagnose-tool-chevron ${l?"expanded":""}`,children:""})]}),l&&a.jsxs("div",{className:"diagnose-tool-details",children:[a.jsxs("div",{className:"diagnose-tool-row",children:[a.jsx("span",{className:"diagnose-tool-label",children:"Description:"}),a.jsx("span",{className:"diagnose-tool-value",children:e.description})]}),a.jsxs("div",{className:"diagnose-tool-row",children:[a.jsx("span",{className:"diagnose-tool-label",children:"Purpose:"}),a.jsx("span",{className:"diagnose-tool-value",children:e.purpose})]}),e.installed&&e.path&&a.jsxs("div",{className:"diagnose-tool-row",children:[a.jsx("span",{className:"diagnose-tool-label",children:"Path:"}),a.jsx("code",{className:"diagnose-tool-path",children:e.path})]}),!e.installed&&!T&&a.jsxs("div",{className:"diagnose-tool-install",children:[a.jsxs("span",{className:"diagnose-tool-install-label",children:["Install (",t==="darwin"?"macOS":t==="linux"?"Linux":"Windows","):"]}),a.jsx("code",{className:"diagnose-tool-install-cmd",children:b()})]}),T&&a.jsxs("div",{className:"diagnose-tool-install-logs",children:[a.jsx("span",{className:"diagnose-tool-install-logs-label",children:u?"Installing...":v?"Installed successfully":S?"Installation failed":""}),a.jsx(ii,{lines:m,pending:u,pendingMessage:"Installing...",maxHeight:200})]}),e.installed&&a.jsxs("div",{className:"diagnose-tool-install-all",children:[a.jsx("div",{className:"diagnose-tool-install-title",children:"Installation commands:"}),a.jsxs("div",{className:"diagnose-tool-install-item",children:[a.jsx("span",{className:"diagnose-tool-install-os",children:"macOS:"}),a.jsx("code",{children:e.install_macos})]}),a.jsxs("div",{className:"diagnose-tool-install-item",children:[a.jsx("span",{className:"diagnose-tool-install-os",children:"Linux:"}),a.jsx("code",{children:e.install_linux})]}),a.jsxs("div",{className:"diagnose-tool-install-item",children:[a.jsx("span",{className:"diagnose-tool-install-os",children:"Windows:"}),a.jsx("code",{children:e.install_windows})]})]})]})]})}async function Z1(){const e=await fetch("/api/encrypt/status");if(!e.ok)throw new Error("Failed to fetch encryption key status");return e.json()}async function WM(){const e=await fetch("/api/encrypt/generate",{method:"POST"});if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.error||"Failed to generate encryption keys")}return e.json()}function VM(){const[e,t]=y.useState(null),[i,r]=y.useState([]),[l,c]=y.useState(!0),[u,d]=y.useState(!1),[m,f]=y.useState(null),[v,_]=y.useState(""),[S,x]=y.useState(!1),[b,C]=y.useState(null),T=()=>{c(!0),f(null),Promise.all([Z1(),Pm()]).then(([E,z])=>{t(E),r(z),c(!1)}).catch(E=>{f(E.message),c(!1)})};y.useEffect(()=>{T()},[]);const k=async()=>{d(!0),f(null);try{const E=await WM();t(E)}catch(E){f(E instanceof Error?E.message:String(E))}d(!1)},R=async()=>{const E=v.trim();if(E){x(!0),C(null);try{await DM(E),_("");const z=await Pm();r(z)}catch(z){C(z instanceof Error?z.message:String(z))}x(!1)}},N=async()=>{C(null);try{const E=await W1();_(E)}catch(E){C(E instanceof Error?E.message:String(E))}};return a.jsxs("div",{className:"diagnose-section",children:[a.jsx("h3",{className:"diagnose-section-title",children:"Security"}),l?a.jsx("div",{className:"diagnose-loading",children:"Checking security status..."}):m?a.jsx("div",{className:"diagnose-error",children:m}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"diagnose-security-card",children:[a.jsxs("div",{className:"diagnose-security-header",children:[a.jsx("span",{className:"diagnose-security-status",children:i.length>0?"":""}),a.jsxs("div",{className:"diagnose-security-info",children:[a.jsx("span",{className:"diagnose-security-label",children:"Server Credentials"}),a.jsx("span",{className:"diagnose-security-desc",children:i.length>0?`${i.length} token(s) configured for server authentication.`:"No credentials configured. Server authentication may not work."})]})]}),i.length>0&&a.jsx("div",{className:"diagnose-security-credentials",children:i.map((E,z)=>a.jsx("div",{className:"diagnose-security-credential-row",children:a.jsx("code",{className:"diagnose-security-credential-value",children:E.masked})},z))}),a.jsxs("div",{className:"diagnose-security-add-token",children:[a.jsx("input",{type:"text",className:"diagnose-security-token-input",placeholder:"Enter token or generate one...",value:v,onChange:E=>_(E.target.value),disabled:S}),a.jsxs("div",{className:"diagnose-security-token-actions",children:[a.jsx("button",{className:"diagnose-security-btn",onClick:R,disabled:S||!v.trim(),children:S?"Adding...":"Add Token"}),a.jsx("button",{className:"diagnose-security-btn diagnose-security-btn--secondary",onClick:N,disabled:S,children:"Generate Random"})]}),b&&a.jsx("div",{className:"diagnose-security-error",children:b})]})]}),e&&a.jsxs("div",{className:"diagnose-security-card",children:[a.jsxs("div",{className:"diagnose-security-header",children:[a.jsx("span",{className:"diagnose-security-status",children:e.valid?"":e.exists?"":""}),a.jsxs("div",{className:"diagnose-security-info",children:[a.jsx("span",{className:"diagnose-security-label",children:"Encryption Key Pair"}),a.jsx("span",{className:"diagnose-security-desc",children:e.valid?"RSA key pair is valid and available for encrypting sensitive data in transit.":e.exists?"Key files found but validation failed. Regenerate to fix.":"No encryption key pair found. Generate one to enable secure data transfer."})]})]}),e.error&&a.jsx("div",{className:"diagnose-security-error",children:e.error}),a.jsxs("div",{className:"diagnose-security-paths",children:[a.jsxs("div",{className:"diagnose-security-path-row",children:[a.jsx("span",{className:"diagnose-security-path-label",children:"Private key:"}),a.jsx("code",{className:"diagnose-security-path-value",children:e.private_key_path})]}),a.jsxs("div",{className:"diagnose-security-path-row",children:[a.jsx("span",{className:"diagnose-security-path-label",children:"Public key:"}),a.jsx("code",{className:"diagnose-security-path-value",children:e.public_key_path})]})]}),a.jsx("button",{className:"diagnose-security-btn",onClick:k,disabled:u,children:u?"Generating...":e.valid?"Regenerate Key Pair":e.exists?"Fix: Regenerate Key Pair":"Generate Key Pair"})]})]})]})}const Ni={Cloudflare:"cloudflare",Ngrok:"ngrok"};async function As(){const e=await fetch("/api/domains");if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.error||"Failed to fetch domains")}return e.json()}async function Lf(e){const t=await fetch("/api/domains",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const i=await t.json().catch(()=>({}));throw new Error(i.error||"Failed to save domains")}}async function GM(){const e=await fetch("/api/domains/cloudflare-status");if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.error||"Failed to fetch cloudflare status")}return e.json()}async function YM(e){const t=await fetch("/api/domains/tunnel/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domain:e})});if(!t.ok){const i=await t.json().catch(()=>({}));throw new Error(i.error||"Failed to start tunnel")}return t}async function Lu(e){const t=e?`?current=${encodeURIComponent(e)}`:"",i=await fetch(`/api/domains/random-subdomain${t}`);if(!i.ok){const l=await i.json().catch(()=>({}));throw new Error(l.error||"Failed to generate domain")}return(await i.json()).domain}async function XM(e){const t=await fetch("/api/domains/tunnel/stop",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({domain:e})});if(!t.ok){const i=await t.json().catch(()=>({}));throw new Error(i.error||"Failed to stop tunnel")}}async function JM(){const e=await fetch("/api/domains/tunnel-name");if(!e.ok){const i=await e.json().catch(()=>({}));throw new Error(i.error||"Failed to fetch tunnel name")}return(await e.json()).tunnel_name||""}async function ZM(e){const t=await fetch("/api/domains/tunnel-name",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tunnel_name:e})});if(!t.ok){const i=await t.json().catch(()=>({}));throw new Error(i.error||"Failed to save tunnel name")}}function QM({entry:e,cfStatus:t,starting:i,onStart:r,onStop:l}){const c=dt();if(e.provider===Ni.Cloudflare&&t){if(!t.installed)return a.jsxs("div",{className:"diagnose-webaccess-status diagnose-webaccess-status--warning",children:[a.jsx("span",{className:"diagnose-webaccess-status-icon",children:""}),a.jsx("span",{children:"cloudflared not installed. Go to System Diagnostics to install."})]});if(!t.authenticated)return a.jsxs("div",{className:"diagnose-webaccess-status diagnose-webaccess-status--warning",children:[a.jsx("span",{className:"diagnose-webaccess-status-icon",children:""}),a.jsx("span",{children:"cloudflared not authenticated."}),a.jsx("button",{className:"diagnose-webaccess-link-btn",onClick:()=>c("cloudflare"),children:"Go to Cloudflare Settings"})]})}if(e.provider===Ni.Ngrok)return a.jsxs("div",{className:"diagnose-webaccess-status diagnose-webaccess-status--warning",children:[a.jsx("span",{className:"diagnose-webaccess-status-icon",children:""}),a.jsx("span",{children:"ngrok is not supported yet"})]});switch(e.status){case"active":return a.jsxs("div",{className:"diagnose-webaccess-status diagnose-webaccess-status--active",children:[a.jsx("span",{className:"diagnose-webaccess-status-icon",children:""}),a.jsx("a",{href:e.tunnel_url||`https://${e.domain}`,target:"_blank",rel:"noopener noreferrer",className:"diagnose-webaccess-tunnel-url",children:e.tunnel_url||`https://${e.domain}`}),a.jsx("button",{className:"diagnose-webaccess-stop-btn",onClick:()=>l(e.domain),children:"Stop"})]});case"connecting":return a.jsxs("div",{className:"diagnose-webaccess-status diagnose-webaccess-status--connecting",children:[a.jsx("span",{className:"diagnose-webaccess-status-icon diagnose-webaccess-spinner"}),a.jsx("span",{children:"Connecting..."})]});case"error":return a.jsxs("div",{className:"diagnose-webaccess-status diagnose-webaccess-status--error",children:[a.jsx("span",{className:"diagnose-webaccess-status-icon",children:""}),a.jsx("span",{children:e.error||"Tunnel error"}),a.jsx("button",{className:"diagnose-webaccess-start-btn",onClick:()=>r(e.domain),disabled:i,children:i?"Starting...":"Retry"})]});default:return a.jsxs("div",{className:"diagnose-webaccess-status diagnose-webaccess-status--stopped",children:[a.jsx("span",{className:"diagnose-webaccess-status-icon",children:i?a.jsx("span",{className:"diagnose-webaccess-spinner"}):""}),a.jsx("span",{children:i?"Starting...":"Stopped"}),a.jsx("button",{className:"diagnose-webaccess-start-btn",onClick:()=>r(e.domain),disabled:i,children:i?"Starting...":"Start"})]})}}function e5({entry:e,cfStatus:t,displayTunnelName:i,starting:r,startingDomain:l,startLogs:c,startDone:u,startError:d,isLast:m,onStart:f,onStop:v,onEdit:_}){const S=c.length>0&&(l===e.domain||!l&&m&&(u||d));return a.jsxs("div",{className:"diagnose-webaccess-row",children:[a.jsxs("div",{className:"diagnose-webaccess-row-domain",children:[a.jsx("a",{href:e.domain.startsWith("http://")||e.domain.startsWith("https://")?e.domain:`https://${e.domain}`,target:"_blank",rel:"noopener noreferrer",className:"diagnose-webaccess-domain-link",children:e.domain}),a.jsx("button",{className:"diagnose-webaccess-edit-btn",onClick:_,title:"Edit",children:a.jsx(gM,{})})]}),e.provider===Ni.Cloudflare&&a.jsxs("div",{className:"diagnose-webaccess-tunnel-name-view",children:[a.jsx("span",{className:"diagnose-webaccess-provider-badge",children:e.provider}),a.jsxs("span",{className:"diagnose-webaccess-tunnel-name-value",children:["tunnel: ",i]})]}),e.provider!==Ni.Cloudflare&&a.jsx("div",{className:"diagnose-webaccess-row-header",children:a.jsx("span",{className:"diagnose-webaccess-provider-badge",children:e.provider})}),a.jsx(QM,{entry:e,cfStatus:t,starting:r,onStart:f,onStop:v}),S&&a.jsxs("div",{className:"diagnose-webaccess-tunnel-logs",children:[a.jsx("span",{className:"diagnose-webaccess-tunnel-logs-label",children:r?"Starting tunnel...":u?"Tunnel started":d?"Tunnel start failed":""}),a.jsx(ii,{lines:c,pending:r,pendingMessage:"Starting tunnel...",maxHeight:200})]})]})}function t5({entry:e,tunnelName:t,onSave:i,onRemove:r,onCancel:l,onError:c}){const[u,d]=y.useState(e.domain),[m,f]=y.useState(e.provider),[v,_]=y.useState(t),S=()=>{u.trim()&&i({domain:u.trim(),provider:m},v)};return a.jsxs("div",{className:"diagnose-webaccess-row diagnose-webaccess-row--editing",children:[a.jsxs("div",{className:"diagnose-webaccess-add-row",children:[a.jsx("label",{className:"diagnose-webaccess-add-label",children:"Domain"}),a.jsx("input",{type:"text",className:"diagnose-webaccess-input",placeholder:"e.g. myapp.example.com",value:u,onChange:x=>d(x.target.value)}),a.jsx("button",{type:"button",className:"diagnose-webaccess-generate-btn",onClick:async()=>{try{const x=await Lu(u||void 0);d(x)}catch(x){c(x instanceof Error?x.message:String(x))}},children:"Generate Random Subdomain"})]}),a.jsxs("div",{className:"diagnose-webaccess-add-row",children:[a.jsx("label",{className:"diagnose-webaccess-add-label",children:"Provider"}),a.jsxs("select",{className:"diagnose-webaccess-select",value:m,onChange:x=>f(x.target.value),children:[a.jsx("option",{value:Ni.Cloudflare,children:"Cloudflare"}),a.jsx("option",{value:Ni.Ngrok,children:"ngrok (not supported)"})]})]}),m===Ni.Cloudflare&&a.jsxs("div",{className:"diagnose-webaccess-add-row",children:[a.jsx("label",{className:"diagnose-webaccess-add-label",children:"Cloudflare Tunnel Name"}),a.jsx("input",{type:"text",className:"diagnose-webaccess-input",placeholder:"auto (derived from domain)",value:v,onChange:x=>_(x.target.value)}),a.jsx("span",{className:"diagnose-webaccess-tunnel-name-hint",children:"Shared Cloudflare named tunnel identifier. Default: auto (derived from domain)"})]}),a.jsxs("div",{className:"diagnose-webaccess-edit-actions",children:[a.jsx("button",{className:"diagnose-webaccess-add-btn",onClick:S,disabled:!u.trim(),children:"Save"}),a.jsx("button",{className:"diagnose-webaccess-cancel-btn",onClick:l,children:"Cancel"}),a.jsx("button",{className:"diagnose-webaccess-remove-btn",onClick:r,children:"Remove"})]})]})}function n5({onAdd:e,onCancel:t,onError:i}){const[r,l]=y.useState(""),[c,u]=y.useState(Ni.Cloudflare),d=()=>{r.trim()&&e({domain:r.trim(),provider:c})};return a.jsxs("div",{className:"diagnose-webaccess-add",children:[a.jsxs("div",{className:"diagnose-webaccess-add-row",children:[a.jsx("label",{className:"diagnose-webaccess-add-label",children:"Domain"}),a.jsx("input",{type:"text",className:"diagnose-webaccess-input",placeholder:"e.g. myapp.example.com",value:r,onChange:m=>l(m.target.value)}),a.jsx("button",{type:"button",className:"diagnose-webaccess-generate-btn",onClick:async()=>{try{const m=await Lu(r||void 0);l(m)}catch(m){i(m instanceof Error?m.message:String(m))}},children:"Generate Random Subdomain"})]}),a.jsxs("div",{className:"diagnose-webaccess-add-row",children:[a.jsx("label",{className:"diagnose-webaccess-add-label",children:"Provider"}),a.jsxs("select",{className:"diagnose-webaccess-select",value:c,onChange:m=>u(m.target.value),children:[a.jsx("option",{value:Ni.Cloudflare,children:"Cloudflare"}),a.jsx("option",{value:Ni.Ngrok,children:"ngrok (not supported)"})]})]}),a.jsxs("div",{className:"diagnose-webaccess-add-actions",children:[a.jsx("button",{className:"diagnose-webaccess-add-btn",onClick:d,disabled:!r.trim(),children:"Add Domain"}),a.jsx("button",{className:"diagnose-webaccess-cancel-btn",onClick:t,children:"Cancel"})]})]})}function i5(){const[e,t]=y.useState([]),[i,r]=y.useState(null),[l,c]=y.useState(!0),[u,d]=y.useState(null),[m,f]=y.useState(null),[v,_]=y.useState(""),[S,x]=y.useState(null),[b,C]=y.useState([]),[T,k]=y.useState(!1),[R,N]=y.useState(!1),[E,z]=y.useState(!1),B=()=>{c(!0),d(null),Promise.all([As(),JM()]).then(([j,A])=>{t(j.domains??[]),_(A),c(!1)}).catch(j=>{d(j.message),c(!1)}),GM().then(j=>r(j)).catch(()=>{})};y.useEffect(()=>{if(!e.some(D=>D.status==="connecting"))return;const A=setInterval(()=>{As().then(D=>t(D.domains??[])).catch(()=>{})},3e3);return()=>clearInterval(A)},[e]),y.useEffect(()=>{B()},[]);const I=async(j,A,D)=>{d(null);try{const $=e.map(ne=>({domain:ne.domain,provider:ne.provider}));$[j]=A,await Lf({domains:$}),D!==v&&(await ZM(D),_(D));const W=await As();t(W.domains??[]),f(null)}catch($){d($ instanceof Error?$.message:String($))}},q=async j=>{d(null);try{const D=e.map(W=>({domain:W.domain,provider:W.provider})).filter((W,ne)=>ne!==j);await Lf({domains:D});const $=await As();t($.domains??[]),f(null)}catch(A){d(A instanceof Error?A.message:String(A))}},F=async j=>{d(null);try{const A=e.map($=>({domain:$.domain,provider:$.provider}));A.push(j),await Lf({domains:A});const D=await As();t(D.domains??[]),z(!1)}catch(A){d(A instanceof Error?A.message:String(A))}},V=async j=>{d(null),x(j),C([]),k(!1),N(!1);try{const A=await YM(j);await Hs(A,{onLog:D=>C($=>[...$,D]),onError:D=>{C($=>[...$,D]),N(!0)},onDone:async D=>{C(W=>[...W,{text:D}]),k(!0);const $=await As();t($.domains??[])}})}catch(A){C(D=>[...D,{text:String(A),error:!0}]),N(!0)}x(null)},G=async j=>{d(null);try{await XM(j);const A=await As();t(A.domains??[])}catch(A){d(A instanceof Error?A.message:String(A))}},Y=j=>S===j,M=v||"(auto)";return a.jsxs("div",{className:"diagnose-section",children:[a.jsx("h3",{className:"diagnose-section-title",children:"Web Access"}),l?a.jsx("div",{className:"diagnose-loading",children:"Loading domains..."}):a.jsxs("div",{className:"diagnose-webaccess-card",children:[e.length===0&&!E&&a.jsx("div",{className:"diagnose-webaccess-empty",children:"No domains configured. Add one to enable public access."}),e.length>0&&a.jsx("div",{className:"diagnose-webaccess-list",children:e.map((j,A)=>m===A?a.jsx(t5,{entry:{domain:j.domain,provider:j.provider},tunnelName:v,onSave:(D,$)=>I(A,D,$),onRemove:()=>q(A),onCancel:()=>f(null),onError:d},A):a.jsx(e5,{entry:j,cfStatus:i,displayTunnelName:M,starting:Y(j.domain),startingDomain:S,startLogs:b,startDone:T,startError:R,isLast:A===e.length-1,onStart:V,onStop:G,onEdit:()=>f(A)},j.domain))}),u&&a.jsx("div",{className:"diagnose-security-error",children:u}),E?a.jsx(n5,{onAdd:F,onCancel:()=>z(!1),onError:d}):a.jsx("button",{className:"diagnose-webaccess-add-toggle",onClick:()=>z(!0),children:"+ Add Domain"})]})]})}async function or(){const e=await fetch("/api/exposed-urls");if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.error||"Failed to fetch exposed URLs")}return e.json()}async function s5(e,t){const i=await fetch("/api/exposed-urls/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({external_domain:e,internal_url:t})});if(!i.ok){const r=await i.json().catch(()=>({}));throw new Error(r.error||"Failed to add exposed URL")}return i.json()}async function r5(e,t,i){const r=await fetch("/api/exposed-urls/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,external_domain:t,internal_url:i})});if(!r.ok){const l=await r.json().catch(()=>({}));throw new Error(l.error||"Failed to update exposed URL")}return r.json()}async function a5(e){const t=await fetch("/api/exposed-urls/delete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});if(!t.ok){const i=await t.json().catch(()=>({}));throw new Error(i.error||"Failed to delete exposed URL")}}async function l5(){const e=await fetch("/api/exposed-urls/status");if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.error||"Failed to fetch Cloudflare status")}return e.json()}async function o5(e){const t=await fetch("/api/exposed-urls/tunnel/start",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});if(!t.ok){const i=await t.json().catch(()=>({}));throw new Error(i.error||"Failed to start tunnel")}}async function c5(e){const t=await fetch("/api/exposed-urls/tunnel/stop",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});if(!t.ok){const i=await t.json().catch(()=>({}));throw new Error(i.error||"Failed to stop tunnel")}}function u5(){const[e,t]=y.useState([]),[i,r]=y.useState(null),[l,c]=y.useState(!0),[u,d]=y.useState(null),[m,f]=y.useState(!1),[v,_]=y.useState(""),[S,x]=y.useState(""),[b,C]=y.useState(null),[T,k]=y.useState(""),[R,N]=y.useState(""),E=async()=>{c(!0),d(null);try{const[M,j]=await Promise.all([or(),l5()]);t(M),r(j)}catch(M){d(M instanceof Error?M.message:String(M))}finally{c(!1)}};y.useEffect(()=>{E()},[]),y.useEffect(()=>{if(!e.some(A=>A.status==="connecting"||A.status==="active"))return;const j=setInterval(()=>{or().then(A=>t(A)).catch(()=>{})},3e3);return()=>clearInterval(j)},[e]);const z=async M=>{if(M.preventDefault(),!(!v||!S)){d(null);try{await s5(v,S);const j=await or();t(j),_(""),x(""),f(!1)}catch(j){d(j instanceof Error?j.message:String(j))}}},B=M=>{C(M.id),k(M.external_domain),N(M.internal_url)},I=async M=>{if(M.preventDefault(),!(!b||!T||!R)){d(null);try{await r5(b,T,R);const j=await or();t(j),C(null)}catch(j){d(j instanceof Error?j.message:String(j))}}},q=async M=>{if(confirm("Are you sure you want to delete this exposed URL?")){d(null);try{await a5(M);const j=await or();t(j)}catch(j){d(j instanceof Error?j.message:String(j))}}},F=async M=>{d(null);try{await o5(M);const j=await or();t(j)}catch(j){d(j instanceof Error?j.message:String(j))}},V=async M=>{d(null);try{await c5(M);const j=await or();t(j)}catch(j){d(j instanceof Error?j.message:String(j))}},G=M=>{switch(M){case"active":return"status-active";case"connecting":return"status-connecting";case"error":return"status-error";default:return"status-stopped"}},Y=M=>{switch(M){case"active":return"Active";case"connecting":return"Connecting...";case"error":return"Error";default:return"Stopped"}};return a.jsxs("div",{className:"diagnose-section",children:[a.jsx("h3",{className:"diagnose-section-title",children:"Exposed URLs"}),l?a.jsx("div",{className:"diagnose-loading",children:"Loading exposed URLs..."}):a.jsxs("div",{className:"exposed-urls-card",children:[a.jsxs("div",{className:"exposed-urls-cf-status",children:[a.jsx("span",{className:"exposed-urls-cf-label",children:"Cloudflare Status:"}),i?a.jsx("span",{className:`exposed-urls-cf-badge ${i.installed?"installed":"not-installed"}`,children:i.installed?i.authenticated?"Installed & Authenticated":"Installed (Not Authenticated)":"Not Installed"}):a.jsx("span",{className:"exposed-urls-cf-badge unknown",children:"Unknown"})]}),e.length===0&&!m&&a.jsx("div",{className:"exposed-urls-empty",children:"No exposed URLs configured. Add one to expose internal services via Cloudflare tunnel."}),e.length>0&&a.jsx("div",{className:"exposed-urls-list",children:e.map(M=>a.jsx("div",{className:"exposed-url-item",children:b===M.id?a.jsxs("form",{onSubmit:I,className:"exposed-url-edit-form",children:[a.jsxs("div",{className:"exposed-url-field",children:[a.jsx("label",{children:"External Domain:"}),a.jsx("input",{type:"text",value:T,onChange:j=>k(j.target.value),placeholder:"e.g., myapp.example.com",required:!0})]}),a.jsxs("div",{className:"exposed-url-field",children:[a.jsx("label",{children:"Internal URL:"}),a.jsx("input",{type:"text",value:R,onChange:j=>N(j.target.value),placeholder:"e.g., http://localhost:3000",required:!0})]}),a.jsxs("div",{className:"exposed-url-actions",children:[a.jsx("button",{type:"submit",className:"exposed-url-btn save",children:"Save"}),a.jsx("button",{type:"button",className:"exposed-url-btn cancel",onClick:()=>C(null),children:"Cancel"})]})]}):a.jsxs("div",{className:"exposed-url-view",children:[a.jsxs("div",{className:"exposed-url-info",children:[a.jsxs("div",{className:"exposed-url-row",children:[a.jsx("span",{className:"exposed-url-label",children:"External:"}),a.jsx("a",{href:`https://${M.external_domain}`,target:"_blank",rel:"noopener noreferrer",className:"exposed-url-link",children:M.external_domain})]}),a.jsxs("div",{className:"exposed-url-row",children:[a.jsx("span",{className:"exposed-url-label",children:"Internal:"}),a.jsx("span",{className:"exposed-url-value",children:M.internal_url})]}),a.jsxs("div",{className:"exposed-url-row",children:[a.jsx("span",{className:"exposed-url-label",children:"Status:"}),a.jsx("span",{className:`exposed-url-status ${G(M.status)}`,children:Y(M.status)})]}),M.tunnel_url&&a.jsxs("div",{className:"exposed-url-row",children:[a.jsx("span",{className:"exposed-url-label",children:"Tunnel:"}),a.jsx("a",{href:M.tunnel_url,target:"_blank",rel:"noopener noreferrer",className:"exposed-url-link",children:M.tunnel_url})]}),M.error&&a.jsxs("div",{className:"exposed-url-row",children:[a.jsx("span",{className:"exposed-url-label",children:"Error:"}),a.jsx("span",{className:"exposed-url-error",children:M.error})]})]}),a.jsxs("div",{className:"exposed-url-actions",children:[M.status==="active"?a.jsx("button",{className:"exposed-url-btn stop",onClick:()=>V(M.id),children:"Stop"}):a.jsx("button",{className:"exposed-url-btn start",onClick:()=>F(M.id),disabled:!i?.installed||!i?.authenticated,children:"Start"}),a.jsx("button",{className:"exposed-url-btn edit",onClick:()=>B(M),children:"Edit"}),a.jsx("button",{className:"exposed-url-btn delete",onClick:()=>q(M.id),children:"Delete"})]})]})},M.id))}),u&&a.jsx("div",{className:"exposed-urls-error",children:u}),m?a.jsxs("form",{onSubmit:z,className:"exposed-urls-add-form",children:[a.jsx("h4",{children:"Add New Exposed URL"}),a.jsxs("div",{className:"exposed-url-field",children:[a.jsx("label",{children:"External Domain:"}),a.jsx("input",{type:"text",value:v,onChange:M=>_(M.target.value),placeholder:"e.g., myapp.example.com",required:!0}),a.jsx("small",{children:"The domain that will be exposed publicly"})]}),a.jsxs("div",{className:"exposed-url-field",children:[a.jsx("label",{children:"Internal URL:"}),a.jsx("input",{type:"text",value:S,onChange:M=>x(M.target.value),placeholder:"e.g., http://localhost:3000",required:!0}),a.jsx("small",{children:"The internal service URL (can be localhost or any internal address)"})]}),a.jsxs("div",{className:"exposed-urls-add-actions",children:[a.jsx("button",{type:"submit",className:"exposed-url-btn save",children:"Add URL"}),a.jsx("button",{type:"button",className:"exposed-url-btn cancel",onClick:()=>f(!1),children:"Cancel"})]})]}):a.jsx("button",{className:"exposed-urls-add-toggle",onClick:()=>f(!0),children:"+ Add Exposed URL"})]})]})}const xi={SSHKeys:"ssh-keys",GitHub:"github",GitConfig:"git-config"};function qS(){const e=dt();return a.jsxs("div",{className:"mcc-git-settings",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(".."),children:" Back"}),a.jsx("h2",{children:"Git Settings"})]}),a.jsx(Q1,{})]})}function Q1(){const[e,t]=y.useState(xi.SSHKeys);return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mcc-git-tabs",children:[a.jsx("button",{className:`mcc-git-tab ${e===xi.SSHKeys?"active":""}`,onClick:()=>t(xi.SSHKeys),children:"SSH Keys"}),a.jsx("button",{className:`mcc-git-tab ${e===xi.GitHub?"active":""}`,onClick:()=>t(xi.GitHub),children:"GitHub"}),a.jsx("button",{className:`mcc-git-tab ${e===xi.GitConfig?"active":""}`,onClick:()=>t(xi.GitConfig),children:"Git Config"})]}),a.jsxs("div",{className:"mcc-git-tab-content",children:[e===xi.SSHKeys&&a.jsx(d5,{}),e===xi.GitHub&&a.jsx(f5,{}),e===xi.GitConfig&&a.jsx(m5,{})]})]})}function h5({sshKey:e,onEdit:t,onDelete:i}){const[r,l]=y.useState(!1),[c,u]=y.useState([]),[d,m]=y.useState(!1),[f,v]=y.useState(null),_=async()=>{l(!0),u([]),m(!1),v(null);try{const b=await Ba(e.privateKey),C=await AM(e.host,b);await Hs(C,{onLog:T=>u(k=>[...k,T]),onError:T=>u(k=>[...k,T]),onDone:(T,k)=>{u(R=>[...R,{text:T}]),m(!0),v(k.success==="true")}})}catch(b){b instanceof Ma?u([{text:"Server encryption keys not configured. Ask the server admin to run: go run ./script/crypto/gen",error:!0}]):u(C=>[...C,{text:String(b),error:!0}]),m(!0),v(!1)}l(!1)},S=()=>{const b=new Blob([e.privateKey],{type:"text/plain"}),C=URL.createObjectURL(b),T=document.createElement("a");T.href=C;const k=(e.name||"id_rsa").replace(/[^a-zA-Z0-9_.-]/g,"_");T.download=k,document.body.appendChild(T),T.click(),document.body.removeChild(T),URL.revokeObjectURL(C)},x=c.length>0;return a.jsxs("div",{className:"mcc-ssh-key-card",children:[a.jsxs("div",{className:"mcc-ssh-key-header",children:[a.jsx(vu,{}),a.jsx("span",{className:"mcc-ssh-key-name",children:e.name}),a.jsx("span",{className:"mcc-ssh-key-host",children:e.host})]}),a.jsxs("div",{className:"mcc-ssh-key-actions",children:[a.jsx("button",{className:"mcc-port-action-btn",onClick:_,disabled:r,children:r?"Testing...":"Test"}),a.jsx("button",{className:"mcc-port-action-btn",onClick:t,children:"Edit"}),a.jsx("button",{className:"mcc-port-action-btn mcc-port-stop",onClick:i,children:"Delete"})]}),x&&a.jsxs("div",{className:"mcc-ssh-test-logs",children:[d&&f!==null&&a.jsx("div",{className:`mcc-ssh-test-result ${f?"mcc-ssh-test-success":"mcc-ssh-test-error"}`,children:f?"Connection successful":"Connection failed"}),a.jsx(ii,{lines:c,pending:r,pendingMessage:"Testing SSH connection...",maxHeight:150})]}),a.jsx("div",{className:"mcc-ssh-key-extra-actions",children:a.jsx("button",{className:"mcc-port-action-btn",onClick:S,children:"Download"})})]})}function d5(){const[e,t]=y.useState(()=>hi()),[i,r]=y.useState(!1),[l,c]=y.useState(null),[u,d]=y.useState(""),[m,f]=y.useState("github.com"),[v,_]=y.useState(""),S=y.useRef(null),x=rt(e),b=()=>{d(""),f("github.com"),_(""),r(!1),c(null)},C=()=>{if(!u.trim()||!m.trim()||!v.trim())return;const R=x.current;let N;if(l)N=R.map(E=>E.id===l.id?{...E,name:u.trim(),host:m.trim(),privateKey:v.trim()}:E);else{const E={id:Date.now().toString(36)+Math.random().toString(36).slice(2,6),name:u.trim(),host:m.trim(),privateKey:v.trim(),createdAt:new Date().toISOString()};N=[...R,E]}_u(N),t(N),b()},T=R=>{c(R),d(R.name),f(R.host),_(R.privateKey),r(!0)},k=R=>{const N=x.current.filter(E=>E.id!==R);_u(N),t(N)};return a.jsxs("div",{className:"mcc-ssh-keys-panel",children:[a.jsx("p",{className:"mcc-git-desc",children:"SSH private keys are stored in your browser's local storage. They are sent to the server only during git clone operations."}),e.length>0&&a.jsx("div",{className:"mcc-ssh-key-list",children:e.map(R=>a.jsx(h5,{sshKey:R,onEdit:()=>T(R),onDelete:()=>k(R.id)},R.id))}),e.length===0&&!i&&a.jsx("div",{className:"mcc-git-empty",children:"No SSH keys configured. Add one to use SSH-based git operations."}),i?a.jsxs("div",{className:"mcc-add-port-form",children:[a.jsxs("div",{className:"mcc-add-port-header",children:[a.jsx("span",{children:l?"Edit SSH Key":"Add SSH Key"}),a.jsx("button",{className:"mcc-close-btn",onClick:b,children:""})]}),a.jsxs("div",{className:"mcc-git-form-fields",children:[a.jsxs("div",{className:"mcc-form-field",children:[a.jsx("label",{children:"Name"}),a.jsx("input",{type:"text",placeholder:"My GitHub Key",value:u,onChange:R=>d(R.target.value)})]}),a.jsxs("div",{className:"mcc-form-field",children:[a.jsx("label",{children:"Host"}),a.jsx("input",{type:"text",placeholder:"github.com",value:m,onChange:R=>f(R.target.value)})]}),a.jsxs("div",{className:"mcc-form-field",children:[a.jsx("label",{children:"Private Key"}),a.jsx("textarea",{className:"mcc-ssh-key-textarea",placeholder:`-----BEGIN OPENSSH PRIVATE KEY-----
...
-----END OPENSSH PRIVATE KEY-----`,value:v,onChange:R=>_(R.target.value),rows:6}),a.jsx("input",{ref:S,type:"file",style:{display:"none"},onChange:R=>{const N=R.target.files?.[0];if(!N)return;const E=new FileReader;E.onload=()=>{_(E.result),u.trim()||d(N.name.replace(/\.[^.]+$/,""))},E.readAsText(N),S.current&&(S.current.value="")}}),a.jsx("button",{type:"button",className:"mcc-port-action-btn mcc-ssh-upload-btn",onClick:()=>S.current?.click(),children:"Upload from file"})]})]}),a.jsx("button",{className:"mcc-forward-btn",onClick:C,children:l?"Update Key":"Save Key"})]}):a.jsxs("button",{className:"mcc-add-port-btn",onClick:()=>r(!0),children:[a.jsx(_o,{}),a.jsx("span",{children:"Add SSH Key"})]})]})}function f5(){const[e,t]=y.useState(null),[i,r]=y.useState(!0),[l,c]=y.useState(""),[u,d]=y.useState(""),[m,f]=y.useState(!1),[v,_]=y.useState(""),[S,x]=y.useState(()=>Aa()),[b,C]=y.useState(!1),T=rt(S);y.useEffect(()=>{LM().then(z=>{t(z),z.configured&&z.client_id&&c(z.client_id),r(!1)}).catch(()=>r(!1))},[]),y.useEffect(()=>{const B=new URLSearchParams(window.location.search).get("code");if(!B)return;const I=new URL(window.location.href);I.searchParams.delete("code"),I.searchParams.delete("state"),window.history.replaceState({},"",I.toString()),BM(B).then(q=>{q.access_token?(yu(q.access_token),x(q.access_token)):q.error&&_(q.error)}).catch(q=>_(String(q)))},[]);const k=async()=>{if(!(!l.trim()||!u.trim())){f(!0),_("");try{const z=await MM(l.trim(),u.trim()),B=await z.json();z.ok?(t({configured:!0,client_id:l.trim()}),C(!1),d("")):_(B.error||"Failed to save")}catch(z){_(String(z))}f(!1)}},R=()=>{if(!e?.client_id)return;const z=window.location.origin+"/?tab=home&view=git-settings",I=`https://github.com/login/oauth/authorize?client_id=${e.client_id}&redirect_uri=${encodeURIComponent(z)}&scope=repo`;window.location.href=I},N=()=>{yu(""),x("")};if(i)return a.jsx("div",{className:"mcc-git-loading",children:"Loading GitHub configuration..."});const E=T.current;return a.jsxs("div",{className:"mcc-github-panel",children:[a.jsxs("div",{className:"mcc-git-section",children:[a.jsxs("div",{className:"mcc-git-section-header",children:[a.jsx("h3",{children:"OAuth App Configuration"}),e?.configured&&!b&&a.jsx("button",{className:"mcc-port-action-btn",onClick:()=>C(!0),children:"Edit"})]}),e?.configured&&!b?a.jsxs("div",{className:"mcc-git-config-status",children:[a.jsx("span",{className:"mcc-git-status-dot mcc-git-status-ok"}),a.jsxs("span",{children:["Configured (Client ID: ",e.client_id?.slice(0,8),"...)"]})]}):a.jsxs("div",{className:"mcc-add-port-form",children:[a.jsxs("p",{className:"mcc-git-desc",children:["Create a GitHub OAuth App at"," ",a.jsx("a",{href:"https://github.com/settings/developers",target:"_blank",rel:"noopener noreferrer",children:"github.com/settings/developers"}),". Set the callback URL to: ",a.jsxs("code",{children:[window.location.origin,"/?tab=home&view=git-settings"]})]}),a.jsxs("div",{className:"mcc-git-form-fields",children:[a.jsxs("div",{className:"mcc-form-field",children:[a.jsx("label",{children:"Client ID"}),a.jsx("input",{type:"text",placeholder:"Ov23li...",value:l,onChange:z=>c(z.target.value)})]}),a.jsxs("div",{className:"mcc-form-field",children:[a.jsx("label",{children:"Client Secret"}),a.jsx("input",{type:"password",placeholder:"Enter client secret",value:u,onChange:z=>d(z.target.value)})]})]}),v&&a.jsx("div",{className:"mcc-ports-error",children:v}),a.jsxs("div",{className:"mcc-git-form-actions",children:[a.jsx("button",{className:"mcc-forward-btn",onClick:k,disabled:m,children:m?"Saving...":"Save Configuration"}),b&&a.jsx("button",{className:"mcc-port-action-btn",onClick:()=>C(!1),children:"Cancel"})]})]})]}),a.jsxs("div",{className:"mcc-git-section",children:[a.jsx("h3",{children:"GitHub Account"}),E?a.jsxs("div",{className:"mcc-git-logged-in",children:[a.jsxs("div",{className:"mcc-git-config-status",children:[a.jsx("span",{className:"mcc-git-status-dot mcc-git-status-ok"}),a.jsx("span",{children:"Logged in to GitHub"})]}),a.jsx("button",{className:"mcc-port-action-btn mcc-port-stop",onClick:N,children:"Logout"})]}):a.jsxs("div",{children:[a.jsx("p",{className:"mcc-git-desc",children:"Login with GitHub to list and clone your repositories."}),a.jsxs("button",{className:"mcc-forward-btn mcc-github-login-btn",onClick:R,disabled:!e?.configured,children:[a.jsx(vM,{}),a.jsx("span",{children:"Login with GitHub"})]}),!e?.configured&&a.jsx("p",{className:"mcc-git-hint",children:"Configure the OAuth App above first."})]})]})]})}function m5(){const[e,t]=y.useState(()=>La()),[i,r]=y.useState(e.name),[l,c]=y.useState(e.email),[u,d]=y.useState(!1),m=()=>{const v={name:i.trim(),email:l.trim()};Tp(v),t(v),d(!0),setTimeout(()=>d(!1),2e3)},f=i.trim()&&l.trim();return a.jsxs("div",{className:"mcc-git-config-panel",children:[a.jsx("p",{className:"mcc-git-desc",children:"Configure your Git user name and email. These will be used for all Git commits."}),a.jsxs("div",{className:"mcc-add-port-form",children:[a.jsxs("div",{className:"mcc-git-form-fields",children:[a.jsxs("div",{className:"mcc-form-field",children:[a.jsx("label",{children:"User Name *"}),a.jsx("input",{type:"text",placeholder:"John Doe",value:i,onChange:v=>r(v.target.value)})]}),a.jsxs("div",{className:"mcc-form-field",children:[a.jsx("label",{children:"Email *"}),a.jsx("input",{type:"email",placeholder:"john@example.com",value:l,onChange:v=>c(v.target.value)})]})]}),u&&a.jsx("div",{className:"mcc-git-success",style:{marginTop:"12px"},children:"Configuration saved successfully!"}),a.jsx("button",{className:"mcc-forward-btn",onClick:m,disabled:!f,style:{marginTop:"16px"},children:"Save Configuration"})]})]})}async function ew(){const e=await fetch("/api/cloudflare/status");if(!e.ok)throw new Error("Failed to fetch cloudflare status");return e.json()}async function p5(){const e=await fetch("/api/cloudflare/login",{method:"POST"});if(!e.ok){const t=await e.text();throw new Error(t||"Login failed")}return e}async function Mf(){const e=await fetch("/api/cloudflare/tunnels");if(!e.ok){const t=await e.text();throw new Error(t||"Failed to fetch tunnels")}return e.json()}async function g5(e){const t=await fetch(`/api/cloudflare/tunnels?name=${encodeURIComponent(e)}`,{method:"POST"});if(!t.ok){const i=await t.text();throw new Error(i||"Failed to create tunnel")}return t.json()}async function v5(e){const t=await fetch(`/api/cloudflare/tunnels?name=${encodeURIComponent(e)}`,{method:"DELETE"});if(!t.ok){const i=await t.text();throw new Error(i||"Failed to delete tunnel")}return t.json()}async function tw(){const e=await fetch("/api/cloudflare/owned-domains");if(!e.ok)throw new Error("Failed to fetch owned domains");return(await e.json()).owned_domains||[]}async function WS(e){const t=await fetch("/api/cloudflare/owned-domains",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({owned_domains:e})});if(!t.ok){const i=await t.text();throw new Error(i||"Failed to save owned domains")}}function nw(){const[e,t]=y.useState(null),[i,r]=y.useState([]),[l,c]=y.useState(!0),[u,d]=y.useState(null),[m,f]=y.useState(!1),[v,_]=y.useState([]),[S,x]=y.useState(null),[b,C]=y.useState(!1),[T,k]=y.useState(""),[R,N]=y.useState(!1),[E,z]=y.useState(null),[B,I]=y.useState(!1),[q,F]=y.useState(null),V=y.useRef(null),[G,Y]=y.useState([]),[M,j]=y.useState(""),[A,D]=y.useState(!1),[$,W]=y.useState(null),[ne,U]=y.useState(!1),P=async()=>{try{const ue=await ew();if(t(ue),ue.authenticated){const Se=await Mf();r(Se||[])}}catch(ue){d(String(ue))}c(!1)},H=async()=>{U(!0);try{const ue=await tw();Y(ue)}catch(ue){W(String(ue))}U(!1)};y.useEffect(()=>{P(),H()},[]);const L=async()=>{f(!0),_([]),x(null);try{const ue=await p5();await Hs(ue,{onLog:Se=>_(Oe=>[...Oe,Se]),onError:Se=>_(Oe=>[...Oe,Se]),onDone:Se=>{_(Oe=>[...Oe,{text:Se}]),P()},onCustom:Se=>{Se.type==="auth_url"&&x(Se.url)}})}catch(ue){_(Se=>[...Se,{text:String(ue),error:!0}])}f(!1)},re=async()=>{if(T.trim()){N(!0);try{await g5(T.trim()),k(""),C(!1);const ue=await Mf();r(ue||[])}catch(ue){d(String(ue))}N(!1)}},me=async ue=>{if(!(!ue||ue.length===0)){I(!0),F(null);try{const Se=new FormData;for(let yt=0;yt<ue.length;yt++)Se.append("files",ue[yt]);const Oe=await fetch("/api/cloudflare/upload",{method:"POST",body:Se}),De=await Oe.json();Oe.ok?(F(De.message),P()):F(`Error: ${De.message||Oe.statusText}`)}catch(Se){F(`Upload failed: ${String(Se)}`)}I(!1),V.current&&(V.current.value="")}},he=async ue=>{if(confirm(`Delete tunnel "${ue}"? This cannot be undone.`)){z(ue);try{await v5(ue);const Se=await Mf();r(Se||[])}catch(Se){d(String(Se))}z(null)}},de=async()=>{if(!M.trim())return;const ue=M.trim();if(G.includes(ue)){W("Domain already exists");return}D(!0),W(null);try{const Se=[...G,ue];await WS(Se),Y(Se),j("")}catch(Se){W(Se instanceof Error?Se.message:String(Se))}D(!1)},oe=async ue=>{if(confirm(`Remove domain "${ue}"?`))try{const Se=G.filter(Oe=>Oe!==ue);await WS(Se),Y(Se)}catch(Se){W(Se instanceof Error?Se.message:String(Se))}},ye=async()=>{try{const ue=await Lu();j(ue)}catch(ue){W(ue instanceof Error?ue.message:String(ue))}};return l?a.jsx("div",{className:"cf-loading",children:"Checking cloudflared status..."}):u?a.jsx("div",{className:"cf-error",children:u}):e?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"cf-section",children:[a.jsx("div",{className:"cf-section-title",children:"Authentication"}),a.jsxs("div",{className:"cf-auth-status",children:[a.jsx("span",{className:`cf-status-dot ${e.authenticated?"ok":"error"}`}),a.jsx("span",{className:"cf-status-text",children:e.authenticated?"Authenticated with Cloudflare":e.error||"Not authenticated"})]}),!e.authenticated&&a.jsx("button",{className:"cf-login-btn",onClick:L,disabled:m,children:m?"Logging in...":"Login"}),S&&a.jsxs("div",{className:"cf-login-url",children:[a.jsx("p",{children:"Open this link to authorize:"}),a.jsx("a",{href:S,target:"_blank",rel:"noopener noreferrer",className:"cf-login-link",children:"Authorize with Cloudflare"})]}),v.length>0&&a.jsx("div",{className:"cf-login-logs",children:a.jsx(ii,{lines:v,pending:m,pendingMessage:"Waiting for authentication...",maxHeight:200})})]}),a.jsxs("div",{className:"cf-section",children:[a.jsx("div",{className:"cf-section-title",children:"Use Existing Authentication"}),a.jsx("p",{className:"cf-section-desc",children:"If you have previously downloaded Cloudflare auth files (cert.pem, tunnel JSON), you can upload them here to reuse."}),a.jsx("input",{ref:V,type:"file",multiple:!0,accept:".pem,.json",style:{display:"none"},onChange:ue=>me(ue.target.files)}),a.jsx("button",{className:"cf-upload-btn",onClick:()=>V.current?.click(),disabled:B,children:B?"Uploading...":"Upload Auth Files"}),q&&a.jsx("div",{className:`cf-upload-message ${q.startsWith("Error")||q.startsWith("Upload failed")?"error":"success"}`,children:q})]}),e.authenticated&&e.cert_files&&e.cert_files.length>0&&a.jsxs("div",{className:"cf-section",children:[a.jsx("div",{className:"cf-section-title",children:"Credential Files"}),a.jsx("div",{className:"cf-cert-list",children:e.cert_files.map(ue=>a.jsxs("div",{className:"cf-cert-card",children:[a.jsxs("div",{className:"cf-cert-info",children:[a.jsx("span",{className:"cf-cert-name",children:ue.name}),a.jsx("span",{className:"cf-cert-path",children:ue.path}),a.jsx("span",{className:"cf-cert-size",children:_5(ue.size)})]}),a.jsx("a",{className:"cf-download-btn",href:`/api/cloudflare/download?name=${encodeURIComponent(ue.name)}`,download:ue.name,children:"Download"})]},ue.name))})]}),e.authenticated&&a.jsxs("div",{className:"cf-section",children:[a.jsxs("div",{className:"cf-section-header",children:[a.jsx("div",{className:"cf-section-title",children:"My Own Domains"}),a.jsx("span",{className:"cf-section-subtitle",children:"Configure domains to use for port forwarding"})]}),a.jsx("p",{className:"cf-section-desc",children:"When Cloudflare is authenticated, these domains will be preferred for port forwarding instead of random subdomains."}),a.jsxs("div",{className:"cf-domain-add-form",children:[a.jsx("input",{className:"cf-input",type:"text",placeholder:"e.g., app.example.com",value:M,onChange:ue=>j(ue.target.value),onKeyDown:ue=>ue.key==="Enter"&&de(),disabled:A}),a.jsx("button",{className:"cf-generate-btn",onClick:ye,disabled:A,title:"Generate random subdomain",children:" Random"}),a.jsx("button",{className:"cf-add-domain-btn",onClick:de,disabled:A||!M.trim(),children:A?"Adding...":"Add Domain"})]}),$&&a.jsx("div",{className:"cf-error-message",children:$}),ne?a.jsx("div",{className:"cf-empty",children:"Loading domains..."}):G.length===0?a.jsx("div",{className:"cf-empty",children:"No custom domains configured."}):a.jsx("div",{className:"cf-domains-list",children:G.map(ue=>a.jsxs("div",{className:"cf-domain-card",children:[a.jsx("div",{className:"cf-domain-info",children:a.jsx("span",{className:"cf-domain-name",children:ue})}),a.jsx("button",{className:"cf-remove-btn",onClick:()=>oe(ue),children:"Remove"})]},ue))})]}),e.authenticated&&a.jsxs("div",{className:"cf-section",children:[a.jsxs("div",{className:"cf-section-header",children:[a.jsx("div",{className:"cf-section-title",children:"Tunnels"}),a.jsx("button",{className:"cf-add-btn",onClick:()=>C(!b),children:b?"Cancel":"+ Create"})]}),b&&a.jsxs("div",{className:"cf-create-form",children:[a.jsx("input",{className:"cf-input",type:"text",placeholder:"Tunnel name",value:T,onChange:ue=>k(ue.target.value),onKeyDown:ue=>ue.key==="Enter"&&re(),disabled:R}),a.jsx("button",{className:"cf-create-btn",onClick:re,disabled:R||!T.trim(),children:R?"Creating...":"Create"})]}),i.length===0?a.jsx("div",{className:"cf-empty",children:"No tunnels configured."}):a.jsx("div",{className:"cf-tunnels-list",children:i.map(ue=>a.jsxs("div",{className:"cf-tunnel-card",children:[a.jsxs("div",{className:"cf-tunnel-info",children:[a.jsx("span",{className:"cf-tunnel-name",children:ue.name}),a.jsxs("span",{className:"cf-tunnel-id",children:[ue.id.slice(0,8),"..."]})]}),a.jsx("button",{className:"cf-delete-btn",onClick:()=>he(ue.name),disabled:E===ue.name,children:E===ue.name?"Deleting...":"Delete"})]},ue.id))})]})]}):null}function VS(){const e=dt();return a.jsxs("div",{className:"cf-settings-view",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(".."),children:""}),a.jsx("h2",{children:"Cloudflare Settings"})]}),a.jsx(nw,{})]})}function _5(e){return e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}async function iw(){const e=await fetch("/api/terminal/config");if(!e.ok){const t=await e.json().catch(()=>({}));throw new Error(t.error||"Failed to load terminal config")}return e.json()}async function y5(e){const t=await fetch("/api/terminal/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const i=await t.json().catch(()=>({}));throw new Error(i.error||"Failed to save terminal config")}}function x5(){const[e,t]=y.useState([]),[i,r]=y.useState(""),[l,c]=y.useState(""),[u,d]=y.useState(""),[m,f]=y.useState(!0),[v,_]=y.useState(!1),[S,x]=y.useState(null),[b,C]=y.useState(!1),[T,k]=y.useState("");y.useEffect(()=>{iw().then(B=>{t(B.extra_paths||[]),r(B.shell||""),c(B.shell_flags?.join(" ")??""),d(B.ps1||""),f(!1)}).catch(B=>{x(B.message),f(!1)})},[]);const R=()=>{const B=T.trim();if(B){if(e.includes(B)){x("This path is already in the list");return}t([...e,B]),k(""),x(null),C(!1)}},N=B=>{t(e.filter((I,q)=>q!==B)),C(!1)},E=async()=>{_(!0),x(null),C(!1);try{const B=l.trim();await y5({extra_paths:e,shell:i.trim()||void 0,shell_flags:B?B.split(/\s+/):void 0,ps1:u||void 0}),C(!0)}catch(B){x(B instanceof Error?B.message:String(B))}_(!1)},z=B=>{B.key==="Enter"&&R()};return a.jsxs("div",{className:"diagnose-section",children:[a.jsx("h3",{className:"diagnose-section-title",children:"Terminal"}),m?a.jsx("div",{className:"diagnose-loading",children:"Loading..."}):a.jsxs("div",{className:"terminal-section-content",children:[a.jsxs("div",{className:"terminal-section-group",children:[a.jsx("label",{className:"terminal-section-label",children:"Default Shell"}),a.jsxs("p",{className:"terminal-section-desc",children:["Shell path or name. Leave empty for default (",a.jsx("code",{children:"bash"}),")."]}),a.jsx("input",{className:"terminal-section-input",type:"text",value:i,onChange:B=>{r(B.target.value),C(!1)},placeholder:"bash"})]}),a.jsxs("div",{className:"terminal-section-group",children:[a.jsx("label",{className:"terminal-section-label",children:"Shell Flags"}),a.jsxs("p",{className:"terminal-section-desc",children:["Space-separated flags passed to the shell. Leave empty for default (",a.jsx("code",{children:"-i"}),")."]}),a.jsx("input",{className:"terminal-section-input",type:"text",value:l,onChange:B=>{c(B.target.value),C(!1)},placeholder:"--login -i"})]}),a.jsxs("div",{className:"terminal-section-group",children:[a.jsx("label",{className:"terminal-section-label",children:"PS1 Prompt"}),a.jsxs("p",{className:"terminal-section-desc",children:["Custom shell prompt. Use ",a.jsx("code",{children:"\\n"})," for newline. Leave empty for shell default."]}),a.jsx("textarea",{className:"terminal-section-input terminal-section-textarea",value:u,onChange:B=>{d(B.target.value),C(!1)},placeholder:"\\\\W $ ",rows:2}),a.jsxs("div",{className:"terminal-section-examples",children:[a.jsx("span",{className:"terminal-section-examples-label",children:"Examples:"}),a.jsx("button",{className:"terminal-section-example-btn",onClick:()=>{d("\\W $ "),C(!1)},children:"Dir name only"}),a.jsx("button",{className:"terminal-section-example-btn",onClick:()=>{d("\\u@\\h:\\w\\n$ "),C(!1)},children:"user@host:path (newline)"}),a.jsx("button",{className:"terminal-section-example-btn",onClick:()=>{d("\\w\\n$ "),C(!1)},children:"Full path (newline)"}),a.jsx("button",{className:"terminal-section-example-btn",onClick:()=>{d("$ "),C(!1)},children:"Minimal"})]})]}),a.jsxs("div",{className:"terminal-section-group",children:[a.jsx("label",{className:"terminal-section-label",children:"Extra PATHs"}),a.jsxs("p",{className:"terminal-section-desc",children:["Extra directories to append to the ",a.jsx("code",{children:"PATH"})," environment variable in terminal sessions."]}),e.length>0&&a.jsx("div",{className:"terminal-section-paths",children:e.map((B,I)=>a.jsxs("div",{className:"terminal-section-path-row",children:[a.jsx("code",{className:"terminal-section-path-value",children:B}),a.jsx("button",{className:"terminal-section-path-remove",onClick:()=>N(I),title:"Remove",children:""})]},I))}),a.jsxs("div",{className:"terminal-section-add-row",children:[a.jsx("input",{className:"terminal-section-input",type:"text",value:T,onChange:B=>k(B.target.value),onKeyDown:z,placeholder:"/usr/local/custom/bin"}),a.jsx("button",{className:"mcc-port-action-btn",onClick:R,disabled:!T.trim(),children:"Add"})]})]}),S&&a.jsx("div",{className:"terminal-section-error",children:S}),b&&a.jsx("div",{className:"terminal-section-success",children:"Saved! New terminal sessions will use the updated settings."}),a.jsx("div",{className:"terminal-section-actions",children:a.jsx("button",{className:"mcc-port-action-btn",onClick:E,disabled:v,children:v?"Saving...":"Save"})})]})]})}async function S5(){const e=await fetch("/api/server/config");if(!e.ok){const t=await e.json();throw new Error(t.error||"Failed to get server config")}return e.json()}async function b5(e){const t=await fetch("/api/server/config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_dir:e})});if(!t.ok){const i=await t.json();throw new Error(i.error||"Failed to set server config")}}function w5(){const[e,t]=y.useState(null),[i,r]=y.useState(!0),[l,c]=y.useState(null),[u,d]=y.useState(!1),[m,f]=y.useState(""),[v,_]=y.useState(!1),[S,x]=y.useState(null);y.useEffect(()=>{b()},[]);const b=async()=>{r(!0),c(null);try{const k=await S5();t(k),f(k.project_dir||""),_(k.using_explicit_dir)}catch(k){c(k instanceof Error?k.message:String(k))}finally{r(!1)}},C=async()=>{d(!0),c(null),x(null);try{const k=v?m.trim():"";await b5(k),x("Settings saved successfully"),await b(),setTimeout(()=>x(null),3e3)}catch(k){c(k instanceof Error?k.message:String(k))}finally{d(!1)}},T=()=>{_(!1),f("")};return i?a.jsx("div",{className:"diagnose-loading",children:"Loading server settings..."}):a.jsxs("div",{className:"server-settings-section",children:[l&&a.jsx("div",{className:"server-settings-error",children:l}),S&&a.jsx("div",{className:"server-settings-success",children:S}),a.jsxs("div",{className:"server-settings-info",children:[a.jsxs("div",{className:"server-settings-row",children:[a.jsx("span",{className:"server-settings-label",children:"Auto-detected directory:"}),a.jsx("span",{className:"server-settings-value server-settings-mono",children:e?.auto_detected_dir})]}),e?.using_explicit_dir&&a.jsxs("div",{className:"server-settings-row",children:[a.jsx("span",{className:"server-settings-label",children:"Currently using:"}),a.jsx("span",{className:"server-settings-value server-settings-mono server-settings-highlight",children:e.project_dir})]})]}),a.jsxs("div",{className:"server-settings-config",children:[a.jsxs("label",{className:"server-settings-checkbox",children:[a.jsx("input",{type:"checkbox",checked:v,onChange:k=>_(k.target.checked)}),a.jsx("span",{children:"Use explicit project directory"})]}),v&&a.jsxs("div",{className:"server-settings-field",children:[a.jsx("label",{htmlFor:"project-dir",children:"Project Directory:"}),a.jsx("input",{id:"project-dir",type:"text",value:m,onChange:k=>f(k.target.value),placeholder:"e.g., /path/to/mobile-coding-connector",className:"server-settings-input"}),a.jsx("small",{children:"When set, this directory will be used instead of the auto-detected directory. This is useful when running the server from a different location."})]})]}),a.jsxs("div",{className:"server-settings-actions",children:[v&&e?.using_explicit_dir&&a.jsx("button",{type:"button",className:"server-settings-btn server-settings-btn--secondary",onClick:T,disabled:u,children:"Clear & Use Auto-detected"}),a.jsx("button",{type:"button",className:"server-settings-btn server-settings-btn--primary",onClick:C,disabled:u,children:u?"Saving...":"Save"})]})]})}async function C5(){const e=await fetch("/api/ai-config");if(!e.ok){const t=await e.json().catch(()=>({error:"Failed to fetch AI config"}));throw new Error(t.error||"Failed to fetch AI config")}return e.json()}async function j5(e){const t=await fetch("/api/ai-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const i=await t.json().catch(()=>({error:"Failed to save AI config"}));throw new Error(i.error||"Failed to save AI config")}}function k5(){const[e,t]=y.useState([]),[i,r]=y.useState([]),[l,c]=y.useState(""),[u,d]=y.useState(""),[m,f]=y.useState(!1),[v,_]=y.useState(!0),[S,x]=y.useState(!1),[b,C]=y.useState(null),[T,k]=y.useState(!1),[R,N]=y.useState(""),[E,z]=y.useState(""),[B,I]=y.useState(""),[q,F]=y.useState(""),[V,G]=y.useState(""),[Y,M]=y.useState("");y.useEffect(()=>{j()},[]);const j=()=>{_(!0),C(null),C5().then(H=>{t(H.providers||[]),r(H.models||[]),c(H.default_provider||""),d(H.default_model||""),f(H.using_new_file),_(!1)}).catch(H=>{C(H.message),_(!1)})},A=async()=>{x(!0),C(null),k(!1);try{await j5({providers:e,models:i,default_provider:l,default_model:u}),k(!0),f(!0)}catch(H){C(H instanceof Error?H.message:String(H))}x(!1)},D=()=>{const H=R.trim(),L=E.trim(),re=B.trim();if(!H||!L){C("Provider name and base URL are required");return}if(e.some(me=>me.name===H)){C(`Provider "${H}" already exists`);return}t([...e,{name:H,base_url:L,api_key:re}]),N(""),z(""),I(""),C(null),k(!1)},$=H=>{const L=e[H];t(e.filter((re,me)=>me!==H)),r(i.filter(re=>re.provider!==L.name)),l===L.name&&(c(""),d("")),k(!1)},W=()=>{const H=q.trim(),L=V.trim(),re=Y.trim();if(!H||!L){C("Provider and model name are required");return}if(!e.some(me=>me.name===H)){C(`Provider "${H}" does not exist`);return}if(i.some(me=>me.provider===H&&me.model===L)){C(`Model "${L}" for provider "${H}" already exists`);return}r([...i,{provider:H,model:L,display_name:re||void 0}]),F(""),G(""),M(""),C(null),k(!1)},ne=H=>{const L=i[H];r(i.filter((re,me)=>me!==H)),u===L.model&&l===L.provider&&d(""),k(!1)},U=H=>{c(H);const L=i.filter(re=>re.provider===H);L.some(re=>re.model===u)||d(L.length>0?L[0].model:""),k(!1)},P=H=>{d(H),k(!1)};return a.jsxs("div",{className:"diagnose-section",children:[a.jsx("h3",{className:"diagnose-section-title",children:"AI Models"}),v?a.jsx("div",{className:"diagnose-loading",children:"Loading..."}):a.jsxs("div",{className:"ai-models-section-content",children:[!m&&a.jsx("div",{className:"ai-models-info",children:"Using legacy config from .config.local.json. Saving will migrate to new file (.ai-critic/ai-models.json)."}),a.jsxs("div",{className:"ai-models-section-group",children:[a.jsx("label",{className:"ai-models-section-label",children:"Providers"}),a.jsx("p",{className:"ai-models-section-desc",children:"Configure AI providers with their base URLs and API keys."}),e.length>0&&a.jsx("div",{className:"ai-models-list",children:e.map((H,L)=>a.jsxs("div",{className:"ai-models-item",children:[a.jsxs("div",{className:"ai-models-item-content",children:[a.jsx("div",{className:"ai-models-item-name",children:H.name}),a.jsx("div",{className:"ai-models-item-details",children:H.base_url}),H.api_key&&a.jsxs("div",{className:"ai-models-item-details",children:["API Key: ","*".repeat(Math.min(H.api_key.length,8))]})]}),a.jsx("button",{className:"ai-models-item-remove",onClick:()=>$(L),title:"Remove",children:""})]},L))}),a.jsxs("div",{className:"ai-models-add-form",children:[a.jsx("input",{className:"ai-models-input",type:"text",value:R,onChange:H=>N(H.target.value),placeholder:"Provider name (e.g., openai)"}),a.jsx("input",{className:"ai-models-input",type:"text",value:E,onChange:H=>z(H.target.value),placeholder:"Base URL (e.g., https://api.openai.com/v1)"}),a.jsx("input",{className:"ai-models-input",type:"password",value:B,onChange:H=>I(H.target.value),placeholder:"API Key"}),a.jsx("button",{className:"mcc-port-action-btn",onClick:D,disabled:!R.trim()||!E.trim(),children:"Add Provider"})]})]}),a.jsxs("div",{className:"ai-models-section-group",children:[a.jsx("label",{className:"ai-models-section-label",children:"Models"}),a.jsx("p",{className:"ai-models-section-desc",children:"Configure models for each provider."}),i.length>0&&a.jsx("div",{className:"ai-models-list",children:i.map((H,L)=>a.jsxs("div",{className:"ai-models-item",children:[a.jsxs("div",{className:"ai-models-item-content",children:[a.jsxs("div",{className:"ai-models-item-name",children:[H.display_name||H.model,H.display_name&&a.jsxs("span",{className:"ai-models-item-id",children:[" (",H.model,")"]})]}),a.jsxs("div",{className:"ai-models-item-details",children:["Provider: ",H.provider]})]}),a.jsx("button",{className:"ai-models-item-remove",onClick:()=>ne(L),title:"Remove",children:""})]},L))}),a.jsxs("div",{className:"ai-models-add-form",children:[a.jsxs("select",{className:"ai-models-select",value:q,onChange:H=>F(H.target.value),children:[a.jsx("option",{value:"",children:"Select provider..."}),e.map(H=>a.jsx("option",{value:H.name,children:H.name},H.name))]}),a.jsx("input",{className:"ai-models-input",type:"text",value:V,onChange:H=>G(H.target.value),placeholder:"Model ID (e.g., gpt-4)"}),a.jsx("input",{className:"ai-models-input",type:"text",value:Y,onChange:H=>M(H.target.value),placeholder:"Display name (optional)"}),a.jsx("button",{className:"mcc-port-action-btn",onClick:W,disabled:!q||!V.trim(),children:"Add Model"})]})]}),a.jsxs("div",{className:"ai-models-section-group",children:[a.jsx("label",{className:"ai-models-section-label",children:"Defaults"}),a.jsx("p",{className:"ai-models-section-desc",children:"Select the default provider and model for AI operations."}),a.jsxs("div",{className:"ai-models-default-row",children:[a.jsx("label",{children:"Default Provider:"}),a.jsxs("select",{className:"ai-models-select",value:l,onChange:H=>U(H.target.value),children:[a.jsx("option",{value:"",children:"Select..."}),e.map(H=>a.jsx("option",{value:H.name,children:H.name},H.name))]})]}),a.jsxs("div",{className:"ai-models-default-row",children:[a.jsx("label",{children:"Default Model:"}),a.jsxs("select",{className:"ai-models-select",value:u,onChange:H=>P(H.target.value),disabled:!l,children:[a.jsx("option",{value:"",children:"Select..."}),i.filter(H=>H.provider===l).map(H=>a.jsx("option",{value:H.model,children:H.display_name||H.model},H.model))]})]})]}),b&&a.jsx("div",{className:"ai-models-error",children:b}),T&&a.jsx("div",{className:"ai-models-success",children:"Saved successfully!"}),a.jsx("div",{className:"ai-models-actions",children:a.jsx("button",{className:"mcc-port-action-btn",onClick:A,disabled:S,children:S?"Saving...":"Save"})})]})]})}function GS(){const e=dt();return a.jsxs("div",{className:"diagnose-view",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(".."),children:""}),a.jsx("h2",{children:"Settings"})]}),a.jsx(i5,{}),a.jsx(u5,{}),a.jsxs("div",{className:"diagnose-section",children:[a.jsx("h3",{className:"diagnose-section-title",children:"Git"}),a.jsx(Q1,{})]}),a.jsx(VM,{}),a.jsx(x5,{}),a.jsx(k5,{}),a.jsxs("div",{className:"diagnose-section",children:[a.jsx("h3",{className:"diagnose-section-title",children:"Cloudflare"}),a.jsx(nw,{})]}),a.jsxs("div",{className:"diagnose-section",children:[a.jsx("h3",{className:"diagnose-section-title",children:"Server"}),a.jsx(w5,{})]}),a.jsxs("div",{className:"settings-export-import",children:[a.jsx("button",{className:"settings-export-import-btn",onClick:()=>e("export"),children:"Export"}),a.jsx("button",{className:"settings-export-import-btn",onClick:()=>e("import"),children:"Import"})]})]})}function YS(){const e=dt();return a.jsxs("div",{className:"mcc-git-settings",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(".."),children:" Back"}),a.jsx("h2",{children:"Clone Repository"})]}),a.jsx("div",{className:"mcc-git-tab-content",children:a.jsx(N5,{})})]})}function N5(){const[e]=y.useState(()=>Aa()),[t,i]=y.useState([]),[r,l]=y.useState(!1),[c,u]=y.useState(""),[d,m]=y.useState(""),[f,v]=y.useState(null),[_,S]=y.useState(null),[x,b]=y.useState([]),[C]=y.useState(()=>hi()),[T,k]=y.useState(""),[R,N]=y.useState(!1),[E,z]=y.useState(""),B=rt(e);y.useEffect(()=>{const F=B.current;F&&(l(!0),OM(F).then(V=>{i(V),l(!1)}).catch(V=>{u(String(V)),l(!1)}))},[B]);const I=async F=>{v(F),S(null),b([]);const V={repo_url:F};if(R&&T){const G=C.find(Y=>Y.id===T);if(G){try{V.ssh_key=await Ba(G.privateKey)}catch(Y){if(Y instanceof Ma){S({status:"error",error:"Server encryption keys not configured. Ask the server admin to run: go run ./script/crypto/gen"}),v(null);return}S({status:"error",error:String(Y)}),v(null);return}V.use_ssh=!0,V.ssh_key_id=T}}try{const G=await Ep(V);if((G.headers.get("Content-Type")||"").includes("text/event-stream")){const M=G.body?.getReader();if(!M){S({status:"error",error:"Failed to read response stream"}),v(null);return}const j=new TextDecoder;let A="";for(;;){const{done:D,value:$}=await M.read();if(D)break;A+=j.decode($,{stream:!0});const W=A.split(`
`);A=W.pop()||"";for(const ne of W)if(ne.startsWith("data: "))try{const U=JSON.parse(ne.slice(6));U.type==="log"?b(P=>[...P,U.message]):U.type==="error"?(b(P=>[...P,`ERROR: ${U.message}`]),S({status:"error",error:U.message})):U.type==="done"&&S({status:"ok",dir:U.dir})}catch{}}}else{const M=await G.json();S(M)}}catch(G){S({status:"error",error:String(G)})}v(null)},q=t.filter(F=>F.full_name.toLowerCase().includes(d.toLowerCase()));return y.useEffect(()=>{if(C.length>0&&!T){const F=C.find(V=>V.host==="github.com");k(F?F.id:C[0].id)}},[C,T]),a.jsxs("div",{className:"mcc-clone-panel",children:[C.length>0&&a.jsxs("div",{className:"mcc-clone-ssh-section",children:[a.jsxs("label",{className:"mcc-clone-ssh-toggle",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:F=>N(F.target.checked)}),a.jsx("span",{children:"Use SSH key for cloning"})]}),R&&a.jsx("select",{className:"mcc-clone-ssh-select",value:T,onChange:F=>k(F.target.value),children:C.map(F=>a.jsxs("option",{value:F.id,children:[F.name," (",F.host,")"]},F.id))})]}),a.jsx("div",{className:"mcc-clone-manual",children:a.jsxs("div",{className:"mcc-form-field",children:[a.jsx("label",{children:"Clone by URL"}),a.jsxs("div",{className:"mcc-clone-manual-row",children:[a.jsx("input",{type:"text",placeholder:"https://github.com/user/repo.git or git@github.com:user/repo.git",value:E,onChange:F=>z(F.target.value)}),a.jsx("button",{className:"mcc-forward-btn mcc-clone-btn",onClick:()=>I(E),disabled:!E.trim()||!!f,children:f===E?"Cloning...":"Clone"})]})]})}),(x.length>0||!!f)&&a.jsx(ii,{lines:x.map(F=>({text:F,error:F.startsWith("ERROR:")})),pending:!!f,pendingMessage:"Cloning in progress..."}),_&&a.jsx("div",{className:`mcc-clone-result ${_.status==="ok"?"mcc-clone-success":"mcc-clone-error"}`,children:_.status==="ok"?`Cloned to: ${_.dir}`:`Error: ${_.error}`}),e?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mcc-clone-search",children:a.jsx("input",{type:"text",placeholder:"Search repositories...",value:d,onChange:F=>m(F.target.value)})}),c&&a.jsx("div",{className:"mcc-ports-error",children:c}),r?a.jsx("div",{className:"mcc-git-loading",children:"Loading repositories..."}):a.jsxs("div",{className:"mcc-clone-repo-list",children:[q.map(F=>a.jsxs("div",{className:"mcc-clone-repo-card",children:[a.jsxs("div",{className:"mcc-clone-repo-info",children:[a.jsxs("div",{className:"mcc-clone-repo-name",children:[F.private&&a.jsx(_M,{}),a.jsx("span",{children:F.full_name})]}),F.description&&a.jsx("div",{className:"mcc-clone-repo-desc",children:F.description}),a.jsxs("div",{className:"mcc-clone-repo-meta",children:[F.language&&a.jsx("span",{className:"mcc-clone-repo-lang",children:F.language}),a.jsx("span",{children:new Date(F.updated_at).toLocaleDateString()})]})]}),a.jsx("button",{className:"mcc-forward-btn mcc-clone-btn",onClick:()=>I(R?F.ssh_url:F.clone_url),disabled:!!f,children:f===(R?F.ssh_url:F.clone_url)?"Cloning...":"Clone"})]},F.full_name)),q.length===0&&!r&&a.jsx("div",{className:"mcc-git-empty",children:d?"No matching repositories.":"No repositories found."})]})]}):a.jsx("div",{className:"mcc-git-empty",children:'Login with GitHub in the "GitHub" tab to list your repositories.'})]})}async function E5(){const e=await fetch("/api/ssh-servers");if(!e.ok)throw new Error("Failed to fetch SSH servers");return e.json()}async function T5(e){const t=await fetch("/api/ssh-servers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to create SSH server");return t.json()}async function R5(e,t){const i=await fetch(`/api/ssh-servers/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok)throw new Error("Failed to update SSH server");return i.json()}async function D5(e){if(!(await fetch(`/api/ssh-servers/${e}`,{method:"DELETE"})).ok)throw new Error("Failed to delete SSH server")}const A5={background:"#0f172a",foreground:"#e2e8f0",cursor:"#60a5fa",cursorAccent:"#0f172a",selectionBackground:"#334155",black:"#0f172a",red:"#ef4444",green:"#22c55e",yellow:"#eab308",blue:"#3b82f6",magenta:"#a855f7",cyan:"#06b6d4",white:"#f1f5f9",brightBlack:"#475569",brightRed:"#f87171",brightGreen:"#4ade80",brightYellow:"#facc15",brightBlue:"#60a5fa",brightMagenta:"#c084fc",brightCyan:"#22d3ee",brightWhite:"#ffffff"};function L5({host:e,port:t,username:i,sshKeyId:r,onClose:l}){const c=y.useRef(null),u=y.useRef(null),d=y.useRef(null),m=y.useRef(null),[f,v]=y.useState(!1),[_,S]=y.useState(!0),[x,b]=y.useState(""),[C,T]=y.useState(!0);y.useEffect(()=>{let B=!1;return(async()=>{try{const F=hi().find(he=>he.id===r);if(!F){b("SSH key not found in localStorage"),S(!1),T(!1);return}let V;try{V=await Ba(F.privateKey)}catch(he){b(he instanceof Error?he.message:"Failed to encrypt SSH key"),S(!1),T(!1);return}if(B||!c.current)return;const G=new wp({cursorBlink:!0,fontSize:14,fontFamily:'Monaco, Menlo, "Ubuntu Mono", Consolas, monospace',theme:A5,allowProposedApi:!0,scrollback:1e4}),Y=new Cp;G.loadAddon(Y),G.open(c.current),Y.fit(),u.current=G,d.current=Y;const M=c.current.querySelector(".xterm-viewport");let j=0,A=0,D=!1;const $=he=>{he.touches.length===1&&(j=he.touches[0].clientY,A=M?.scrollTop??0,D=!1)},W=he=>{if(he.touches.length!==1||!M)return;const de=j-he.touches[0].clientY;!D&&Math.abs(de)>5&&(D=!0),D&&(M.scrollTop=A+de)},ne=()=>{D=!1};M&&(M.addEventListener("touchstart",$,{passive:!0}),M.addEventListener("touchmove",W,{passive:!0}),M.addEventListener("touchend",ne,{passive:!0}));const U=window.location.protocol==="https:"?"wss:":"ws:",P=new URLSearchParams({ssh:"true",host:e,port:t.toString(),user:i}),H=`${U}//${window.location.host}/api/terminal?${P.toString()}`,L=new WebSocket(H);L.binaryType="arraybuffer",m.current=L;const re=()=>{if(L.readyState!==WebSocket.OPEN||!Y)return;const he=Y.proposeDimensions();he&&L.send(JSON.stringify({type:"resize",cols:he.cols,rows:he.rows}))};L.onopen=()=>{B||(L.send(JSON.stringify({type:"ssh_key",key:V})),v(!0),S(!1),T(!1),setTimeout(()=>{B||(Y.fit(),re())},100))},L.onmessage=he=>{if(!B)if(he.data instanceof ArrayBuffer)G.write(new TextDecoder().decode(he.data));else{const de=he.data;try{const oe=JSON.parse(de);oe.type==="error"?(b(oe.message||"Connection error"),T(!1)):oe.type}catch{G.write(de)}}},L.onclose=()=>{B||(v(!1),x||b("Connection closed"))},L.onerror=()=>{B||(b("Connection error"),S(!1),T(!1))},G.onData(he=>{L.readyState===WebSocket.OPEN&&L.send(he)});const me=()=>{B||(Y.fit(),re())};return window.addEventListener("resize",me),()=>{window.removeEventListener("resize",me),M&&(M.removeEventListener("touchstart",$),M.removeEventListener("touchmove",W),M.removeEventListener("touchend",ne))}}catch(q){B||(b(q instanceof Error?q.message:"Failed to initialize terminal"),S(!1),T(!1))}})(),()=>{B=!0,m.current?.close(),u.current?.dispose()}},[e,t,i,r]);const k=()=>{m.current?.readyState===WebSocket.OPEN&&m.current.send("")},R=()=>{m.current?.readyState===WebSocket.OPEN&&m.current.send("\x1B")},N=()=>{m.current?.readyState===WebSocket.OPEN&&m.current.send("")},E=()=>{m.current?.readyState===WebSocket.OPEN&&m.current.send("	")},z=async()=>{try{const B=await navigator.clipboard.readText();B&&m.current?.readyState===WebSocket.OPEN&&m.current.send(B)}catch{}};return a.jsxs("div",{className:"embedded-terminal",children:[a.jsxs("div",{className:"embedded-terminal-header",children:[a.jsxs("div",{className:"embedded-terminal-info",children:[a.jsxs("span",{className:"embedded-terminal-title",children:[i,"@",e,":",t]}),C&&a.jsx("span",{className:"embedded-terminal-status connecting",children:"Initializing..."}),_&&!C&&a.jsx("span",{className:"embedded-terminal-status connecting",children:"Connecting..."}),f&&a.jsx("span",{className:"embedded-terminal-status connected",children:"Connected"}),x&&!f&&a.jsx("span",{className:"embedded-terminal-status error",children:x})]}),a.jsx("button",{className:"embedded-terminal-close-btn",onClick:l,children:"Close"})]}),a.jsx("div",{className:"embedded-terminal-content",ref:c}),a.jsxs("div",{className:"embedded-terminal-actions",children:[a.jsx("button",{className:"embedded-terminal-btn",onClick:E,children:"Tab"}),a.jsx("button",{className:"embedded-terminal-btn",onClick:R,children:"Esc"}),a.jsx("button",{className:"embedded-terminal-btn",onClick:k,children:"^C"}),a.jsx("button",{className:"embedded-terminal-btn",onClick:N,children:"^D"}),a.jsx("button",{className:"embedded-terminal-btn",onClick:z,children:"Paste"})]})]})}function XS(){const e=dt(),[t,i]=y.useState([]),[r,l]=y.useState([]),[c,u]=y.useState(!0),[d,m]=y.useState(""),[f,v]=y.useState(null),[_,S]=y.useState(!1),[x,b]=y.useState(null),[C,T]=y.useState(null),[k,R]=y.useState(""),[N,E]=y.useState(""),[z,B]=y.useState(22),[I,q]=y.useState(""),[F,V]=y.useState("");y.useEffect(()=>{G(),l(hi())},[]);const G=async()=>{u(!0),m("");try{const P=await E5();i(P)}catch(P){m(P instanceof Error?P.message:"Failed to load SSH servers")}finally{u(!1)}},Y=()=>{R(""),E(""),B(22),q(""),V(""),v(null),S(!1)},M=()=>{if(r.length===0){alert("Please add an SSH key in Git Settings first.");return}Y(),V(r[0]?.id||""),S(!0)},j=P=>{v(P),R(P.name),E(P.host),B(P.port),q(P.username),V(P.ssh_key_id),S(!1)},A=async()=>{if(!k.trim()||!N.trim()||!I.trim()){alert("Please fill in all required fields.");return}m("");const P={name:k.trim(),host:N.trim(),port:z,username:I.trim(),ssh_key_id:F};try{f?await R5(f.id,P):await T5(P),Y(),await G()}catch(H){m(H instanceof Error?H.message:"Failed to save SSH server")}},D=async P=>{try{await D5(P),await G(),b(null)}catch(H){m(H instanceof Error?H.message:"Failed to delete SSH server")}},$=P=>{if(!r.find(L=>L.id===P.ssh_key_id)){alert("SSH key not found. Please configure SSH keys in Git Settings.");return}T(P)},W=()=>{T(null)},ne=P=>r.find(L=>L.id===P)?.name||"Unknown Key",U=_||f!==null;return a.jsxs("div",{className:"mcc-ssh-servers-view",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(".."),children:" Back"}),a.jsx("h2",{children:"SSH Servers"})]}),!U&&a.jsxs("button",{className:"mcc-ssh-add-btn",onClick:M,children:[a.jsx(_o,{}),a.jsx("span",{children:"Add SSH Server"})]}),r.length===0&&!U&&a.jsxs("div",{className:"mcc-ssh-warning",children:[a.jsx(vu,{}),a.jsx("span",{children:"No SSH keys configured. "}),a.jsx("button",{onClick:()=>e("../settings/git"),children:"Add SSH Key"})]}),d&&a.jsx("div",{className:"mcc-ssh-error",children:d}),U&&a.jsxs("div",{className:"mcc-ssh-form",children:[a.jsxs("div",{className:"mcc-ssh-form-row",children:[a.jsx("label",{children:"Name"}),a.jsx("input",{type:"text",value:k,onChange:P=>R(P.target.value),placeholder:"e.g., Production Server"})]}),a.jsxs("div",{className:"mcc-ssh-form-row",children:[a.jsx("label",{children:"Host / IP"}),a.jsx("input",{type:"text",value:N,onChange:P=>E(P.target.value),placeholder:"e.g., 192.168.1.100 or server.example.com"})]}),a.jsxs("div",{className:"mcc-ssh-form-row",children:[a.jsx("label",{children:"Port"}),a.jsx("input",{type:"number",value:z,onChange:P=>B(parseInt(P.target.value)||22),placeholder:"22",min:1,max:65535})]}),a.jsxs("div",{className:"mcc-ssh-form-row",children:[a.jsx("label",{children:"Username"}),a.jsx("input",{type:"text",value:I,onChange:P=>q(P.target.value),placeholder:"e.g., root or ubuntu"})]}),a.jsxs("div",{className:"mcc-ssh-form-row",children:[a.jsx("label",{children:"SSH Key"}),a.jsx("select",{value:F,onChange:P=>V(P.target.value),children:r.map(P=>a.jsxs("option",{value:P.id,children:[P.name," (",P.host,")"]},P.id))})]}),a.jsxs("div",{className:"mcc-ssh-form-buttons",children:[a.jsx("button",{className:"mcc-ssh-save-btn",onClick:A,children:"Save"}),a.jsx("button",{className:"mcc-ssh-cancel-btn",onClick:Y,children:"Cancel"})]})]}),!U&&a.jsx("div",{className:"mcc-ssh-servers-list",children:c?a.jsx("div",{className:"mcc-ssh-empty",children:"Loading..."}):t.length===0?a.jsxs("div",{className:"mcc-ssh-empty",children:[a.jsx(ro,{}),a.jsx("p",{children:"No SSH servers configured yet."}),a.jsx("p",{children:'Click "Add SSH Server" to get started.'})]}):t.map(P=>a.jsxs("div",{className:"mcc-ssh-server-card",children:[a.jsxs("div",{className:"mcc-ssh-server-row",children:[a.jsxs("div",{className:"mcc-ssh-server-info",children:[a.jsxs("div",{className:"mcc-ssh-server-header",children:[a.jsx("span",{className:"mcc-ssh-server-name",children:P.name}),a.jsxs("span",{className:"mcc-ssh-server-key",children:[a.jsx(vu,{})," ",ne(P.ssh_key_id)]})]}),a.jsx("div",{className:"mcc-ssh-server-details",children:a.jsxs("code",{children:[P.username,"@",P.host,":",P.port]})})]}),a.jsxs("div",{className:"mcc-ssh-server-actions",children:[a.jsxs("button",{className:"mcc-ssh-connect-btn",onClick:()=>$(P),title:"Connect via SSH",disabled:C?.id===P.id,children:[a.jsx(ro,{}),C?.id===P.id?"Connected":"Connect"]}),a.jsx("button",{className:"mcc-ssh-edit-btn",onClick:()=>j(P),title:"Edit",children:"Edit"}),x===P.id?a.jsxs("div",{className:"mcc-ssh-delete-confirm",children:[a.jsx("span",{children:"Delete?"}),a.jsx("button",{onClick:()=>D(P.id),children:"Yes"}),a.jsx("button",{onClick:()=>b(null),children:"No"})]}):a.jsx("button",{className:"mcc-ssh-delete-btn",onClick:()=>b(P.id),title:"Delete",children:"Delete"})]})]}),C?.id===P.id&&a.jsx(L5,{host:P.host,port:P.port,username:P.username,sshKeyId:P.ssh_key_id,onClose:W})]},P.id))})]})}const M5={background:"#0f172a",foreground:"#e2e8f0",cursor:"#60a5fa",cursorAccent:"#0f172a",selectionBackground:"#334155",black:"#0f172a",red:"#ef4444",green:"#22c55e",yellow:"#eab308",blue:"#3b82f6",magenta:"#a855f7",cyan:"#06b6d4",white:"#f1f5f9",brightBlack:"#475569",brightRed:"#f87171",brightGreen:"#4ade80",brightYellow:"#facc15",brightBlue:"#60a5fa",brightMagenta:"#c084fc",brightCyan:"#22d3ee",brightWhite:"#ffffff"};function B5({cwd:e,onClose:t}){const i=y.useRef(null),r=y.useRef(null),l=y.useRef(null),c=y.useRef(null),[u,d]=y.useState(!1),[m,f]=y.useState(!0),[v,_]=y.useState("");y.useEffect(()=>{let k=!1;if(!i.current)return;const R=new wp({cursorBlink:!0,fontSize:14,fontFamily:'Monaco, Menlo, "Ubuntu Mono", Consolas, monospace',theme:M5,allowProposedApi:!0,scrollback:1e4}),N=new Cp;R.loadAddon(N),R.open(i.current),N.fit(),r.current=R,l.current=N;const E=i.current.querySelector(".xterm-viewport");let z=0,B=0,I=!1;const q=$=>{$.touches.length===1&&(z=$.touches[0].clientY,B=E?.scrollTop??0,I=!1)},F=$=>{if($.touches.length!==1||!E)return;const W=z-$.touches[0].clientY;!I&&Math.abs(W)>5&&(I=!0),I&&(E.scrollTop=B+W)},V=()=>{I=!1};E&&(E.addEventListener("touchstart",q,{passive:!0}),E.addEventListener("touchmove",F,{passive:!0}),E.addEventListener("touchend",V,{passive:!0}));const G=window.location.protocol==="https:"?"wss:":"ws:",Y=new URLSearchParams;e&&Y.set("cwd",e),Y.set("name","File Manager");const M=`${G}//${window.location.host}/api/terminal${Y.toString()?"?"+Y.toString():""}`,j=new WebSocket(M);j.binaryType="arraybuffer",c.current=j;const A=()=>{if(j.readyState!==WebSocket.OPEN||!N)return;const $=N.proposeDimensions();$&&j.send(JSON.stringify({type:"resize",cols:$.cols,rows:$.rows}))};j.onopen=()=>{k||(d(!0),f(!1),setTimeout(()=>{k||(N.fit(),A())},100))},j.onmessage=$=>{if(!k)if($.data instanceof ArrayBuffer)R.write(new TextDecoder().decode($.data));else{const W=$.data;try{const ne=JSON.parse(W);ne.type==="error"&&_(ne.message||"Connection error")}catch{R.write(W)}}},j.onclose=()=>{k||(d(!1),v||_("Connection closed"))},j.onerror=()=>{k||(_("Connection error"),f(!1))},R.onData($=>{j.readyState===WebSocket.OPEN&&j.send($)});const D=()=>{k||(N.fit(),A())};return window.addEventListener("resize",D),()=>{k=!0,window.removeEventListener("resize",D),E&&(E.removeEventListener("touchstart",q),E.removeEventListener("touchmove",F),E.removeEventListener("touchend",V)),j.close(),R.dispose()}},[e]);const S=()=>{c.current?.readyState===WebSocket.OPEN&&c.current.send("")},x=()=>{c.current?.readyState===WebSocket.OPEN&&c.current.send("\x1B")},b=()=>{c.current?.readyState===WebSocket.OPEN&&c.current.send("")},C=()=>{c.current?.readyState===WebSocket.OPEN&&c.current.send("	")},T=async()=>{try{const k=await navigator.clipboard.readText();k&&c.current?.readyState===WebSocket.OPEN&&c.current.send(k)}catch{}};return a.jsxs("div",{className:"local-terminal",children:[a.jsxs("div",{className:"local-terminal-header",children:[a.jsxs("div",{className:"local-terminal-info",children:[a.jsx("span",{className:"local-terminal-title",children:e||"Terminal"}),m&&a.jsx("span",{className:"local-terminal-status connecting",children:"Connecting..."}),u&&a.jsx("span",{className:"local-terminal-status connected",children:"Connected"}),v&&!u&&a.jsx("span",{className:"local-terminal-status error",children:v})]}),a.jsx("button",{className:"local-terminal-close-btn",onClick:t,children:"Close"})]}),a.jsx("div",{className:"local-terminal-content",ref:i}),a.jsxs("div",{className:"local-terminal-actions",children:[a.jsx("button",{className:"local-terminal-btn",onClick:C,children:"Tab"}),a.jsx("button",{className:"local-terminal-btn",onClick:x,children:"Esc"}),a.jsx("button",{className:"local-terminal-btn",onClick:S,children:"^C"}),a.jsx("button",{className:"local-terminal-btn",onClick:b,children:"^D"}),a.jsx("button",{className:"local-terminal-btn",onClick:T,children:"Paste"})]})]})}function O5(e){return e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:e<1024*1024*1024?`${(e/(1024*1024)).toFixed(1)} MB`:`${(e/(1024*1024*1024)).toFixed(2)} GB`}function z5(e){return e?new Date(e).toLocaleString():"Unknown"}function P5({file:e,onClose:t,onView:i,onEdit:r}){console.log("FileActionSheet rendered, file:",e);const l=()=>{t()};return e?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"file-action-sheet-overlay",onClick:l}),a.jsxs("div",{className:"file-action-sheet",children:[a.jsx("div",{className:"file-action-sheet-handle"}),a.jsxs("div",{className:"file-action-sheet-content",children:[a.jsxs("div",{className:"file-action-sheet-header",children:[a.jsx("div",{className:"file-action-sheet-icon",children:""}),a.jsx("div",{className:"file-action-sheet-name",children:e.name})]}),a.jsxs("div",{className:"file-action-sheet-info",children:[a.jsxs("div",{className:"file-action-sheet-info-row",children:[a.jsx("span",{className:"file-action-sheet-info-label",children:"Size"}),a.jsx("span",{className:"file-action-sheet-info-value",children:O5(e.size)})]}),a.jsxs("div",{className:"file-action-sheet-info-row",children:[a.jsx("span",{className:"file-action-sheet-info-label",children:"Path"}),a.jsx("span",{className:"file-action-sheet-info-value",children:e.path})]}),e.modifiedTime&&a.jsxs("div",{className:"file-action-sheet-info-row",children:[a.jsx("span",{className:"file-action-sheet-info-label",children:"Modified"}),a.jsx("span",{className:"file-action-sheet-info-value",children:z5(e.modifiedTime)})]})]}),a.jsxs("div",{className:"file-action-sheet-actions",children:[a.jsx("button",{className:"file-action-sheet-btn view",onClick:()=>{i(),l()},children:" View"}),a.jsx("button",{className:"file-action-sheet-btn edit",onClick:()=>{r(),l()},children:" Edit"}),a.jsx("button",{className:"file-action-sheet-btn cancel",onClick:l,children:"Cancel"})]})]})]})]}):(console.log("FileActionSheet: no file, returning null"),null)}async function H5(e,t=0,i=8192){const r=`/api/server/files/content?path=${encodeURIComponent(e)}&offset=${t}&limit=${i}`,l=await fetch(r);if(!l.ok)throw new Error("Failed to fetch file content");return l.json()}async function I5(e){const t=await fetch(`/api/server/files/content?path=${encodeURIComponent(e)}`);if(!t.ok)throw new Error("Failed to fetch file content");return(await t.json()).content}async function U5(e,t){const i=await fetch("/api/server/files/content",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e,content:t})});if(!i.ok){const r=await i.json().catch(()=>({error:"Failed to save file"}));throw new Error(r.error||"Failed to save file")}}async function F5(e,t){let i=`/api/server/files?base_path=${encodeURIComponent(e)}`;t&&(i+=`&path=${encodeURIComponent(t)}`);const r=await fetch(i);if(!r.ok)throw new Error("Failed to fetch server files");return r.json()}async function $5(){const e=await fetch("/api/files/home");if(!e.ok)throw new Error("Failed to fetch home directory");return(await e.json()).home_dir}const Bf=8192;function K5(e){return e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function q5({filePath:e,onClose:t}){const[i,r]=y.useState(""),[l,c]=y.useState(!0),[u,d]=y.useState(""),[m,f]=y.useState(0),[v,_]=y.useState(0),[S,x]=y.useState(1);y.useEffect(()=>{b(0)},[e]);const b=async k=>{c(!0),d("");try{const R=await H5(e,k*Bf,Bf);r(R.content),_(R.totalSize),x(Math.ceil(R.totalSize/Bf)),f(k)}catch(R){d(R instanceof Error?R.message:"Failed to load file")}finally{c(!1)}},C=()=>{m>0&&b(m-1)},T=()=>{m<S-1&&b(m+1)};return a.jsx("div",{className:"file-viewer-overlay",onClick:t,children:a.jsxs("div",{className:"file-viewer",onClick:k=>k.stopPropagation(),children:[a.jsxs("div",{className:"file-viewer-header",children:[a.jsxs("span",{className:"file-viewer-title",children:[e.split("/").pop(),v>0&&a.jsxs("span",{style:{marginLeft:12,fontSize:12,color:"#94a3b8",fontWeight:400},children:["(",K5(v),")"]})]}),a.jsx("button",{className:"file-viewer-close",onClick:t,children:""})]}),a.jsx("div",{className:"file-viewer-content",children:l?a.jsx("div",{style:{textAlign:"center",padding:40,color:"#94a3b8"},children:"Loading..."}):u?a.jsx("div",{style:{textAlign:"center",padding:40,color:"#ef4444"},children:u}):a.jsx("pre",{className:"file-viewer-text",children:i})}),S>1&&a.jsxs("div",{className:"file-viewer-pagination",children:[a.jsx("button",{className:"file-viewer-page-btn",onClick:C,disabled:m===0||l,children:" Previous"}),a.jsxs("span",{className:"file-viewer-page-info",children:["Page ",m+1," of ",S]}),a.jsx("button",{className:"file-viewer-page-btn",onClick:T,disabled:m>=S-1||l,children:"Next "})]})]})})}function W5({filePath:e,basePath:t,onClose:i,onSave:r}){const[l,c]=y.useState(""),[u,d]=y.useState(""),[m,f]=y.useState(!0),[v,_]=y.useState(!1),[S,x]=y.useState("");y.useEffect(()=>{b()},[e]);const b=async()=>{f(!0),x("");try{const R=t+(e?"/"+e:""),N=await I5(R);c(N),d(N)}catch(R){x(R instanceof Error?R.message:"Failed to load file")}finally{f(!1)}},C=async()=>{_(!0),x("");try{const R=t+(e?"/"+e:"");await U5(R,l),d(l),r()}catch(R){x(R instanceof Error?R.message:"Failed to save file")}finally{_(!1)}},T=()=>{l!==u?confirm("You have unsaved changes. Are you sure you want to discard them?")&&i():i()},k=l!==u;return a.jsx("div",{className:"file-editor-overlay",onClick:T,children:a.jsxs("div",{className:"file-editor",onClick:R=>R.stopPropagation(),children:[a.jsxs("div",{className:"file-editor-header",children:[a.jsxs("span",{className:"file-editor-title",children:[e.split("/").pop(),k&&a.jsx("span",{style:{color:"#f59e0b",marginLeft:8},children:""})]}),a.jsx("button",{className:"file-editor-close",onClick:T,children:""})]}),a.jsx("div",{className:"file-editor-content",children:m?a.jsx("div",{style:{textAlign:"center",padding:40,color:"#94a3b8"},children:"Loading..."}):S?a.jsx("div",{style:{textAlign:"center",padding:40,color:"#ef4444"},children:S}):a.jsx("textarea",{className:"file-editor-textarea",value:l,onChange:R=>c(R.target.value),placeholder:"Start typing...",spellCheck:!1})}),a.jsxs("div",{className:"file-editor-actions",children:[a.jsx("button",{className:"file-editor-btn save",onClick:C,disabled:v||m||!k,children:v?"Saving...":"Save"}),a.jsx("button",{className:"file-editor-btn cancel",onClick:T,disabled:v,children:"Cancel"})]})]})})}function V5(){const e=dt(),[t,i]=y.useState(""),[r,l]=y.useState(""),[c,u]=y.useState(""),[d,m]=y.useState([]),[f,v]=y.useState(!0),[_,S]=y.useState(!1),[x,b]=y.useState(""),[C,T]=y.useState(null),[k,R]=y.useState(!1),[N,E]=y.useState(!1);y.useEffect(()=>{$5().then(j=>{l(j),u(j),b(j),z(j,"")})},[]);const z=async(j,A)=>{v(!0);try{const D=await F5(j,A||void 0);m(D)}catch(D){console.error("Failed to load files:",D),m([])}finally{v(!1)}},B=j=>{if(t==="..")return j?`/${j}`:"/";if(t.startsWith("../")){const A=t.slice(3);return A?`/${A}/${j}`:`/${j}`}return t?`${t}/${j}`:j},I=j=>{console.log("File clicked:",j);const A=B(j.path),D={name:j.name,path:A,size:j.size||0,isDir:!!j.is_dir,modifiedTime:j.modified_time};console.log("Setting selected file:",D),T(D)},q=async j=>{if(j===".."&&t===""){i(".."),u("/"),await z("/",""),b("/");return}if(t===".."){if(j===""){i(""),u(r),await z(r,""),b(r);return}const A=j===".."?"":j;i(A?`../${A}`:".."),await z("/",A),b(A?`/${A}`:"/");return}i(j),await z(r,j),b(j?`${r}/${j}`:r)},F=()=>{S(!_)},V=()=>{R(!0)},G=()=>{E(!0)},M=(()=>{if(t==="..")return[{name:"root",path:""}];if(t==="")return[];if(t.startsWith("../")){const D=t.slice(3).split("/").filter(Boolean);return[{name:"root",path:""},...D.map($=>({name:$,path:"../"+D.slice(0,D.indexOf($)+1).join("/")}))]}const j=t.split("/").filter(Boolean);return j.map((A,D)=>({name:A,path:j.slice(0,D+1).join("/")}))})();return a.jsxs("div",{className:"mcc-manage-files",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(-1),children:a.jsx(Np,{})}),a.jsx("h2",{children:"Manage Server Files"})]}),a.jsxs("button",{className:`mcc-manage-files-terminal-toggle ${_?"active":""}`,onClick:F,children:[a.jsx(ro,{}),_?"Hide Terminal":"Show Terminal"]}),_&&a.jsx("div",{className:"mcc-manage-files-terminal",children:a.jsx(B5,{cwd:x,onClose:()=>S(!1)})}),a.jsxs("div",{className:"mcc-manage-files-browser",children:[a.jsxs("div",{className:"mcc-filebrowser-breadcrumb",children:[a.jsx("button",{className:"mcc-filebrowser-crumb",onClick:()=>q(""),children:t===".."?"root":"home"}),M.map(j=>a.jsxs("span",{children:[a.jsx("span",{className:"mcc-filebrowser-crumb-sep",children:"/"}),a.jsx("button",{className:"mcc-filebrowser-crumb",onClick:()=>q(j.path),children:j.name})]},j.path))]}),f?a.jsx("div",{className:"mcc-files-empty",children:"Loading..."}):a.jsxs("div",{className:"mcc-filebrowser-list",children:[(t!==".."||M.length>0)&&a.jsxs("div",{className:"mcc-filebrowser-entry",onClick:()=>{if(t==="")q("..");else{if(t==="..")return;if(t.startsWith("../")){const j=t.slice(3),A=j.includes("/")?"../"+j.substring(0,j.lastIndexOf("/")):"..";q(A)}else{const j=t.includes("/")?t.substring(0,t.lastIndexOf("/")):"";q(j)}}},children:[a.jsx("span",{className:"mcc-filebrowser-icon",children:""}),a.jsx("span",{className:"mcc-filebrowser-name",children:".."})]}),d.length===0?a.jsx("div",{className:"mcc-files-empty",children:"Empty directory"}):d.map(j=>a.jsxs("div",{className:"mcc-filebrowser-entry",onClick:()=>{j.is_dir?t===".."?q("../"+j.name):t.startsWith("../")?q(t+"/"+j.name):q(t?t+"/"+j.name:j.name):I(j)},children:[a.jsx("span",{className:"mcc-filebrowser-icon",children:j.is_dir?"":""}),a.jsx("span",{className:"mcc-filebrowser-name",children:j.name}),!j.is_dir&&j.size!==void 0&&a.jsx("span",{className:"mcc-filebrowser-size",children:G5(j.size)})]},j.path))]})]}),a.jsx(P5,{file:C,onClose:()=>T(null),onView:V,onEdit:G}),k&&C&&a.jsx(q5,{filePath:c+"/"+C.path,onClose:()=>R(!1)}),N&&C&&a.jsx(W5,{filePath:C.path,basePath:c,onClose:()=>E(!1),onSave:()=>{E(!1),T(null)}})]})}function G5(e){return e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function JS({onSelectProject:e}){const t=dt(),{projectsList:i,projectsLoading:r,fetchProjects:l,currentProject:c}=In(),u=Qt(),d=e??u?.onSelectProject??(()=>{}),[m,f]=y.useState(null),[v,_]=Is(b=>{b.ok&&l(),f(null)}),S=async b=>{try{await IL(b),l()}catch{}},x=async b=>{b.repo_url&&(f(b.id),_.run(async()=>{const C={repo_url:b.repo_url,target_dir:b.dir};if(b.use_ssh&&b.ssh_key_id){const k=hi().find(R=>R.id===b.ssh_key_id);k&&(C.ssh_key=await Ba(k.privateKey),C.use_ssh=!0,C.ssh_key_id=b.ssh_key_id)}return Ep(C)}))};return a.jsxs("div",{className:"mcc-workspace-list",children:[a.jsx("div",{className:"mcc-section-header",children:a.jsx("h2",{children:"Your Projects"})}),r?a.jsx("div",{className:"mcc-ports-empty",children:"Loading projects..."}):i.length===0?a.jsx("div",{className:"mcc-ports-empty",children:"No projects yet. Clone a repository from Git Settings."}):a.jsxs("div",{className:"mcc-workspace-cards",children:[i.map(b=>a.jsx(Y5,{project:b,isActive:b.name===c?.name,onSelect:()=>d(b),onOpen:()=>{t(`/project/${encodeURIComponent(b.name)}`)},onRemove:()=>S(b.id),onClone:()=>x(b),cloning:m===b.id,anyCloning:v.running},b.id)),(v.showLogs||v.result)&&a.jsx("div",{style:{marginTop:8},children:a.jsx(xr,{state:v,pendingMessage:"Cloning in progress...",maxHeight:200})})]}),a.jsxs("button",{className:"mcc-new-workspace-btn",onClick:()=>t("clone-repo"),children:[a.jsx(_o,{}),a.jsx("span",{children:"Clone Repository"})]}),a.jsxs("button",{className:"mcc-new-workspace-btn",onClick:()=>t("add-from-filesystem"),children:[a.jsx(K1,{}),a.jsx("span",{children:"Add From Filesystem"})]}),a.jsxs("button",{className:"mcc-git-settings-btn",onClick:()=>t("settings/git"),children:[a.jsx(fM,{}),a.jsx("span",{children:"Git Settings"})]}),a.jsxs("button",{className:"mcc-diagnose-btn",onClick:()=>t("diagnose"),children:[a.jsx(mM,{}),a.jsx("span",{children:"System Diagnostics"})]}),a.jsxs("button",{className:"mcc-diagnose-btn",onClick:()=>t("manage-server"),children:[a.jsx(Au,{}),a.jsx("span",{children:"Manage Server"})]}),a.jsxs("button",{className:"mcc-diagnose-btn",onClick:()=>t("ssh-servers"),children:[a.jsx(ro,{}),a.jsx("span",{children:"Manage SSH"})]})]})}function Y5({project:e,isActive:t,onSelect:i,onOpen:r,onRemove:l,onClone:c,cloning:u,anyCloning:d}){const m=new Date(e.created_at).toLocaleDateString(),f=!e.dir_exists,v=Y1(e);return a.jsxs("div",{className:`mcc-workspace-card mcc-workspace-card-clickable${t?" mcc-workspace-card-active":""}`,onClick:i,children:[a.jsxs("div",{className:"mcc-workspace-card-header",children:[a.jsx("span",{className:"mcc-workspace-name",children:e.name}),t&&a.jsx("span",{className:"mcc-workspace-active-badge",children:"Working on"}),f&&a.jsx("span",{className:"mcc-workspace-missing-badge",children:"Not cloned"})]}),a.jsx("div",{className:"mcc-workspace-card-meta",children:a.jsx("span",{children:e.dir})}),a.jsxs("div",{className:"mcc-workspace-card-meta",style:{marginTop:4},children:[a.jsx("span",{children:e.repo_url}),a.jsx("span",{children:m})]}),f&&e.repo_url&&!v.hasSSHKey&&a.jsx("div",{style:{marginTop:8},children:a.jsx(wa,{message:v.message,style:{marginBottom:0}})}),a.jsxs("div",{className:"mcc-port-actions",style:{marginTop:8},children:[a.jsx("button",{className:"mcc-port-action-btn",onClick:_=>{_.stopPropagation(),r()},children:"Open"}),f&&e.repo_url&&a.jsx("button",{className:"mcc-port-action-btn mcc-port-clone",onClick:_=>{_.stopPropagation(),c()},disabled:d||!v.hasSSHKey,style:{opacity:v.hasSSHKey?1:.5},children:u?"Cloning...":"Clone"}),a.jsx("button",{className:"mcc-port-action-btn mcc-port-stop",onClick:_=>{_.stopPropagation(),l()},children:"Remove"})]})]})}function sw(e,t){const i=dt(),r=Hn(),{currentProject:l,tabHistories:c,pushTabHistory:u,popTabHistory:d}=In(),m=rt(l),f=rt(r),v=rt(c),_=rt(t),S=()=>{const R=m.current;return R?`/project/${encodeURIComponent(R.name)}/${e}`:`/${e}`},x=()=>_.current?.defaultBackPath??S(),b=R=>{const N=S(),E=R?`${N}/${R}`:N;u(e,f.current.pathname),i(E)},C=R=>{const N=S(),E=R?`${N}/${R}`:N;i(E,{replace:!0})},T=()=>{if((v.current[e]||[]).length>0){const E=d(e);if(E){i(E,{replace:!0});return}}const N=x();i(N,{replace:!0})},k=(c[e]?.length||0)>0;return{pushView:b,replaceView:C,goBack:T,canGoBack:k,currentHistory:c[e]||[]}}function X5({value:e,onChange:t,options:i,placeholder:r="Select..."}){const[l,c]=y.useState(!1),u=y.useRef(null);y.useEffect(()=>{if(!l)return;const m=f=>{u.current&&!u.current.contains(f.target)&&c(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[l]);const d=i.find(m=>m.value===e);return a.jsxs("div",{className:"custom-select",ref:u,children:[a.jsxs("button",{className:`custom-select-trigger${l?" custom-select-trigger--open":""}`,onClick:()=>c(!l),type:"button",children:[a.jsx("span",{className:"custom-select-trigger-text",children:d?d.label:r}),a.jsx("span",{className:"custom-select-arrow",children:l?"":""})]}),l&&a.jsx("div",{className:"custom-select-dropdown",children:i.map(m=>a.jsxs("button",{className:`custom-select-option${m.value===e?" custom-select-option--selected":""}`,onClick:()=>{t(m.value),c(!1)},type:"button",children:[a.jsx("span",{className:"custom-select-option-label",children:m.label}),m.sublabel&&a.jsx("span",{className:"custom-select-option-sublabel",children:m.sublabel}),m.value===e&&a.jsx("span",{className:"custom-select-option-check",children:""})]},m.value))})]})}function rw({projectDir:e,sshKeyId:t}){const[i,r]=y.useState([]),[l,c]=y.useState(""),[u,d]=y.useState(null),[m,f]=Is();y.useEffect(()=>{cA(e).then(S=>{r(S||[]);const x=S?.find(b=>b.isCurrent);x&&!l&&c(x.name)}).catch(()=>r([]))},[e]);const v=()=>{f.run(async()=>{d(null);let S;try{S=await Rp(t)}catch(x){throw x instanceof Ma&&d("Server encryption keys not configured."),x}return hA(e,S)})},_=!!t;return a.jsxs("div",{children:[!_&&a.jsx(wa,{message:"SSH key required for push operations. Configure in project settings.",style:{marginBottom:10}}),a.jsxs("div",{className:"mcc-git-push-row",children:[a.jsxs("button",{className:"mcc-git-push-btn",onClick:v,disabled:m.running||!_,style:{opacity:_?1:.5},children:[m.running?"Pushing...":"Push",a.jsx(q1,{size:14,style:{verticalAlign:"middle"}})]}),i.length>0&&a.jsx("select",{className:"mcc-git-branch-select",value:l,onChange:S=>c(S.target.value),children:i.map(S=>a.jsxs("option",{value:S.name,children:[S.name,S.isCurrent?" (current)":""]},S.name))})]}),a.jsx(xr,{state:m,pendingMessage:"Pushing...",maxHeight:200}),u&&a.jsx("div",{className:"mcc-git-fetch-result error",style:{marginTop:8},children:u})]})}function J5({projectId:e}){console.log("[ProjectTodos] Initializing with projectId:",e);const[t,i]=y.useState([]),[r,l]=y.useState(!0),[c,u]=y.useState(""),[d,m]=y.useState(null),[f,v]=y.useState(""),[_,S]=y.useState("");y.useEffect(()=>{console.log("[ProjectTodos] useEffect triggered, loading todos..."),x()},[e]);const x=async()=>{console.log("[ProjectTodos] Loading todos for project:",e);try{l(!0);const E=await KL(e);console.log("[ProjectTodos] Loaded todos:",E),i(E||[])}catch(E){console.error("[ProjectTodos] Failed to load todos:",E),i([])}finally{l(!1)}},b=async()=>{console.log("[ProjectTodos] Adding todo:",c);try{S(""),u("");const E=await qL(e,c.trim());console.log("[ProjectTodos] Added todo successfully:",E),i([...t,E])}catch(E){console.error("[ProjectTodos] Failed to add todo:",E),S(E instanceof Error?E.message:"Failed to add todo"),u(c)}},C=async E=>{console.log("[ProjectTodos] Toggling todo:",E.id,"done:",!E.done);try{S("");const z=await PS(e,E.id,{done:!E.done});console.log("[ProjectTodos] Updated todo successfully:",z),i(t.map(B=>B.id===E.id?z:B))}catch(z){console.error("[ProjectTodos] Failed to update todo:",z),S(z instanceof Error?z.message:"Failed to update todo")}},T=E=>{console.log("[ProjectTodos] Editing todo:",E.id),m(E.id),v(E.text)},k=async E=>{if(!f.trim()){m(null);return}console.log("[ProjectTodos] Saving todo edit:",E,"text:",f);try{S("");const z=await PS(e,E,{text:f.trim()});console.log("[ProjectTodos] Saved todo edit successfully:",z),i(t.map(B=>B.id===E?z:B)),m(null)}catch(z){console.error("[ProjectTodos] Failed to update todo:",z),S(z instanceof Error?z.message:"Failed to update todo")}},R=()=>{console.log("[ProjectTodos] Cancelling edit"),m(null),v("")},N=async E=>{if(confirm("Are you sure you want to delete this todo?")){console.log("[ProjectTodos] Deleting todo:",E);try{S(""),await WL(e,E),console.log("[ProjectTodos] Deleted todo successfully"),i(t.filter(z=>z.id!==E))}catch(z){console.error("[ProjectTodos] Failed to delete todo:",z),S(z instanceof Error?z.message:"Failed to delete todo")}}};return a.jsxs("div",{style:{padding:"16px",marginTop:16},children:[a.jsx("div",{style:{fontSize:"15px",fontWeight:600,color:"#e2e8f0",marginBottom:12},children:"Project TODOs"}),_&&a.jsx("div",{className:"mcc-todo-error",children:_}),a.jsxs("div",{className:"mcc-todo-add",children:[a.jsx("input",{type:"text",className:"mcc-todo-input",placeholder:"Add a new task...",value:c,onChange:E=>u(E.target.value),onKeyPress:E=>E.key==="Enter"&&b()}),a.jsx("button",{className:"mcc-todo-btn",onClick:b,disabled:!c.trim(),children:"Add"})]}),r?a.jsx("div",{className:"mcc-todo-empty",children:"Loading..."}):t.length===0?a.jsx("div",{className:"mcc-todo-empty",children:"No tasks yet. Add one above to get started."}):a.jsx("div",{className:"mcc-todo-list",children:t.map(E=>a.jsxs("div",{className:`mcc-todo-item ${E.done?"done":""}`,children:[a.jsx("input",{type:"checkbox",className:"mcc-todo-checkbox",checked:E.done,onChange:()=>C(E)}),d===E.id?a.jsx("input",{type:"text",className:"mcc-todo-edit-input",value:f,onChange:z=>v(z.target.value),onKeyPress:z=>z.key==="Enter"&&k(E.id),autoFocus:!0}):a.jsx("span",{className:"mcc-todo-text",children:E.text}),a.jsx("div",{className:"mcc-todo-actions",children:d===E.id?a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"mcc-todo-icon-btn",onClick:()=>k(E.id),children:""}),a.jsx("button",{className:"mcc-todo-icon-btn",onClick:R,children:""})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"mcc-todo-icon-btn",onClick:()=>T(E),children:""}),a.jsx("button",{className:"mcc-todo-icon-btn danger",onClick:()=>N(E.id),children:""})]})})]},E.id))})]})}function Z5(){const{projectName:e}=es(),t=dt(),{projectsList:i,fetchProjects:r}=In(),{goBack:l}=sw(nt.Home,{defaultBackPath:"/home"}),c=i.find(F=>F.name===e),u=IM(c),[d,m]=y.useState([]),[f,v]=y.useState(""),[_,S]=y.useState(!1),[x,b]=y.useState(""),[C,T]=y.useState(""),[k,R]=Is(F=>{F.ok&&r()});if(y.useEffect(()=>{const F=hi();m(F),c?.ssh_key_id&&v(c.ssh_key_id)},[c?.ssh_key_id]),!c)return a.jsxs("div",{className:"mcc-workspace-list",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:l,children:""}),a.jsx("h2",{children:"Project Not Found"})]}),a.jsx("div",{className:"mcc-ports-empty",children:"Project not found."})]});const N=async()=>{S(!0),b(""),T("");try{await zS(c.id,{ssh_key_id:f||null,use_ssh:!!f}),r(),T("SSH key updated successfully")}catch(F){b(F instanceof Error?F.message:"Failed to update project")}finally{S(!1)}},E=async()=>{S(!0),b(""),T("");try{await zS(c.id,{ssh_key_id:null,use_ssh:!1}),v(""),r(),T("SSH key removed")}catch(F){b(F instanceof Error?F.message:"Failed to update project")}finally{S(!1)}},z=async()=>{if(!c.use_ssh||!c.ssh_key_id)return;const F=d.find(V=>V.id===c.ssh_key_id);if(F)return Ba(F.privateKey)},B=F=>{R.run(async()=>{const V=await z();return FL(F,{project_id:c.id,ssh_key:V})})},I=()=>{c.repo_url&&R.run(async()=>{const F={repo_url:c.repo_url,target_dir:c.dir};if(c.use_ssh&&c.ssh_key_id){const V=await z();V&&(F.ssh_key=V,F.use_ssh=!0,F.ssh_key_id=c.ssh_key_id)}return Ep(F)})},q=d.find(F=>F.id===c.ssh_key_id);return a.jsxs("div",{className:"mcc-workspace-list",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:l,children:""}),a.jsx("h2",{children:"Configure Project"})]}),a.jsxs("div",{style:{padding:"0 16px"},children:[a.jsx("div",{style:{fontSize:"16px",fontWeight:600,color:"#e2e8f0",marginBottom:4},children:c.name}),a.jsx("div",{style:{fontSize:"13px",color:"#94a3b8",marginBottom:2},children:c.dir}),a.jsx("div",{style:{fontSize:"13px",color:"#64748b"},children:c.repo_url})]}),a.jsxs("div",{style:{padding:"16px",marginTop:16},children:[a.jsx("div",{style:{fontSize:"15px",fontWeight:600,color:"#e2e8f0",marginBottom:12},children:"Git Operations"}),c.dir_exists?a.jsxs(a.Fragment,{children:[!u.hasSSHKey&&a.jsx(wa,{message:u.message}),a.jsxs("div",{style:{display:"flex",gap:10,marginBottom:12},children:[a.jsx("button",{className:"mcc-port-action-btn",onClick:()=>B(gu.Fetch),disabled:k.running||!u.hasSSHKey,style:{flex:1,padding:"10px 16px",background:"#1e293b",color:"#e2e8f0",border:"1px solid #334155",borderRadius:8,fontSize:"14px",fontWeight:600,cursor:"pointer",opacity:u.hasSSHKey?1:.5},children:k.running?"...":"Git Fetch"}),a.jsx("button",{className:"mcc-port-action-btn",onClick:()=>B(gu.Pull),disabled:k.running||!u.hasSSHKey,style:{flex:1,padding:"10px 16px",background:"#1e293b",color:"#e2e8f0",border:"1px solid #334155",borderRadius:8,fontSize:"14px",fontWeight:600,cursor:"pointer",opacity:u.hasSSHKey?1:.5},children:k.running?"...":"Git Pull"})]})]}):a.jsx("div",{style:{marginBottom:12},children:c.repo_url?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{fontSize:"13px",color:"#f59e0b",marginBottom:10,padding:"8px 12px",background:"rgba(245, 158, 11, 0.1)",border:"1px solid rgba(245, 158, 11, 0.2)",borderRadius:8},children:"Directory does not exist on filesystem. Clone the repository to create it."}),!u.hasSSHKey&&a.jsx(wa,{message:u.message}),a.jsx("button",{className:"mcc-port-action-btn",onClick:I,disabled:k.running||!u.hasSSHKey,style:{width:"100%",padding:"10px 16px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:8,fontSize:"14px",fontWeight:600,cursor:"pointer",opacity:u.hasSSHKey?1:.5},children:k.running?"Cloning...":"Git Clone"})]}):a.jsx("div",{style:{fontSize:"13px",color:"#94a3b8",padding:"8px 12px",background:"rgba(148, 163, 184, 0.05)",border:"1px solid #334155",borderRadius:8},children:"Directory does not exist and no repository URL is configured."})}),a.jsx(xr,{state:k,pendingMessage:"Running...",maxHeight:200}),c.dir_exists&&a.jsx("div",{style:{marginTop:16},children:a.jsx(rw,{projectDir:c.dir,sshKeyId:c.ssh_key_id})})]}),a.jsxs("div",{style:{padding:"16px",marginTop:16},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[a.jsx(vu,{}),a.jsx("span",{style:{fontSize:"15px",fontWeight:600,color:"#e2e8f0"},children:"SSH Key for Git Operations"})]}),a.jsx("div",{style:{fontSize:"13px",color:"#94a3b8",marginBottom:12},children:"Select an SSH private key to use for fetch and push operations. Keys are managed in Git Settings."}),q?a.jsxs("div",{style:{padding:"10px 14px",background:"rgba(96, 165, 250, 0.08)",border:"1px solid rgba(96, 165, 250, 0.2)",borderRadius:8,marginBottom:12,fontSize:"13px",color:"#93c5fd"},children:["Current: ",a.jsx("strong",{children:q.name})," (",q.host,")"]}):a.jsx("div",{style:{padding:"10px 14px",background:"rgba(148, 163, 184, 0.05)",border:"1px solid #334155",borderRadius:8,marginBottom:12,fontSize:"13px",color:"#64748b"},children:"No SSH key configured"}),d.length===0?a.jsxs("div",{style:{fontSize:"13px",color:"#94a3b8"},children:["No SSH keys available."," ",a.jsx("button",{style:{background:"none",border:"none",color:"#60a5fa",cursor:"pointer",fontSize:"13px",textDecoration:"underline",padding:0},onClick:()=>t("/home/settings/git"),children:"Add one in Git Settings"})]}):a.jsxs(a.Fragment,{children:[a.jsx(X5,{value:f,onChange:v,placeholder:"-- No SSH key --",options:[{value:"",label:"-- No SSH key --"},...d.map(F=>({value:F.id,label:F.name,sublabel:F.host}))]}),a.jsxs("div",{style:{display:"flex",gap:10},children:[a.jsx("button",{className:"mcc-port-action-btn",onClick:N,disabled:_,style:{flex:1,padding:"10px 16px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:8,fontSize:"14px",fontWeight:600,cursor:"pointer"},children:_?"Saving...":"Save"}),c.ssh_key_id&&a.jsx("button",{className:"mcc-port-action-btn",onClick:E,disabled:_,style:{padding:"10px 16px",background:"#1e293b",color:"#f87171",border:"1px solid #334155",borderRadius:8,fontSize:"14px",cursor:"pointer"},children:"Unset Key"})]})]}),x&&a.jsx("div",{style:{marginTop:12,padding:"10px 14px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:8,color:"#fca5a5",fontSize:"13px"},children:x}),C&&a.jsx("div",{style:{marginTop:12,padding:"10px 14px",background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",borderRadius:8,color:"#86efac",fontSize:"13px"},children:C})]}),a.jsx(L1,{children:a.jsx(J5,{projectId:c.id})})]})}let Q5=0;const e6=1e3,xa=[],t6={log:console.log,warn:console.warn,error:console.error,info:console.info,debug:console.debug};function Ul(e){return(...t)=>{const i=t.map(l=>{if(typeof l=="object")try{return JSON.stringify(l)}catch{return String(l)}return String(l)}).join(" "),r={id:++Q5,timestamp:new Date,level:e,message:i,args:t};xa.push(r),xa.length>e6&&xa.shift(),t6[e].apply(console,t)}}typeof window<"u"&&(console.log=Ul("log"),console.warn=Ul("warn"),console.error=Ul("error"),console.info=Ul("info"),console.debug=Ul("debug"));function n6(){return[...xa]}function i6(){xa.length=0}function s6(){return xa.map(e=>{const t=e.timestamp.toISOString(),i=e.level.toUpperCase().padEnd(5);return`[${t}] ${i} ${e.message}`}).join(`
`)}function ZS(){const e=dt(),[t,i]=y.useState([]),[r,l]=y.useState(""),[c,u]=y.useState("all"),[d,m]=y.useState(!1),f=y.useCallback(()=>{i(n6())},[]);y.useEffect(()=>{f();const b=setInterval(f,2e3);return()=>clearInterval(b)},[f]);const v=()=>{i6(),f()},_=async()=>{const b=s6();await navigator.clipboard.writeText(b),m(!0),setTimeout(()=>m(!1),2e3)},S=t.filter(b=>{const C=c==="all"||b.level===c,T=!r||b.message.toLowerCase().includes(r.toLowerCase());return C&&T}),x=b=>{switch(b){case"error":return"logs-level-error";case"warn":return"logs-level-warn";case"info":return"logs-level-info";case"debug":return"logs-level-debug";default:return""}};return a.jsxs("div",{className:"logs-view",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e("../"),children:a.jsx(Np,{})}),a.jsx("h2",{children:"Frontend Logs"})]}),a.jsxs("div",{className:"logs-controls",children:[a.jsx("input",{type:"text",placeholder:"Filter logs...",value:r,onChange:b=>l(b.target.value),className:"logs-filter-input"}),a.jsxs("select",{value:c,onChange:b=>u(b.target.value),className:"logs-level-select",children:[a.jsx("option",{value:"all",children:"All Levels"}),a.jsx("option",{value:"error",children:"Error"}),a.jsx("option",{value:"warn",children:"Warning"}),a.jsx("option",{value:"info",children:"Info"}),a.jsx("option",{value:"log",children:"Log"}),a.jsx("option",{value:"debug",children:"Debug"})]})]}),a.jsxs("div",{className:"logs-actions",children:[a.jsx("button",{className:"logs-action-btn",onClick:f,children:"Refresh"}),a.jsx("button",{className:"logs-action-btn",onClick:v,children:"Clear"}),a.jsx("button",{className:"logs-action-btn logs-copy-btn",onClick:_,children:d?"Copied!":"Copy All"})]}),a.jsxs("div",{className:"logs-count",children:[S.length," of ",t.length," entries"]}),a.jsx("div",{className:"logs-list",children:S.length===0?a.jsx("div",{className:"logs-empty",children:"No logs to display"}):S.map(b=>a.jsxs("div",{className:`logs-entry ${x(b.level)}`,children:[a.jsx("span",{className:"logs-time",children:b.timestamp.toLocaleTimeString()}),a.jsx("span",{className:`logs-level ${x(b.level)}`,children:b.level}),a.jsx("span",{className:"logs-message",children:b.message})]},b.id))})]})}const Im="cursor-agent-api-key";function Dp(){try{return localStorage.getItem(Im)||""}catch{return""}}function aw(e){try{e?localStorage.setItem(Im,e):localStorage.removeItem(Im)}catch{}}function r6(){return!!Dp()}async function a6(e){let t;e.includeBrowser&&(t={git_configs:{ssh_keys:hi(),github_token:Aa(),git_user_config:La(),cursor_api_key:Dp()||void 0}});const i={include_ai_critic:e.includeAICritic??!0,include_cloudflare:e.includeCloudflare??!0,include_opencode:e.includeOpencode??!0};t&&(i.browser_data=t);const r=await fetch("/api/settings/export-zip",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!r.ok){const f=await r.json().catch(()=>({}));throw new Error(f.error||"Failed to export settings")}const l=await r.blob(),c=r.headers.get("Content-Disposition");let u="ai-critic-settings.zip";if(c){const f=c.match(/filename="?([^"]+)"?/);f&&(u=f[1])}const d=URL.createObjectURL(l),m=document.createElement("a");m.href=d,m.download=u,document.body.appendChild(m),m.click(),document.body.removeChild(m),URL.revokeObjectURL(d)}async function l6(e){const t=new FormData;t.append("file",e);const i=await fetch("/api/settings/import-zip/preview",{method:"POST",body:t});if(!i.ok){const r=await i.json().catch(()=>({}));throw new Error(r.error||"Failed to preview zip")}return i.json()}async function o6(e,t){const i=new FormData;i.append("file",e),i.append("selected_paths",JSON.stringify(t));const r=await fetch("/api/settings/import-zip/confirm",{method:"POST",body:i});if(!r.ok){const l=await r.json().catch(()=>({}));throw new Error(l.error||"Failed to import zip")}}async function QS(e){const t=new FormData;t.append("file",e);const i=await fetch("/api/settings/import-zip/browser-data",{method:"POST",body:t});if(!i.ok){const r=await i.json().catch(()=>({}));throw new Error(r.error||"Failed to extract browser data")}return i.json()}function c6(e){if(e.git_configs){const t=e.git_configs;t.ssh_keys&&t.ssh_keys.length>0&&_u(t.ssh_keys),t.github_token&&yu(t.github_token),t.git_user_config&&Tp(t.git_user_config),t.cursor_api_key&&aw(t.cursor_api_key)}}function eb(){const e=dt(),[t,i]=y.useState([]),[r,l]=y.useState(!1),[c,u]=y.useState(null),[d,m]=y.useState(!0);y.useEffect(()=>{f()},[]);const f=async()=>{m(!0);const R=[];try{const I=await Pm();R.push({id:"credentials",category:"ai-critic",label:"Server Credentials",description:"API tokens for authentication",checked:I.length>0,exists:I.length>0,details:I.length>0?`${I.length} token(s)`:"None"})}catch{R.push({id:"credentials",category:"ai-critic",label:"Server Credentials",description:"API tokens for authentication",checked:!1,exists:!1,details:"Unable to load"})}try{const I=await Z1();R.push({id:"encryption_keys",category:"ai-critic",label:"Encryption Keys",description:"RSA key pair for encryption",checked:I.exists,exists:I.exists,details:I.exists?"Keys exist":"None"})}catch{R.push({id:"encryption_keys",category:"ai-critic",label:"Encryption Keys",description:"RSA key pair for encryption",checked:!1,exists:!1,details:"Unable to load"})}try{const q=(await As()).domains?.length??0;R.push({id:"web_domains",category:"ai-critic",label:"Web Domains",description:"Configured domains for port forwarding",checked:q>0,exists:q>0,details:q>0?`${q} domain(s)`:"None"})}catch{R.push({id:"web_domains",category:"ai-critic",label:"Web Domains",description:"Configured domains for port forwarding",checked:!1,exists:!1,details:"Unable to load"})}try{const I=await iw(),q=!!(I.extra_paths?.length||I.shell);R.push({id:"terminal_config",category:"ai-critic",label:"Terminal Config",description:"Shell and PATH settings",checked:q,exists:q,details:q?"Config exists":"None"})}catch{R.push({id:"terminal_config",category:"ai-critic",label:"Terminal Config",description:"Shell and PATH settings",checked:!1,exists:!1,details:"Unable to load"})}try{const q=(await ew()).cert_files??[],F=q.length>0;R.push({id:"cloudflare",category:"cloudflare",label:"Cloudflare Credentials",description:"cert.pem and tunnel files from ~/.cloudflared/",checked:F,exists:F,details:F?`${q.length} file(s): ${q.map(V=>V.name).join(", ")}`:"None"})}catch{R.push({id:"cloudflare",category:"cloudflare",label:"Cloudflare Credentials",description:"cert.pem and tunnel files from ~/.cloudflared/",checked:!1,exists:!1,details:"Unable to load"})}try{const I=await F1(),q=I.authenticated;R.push({id:"opencode",category:"opencode",label:"OpenCode Config",description:"Auth, settings & plugins from ~/.local/share/opencode/ and ~/.config/opencode/plugins/",checked:q,exists:q,details:q?`${I.providers?.length??0} provider(s)`:"None"})}catch{R.push({id:"opencode",category:"opencode",label:"OpenCode Config",description:"Auth, settings & plugins from ~/.local/share/opencode/ and ~/.config/opencode/plugins/",checked:!1,exists:!1,details:"Unable to load"})}const N=hi();R.push({id:"browser_ssh_keys",category:"browser",label:"SSH Keys",description:"SSH keys stored in browser",checked:N.length>0,exists:N.length>0,details:N.length>0?`${N.length} key(s)`:"None"});const E=Aa();R.push({id:"browser_github_token",category:"browser",label:"GitHub Token",description:"GitHub personal access token",checked:!!E,exists:!!E,details:E?"Token exists":"None"});const z=La(),B=!!(z.name||z.email);R.push({id:"browser_git_config",category:"browser",label:"Git User Config",description:"Git name and email settings",checked:B,exists:B,details:B?`${z.name||"(no name)"} <${z.email||"(no email)"}>`:"None"}),i(R),m(!1)},v=R=>{i(N=>N.map(E=>E.id===R?{...E,checked:!E.checked}:E))},_=R=>{const E=t.filter(z=>z.category===R).every(z=>z.checked);i(z=>z.map(B=>B.category===R?{...B,checked:!E}:B))},S=async()=>{l(!0),u(null);try{const R=new Set;t.forEach(N=>{N.checked&&R.add(N.category)}),await a6({includeBrowser:R.has("browser"),includeAICritic:R.has("ai-critic"),includeCloudflare:R.has("cloudflare"),includeOpencode:R.has("opencode")})}catch(R){u(R instanceof Error?R.message:String(R))}l(!1)},x=t.filter(R=>R.category==="ai-critic"),b=t.filter(R=>R.category==="cloudflare"),C=t.filter(R=>R.category==="opencode"),T=t.filter(R=>R.category==="browser"),k=(R,N,E)=>{if(N.length===0)return null;const z=N.every(I=>I.checked),B=N.some(I=>I.checked)&&!z;return a.jsxs("div",{className:"export-page-category",children:[a.jsx("div",{className:"export-page-category-header",children:a.jsxs("label",{className:"export-page-category-checkbox",children:[a.jsx("input",{type:"checkbox",checked:z,ref:I=>{I&&(I.indeterminate=B)},onChange:()=>_(E)}),a.jsx("span",{className:"export-page-category-title",children:R})]})}),a.jsx("div",{className:"export-page-category-items",children:N.map(I=>a.jsxs("label",{className:`export-page-item ${I.exists?"":"export-page-item--missing"}`,children:[a.jsx("input",{type:"checkbox",checked:I.checked,onChange:()=>v(I.id),disabled:!I.exists}),a.jsxs("div",{className:"export-page-item-info",children:[a.jsx("span",{className:"export-page-item-label",children:I.label}),a.jsx("span",{className:"export-page-item-description",children:I.description}),I.details&&a.jsx("span",{className:"export-page-item-details",children:I.details})]})]},I.id))})]})};return a.jsxs("div",{className:"diagnose-view",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(".."),children:""}),a.jsx("h2",{children:"Export Settings"})]}),a.jsxs("div",{className:"export-page-card",children:[a.jsx("p",{className:"export-page-description",children:"Select the items you want to export. Each category can be expanded to choose specific items."}),d?a.jsx("div",{className:"export-page-loading",children:"Loading items..."}):a.jsxs("div",{className:"export-page-categories",children:[k(".ai-critic/ Directory",x,"ai-critic"),k("Cloudflare Credentials",b,"cloudflare"),k("OpenCode Config",C,"opencode"),k("Browser Data (Git Configs)",T,"browser")]}),c&&a.jsx("div",{className:"export-page-error",children:c}),a.jsxs("div",{className:"export-page-actions",children:[a.jsx("button",{className:"export-page-btn export-page-btn--primary",onClick:S,disabled:r||d||!t.some(R=>R.checked),children:r?"Exporting...":"Export .zip"}),a.jsx("button",{className:"export-page-btn export-page-btn--secondary",onClick:()=>e(".."),children:"Cancel"})]})]})]})}const On={Create:"create",Overwrite:"overwrite",Merge:"merge"};function u6(e){return e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function tb(e){switch(e){case On.Create:return"New";case On.Overwrite:return"Overwrite";case On.Merge:return"Merge";default:return e}}function nb(e){switch(e){case On.Create:return"import-page-action-badge--create";case On.Overwrite:return"import-page-action-badge--overwrite";case On.Merge:return"import-page-action-badge--merge";default:return""}}function h6(e){const t=[];if(e.git_configs?.ssh_keys?.length){const i=hi(),r=new Set(i.map(u=>u.name)),l=e.git_configs.ssh_keys,c=l.filter(u=>!r.has(u.name)).length;i.length===0?t.push({label:"SSH Keys",detail:`${l.length} key(s)`,action:On.Create}):c>0?t.push({label:"SSH Keys",detail:`${l.length} key(s) (${c} new, ${l.length-c} existing)`,action:On.Merge}):t.push({label:"SSH Keys",detail:`${l.length} key(s) (all exist)`,action:On.Overwrite})}if(e.git_configs?.github_token){const i=Aa();t.push({label:"GitHub Token",detail:i?"Will replace existing token":"No existing token",action:i?On.Overwrite:On.Create})}if(e.git_configs?.git_user_config){const i=La(),r=!!(i.name||i.email),l=e.git_configs.git_user_config;t.push({label:"Git User Config",detail:`${l.name||"(no name)"} <${l.email||"(no email)"}>`,action:r?On.Overwrite:On.Create})}return t}function d6(e){const t=new Map;for(const i of e){const r=i.path.indexOf("/"),l=r>=0?i.path.substring(0,r):"(root)",c=t.get(l)||[];c.push(i),t.set(l,c)}return Array.from(t.entries()).map(([i,r])=>({group:i,files:r}))}function f6(e){switch(e){case"ai-critic":return".ai-critic/ Directory";case"cloudflare":return"Cloudflare Credentials";case"opencode":return"OpenCode Config";default:return e}}function ib(){const e=dt(),t=y.useRef(null),[i,r]=y.useState("choose"),[l,c]=y.useState(null),[u,d]=y.useState([]),[m,f]=y.useState(!1),[v,_]=y.useState([]),[S,x]=y.useState(!0),[b,C]=y.useState(null),[T,k]=y.useState(!1),[R,N]=y.useState(null),[E,z]=y.useState(!1),B=async M=>{const j=M.target.files?.[0];if(j){C(null),z(!0);try{const A=await l6(j);c(j);const D=A.files.filter(W=>W.path!=="browser-data.json"),$=A.files.find(W=>W.path==="browser-data.json");if(d(D.map(W=>({...W,selected:!0}))),f(!!$),x(!!$),$)try{const W=await QS(j);_(h6(W))}catch{_([])}else _([]);r("preview")}catch(A){C(A instanceof Error?A.message:String(A))}z(!1)}},I=M=>{d(j=>j.map(A=>A.path===M?{...A,selected:!A.selected}:A))},q=M=>{const A=u.filter(D=>{const $=D.path.indexOf("/");return($>=0?D.path.substring(0,$):"(root)")===M}).every(D=>D.selected);d(D=>D.map($=>{const W=$.path.indexOf("/");return(W>=0?$.path.substring(0,W):"(root)")===M?{...$,selected:!A}:$}))},F=async()=>{if(l){k(!0),N(null);try{const M=u.filter(j=>j.selected).map(j=>j.path);if(await o6(l,M),S&&m){const j=await QS(l);c6(j)}r("done")}catch(M){N(M instanceof Error?M.message:String(M))}k(!1)}},V=d6(u),G=u.filter(M=>M.selected).length,Y=u.length;return a.jsxs("div",{className:"diagnose-view",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(".."),children:""}),a.jsx("h2",{children:"Import Settings"})]}),i==="choose"&&a.jsxs("div",{className:"import-page-card",children:[a.jsx("p",{className:"import-page-description",children:"Choose a previously exported settings file (.zip) to import."}),a.jsx("input",{ref:t,type:"file",accept:".zip,application/zip",className:"import-page-file-input",onChange:B}),a.jsx("button",{className:"import-page-choose-btn",onClick:()=>t.current?.click(),disabled:E,children:E?"Analyzing...":"Choose .zip File"}),b&&a.jsx("div",{className:"import-page-error",children:b}),a.jsx("div",{className:"import-page-actions",children:a.jsx("button",{className:"import-page-btn import-page-btn--secondary",onClick:()=>e(".."),children:"Cancel"})})]}),i==="preview"&&a.jsxs("div",{className:"import-page-card",children:[a.jsxs("p",{className:"import-page-description",children:["Select the items you want to import from ",a.jsx("strong",{children:l?.name}),":"]}),a.jsx("div",{className:"import-page-summary",children:a.jsxs("span",{className:"import-page-summary-badge",children:[G," of ",Y," selected"]})}),a.jsx("div",{className:"import-page-file-list",children:V.map(M=>{const j=M.files.every(D=>D.selected),A=M.files.some(D=>D.selected)&&!j;return a.jsxs("div",{className:"import-page-file-group",children:[a.jsx("div",{className:"import-page-file-group-header",children:a.jsxs("label",{className:"import-page-group-checkbox",children:[a.jsx("input",{type:"checkbox",checked:j,ref:D=>{D&&(D.indeterminate=A)},onChange:()=>q(M.group)}),a.jsxs("span",{children:[f6(M.group),"/"]})]})}),M.files.map(D=>a.jsxs("label",{className:"import-page-file-row import-page-file-row--selectable",children:[a.jsx("input",{type:"checkbox",checked:D.selected,onChange:()=>I(D.path)}),a.jsx("span",{className:"import-page-file-name",children:D.path.substring(D.path.indexOf("/")+1)}),a.jsx("span",{className:"import-page-file-size",children:u6(D.size)}),a.jsx("span",{className:`import-page-action-badge ${nb(D.action)}`,children:tb(D.action)})]},D.path))]},M.group)})}),m&&a.jsxs("div",{className:"import-page-browser-data-section",children:[a.jsxs("label",{className:"import-page-browser-data-option",children:[a.jsx("input",{type:"checkbox",checked:S,onChange:()=>x(M=>!M)}),a.jsxs("div",{className:"import-page-section-info",children:[a.jsx("span",{className:"import-page-section-label",children:"Browser Data (Git Configs)"}),a.jsx("span",{className:"import-page-section-note",children:"Saved to browser local storage"})]})]}),S&&v.length>0&&a.jsx("div",{className:"import-page-browser-data-items",children:v.map(M=>a.jsxs("div",{className:"import-page-file-row",children:[a.jsx("span",{className:"import-page-file-name",children:M.label}),a.jsx("span",{className:"import-page-file-size",children:M.detail}),a.jsx("span",{className:`import-page-action-badge ${nb(M.action)}`,children:tb(M.action)})]},M.label))})]}),R&&a.jsx("div",{className:"import-page-error",children:R}),a.jsxs("div",{className:"import-page-actions",children:[a.jsx("button",{className:"import-page-btn import-page-btn--primary",onClick:F,disabled:G===0&&(!m||!S)||T,children:T?"Importing...":`Import ${G>0?G+" Item"+(G!==1?"s":""):"Browser Data"}`}),a.jsx("button",{className:"import-page-btn import-page-btn--secondary",onClick:()=>{r("choose"),c(null),d([])},disabled:T,children:"Back"})]})]}),i==="done"&&a.jsxs("div",{className:"import-page-card",children:[a.jsxs("div",{className:"import-page-success",children:[a.jsx("span",{className:"import-page-success-icon",children:""}),a.jsx("span",{children:"Settings imported successfully!"})]}),a.jsx("div",{className:"import-page-actions",children:a.jsx("button",{className:"import-page-btn import-page-btn--primary",onClick:()=>e(".."),children:"Back to Settings"})})]})]})}const Um={Uploading:"uploading",Merging:"merging"};async function sb(e){const t=await fetch("/api/files/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e})});if(!t.ok){const i=await t.json().catch(()=>({}));throw new Error(i.error||"Failed to check file")}return t.json()}const Of=2*1024*1024;function m6(e,t,i,r){return new Promise((l,c)=>{const u=new FormData;u.append("upload_id",e),u.append("chunk_index",String(t)),u.append("chunk",i,`chunk_${t}`);const d=new XMLHttpRequest;d.upload.addEventListener("progress",m=>{m.lengthComputable&&r(m.loaded,m.total)}),d.addEventListener("load",()=>{if(d.status>=200&&d.status<300)l();else try{const m=JSON.parse(d.responseText);c(new Error(m.error||`Failed to upload chunk ${t}`))}catch{c(new Error(`Failed to upload chunk ${t}`))}}),d.addEventListener("error",()=>{c(new Error(`Network error uploading chunk ${t}`))}),d.addEventListener("abort",()=>{c(new Error(`Upload chunk ${t} aborted`))}),d.open("POST","/api/files/upload/chunk"),d.send(u)})}async function lw(e,t,i){const r=e.size,l=Math.max(1,Math.ceil(r/Of)),c=await fetch("/api/files/upload/init",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:t,total_chunks:l,total_size:r})});if(!c.ok){const v=await c.json().catch(()=>({}));throw new Error(v.error||"Failed to initialize upload")}const{upload_id:u}=await c.json();let d=0;for(let v=0;v<l;v++){const _=v*Of,S=Math.min(_+Of,r),x=S-_,b=e.slice(_,S),C=d;await m6(u,v,b,(T,k)=>{i?.({loaded:C+T,total:r,percent:Math.round((C+T)/r*100),phase:Um.Uploading,chunkIndex:v,totalChunks:l,chunkLoaded:T,chunkTotal:k})}),d+=x}i?.({loaded:r,total:r,percent:100,phase:Um.Merging,chunkIndex:l-1,totalChunks:l});const m=await fetch("/api/files/upload/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({upload_id:u})});if(!m.ok){const v=await m.json().catch(()=>({}));throw new Error(v.error||"Failed to complete upload")}const f=await m.json();return{status:f.status,path:f.path,size:f.size,original_name:e.name}}async function p6(e){const t=new URLSearchParams({path:e}),i=await fetch(`/api/files/browse?${t}`);if(!i.ok){const r=await i.json().catch(()=>({}));throw new Error(r.error||"Failed to browse directory")}return i.json()}function g6(e){return`/api/files/download?${new URLSearchParams({path:e})}`}function v6(e,t){return new Promise((i,r)=>{const l=g6(e),c=new XMLHttpRequest;c.addEventListener("progress",u=>{if(t){const d=u.lengthComputable?u.total:0,m=d>0?Math.round(u.loaded/d*100):0;t({loaded:u.loaded,total:d,percent:m})}}),c.addEventListener("load",()=>{if(c.status>=200&&c.status<300){const u=new Blob([c.response]),d=URL.createObjectURL(u),m=e.split("/").pop()||"download",f=document.createElement("a");f.href=d,f.download=m,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(d),i()}else r(new Error("Download failed"))}),c.addEventListener("error",()=>{r(new Error("Network error during download"))}),c.addEventListener("abort",()=>{r(new Error("Download aborted"))}),c.open("GET",l),c.responseType="arraybuffer",c.send()})}function _6(e){if(e===0)return"0 B";const t=["B","KB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,i)).toFixed(i>0?1:0)} ${t[i]}`}function y6(e){const t=e.split("/").filter(Boolean),i=[{name:"/",path:"/"}];let r="";for(const l of t)r+="/"+l,i.push({name:l,path:r});return i}const zf={File:"file",FileOrDir:"file_or_dir",Dir:"dir"};function Ap({selectMode:e=zf.File,onSelect:t,onDirectoryChange:i,initialDir:r="/",hidePathInput:l=!1}){const[c,u]=y.useState(r),[d,m]=y.useState(r),[f,v]=y.useState([]),[_,S]=y.useState(!1),[x,b]=y.useState(null),[C,T]=y.useState(null),k=rt(c),R=rt(t),N=rt(i);y.useEffect(()=>{E(k.current)},[]);const E=async V=>{S(!0),b(null),T(null),R.current?.(null);try{const G=await p6(V);v(G.entries),u(G.path),m(G.path),N.current?.(G.path)}catch(G){b(G instanceof Error?G.message:String(G)),v([])}S(!1)},z=V=>{if(V.is_dir)if(e===zf.FileOrDir){const G=C===V.path?null:V.path;T(G),R.current?.(G)}else E(V.path);else{if(e===zf.Dir)return;const G=C===V.path?null:V.path;T(G),R.current?.(G)}},B=V=>{V.is_dir&&E(V.path)},I=()=>{const V=d.trim();V&&E(V)},q=V=>{V.key==="Enter"&&I()},F=y6(c);return a.jsxs(a.Fragment,{children:[!l&&a.jsxs("div",{className:"download-section",children:[a.jsx("label",{className:"download-label",children:"Server Path"}),a.jsxs("div",{className:"download-path-row",children:[a.jsx("input",{type:"text",className:"download-path-input",placeholder:"/path/to/directory",value:d,onChange:V=>m(V.target.value),onKeyDown:q}),a.jsx("button",{className:"download-go-btn",onClick:I,disabled:_||!d.trim(),children:"Go"})]})]}),a.jsx("div",{className:"download-breadcrumb",children:F.map((V,G)=>a.jsxs("span",{children:[G>0&&a.jsx("span",{className:"download-breadcrumb-sep",children:"/"}),G<F.length-1?a.jsx("button",{className:"download-breadcrumb-item",onClick:()=>E(V.path),children:V.name}):a.jsx("span",{className:"download-breadcrumb-current",children:V.name})]},V.path))}),x&&a.jsx("div",{className:"download-error",children:x}),_?a.jsx("div",{className:"download-loading",children:"Loading..."}):f.length===0&&!x?a.jsx("div",{className:"download-empty",children:"Directory is empty"}):a.jsx("div",{className:"download-file-list",children:f.map(V=>a.jsxs("button",{className:`download-file-item${C===V.path?" download-file-item-selected":""}`,onClick:()=>z(V),onDoubleClick:()=>B(V),children:[a.jsx("span",{className:"download-file-icon",children:V.is_dir?"":""}),a.jsx("span",{className:"download-file-name",children:V.name}),V.is_dir?a.jsx("span",{className:"download-file-dir-hint",children:""}):a.jsx("span",{className:"download-file-size",children:_6(V.size)})]},V.path))})]})}function Fm(e){if(e===0)return"0 B";const t=["B","KB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,i)).toFixed(i>0?1:0)} ${t[i]}`}function rb(e){return Fm(e)+"/s"}function Lp({progress:e,label:t="Transfer"}){const i=y.useRef(0),r=y.useRef({time:0,loaded:0}),[l,c]=y.useState(0),[u,d]=y.useState(0);if(y.useEffect(()=>{if(!e){i.current=0,r.current={time:0,loaded:0},c(0),d(0);return}const _=Date.now();if(i.current===0){i.current=_,r.current={time:_,loaded:e.loaded};return}const S=(_-i.current)/1e3;S>0&&c(e.loaded/S);const x=r.current,b=_-x.time;if(b>=500){const C=e.loaded-x.loaded,T=b/1e3;T>0&&d(C/T),r.current={time:_,loaded:e.loaded}}},[e]),!e)return null;const m=e.phase===Um.Merging,f=e.totalChunks!=null&&e.totalChunks>1,v=e.chunkLoaded!=null&&e.chunkTotal?Math.round(e.chunkLoaded/e.chunkTotal*100):100;return a.jsxs("div",{className:"transfer-progress",children:[a.jsx("div",{className:"transfer-progress-bar-bg",children:a.jsx("div",{className:"transfer-progress-bar",style:{width:`${e.percent}%`}})}),a.jsxs("div",{className:"transfer-progress-info",children:[a.jsx("span",{className:"transfer-progress-percent",children:m?"Merging...":`${t}: ${e.percent}%`}),a.jsxs("span",{className:"transfer-progress-size",children:[Fm(e.loaded)," / ",Fm(e.total)]})]}),f&&!m&&a.jsxs("div",{className:"transfer-progress-chunk",children:[a.jsxs("div",{className:"transfer-progress-chunk-label",children:["Chunk ",(e.chunkIndex??0)+1," / ",e.totalChunks]}),a.jsx("div",{className:"transfer-progress-chunk-bar-bg",children:a.jsx("div",{className:"transfer-progress-chunk-bar",style:{width:`${v}%`}})})]}),m&&a.jsx("div",{className:"transfer-progress-merging",children:"Combining chunks on server..."}),!m&&a.jsxs("div",{className:"transfer-progress-speed",children:[a.jsxs("span",{children:["Avg: ",rb(l)]}),a.jsxs("span",{children:["Current: ",rb(u)]})]})]})}function ab(e){if(e===0)return"0 B";const t=["B","KB","MB","GB"],i=Math.floor(Math.log(e)/Math.log(1024));return`${(e/Math.pow(1024,i)).toFixed(i>0?1:0)} ${t[i]}`}function lb(){const e=dt(),t=y.useRef(null),[i,r]=y.useState(null),[l,c]=y.useState(""),[u,d]=y.useState(null),[m,f]=y.useState(!1),[v,_]=y.useState(!1),[S,x]=y.useState(null),[b,C]=y.useState(!1),[T,k]=y.useState(null),[R,N]=y.useState(!1),E=V=>{const G=V.target.files?.[0]??null;r(G),C(!1),k(null),d(null)},z=()=>{t.current?.click()},B=async()=>{if(!l.trim()){k("Please enter a server path");return}f(!0),k(null),d(null);try{const V=await sb(l.trim());d(V)}catch(V){k(V instanceof Error?V.message:String(V))}f(!1)},I=async()=>{if(!i){k("Please select a file");return}if(!l.trim()){k("Please enter a server path");return}_(!0),k(null),C(!1),x(null);try{await lw(i,l.trim(),x),C(!0);const V=await sb(l.trim());d(V)}catch(V){k(V instanceof Error?V.message:String(V))}_(!1)},q=V=>{const G=V.replace(/\/$/,"");c(i?G+"/"+i.name:G+"/"),d(null),C(!1)},F=u?.exists&&!u.is_dir&&!b;return a.jsxs("div",{className:"upload-view",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(".."),children:""}),a.jsx("h2",{children:"Upload File"})]}),a.jsxs("div",{className:"upload-form",children:[a.jsxs("div",{className:"upload-section",children:[a.jsx("label",{className:"upload-label",children:"Local File"}),a.jsx("input",{ref:t,type:"file",onChange:E,style:{display:"none"}}),a.jsx("button",{className:"upload-choose-btn",onClick:z,children:i?"Change File":"Choose File"}),i&&a.jsxs("div",{className:"upload-file-info",children:[a.jsxs("div",{className:"upload-file-info-row",children:[a.jsx("span",{className:"upload-file-info-label",children:"Name:"}),a.jsx("span",{className:"upload-file-info-value",children:i.name})]}),a.jsxs("div",{className:"upload-file-info-row",children:[a.jsx("span",{className:"upload-file-info-label",children:"Size:"}),a.jsx("span",{className:"upload-file-info-value",children:ab(i.size)})]}),a.jsxs("div",{className:"upload-file-info-row",children:[a.jsx("span",{className:"upload-file-info-label",children:"Type:"}),a.jsx("span",{className:"upload-file-info-value",children:i.type||"unknown"})]}),a.jsxs("div",{className:"upload-file-info-row",children:[a.jsx("span",{className:"upload-file-info-label",children:"Modified:"}),a.jsx("span",{className:"upload-file-info-value",children:new Date(i.lastModified).toLocaleString()})]})]})]}),a.jsxs("div",{className:"upload-section",children:[a.jsx("label",{className:"upload-label",children:"Server Destination Path"}),a.jsxs("div",{className:"upload-path-row",children:[a.jsx("input",{type:"text",className:"upload-path-input",placeholder:"/path/to/destination/file.txt",value:l,onChange:V=>{c(V.target.value),d(null),C(!1)}}),a.jsx("button",{className:"upload-check-btn",onClick:()=>N(!R),children:"Browse"}),a.jsx("button",{className:"upload-check-btn",onClick:B,disabled:m||!l.trim(),children:m?"Checking...":"Check"})]})]}),R&&a.jsx("div",{className:"upload-section",children:a.jsx(Ap,{selectMode:"dir",hidePathInput:!0,onDirectoryChange:q})}),u&&a.jsxs("div",{className:"upload-section",children:[a.jsx("label",{className:"upload-label",children:"Server File Status"}),u.exists?a.jsxs("div",{className:"upload-server-info",children:[a.jsxs("div",{className:"upload-file-info-row",children:[a.jsx("span",{className:"upload-file-info-label",children:"Status:"}),a.jsx("span",{className:"upload-file-info-value upload-file-exists",children:u.is_dir?"Directory exists":"File exists"})]}),a.jsxs("div",{className:"upload-file-info-row",children:[a.jsx("span",{className:"upload-file-info-label",children:"Path:"}),a.jsx("code",{className:"upload-file-info-code",children:u.path})]}),a.jsxs("div",{className:"upload-file-info-row",children:[a.jsx("span",{className:"upload-file-info-label",children:"Size:"}),a.jsx("span",{className:"upload-file-info-value",children:ab(u.size)})]}),u.mod_time&&a.jsxs("div",{className:"upload-file-info-row",children:[a.jsx("span",{className:"upload-file-info-label",children:"Modified:"}),a.jsx("span",{className:"upload-file-info-value",children:new Date(u.mod_time).toLocaleString()})]}),u.file_mode&&a.jsxs("div",{className:"upload-file-info-row",children:[a.jsx("span",{className:"upload-file-info-label",children:"Permissions:"}),a.jsx("code",{className:"upload-file-info-code",children:u.file_mode})]})]}):a.jsxs("div",{className:"upload-server-info",children:[a.jsxs("div",{className:"upload-file-info-row",children:[a.jsx("span",{className:"upload-file-info-label",children:"Status:"}),a.jsx("span",{className:"upload-file-info-value upload-file-not-exists",children:"File does not exist (will be created)"})]}),a.jsxs("div",{className:"upload-file-info-row",children:[a.jsx("span",{className:"upload-file-info-label",children:"Path:"}),a.jsx("code",{className:"upload-file-info-code",children:u.path})]})]})]}),F&&a.jsx("div",{className:"upload-warning",children:"This file already exists on the server and will be overwritten."}),T&&a.jsx("div",{className:"upload-error",children:T}),v&&a.jsx(Lp,{progress:S,label:"Upload"}),b&&a.jsx("div",{className:"upload-success",children:"File uploaded successfully!"}),a.jsx("button",{className:"upload-submit-btn",onClick:I,disabled:v||!i||!l.trim(),children:v?"Uploading...":F?"Overwrite & Upload":"Upload"})]})]})}function ob(){const e=dt(),[t,i]=y.useState(null),[r,l]=y.useState(!1),[c,u]=y.useState(null),[d,m]=y.useState(null),f=async()=>{if(t){l(!0),u(null),m(null);try{await v6(t,u)}catch(v){m(v instanceof Error?v.message:String(v))}l(!1)}};return a.jsxs("div",{className:"download-view",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(".."),children:""}),a.jsx("h2",{children:"Download File"})]}),a.jsxs("div",{className:"download-form",children:[a.jsx(Ap,{selectMode:"file",onSelect:i}),d&&a.jsx("div",{className:"download-error",children:d}),r&&a.jsx(Lp,{progress:c,label:"Download"}),a.jsx("button",{className:"download-submit-btn",onClick:f,disabled:!t||r,children:r?"Downloading...":t?`Download ${t.split("/").pop()}`:"Select a file to download"})]})]})}const Sr="";async function x6(){const e=await fetch(`${Sr}/api/keep-alive/ping`);if(!e.ok)throw new Error(`ping failed: ${e.status}`);return e.json()}async function S6(){const e=await fetch(`${Sr}/api/keep-alive/status`);if(!e.ok)throw new Error(`status failed: ${e.status}`);return e.json()}function b6(){return fetch(`${Sr}/api/keep-alive/restart-daemon`,{method:"POST",headers:{Accept:"text/event-stream"}})}function w6(){return fetch(`${Sr}/api/server/exec-restart`,{method:"POST",headers:{Accept:"text/event-stream"}})}async function ow(){const e=await fetch(`${Sr}/api/keep-alive/upload-target`);if(!e.ok)throw new Error(`upload-target failed: ${e.status}`);return e.json()}async function C6(e){const t=await fetch(`${Sr}/api/keep-alive/set-binary`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e})});if(!t.ok)throw new Error(`set-binary failed: ${t.status}`);return t.json()}async function j6(e,t){const i=await ow(),r=await lw(e,i.path,t);return await C6(i.path),{target:i,path:r.path,size:r.size}}async function k6(){const e=await fetch(`${Sr}/api/build/buildable-projects`);if(!e.ok)throw new Error(`buildable-projects failed: ${e.status}`);return e.json()}function Pf({label:e,runningLabel:t,action:i,onComplete:r,className:l="",disabled:c=!1,logMaxHeight:u=150,icon:d}){const[m,f]=Is(r),v=()=>{f.run(i)};return a.jsxs("div",{className:"streaming-action-button-container",children:[a.jsx(UM,{label:e,runningLabel:t,onClick:v,running:m.running,className:l,disabled:c,icon:d}),a.jsx(xr,{state:m,pendingMessage:t,maxHeight:u})]})}const N6="";async function E6(){const e=await fetch(`${N6}/api/server/status`);if(!e.ok)throw new Error(`server status failed: ${e.status}`);return e.json()}function cb(){const e=dt(),{goBack:t}=sw(nt.Home,{defaultBackPath:"/home"}),[i,r]=y.useState(null),[l,c]=y.useState(null),[u,d]=y.useState(null),[m,f]=y.useState(!0),[v,_]=y.useState(null),[S,x]=y.useState(null),[b,C]=y.useState(null),[T,k]=y.useState(null),[R,N]=y.useState(null),[E,z]=y.useState(!1),[B,I]=y.useState(null),[q,F]=y.useState([]),[V,G]=y.useState(null),[Y,M]=y.useState([]),[j,A]=y.useState(!1),[D,$]=y.useState(null),[W,ne]=y.useState(!0),U=y.useRef(null),P=y.useRef(null),H=y.useCallback(async()=>{try{_(null);const oe=await x6();if(r(oe.running),c(oe.start_command??null),oe.running){const ye=await S6();d(ye)}else d(null)}catch(oe){_(oe.message||"Failed to fetch status")}finally{f(!1)}},[]);y.useEffect(()=>{H();const oe=setInterval(H,1e4);return()=>clearInterval(oe)},[H]);const L=y.useCallback(async()=>{try{const oe=await E6();$(oe)}catch{$(null)}finally{ne(!1)}},[]);y.useEffect(()=>{L();const oe=setInterval(L,1e4);return()=>clearInterval(oe)},[L]),y.useEffect(()=>{if(!u?.next_health_check_time){C(null);return}const oe=()=>{if(!u.next_health_check_time)return;const ue=new Date(u.next_health_check_time).getTime(),Se=Date.now(),Oe=Math.max(0,Math.ceil((ue-Se)/1e3));C(`${Oe}s`)};oe();const ye=setInterval(oe,1e3);return()=>clearInterval(ye)},[u?.next_health_check_time]),y.useEffect(()=>{(async()=>{try{const ye=await k6();if(F(ye),u?.binary_path){const ue=u.binary_path,Se=ue.match(/-v(\d+)$/),De=(Se?parseInt(Se[1],10):0)+1,yt=Se?ue.replace(/-v\d+$/,`-v${De}`):`${ue}-v1`;G(yt)}}catch{F([])}})()},[u?.binary_path]),y.useEffect(()=>{if(!i){P.current&&(P.current.abort(),P.current=null),A(!1);return}const oe=new AbortController;return P.current=oe,M([]),A(!0),(async()=>{try{const ye=await fetch("/api/keep-alive/logs?lines=100",{headers:{Accept:"text/event-stream"},signal:oe.signal});if(!ye.ok){A(!1);return}await Hs(ye,{onLog:ue=>{M(Se=>{const Oe=[...Se,ue];return Oe.length>500?Oe.slice(Oe.length-500):Oe})},onError:ue=>{M(Se=>[...Se,ue])},onDone:()=>{A(!1)}})}catch{}finally{A(!1)}})(),()=>{oe.abort(),P.current=null}},[i]);const re=async oe=>{const ye=oe.target.files?.[0];if(ye){k(ye),x(null);try{const ue=await ow();N(ue)}catch(ue){_(`Failed to get upload target: ${ue.message}`),k(null)}}},me=async()=>{if(T){z(!0),I(null),x(null);try{const oe=await j6(T,ye=>{I(ye)});x(`Uploaded: ${oe.target.binary_name} (${da(oe.size)})  version ${oe.target.next_version}`),I(null),k(null),N(null),H()}catch(oe){x(`Upload failed: ${oe.message}`),I(null)}finally{z(!1),U.current&&(U.current.value="")}}},he=()=>{k(null),N(null),U.current&&(U.current.value="")},de=async()=>fetch("/api/build/build-next",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({project_id:q[0]?.id})});return a.jsxs("div",{className:"mcc-manage-server",children:[a.jsxs("div",{className:"mcc-section-header",style:{display:"flex",alignItems:"center",gap:8},children:[a.jsx("button",{className:"mcc-back-btn",onClick:t,style:{background:"none",border:"none",cursor:"pointer",padding:4},children:a.jsx(Np,{})}),a.jsx("h2",{style:{margin:0},children:"Manage Server"}),a.jsx("button",{className:"mcc-port-action-btn",onClick:H,style:{marginLeft:"auto"},disabled:m,children:"Refresh"})]}),v&&a.jsx("div",{className:"manage-server-error",children:v}),S&&a.jsx("div",{className:"manage-server-success",children:S}),a.jsxs("div",{className:"manage-server-card",children:[a.jsxs("div",{className:"manage-server-card-header",children:[a.jsx("span",{className:"manage-server-card-title",children:"Keep-Alive Daemon"}),i===null?a.jsx("span",{className:"manage-server-badge manage-server-badge--checking",children:"Checking..."}):i?a.jsx("span",{className:"manage-server-badge manage-server-badge--running",children:"Running"}):a.jsx("span",{className:"manage-server-badge manage-server-badge--stopped",children:"Not Running"})]}),u&&a.jsxs("div",{className:"manage-server-info",children:[a.jsx(wt,{label:"Server PID",value:u.server_pid?String(u.server_pid):"N/A"}),a.jsx(wt,{label:"Server Port",value:String(u.server_port)}),a.jsx(wt,{label:"Keep-Alive PID",value:String(u.keep_alive_pid)}),a.jsx(wt,{label:"Keep-Alive Port",value:String(u.keep_alive_port)}),a.jsx(wt,{label:"Binary",value:u.binary_path,mono:!0}),a.jsx(wt,{label:"Daemon Binary",value:u.daemon_binary_path,mono:!0}),a.jsx(wt,{label:"Restart Count",value:String(u.restart_count)}),u.next_binary&&a.jsx(wt,{label:"Next Binary",value:u.next_binary,mono:!0,highlight:!0}),b&&a.jsx(wt,{label:"Next Check",value:b}),u.uptime&&a.jsx(wt,{label:"Uptime",value:u.uptime}),u.started_at&&a.jsx(wt,{label:"Started At",value:(()=>{const oe=new Date(u.started_at),ye=oe.toLocaleDateString("en-CA"),ue=oe.toLocaleTimeString("en-US",{hour12:!0});return`${ye} ${ue}`})()})]}),!i&&!m&&a.jsxs("div",{className:"manage-server-hint",children:[a.jsx("p",{children:"The keep-alive daemon is not running. Start it with:"}),l&&a.jsx("pre",{className:"manage-server-command",children:l})]})]}),i&&a.jsxs("div",{className:"manage-server-actions",children:[a.jsx(Pf,{label:"Restart Server",runningLabel:"Restarting Server...",action:w6,className:"manage-server-btn manage-server-btn--restart",logMaxHeight:200,onComplete:oe=>{oe.ok&&setTimeout(H,3e3)}}),a.jsx(Pf,{label:"Restart Daemon",runningLabel:"Restarting Daemon...",action:b6,className:"manage-server-btn manage-server-btn--restart",logMaxHeight:200,onComplete:oe=>{oe.ok&&setTimeout(H,3e3)}}),a.jsxs("div",{children:[T?a.jsxs("div",{className:"manage-server-confirm",children:[a.jsxs("div",{className:"manage-server-confirm-info",children:[a.jsxs("div",{className:"manage-server-confirm-row",children:[a.jsx("span",{className:"manage-server-info-label",children:"File"}),a.jsxs("span",{className:"manage-server-info-value",children:[T.name," (",da(T.size),")"]})]}),R&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"manage-server-confirm-row",children:[a.jsx("span",{className:"manage-server-info-label",children:"Target Path"}),a.jsx("span",{className:"manage-server-info-value manage-server-info-value--mono",children:R.path})]}),a.jsxs("div",{className:"manage-server-confirm-row",children:[a.jsx("span",{className:"manage-server-info-label",children:"Version"}),a.jsxs("span",{className:"manage-server-info-value",children:["v",R.current_version,"  v",R.next_version]})]})]})]}),a.jsxs("div",{className:"manage-server-confirm-actions",children:[a.jsx("button",{className:"manage-server-btn manage-server-btn--confirm",onClick:me,disabled:E,children:E?"Uploading...":"Confirm Upload"}),a.jsx("button",{className:"manage-server-btn manage-server-btn--cancel",onClick:he,disabled:E,children:"Cancel"})]})]}):a.jsxs("label",{className:"manage-server-btn manage-server-btn--upload",style:{cursor:E?"not-allowed":"pointer"},children:["Upload New Binary",a.jsx("input",{ref:U,type:"file",style:{display:"none"},onChange:re,disabled:E})]}),E&&a.jsx(Lp,{progress:B,label:"Upload"}),a.jsx("p",{className:"manage-server-upload-hint",children:"Upload a new binary. It will be placed with the next version number and used on next restart."}),a.jsxs("div",{style:{marginTop:16,borderTop:"1px solid #e5e7eb",paddingTop:16},children:[a.jsx(Pf,{label:"Build Next",runningLabel:"Building...",action:de,className:"manage-server-btn manage-server-btn--upload",logMaxHeight:200,disabled:q.length===0,onComplete:oe=>{oe.ok&&H()}}),V&&a.jsxs("div",{className:"manage-server-confirm-row",style:{marginTop:8,fontSize:12},children:[a.jsx("span",{className:"manage-server-info-label",children:"Output:"}),a.jsx("span",{className:"manage-server-info-value manage-server-info-value--mono",style:{fontSize:11},children:V})]}),q.length===0?a.jsx("p",{className:"manage-server-upload-hint",style:{color:"#dc2626"},children:"No buildable projects found. Ensure the project has a script/server/build directory."}):a.jsxs("p",{className:"manage-server-upload-hint",children:["Build the next binary from source using script/server/build/for-linux-amd64.",q[0]&&a.jsxs(a.Fragment,{children:[" Project: ",a.jsx("strong",{children:q[0].name})]})]})]})]})]}),a.jsxs("div",{className:"manage-server-card",style:{marginTop:12},children:[a.jsx("div",{className:"manage-server-card-header",children:a.jsx("span",{className:"manage-server-card-title",children:"Server Status"})}),W?a.jsx("div",{style:{padding:16,color:"#6b7280"},children:"Loading..."}):D?a.jsxs("div",{className:"manage-server-info",children:[a.jsx(wt,{label:"OS",value:D.os_info.os}),a.jsx(wt,{label:"Arch",value:D.os_info.arch}),a.jsx(wt,{label:"Kernel",value:D.os_info.kernel}),a.jsx(wt,{label:"CPU Cores",value:String(D.cpu.num_cpu)}),a.jsx(wt,{label:"CPU Usage",value:`${D.cpu.used_percent.toFixed(1)}%`}),a.jsx(wt,{label:"Total Memory",value:da(D.memory.total)}),a.jsx(wt,{label:"Used Memory",value:`${da(D.memory.used)} (${D.memory.used_percent.toFixed(1)}%)`}),D.disk.map((oe,ye)=>a.jsx(wt,{label:`Disk ${oe.mount_point}`,value:`${da(oe.used)} / ${da(oe.size)} (${oe.use_percent.toFixed(1)}%)`},ye)),a.jsx("div",{style:{marginTop:12,fontWeight:600,fontSize:13,color:"#374151"},children:"Top CPU Processes"}),D.top_cpu.map((oe,ye)=>a.jsx(wt,{label:`${oe.name} (PID: ${oe.pid})`,value:`CPU: ${oe.cpu} | Mem: ${oe.mem}`,mono:!0},ye)),a.jsx("div",{style:{marginTop:12,fontWeight:600,fontSize:13,color:"#374151"},children:"Top Memory Processes"}),D.top_mem.map((oe,ye)=>a.jsx(wt,{label:`${oe.name} (PID: ${oe.pid})`,value:`CPU: ${oe.cpu} | Mem: ${oe.mem}`,mono:!0},ye))]}):a.jsx("div",{style:{padding:16,color:"#6b7280"},children:"Unable to load server status"})]}),i&&a.jsxs("div",{className:"manage-server-card",style:{marginTop:12},children:[a.jsxs("div",{className:"manage-server-card-header",children:[a.jsx("span",{className:"manage-server-card-title",children:"Server Logs"}),a.jsx("span",{className:`manage-server-badge ${j?"manage-server-badge--running":"manage-server-badge--stopped"}`,children:j?"Live":"Disconnected"})]}),a.jsx(ii,{lines:Y,pending:j,pendingMessage:"Streaming...",emptyMessage:"No log output yet...",maxHeight:300})]}),a.jsxs("div",{className:"manage-server-card",style:{marginTop:12},children:[a.jsx("div",{className:"manage-server-card-header",children:a.jsx("span",{className:"manage-server-card-title",children:"File Manager"})}),a.jsxs("button",{className:"manage-server-btn manage-server-btn--file-transfer",onClick:()=>e("../manage-files"),style:{width:"100%",marginBottom:0},children:[a.jsx(K1,{}),a.jsx("span",{children:"Manage Files"})]})]}),a.jsxs("div",{className:"manage-server-card",style:{marginTop:12},children:[a.jsx("div",{className:"manage-server-card-header",children:a.jsx("span",{className:"manage-server-card-title",children:"File Transfer"})}),a.jsxs("div",{className:"manage-server-file-transfer",children:[a.jsxs("button",{className:"manage-server-btn manage-server-btn--file-transfer",onClick:()=>e("../upload-file"),children:[a.jsx(q1,{}),a.jsx("span",{children:"Upload File"})]}),a.jsxs("button",{className:"manage-server-btn manage-server-btn--file-transfer",onClick:()=>e("../download-file"),children:[a.jsx(pM,{}),a.jsx("span",{children:"Download File"})]})]})]})]})}function wt({label:e,value:t,mono:i,highlight:r}){return a.jsxs("div",{className:"manage-server-info-row",children:[a.jsx("span",{className:"manage-server-info-label",children:e}),a.jsx("span",{className:`manage-server-info-value${i?" manage-server-info-value--mono":""}${r?" manage-server-info-value--highlight":""}`,children:t})]})}function da(e){return e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:e<1024*1024*1024?`${(e/(1024*1024)).toFixed(1)} MB`:e<1024*1024*1024*1024?`${(e/(1024*1024*1024)).toFixed(1)} GB`:`${(e/(1024*1024*1024*1024)).toFixed(1)} TB`}function ub(){const e=dt(),{fetchProjects:t}=In(),[i,r]=y.useState(""),[l,c]=y.useState(""),[u,d]=y.useState(!1),[m,f]=y.useState(null),[v,_]=y.useState(null),S=b=>{r(b),f(null),_(null)},x=async()=>{if(!i){f("Please select a directory");return}d(!0),f(null),_(null);try{const b=await UL({dir:i,name:l.trim()||void 0});_(`Added workspace: ${b.name} (${b.dir})`),t()}catch(b){f(b instanceof Error?b.message:String(b))}d(!1)};return a.jsxs("div",{className:"add-fs-view",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:()=>e(".."),children:""}),a.jsx("h2",{children:"Add From Filesystem"})]}),a.jsxs("div",{className:"add-fs-form",children:[a.jsxs("div",{className:"add-fs-section",children:[a.jsx("label",{className:"add-fs-label",children:"Workspace Name (optional)"}),a.jsx("input",{type:"text",className:"add-fs-input",placeholder:"Leave empty to use directory name",value:l,onChange:b=>c(b.target.value)})]}),a.jsxs("div",{className:"add-fs-section",children:[a.jsx("label",{className:"add-fs-label",children:"Selected Directory"}),a.jsx("div",{className:"add-fs-selected-dir",children:i||"Browse below to select a directory"})]}),a.jsxs("div",{className:"add-fs-section add-fs-browser-section",children:[a.jsx("label",{className:"add-fs-label",children:"Browse Server Filesystem"}),a.jsx(Ap,{selectMode:"dir",onDirectoryChange:S})]}),m&&a.jsx("div",{className:"add-fs-error",children:m}),v&&a.jsx("div",{className:"add-fs-success",children:v}),a.jsx("button",{className:"add-fs-submit-btn",onClick:x,disabled:u||!i,children:u?"Adding...":"Add Workspace"})]})]})}function hb(){return null}function Mp(e){const t=dt(),{currentProject:i}=In(),r=rt(i);return l=>{const c=r.current,u=c?`/project/${encodeURIComponent(c.name)}/${e}`:`/${e}`;t(l?`${u}/${l}`:u,{replace:!0})}}function db(){const{currentProject:e,agents:t,agentsLoading:i,refreshAgents:r,agentSessions:l,setAgentSession:c,agentLaunchError:u,setAgentLaunchError:d}=In(),m=e?.dir??null,f=e?.name??null,v=Mp(nt.Agent),[_,S]=y.useState(null),x=rt(m),b=rt(c),C=y.useCallback(()=>m?(S(null),jp().then(N=>{const E=N.filter(z=>z.project_dir===x.current&&(z.status===ci.Running||z.status===ci.Starting));for(const z of E)b.current(z.agent_id,z)}).catch(N=>{const E=N instanceof Error?N.message:String(N);console.error("Failed to load agent sessions:",E),S(E)})):Promise.resolve(),[m]);y.useEffect(()=>{C()},[m]),y.useEffect(()=>{const N=()=>{document.visibilityState==="visible"&&C()};return document.addEventListener("visibilitychange",N),()=>document.removeEventListener("visibilitychange",N)},[C]);const T=async N=>{if(m){d("");try{const E=N.id==="cursor-agent"?Dp():void 0,z=await VL(N.id,m,E);c(N.id,z),v(N.id)}catch(E){d(E instanceof Error?E.message:String(E))}}},k=async N=>{const E=l[N];if(E){try{await z1(E.id)}catch{}c(N,null),v("")}};if(!m)return a.jsx("div",{className:"mcc-agent-view",children:a.jsxs("div",{className:"mcc-empty-state",children:[a.jsx(dM,{}),a.jsx("h3",{children:"No Project Selected"}),a.jsx("p",{children:"Select a project from the Home tab to start an agent."})]})});const R={projectName:f,agents:t,agentsLoading:i,sessions:l,setSession:c,launchError:u,sessionsLoadError:_,onLaunchHeadless:T,onStopAgent:k,onRefreshAgents:r,navigateToView:v};return a.jsxs(a.Fragment,{children:[_&&a.jsxs("div",{className:"mcc-agent-error",style:{margin:"12px 16px",padding:"12px 16px",background:"#fef2f2",border:"1px solid #fecaca",borderRadius:"8px"},children:[a.jsx("strong",{children:"Error loading sessions:"})," ",_]}),a.jsx(Na,{context:R})]})}function Bp({agents:e,loading:t,launchError:i,sessions:r,onLaunchHeadless:l,onOpenSessions:c,onStopAgent:u,onConfigureAgent:d}){return a.jsxs("div",{className:"mcc-agent-view",children:[a.jsx("div",{className:"mcc-agent-header",children:a.jsx("h2",{children:"Agents"})}),t&&a.jsx("div",{className:"mcc-agent-loading",children:"Loading agents..."}),i&&a.jsx("div",{className:"mcc-agent-error",children:i}),a.jsx("div",{className:"mcc-agent-list",children:e.map(m=>{const f=r[m.id];return a.jsxs("div",{className:"mcc-agent-card",children:[a.jsxs("div",{className:"mcc-agent-card-header",children:[a.jsxs("div",{className:"mcc-agent-card-info",children:[a.jsx("span",{className:"mcc-agent-card-name",children:m.name}),a.jsx("span",{className:`mcc-agent-card-status ${m.installed?"installed":"not-installed"}`,children:m.installed?"Installed":"Not installed"}),f&&a.jsx("span",{className:`mcc-agent-card-status ${f.status}`,children:f.status})]}),a.jsx("button",{className:"mcc-agent-card-settings-icon",onClick:()=>d(m.id),title:"Settings",children:a.jsx(Au,{})})]}),a.jsx("div",{className:"mcc-agent-card-desc",children:m.description}),a.jsxs("div",{className:"mcc-agent-card-actions",children:[m.headless&&m.installed&&f&&a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"mcc-forward-btn mcc-agent-launch-btn",onClick:()=>c(m.id),children:"Open Sessions"}),a.jsx("button",{className:"mcc-agent-stop-btn",onClick:()=>u(m.id),children:"Stop"})]}),m.headless&&m.installed&&!f&&a.jsx("button",{className:"mcc-forward-btn mcc-agent-launch-btn",onClick:()=>l(m),children:"Start Chat"}),!m.headless&&m.installed&&a.jsx("span",{className:"mcc-agent-card-note",children:"Terminal-only agent"}),!m.installed&&a.jsx("button",{className:"mcc-forward-btn mcc-agent-configure-btn",onClick:()=>d(m.id),children:"Configure Path"})]})]},m.id)})})]})}function fb(){const e=Qt();return a.jsx(Bp,{agents:e.agents,loading:e.agentsLoading,launchError:e.launchError,sessions:e.sessions,onLaunchHeadless:e.onLaunchHeadless,onOpenSessions:t=>e.navigateToView(t),onStopAgent:e.onStopAgent,onConfigureAgent:t=>e.navigateToView(`${t}/settings`)})}const xu={User:"user",Agent:"agent"},$m={TextPlain:"text/plain",ToolCall:"tool/call",Thinking:"text/thinking"},Sa={MessageCreated:"acp.message.created",MessageUpdated:"acp.message.updated",MessageCompleted:"acp.message.completed"};function T6(e){try{const t=JSON.parse(e);if(!t.type||!t.message)return null;const i=t.type,r=t.message;switch(i){case Sa.MessageCreated:return l=>{const c=l.findIndex(u=>u.id===r.id);if(c>=0){const u=[...l];return u[c]=Hf(u[c],r),u}return[...l,r]};case Sa.MessageUpdated:return l=>{const c=l.findIndex(u=>u.id===r.id);if(c>=0){const u=[...l];return u[c]=Hf(u[c],r),u}return[...l,r]};case Sa.MessageCompleted:return l=>{const c=l.findIndex(u=>u.id===r.id);if(c>=0){const u=[...l];return u[c]=Hf(u[c],r),u}return[...l,r]};default:return null}}catch{return null}}function Hf(e,t){const i=[...e.parts];for(const r of t.parts){const l=i.findIndex(c=>c.id===r.id);l>=0?i[l]=r:i.push(r)}return{...e,...t,parts:i}}function cw(e){return!Array.isArray(e)||e.length===0?[]:e}function If(e,t){const i=e.toLowerCase(),r=t.toLowerCase();if(i===r)return 1e3;if(i.startsWith(r))return 500;if(i.includes(r))return 100;let l=0,c=0,u=-1;for(let d=0;d<i.length&&l<r.length;d++)i[d]===r[l]&&(u===d-1?c+=10:c+=1,u=d,l++);return l<r.length?0:c}function R6(e,t){return t.trim()?e.map(r=>{const l=If(r.name,t),c=If(r.id,t),u=If(r.providerName,t),d=Math.max(l,c,u);return{model:r,score:d}}).filter(r=>r.score>0).sort((r,l)=>l.score-r.score).map(r=>r.model):e}function uw({models:e,currentModel:t,onSelect:i,placeholder:r="Select model...",disabled:l=!1}){const[c,u]=y.useState(!1),[d,m]=y.useState(""),f=y.useRef(null),v=y.useRef(null);y.useEffect(()=>{if(!c)return;const T=k=>{f.current&&!f.current.contains(k.target)&&(u(!1),m(""))};return document.addEventListener("mousedown",T),()=>document.removeEventListener("mousedown",T)},[c]),y.useEffect(()=>{c&&v.current&&v.current.focus()},[c]);const _=y.useMemo(()=>R6(e,d),[e,d]),S=y.useMemo(()=>{const T={};return _.forEach(k=>{T[k.providerName]||(T[k.providerName]=[]),T[k.providerName].push(k)}),T},[_]),x=y.useMemo(()=>t?e.find(T=>T.id===t.modelID&&T.providerId===t.providerID):null,[e,t]),b=T=>{i({modelID:T.id,providerID:T.providerId}),u(!1),m("")},C=T=>{T.key==="Escape"&&(u(!1),m(""))};return l||e.length===0?a.jsx("span",{className:"mcc-model-selector-trigger mcc-model-selector-disabled",children:x?x.name:r}):a.jsxs("div",{className:"mcc-model-selector",ref:f,children:[a.jsxs("button",{className:"mcc-model-selector-trigger",onClick:()=>u(!c),type:"button",children:[a.jsx("span",{className:"mcc-model-selector-current",children:x?x.name:r}),a.jsx("span",{className:"mcc-model-selector-chevron",children:""})]}),c&&a.jsxs("div",{className:"mcc-model-selector-dropdown",children:[a.jsxs("div",{className:"mcc-model-selector-search",children:[a.jsx("input",{ref:v,type:"text",placeholder:"Search models...",value:d,onChange:T=>m(T.target.value),onKeyDown:C,className:"mcc-model-selector-search-input"}),d&&a.jsxs("span",{className:"mcc-model-selector-search-count",children:[_.length," found"]})]}),a.jsx("div",{className:"mcc-model-selector-list",children:_.length===0?a.jsxs("div",{className:"mcc-model-selector-empty",children:['No models match "',d,'"']}):Object.entries(S).map(([T,k])=>a.jsxs("div",{className:"mcc-model-selector-group",children:[a.jsx("div",{className:"mcc-model-selector-provider",children:T}),k.map(R=>{const N=t?.modelID===R.id&&t?.providerID===R.providerId;return a.jsxs("button",{className:`mcc-model-selector-option${N?" mcc-model-selector-option-active":""}`,onClick:()=>b(R),type:"button",children:[a.jsx("span",{className:"mcc-model-selector-option-name",children:R.name}),a.jsx("span",{className:"mcc-model-selector-option-id",children:R.id}),R.is_default&&a.jsx("span",{className:"mcc-model-selector-badge",children:"default"}),R.is_current&&a.jsx("span",{className:"mcc-model-selector-badge mcc-model-selector-badge-current",children:"current"})]},`${R.providerId}:${R.id}`)})]},T))})]})]})}function pr({agentName:e,projectName:t,onStop:i,onBack:r,stopLabel:l="Stop",contextPercent:c,availableModels:u,currentModel:d,onModelChange:m}){const f=u&&u.length>0&&m;return a.jsxs("div",{className:"mcc-agent-chat-header",children:[r&&a.jsx("button",{className:"mcc-agent-back-btn",onClick:r,title:"Back to agents",children:a.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:a.jsx("path",{d:"M19 12H5M12 19l-7-7 7-7"})})}),a.jsxs("div",{className:"mcc-agent-chat-title",children:[a.jsx("span",{children:e}),f&&d&&a.jsxs("div",{className:"mcc-agent-model-info",children:[a.jsx(uw,{models:u,currentModel:d,onSelect:m,placeholder:"Select model..."}),c!==void 0&&a.jsxs("span",{className:"mcc-agent-context-usage",children:[c,"%"]})]})]}),i&&a.jsx("button",{className:"mcc-agent-stop-btn",onClick:i,children:l})]})}function D6(e,t){return e.length<=t?e:e.slice(0,t)+"..."}function mb(e){if(!e?.model)return;const t=e.model.split("/");if(t.length>=2)return{providerID:t[0],modelID:t[1]}}function A6({session:e,projectName:t,onBack:i,onStop:r,onSelectSession:l,onSessionUpdate:c,onSettings:u}){const[d,m]=y.useState([]),[f,v]=y.useState(!0),[_,S]=y.useState(!1),[x,b]=y.useState(1),[C,T]=y.useState(1),[k,R]=y.useState(0),[N,E]=y.useState(null),z=20,B=rt(l),I=rt(e);y.useEffect(()=>{kp().then(G=>E(G)).catch(()=>{})},[]),y.useEffect(()=>{if(e.status!==ci.Starting)return;const G=setInterval(async()=>{try{const M=(await jp()).find(j=>j.id===I.current.id);M&&c(M)}catch{}},1500);return()=>clearInterval(G)},[e.id,e.status]),y.useEffect(()=>{if(e.status!==ci.Running)return;let G=!1;return(async()=>{v(!0);try{const M=await GL(e.id,x,z);if(G)return;if(M.total===0){const A=mb(N),D=await HS(e.id,A);G||B.current(D.id);return}T(M.total_pages),R(M.total);const j=await Promise.all(M.items.map(async A=>{try{const D=await U1(e.id,A.id),ne=cw(D).find(U=>U.role===xu.User)?.parts.map(U=>U.content||"").join(" ").trim()||"";return{id:A.id,firstMessage:ne,created_at:A.created_at}}catch{return{id:A.id,firstMessage:"",created_at:A.created_at}}}));G||(m(j),v(!1))}catch{G||v(!1)}})(),()=>{G=!0}},[e.id,e.status,x]);const q=async()=>{S(!0);try{const G=mb(N),Y=await HS(e.id,G);l(Y.id)}catch{}S(!1)},F=G=>{G>=1&&G<=C&&b(G)},V=()=>C<=1?null:a.jsxs("div",{className:"mcc-agent-pagination",children:[a.jsxs("div",{className:"mcc-agent-pagination-info",children:["Showing ",d.length," of ",k," sessions"]}),a.jsxs("div",{className:"mcc-agent-pagination-controls",children:[a.jsx("button",{className:"mcc-agent-pagination-btn",onClick:()=>F(x-1),disabled:x===1,children:""}),a.jsxs("span",{className:"mcc-agent-pagination-page",children:["Page ",x," of ",C]}),a.jsx("button",{className:"mcc-agent-pagination-btn",onClick:()=>F(x+1),disabled:x===C,children:""})]})]});return e.status===ci.Starting?a.jsxs("div",{className:"mcc-agent-view",children:[a.jsx(pr,{agentName:e.agent_name,projectName:t,onStop:r,onBack:i}),a.jsxs("div",{className:"mcc-agent-starting",children:[a.jsx("div",{className:"mcc-agent-spinner"}),a.jsx("span",{children:"Starting agent server..."})]})]}):a.jsxs("div",{className:"mcc-agent-view",children:[a.jsx(pr,{agentName:e.agent_name,projectName:t,onBack:i}),a.jsxs("div",{className:"mcc-agent-header",style:{paddingTop:4},children:[a.jsx("h2",{children:"Sessions"}),u&&a.jsx("button",{className:"mcc-agent-settings-icon-btn",onClick:u,title:"Agent Settings",children:a.jsx(Au,{})})]}),a.jsx("div",{className:"mcc-agent-new-chat-row",children:a.jsx("button",{className:"mcc-forward-btn mcc-agent-new-chat-btn",onClick:q,disabled:_,children:_?"...":"+ New Chat"})}),f?a.jsx("div",{className:"mcc-agent-loading",children:"Loading sessions..."}):d.length===0?a.jsx("div",{className:"mcc-agent-loading",children:"No sessions yet"}):a.jsxs(a.Fragment,{children:[V(),a.jsx("div",{className:"mcc-agent-session-list",children:d.map((G,Y)=>{const M=k-(x-1)*z-Y;return a.jsxs("button",{className:"mcc-agent-session-card",onClick:()=>l(G.id),children:[a.jsxs("div",{className:"mcc-agent-session-card-title",children:["Session ",M]}),a.jsx("div",{className:"mcc-agent-session-card-preview",children:G.firstMessage?D6(G.firstMessage,100):"No messages yet"}),a.jsxs("div",{className:"mcc-agent-session-card-id",children:[G.id.slice(0,8),"..."]})]},G.id)})}),V()]})]})}function pb(){const e=Qt(),i=es().agentId||"",r=e.sessions[i];return r?a.jsx(A6,{session:r,projectName:e.projectName,onBack:()=>e.navigateToView(""),onStop:()=>e.onStopAgent(i),onSelectSession:l=>e.navigateToView(`${i}/${l}`),onSessionUpdate:l=>e.setSession(i,l),onSettings:()=>e.navigateToView(`${i}/settings`)}):a.jsx(Bp,{agents:e.agents,loading:e.agentsLoading,launchError:e.launchError,sessions:e.sessions,onLaunchHeadless:e.onLaunchHeadless,onOpenSessions:l=>e.navigateToView(l),onStopAgent:e.onStopAgent,onConfigureAgent:l=>e.navigateToView(`${l}/settings`)})}function L6(e){const t=[];for(const i of e){const r=t[t.length-1];r&&r[0].role===i.role?r.push(i):t.push([i])}return t}function M6({messages:e}){const t=e[0].role===xu.User,i=[],r=[];for(const l of e)for(const c of l.parts)c.content_type===$m.Thinking?i.push(c):r.push(c);return a.jsxs("div",{className:`mcc-agent-msg ${t?"mcc-agent-msg-user":"mcc-agent-msg-assistant"}`,children:[a.jsx("div",{className:"mcc-agent-msg-avatar",children:t?"":""}),a.jsxs("div",{className:"mcc-agent-msg-content",children:[i.length>0&&a.jsx(B6,{parts:i}),r.map((l,c)=>a.jsx(O6,{part:l},l.id||c))]})]})}function B6({parts:e}){const[t,i]=y.useState(!1),r=e.map(f=>f.content||"").join(`
`).trim(),l=r.length>0,c=e.some(f=>!f.content||f.content==="");if(!l&&!c)return null;const u=r.split(`
`),d=u.length>3,m=d&&!t?u.slice(0,3).join(`
`):r;return a.jsxs("div",{className:"mcc-agent-msg-thinking",children:[a.jsxs("div",{className:"mcc-agent-msg-thinking-label",children:[a.jsx("span",{className:"mcc-agent-msg-thinking-icon",children:""}),a.jsx("span",{children:c&&!l?"Thinking...":"Thinking"})]}),l&&a.jsx("div",{className:`mcc-agent-msg-thinking-content ${!t&&d?"clamped":""}`,children:m}),d&&a.jsx("button",{className:"mcc-agent-msg-thinking-toggle",onClick:()=>i(!t),children:t?"Show less":"Show more"})]})}function O6({part:e}){return e.content_type===$m.TextPlain?e.content?a.jsx("div",{className:"mcc-agent-msg-text",children:e.content}):null:e.content_type===$m.ToolCall?a.jsx(z6,{part:e}):e.content?a.jsx("div",{className:"mcc-agent-msg-text",children:e.content}):null}const gb=500;function vb({text:e,className:t}){const[i,r]=y.useState(!1),l=e.length>gb,c=!i&&l?e.slice(0,gb)+"...":e;return a.jsxs(a.Fragment,{children:[a.jsx("pre",{className:t,children:c}),l&&a.jsx("button",{className:"mcc-agent-msg-tool-expand-btn",onClick:()=>r(!i),children:i?"Show less":"Show more"})]})}function z6({part:e}){const t=e.name||"tool",i=e.metadata?.status,r=i==="running"||i==="pending",l=i==="error",c=e.metadata?.output,u=e.metadata?.error,d=e.metadata?.title;let m="";const f=e.metadata?.input||P6(e.content);if(f&&typeof f=="object"){const v=f;m=v.filePath||v.path||v.file||""}return a.jsxs("div",{className:`mcc-agent-msg-tool ${r?"running":""} ${l?"error":""}`,children:[a.jsxs("div",{className:"mcc-agent-msg-tool-header",children:[a.jsx("span",{className:"mcc-agent-msg-tool-icon",children:r?"":l?"":""}),a.jsx("span",{className:"mcc-agent-msg-tool-name",children:d||t}),m&&a.jsx("span",{className:"mcc-agent-msg-tool-file",children:m})]}),c&&a.jsx(vb,{text:c,className:"mcc-agent-msg-tool-output"}),u&&a.jsx(vb,{text:u,className:"mcc-agent-msg-tool-error"})]})}function P6(e){try{return JSON.parse(e)}catch{return null}}function H6({session:e,projectName:t,opencodeSID:i,onStop:r,onBack:l,onSessionUpdate:c}){const[u,d]=y.useState([]),[m,f]=y.useState(""),[v,_]=y.useState(!1),[S,x]=y.useState(!1),[b,C]=y.useState(null),[T,k]=y.useState(null),[R,N]=y.useState(0),[E,z]=y.useState([]),B=X1([u]),I=rt(e);y.useEffect(()=>{if(e.status!==ci.Starting)return;const j=setInterval(async()=>{try{const D=(await jp()).find($=>$.id===I.current.id);D&&c(D)}catch{}},1500);return()=>clearInterval(j)},[e.id,e.status]),y.useEffect(()=>{e.status===ci.Running&&Promise.all([P1(e.id),I1(e.id),kp()]).then(([j,A,D])=>{const $=[];for(const U of A.providers||[])for(const[,P]of Object.entries(U.models||{}))$.push({id:P.id,name:P.name,providerId:U.id,providerName:U.name||U.id,is_default:P.is_default,is_current:P.is_current});$.sort((U,P)=>{const H=U.providerName.localeCompare(P.providerName);return H!==0?H:U.name.localeCompare(P.name)}),z($);let W=j.model?.modelID,ne=j.model?.providerID;if(!W&&D?.model){const U=D.model.split("/");U.length>=2&&(ne=U[0],W=U[1])}if(!W&&A.default){const U=A.default,P=Object.keys(U)[0];P&&(ne=P,W=U[P])}if(ne&&W){const P=A.providers?.find(H=>H.id===ne)?.models?.[W];P?.limit?.context&&N(P.limit.context)}k({...j,model:W?{modelID:W,providerID:ne||""}:j.model})}).catch(()=>{})},[e.id,e.status]),y.useEffect(()=>{!i||e.status!==ci.Running||U1(e.id,i).then(j=>{const A=cw(j);if(d(A),A.length>0)for(let D=A.length-1;D>=0;D--){const $=A[D];if($.role===xu.User&&$.model){const W=$.model.split("/");W.length>=2&&k(ne=>ne&&{...ne,model:{modelID:W[1],providerID:W[0]}});break}}}).catch(()=>{})},[i,e.status]),y.useEffect(()=>{if(e.status!==ci.Running)return;const j=new EventSource(XL(e.id));return j.onmessage=A=>{const D=T6(A.data);D&&d(D);try{const $=JSON.parse(A.data),W=$?.type;if($?.message?.role===xu.Agent&&(W===Sa.MessageCreated||W===Sa.MessageUpdated?x(!0):W===Sa.MessageCompleted&&x(!1)),W==="session.idle"&&x(!1),W==="session.status"){const U=$?.properties?.status?.type;U==="idle"?x(!1):U==="busy"&&x(!0)}}catch{}},()=>j.close()},[e.id,e.status]);const q=async()=>{if(!m.trim()||!i)return;const j=m.trim();f(""),_(!0),x(!0);try{const A=T?.model;await YL(e.id,i,j,A)}catch{}_(!1)},F=async j=>{try{await H1(e.id,{model:{modelID:j.modelID}}),k(A=>A&&{...A,model:{modelID:j.modelID,providerID:j.providerID}})}catch(A){C(`Failed to change model: ${A instanceof Error?A.message:String(A)}`)}},V=async()=>{try{await z1(e.id),r()}catch{}},G=j=>{j.key==="Enter"&&!j.shiftKey&&(j.preventDefault(),q())};if(e.status===ci.Starting)return a.jsxs("div",{className:"mcc-agent-view",children:[a.jsx(pr,{agentName:e.agent_name,projectName:t,onStop:r,onBack:l}),a.jsxs("div",{className:"mcc-agent-starting",children:[a.jsx("div",{className:"mcc-agent-spinner"}),a.jsx("span",{children:"Starting agent server..."})]})]});if(e.status===ci.Error)return a.jsxs("div",{className:"mcc-agent-view",children:[a.jsx(pr,{agentName:e.agent_name,projectName:t,onStop:r,onBack:l,stopLabel:"Close"}),a.jsxs("div",{className:"mcc-agent-error-state",children:[a.jsx("span",{children:"Agent failed to start"}),e.error&&a.jsx("p",{className:"mcc-agent-error",children:e.error}),a.jsx("button",{className:"mcc-forward-btn",onClick:r,children:"Try Again"})]})]});const Y=T?.model?.modelID||void 0,M=(R>0,void 0);return a.jsxs("div",{className:"mcc-agent-view mcc-agent-view-chat",children:[a.jsx(pr,{agentName:e.agent_name,projectName:t,onBack:l,modelName:Y,contextPercent:M,availableModels:E,currentModel:T?.model,onModelChange:F}),a.jsxs("div",{className:"mcc-agent-messages",ref:B,children:[a.jsxs("div",{className:"mcc-agent-msg mcc-agent-msg-assistant",children:[a.jsx("div",{className:"mcc-agent-msg-avatar",children:""}),a.jsx("div",{className:"mcc-agent-msg-content",children:a.jsxs("div",{className:"mcc-agent-msg-text",children:["Hi! I'm ",e.agent_name,". I'm ready to help with your project. What would you like to work on?"]})})]}),L6(u).map((j,A)=>a.jsx(M6,{messages:j},j[0].id||A))]}),b&&a.jsxs("div",{className:"mcc-agent-error-toast",children:[a.jsx("span",{children:b}),a.jsx("button",{className:"mcc-agent-error-toast-close",onClick:()=>C(null),children:""})]}),a.jsxs("div",{className:"mcc-agent-input-area",children:[a.jsx("textarea",{className:"mcc-agent-input",placeholder:"Type a message...",value:m,onChange:j=>f(j.target.value),onKeyDown:G,rows:2,disabled:v||S}),S?a.jsx("button",{className:"mcc-agent-send-btn mcc-agent-stop-btn",onClick:V,children:"Stop"}):a.jsx("button",{className:"mcc-agent-send-btn",onClick:q,disabled:!m.trim()||v,children:v?"...":"Send"})]})]})}function _b(){const e=Qt(),t=es(),i=t.agentId||"",r=t.sessionId||"",l=e.sessions[i];return l?a.jsx(H6,{session:l,projectName:e.projectName,opencodeSID:r,onStop:()=>e.onStopAgent(i),onBack:()=>e.navigateToView(i),onSessionUpdate:c=>e.setSession(i,c)}):a.jsx(Bp,{agents:e.agents,loading:e.agentsLoading,launchError:e.launchError,sessions:e.sessions,onLaunchHeadless:e.onLaunchHeadless,onOpenSessions:c=>e.navigateToView(c),onStopAgent:e.onStopAgent,onConfigureAgent:c=>e.navigateToView(`${c}/settings`)})}function I6({onSuccess:e,onError:t}){const[i,r]=y.useState(""),[l,c]=y.useState(()=>r6()),u=()=>{try{aw(i),c(!!i),r(""),e?.(i?"API key saved to browser storage":"API key cleared")}catch(d){t?.(d instanceof Error?d.message:"Failed to save API key")}};return a.jsxs("div",{className:"mcc-agent-settings-field",children:[a.jsx("label",{className:"mcc-agent-settings-label",children:"Cursor API Key"}),a.jsx("div",{className:"mcc-agent-settings-hint",children:l?a.jsx("span",{style:{color:"#86efac"},children:" API key is stored in browser"}):a.jsx("span",{children:"Set a custom API key for Cursor agent (stored locally in browser)."})}),a.jsxs("div",{style:{display:"flex",gap:8,marginTop:8},children:[a.jsx("input",{type:"password",value:i,onChange:d=>r(d.target.value),onKeyDown:d=>d.stopPropagation(),placeholder:l?"":"Enter API key",autoComplete:"new-password",style:{flex:1,padding:"10px 12px",background:"#1e293b",border:"1px solid #334155",borderRadius:8,color:"#e2e8f0",fontSize:"14px"}}),a.jsx("button",{onClick:u,style:{padding:"10px 16px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:8,fontSize:"14px",fontWeight:600,cursor:"pointer",whiteSpace:"nowrap"},children:i?"Save":l?"Clear":"Save"})]}),a.jsx("div",{className:"mcc-agent-settings-hint",style:{marginTop:8,fontSize:"12px",color:"#64748b"},children:"Note: The API key will be passed to the agent when starting a new session."})]})}function hw({agentId:e,onRefreshAgents:t}){const[i,r]=y.useState(null),[l,c]=y.useState(""),[u,d]=y.useState(null),[m,f]=y.useState(!0),[v,_]=y.useState(!1),[S,x]=y.useState(""),[b,C]=y.useState(""),T=async()=>{try{const N=await US(e);d(N)}catch{}};y.useEffect(()=>{Promise.all([O1(),eM(e),US(e)]).then(([N,E,z])=>{const B=N.find(I=>I.id===e);r(B||null),c(E.binary_path||""),d(z),f(!1)}).catch(()=>f(!1))},[e]);const k=async()=>{_(!0),C(""),x("");try{await IS(e,l),x("Binary path saved."),t?.(),await T()}catch(N){C(N instanceof Error?N.message:"Failed to save settings")}finally{_(!1)}},R=async()=>{_(!0),C(""),x("");try{await IS(e,""),c(""),x("Binary path cleared. The agent will use the default command."),t?.(),await T()}catch(N){C(N instanceof Error?N.message:"Failed to clear settings")}finally{_(!1)}};return m?a.jsx("div",{className:"mcc-agent-loading",children:"Loading path settings..."}):a.jsxs("div",{children:[a.jsxs("div",{className:"mcc-agent-settings-field",style:{marginBottom:16},children:[a.jsx("label",{className:"mcc-agent-settings-label",children:"Effective Binary Path"}),a.jsx("div",{style:{padding:"10px 12px",background:u?.found?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",border:`1px solid ${u?.found?"rgba(34, 197, 94, 0.3)":"rgba(239, 68, 68, 0.3)"}`,borderRadius:8,fontFamily:"monospace",fontSize:"13px",color:u?.found?"#86efac":"#fca5a5",wordBreak:"break-all"},children:u?.found?u.effective_path:a.jsxs("span",{children:["Not found",u?.error?`: ${u.error}`:""]})})]}),a.jsxs("div",{className:"mcc-agent-settings-field",children:[a.jsx("label",{className:"mcc-agent-settings-label",children:"Custom Binary Path"}),a.jsxs("div",{className:"mcc-agent-settings-hint",children:["Specify a custom path to the ",i?.name||e," binary. Leave empty to use the default command (",i?.command||"unknown",")."]}),a.jsx("input",{type:"text",className:"mcc-agent-settings-input",value:l,onChange:N=>c(N.target.value),placeholder:`e.g. /usr/local/bin/${i?.command||"agent"}`,style:{width:"100%",padding:"10px 12px",background:"#1e293b",border:"1px solid #334155",borderRadius:8,color:"#e2e8f0",fontSize:"14px"}})]}),a.jsxs("div",{className:"mcc-agent-settings-field",style:{marginTop:12},children:[a.jsxs("div",{className:"mcc-agent-settings-hint",children:[a.jsx("strong",{children:"Status:"})," ",i?.installed?a.jsx("span",{style:{color:"#86efac"},children:"Installed"}):a.jsx("span",{style:{color:"#fca5a5"},children:"Not installed"})]}),!i?.installed&&a.jsx("div",{className:"mcc-agent-settings-hint",style:{marginTop:8},children:"The agent binary was not found in PATH. Configure a custom binary path above to specify where the agent is installed."})]}),a.jsxs("div",{className:"mcc-agent-settings-actions",style:{display:"flex",gap:10,marginTop:16},children:[a.jsx("button",{className:"mcc-agent-settings-save-btn",onClick:k,disabled:v,style:{flex:1,padding:"10px 16px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:8,fontSize:"14px",fontWeight:600,cursor:"pointer"},children:v?"Saving...":"Save Path"}),l&&a.jsx("button",{className:"mcc-agent-settings-clear-btn",onClick:R,disabled:v,style:{padding:"10px 16px",background:"#1e293b",color:"#f87171",border:"1px solid #334155",borderRadius:8,fontSize:"14px",cursor:"pointer"},children:"Clear"})]}),b&&a.jsx("div",{className:"mcc-agent-settings-message mcc-agent-settings-error",style:{marginTop:12,padding:"10px 14px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:8,color:"#fca5a5",fontSize:"13px"},children:b}),S&&a.jsx("div",{className:"mcc-agent-settings-message mcc-agent-settings-success",style:{marginTop:12,padding:"10px 14px",background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",borderRadius:8,color:"#86efac",fontSize:"13px"},children:S})]})}function U6({agentId:e,session:t,projectName:i,onBack:r,onRefreshAgents:l}){const[c,u]=y.useState({prompt_append_message:"",followup_append_message:""}),[d,m]=y.useState([]),[f,v]=y.useState(!0),[_,S]=y.useState(!1),[x,b]=y.useState(""),[C,T]=y.useState("");y.useEffect(()=>{if(!t){v(!1);return}Promise.all([JL(t.id),QL(t.id)]).then(([E,z])=>{u(E),m(z),v(!1)}).catch(()=>v(!1))},[t?.id]);const k=async()=>{if(t){S(!0),T(""),b("");try{const E=await ZL(t.id,c);u(E),b("Settings saved")}catch(E){T(E instanceof Error?E.message:"Failed to save settings")}finally{S(!1)}}},R=E=>{T(""),b(E)},N=E=>{b(""),T(E)};return a.jsxs("div",{className:"mcc-agent-view",children:[t?a.jsx(pr,{agentName:t.agent_name,projectName:i,onBack:r}):a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:r,children:""}),a.jsx("h2",{children:"Cursor Settings"})]}),a.jsx("div",{className:"mcc-agent-header",style:{paddingTop:4},children:a.jsx("h2",{children:"Settings"})}),f?a.jsx("div",{className:"mcc-agent-loading",children:"Loading settings..."}):a.jsxs("div",{className:"mcc-agent-settings-form",children:[a.jsx("div",{style:{marginBottom:20,paddingBottom:20,borderBottom:"1px solid #334155"},children:a.jsx(hw,{agentId:e,onRefreshAgents:l})}),a.jsx("div",{style:{marginBottom:20},children:a.jsx(I6,{onSuccess:R,onError:N})}),t?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mcc-agent-settings-field",children:[a.jsx("label",{className:"mcc-agent-settings-label",children:"Prompt Append Message"}),a.jsx("div",{className:"mcc-agent-settings-hint",children:"This text will be appended to every message you type in the chat box before sending."}),a.jsx("textarea",{className:"mcc-agent-settings-textarea",value:c.prompt_append_message,onChange:E=>u(z=>({...z,prompt_append_message:E.target.value})),rows:5,placeholder:"e.g. Always explain your reasoning step by step."}),d.length>0&&a.jsx("div",{className:"mcc-agent-settings-templates",children:d.map(E=>a.jsxs("button",{className:"mcc-agent-settings-template-btn",onClick:()=>u(z=>({...z,prompt_append_message:z.prompt_append_message?z.prompt_append_message+`
`+E.content:E.content})),title:`Append "${E.name}" template`,children:["+ ",E.name]},E.id))})]}),a.jsxs("div",{className:"mcc-agent-settings-field",children:[a.jsx("label",{className:"mcc-agent-settings-label",children:"Followup Append Message"}),a.jsx("div",{className:"mcc-agent-settings-hint",children:"This text will be appended to messages consumed via a followup callback."}),a.jsx("textarea",{className:"mcc-agent-settings-textarea",value:c.followup_append_message,onChange:E=>u(z=>({...z,followup_append_message:E.target.value})),rows:5,placeholder:"e.g. After completing the task, summarize what was done."}),d.length>0&&a.jsx("div",{className:"mcc-agent-settings-templates",children:d.map(E=>a.jsxs("button",{className:"mcc-agent-settings-template-btn",onClick:()=>u(z=>({...z,followup_append_message:z.followup_append_message?z.followup_append_message+`
`+E.content:E.content})),title:`Append "${E.name}" template`,children:["+ ",E.name]},E.id))})]}),a.jsx("div",{className:"mcc-agent-settings-actions",children:a.jsx("button",{className:"mcc-agent-settings-save-btn",onClick:k,disabled:_,children:_?"Saving...":"Save Settings"})})]}):a.jsx("div",{className:"mcc-agent-settings-hint",style:{marginTop:12,fontStyle:"italic",color:"#64748b"},children:"Start a chat session to configure prompt and followup messages."}),C&&a.jsx("div",{className:"mcc-agent-settings-message mcc-agent-settings-error",children:C}),x&&a.jsx("div",{className:"mcc-agent-settings-message mcc-agent-settings-success",children:x})]})]})}function F6(e,t){const i=t?.maxReconnects,r=t?.reconnectDelayMs,[l,c]=y.useState(!1),[u,d]=y.useState([]),[m,f]=y.useState(!1),[v,_]=y.useState(null),[S,x]=y.useState(null),[b,C]=y.useState(!1),[T,k]=y.useState(0),R=y.useRef(null),N=y.useRef(!1),E=y.useRef(null),z=y.useRef([]);E.current=S,z.current=u;const B=y.useCallback(()=>{N.current=!1,R.current?.abort(),R.current=null,c(!1),d([]),f(!1),_(null),x(null),C(!1),k(0)},[]),I=y.useCallback(()=>{N.current=!0,R.current?.abort(),c(!1),C(!1)},[]),q=y.useCallback(async(M,j)=>{try{const A=E.current??void 0,D=j?z.current.length:0;if(j&&(C(!0),await new Promise(ne=>setTimeout(ne,r)),N.current))return!1;R.current=new AbortController;const $=await M(A,D);if(N.current)return!1;C(!1);let W=!1;return await Hs($,{onLog:ne=>{N.current||d(U=>[...U,ne])},onError:ne=>{N.current||d(U=>[...U,ne])},onCustom:ne=>{ne.type==="session"&&ne.session_id&&(x(ne.session_id),E.current=ne.session_id)},onDone:(ne,U)=>{if(W=!0,!N.current){const P=U.success===void 0||U.success==="true",H={ok:P,message:ne||(P?"Completed successfully":"Failed"),publicUrl:U.public_url};_(H),e?.(H)}}}),W}catch(A){if(N.current)return!1;const D=A instanceof Error?A.message:"Connection failed";if((D.includes("fetch")||D.includes("network")||D.includes("connection")||D.includes("abort")||D.includes("timeout"))&&!j)return!1;throw A}},[e,r]),F=y.useCallback(async M=>{N.current=!1,c(!0),_(null),f(!0),k(0);let j=0,A=!1;for(;!A&&!N.current&&j<=i;){j>0&&k(j);try{if(A=await q(M,j>0),!A&&!N.current&&(j++,j>i)){const D={ok:!1,message:`Connection lost. Maximum reconnection attempts (${i}) exceeded.`};_(D),e?.(D);break}}catch(D){if(N.current)break;const W={ok:!1,message:D instanceof Error?D.message:"Action failed"};_(W),e?.(W);break}}c(!1),C(!1)},[i,e,q]),V=y.useCallback(async()=>{E.current&&(C(!0),k(M=>M+1),C(!1))},[]);return[{running:l,logs:u,result:v,showLogs:m,sessionId:S,reconnecting:b,reconnectionCount:T},{run:F,reconnect:V,reset:B,cancel:I}]}function $6({agentId:e,session:t,projectName:i,onBack:r,onRefreshAgents:l}){const[c,u]=y.useState(null),[d,m]=y.useState(null),[f,v]=y.useState({}),[_,S]=y.useState(""),[x,b]=y.useState(""),[C,T]=y.useState(null),[k,R]=y.useState(null),[N,E]=y.useState([]),[z,B]=y.useState(""),[I,q]=y.useState(!0),[F,V]=y.useState(!1),[G,Y]=y.useState(""),[M,j]=y.useState(""),[A,D]=Is(xe=>{xe.ok?Y(xe.message):j(xe.message),setTimeout(()=>{Se()},1e3)}),[$,W]=y.useState(!1),[ne,U]=y.useState(""),[P,H]=y.useState([]),[L,re]=F6(xe=>{xe.ok?(W(!0),xe.publicUrl&&U(xe.publicUrl),Y(xe.message)):j(xe.message),setTimeout(()=>{Se()},1e3)},{maxReconnects:20,reconnectDelayMs:2e3}),me=k?.modelID!==C?.modelID||k?.providerID!==C?.providerID,he=_!==(f.default_domain||"")||x!==(f.web_server?.password||"");y.useEffect(()=>{de()},[t?.id]);const de=async()=>{q(!0);try{const[xe,di,br]=await Promise.all([kp(),FS(),F1()]);v(xe),S(xe.default_domain||""),b(xe.web_server?.password||""),m(di),u(br);let fi=null;if(xe.model){const Kt=xe.model.split("/");Kt.length>=2?fi={providerID:Kt[0],modelID:Kt[1]}:fi={providerID:"",modelID:xe.model}}T(fi),R(fi);try{const Kt=await B1();H(Kt.filter(tn=>tn.available&&(tn.id==="cloudflare_owned"||tn.id==="cloudflare_tunnel")))}catch{}if(t){const[Kt,tn]=await Promise.all([P1(t.id),I1(t.id)]),Us=Kt.model?.modelID?{modelID:Kt.model.modelID,providerID:Kt.model.providerID||""}:null,wr=fi||Us;T(wr),R(wr);const Fs=[];let Ot="";for(const cn of tn.providers){for(const[ie,pe]of Object.entries(cn.models))Fs.push({id:ie,name:pe.name||ie,providerId:cn.id,providerName:cn.name||cn.id,is_default:tn.default?.[cn.id]===ie});tn.default?.[cn.id]&&(Ot=tn.default[cn.id])}Fs.sort((cn,ie)=>{const pe=cn.providerName.localeCompare(ie.providerName);return pe!==0?pe:cn.name.localeCompare(ie.name)}),E(Fs),B(Ot)}}catch(xe){console.error("Failed to load settings:",xe)}finally{q(!1)}},oe=async()=>{if(!(!t||!k)){V(!0),j(""),Y("");try{await H1(t.id,{model:{modelID:k.modelID}}),T(k),v({...f,model:`${k.providerID}/${k.modelID}`}),Y("Model updated successfully")}catch(xe){j(xe instanceof Error?xe.message:"Failed to update model")}finally{V(!1)}}},ye=async()=>{V(!0),j(""),Y("");try{const xe=f.web_server||{enabled:!1,port:4096};await tM({...f,default_domain:_,web_server:{enabled:xe.enabled,port:xe.port,exposed_domain:xe.exposed_domain,password:x}}),v({...f,default_domain:_,web_server:{enabled:xe.enabled,port:xe.port,exposed_domain:xe.exposed_domain,password:x}}),Y("Settings saved successfully")}catch(xe){j(xe instanceof Error?xe.message:"Failed to save settings")}finally{V(!1)}},ue=()=>{R(C?{...C}:null),S(f.default_domain||""),b(f.web_server?.password||""),j(""),Y("")},Se=async()=>{try{const xe=await FS();m(xe)}catch(xe){console.error("Failed to refresh web status:",xe)}},Oe=async xe=>{j(""),Y(""),await D.run(()=>nM(xe))},De=async()=>{j(""),Y(""),await re.run((xe,di)=>iM(void 0,xe,di))},yt=async()=>{j(""),Y("");try{const xe=await sM();xe.success?(W(!1),U(""),Y(xe.message)):j(xe.message)}catch(xe){j(xe instanceof Error?xe.message:"Failed to unmap domain")}};return a.jsxs("div",{className:"mcc-agent-view",children:[t?a.jsx(pr,{agentName:t.agent_name,projectName:i,onBack:r}):a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:r,children:""}),a.jsx("h2",{children:"OpenCode Settings"})]}),a.jsx("div",{className:"mcc-agent-header",style:{paddingTop:4},children:a.jsx("h2",{children:"Settings"})}),I?a.jsx("div",{className:"mcc-agent-loading",children:"Loading settings..."}):a.jsxs("div",{className:"mcc-agent-settings-form",children:[a.jsx("div",{style:{marginBottom:20,paddingBottom:20,borderBottom:"1px solid #334155"},children:a.jsx(hw,{agentId:e,onRefreshAgents:l})}),a.jsxs("div",{className:"mcc-agent-settings-field",style:{marginBottom:20},children:[a.jsx("label",{className:"mcc-agent-settings-label",children:"Login Status"}),a.jsxs("div",{style:{padding:"12px 14px",background:c?.authenticated?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",border:`1px solid ${c?.authenticated?"rgba(34, 197, 94, 0.3)":"rgba(239, 68, 68, 0.3)"}`,borderRadius:8},children:[a.jsx("div",{style:{color:c?.authenticated?"#86efac":"#fca5a5",fontWeight:600,marginBottom:c?.providers?.length?8:0},children:c?.authenticated?" Authenticated":" Not authenticated"}),c?.providers&&c.providers.length>0&&a.jsxs("div",{style:{fontSize:"13px",color:"#94a3b8"},children:[a.jsx("strong",{children:"Providers:"}),a.jsx("ul",{style:{margin:"8px 0 0 0",paddingLeft:20},children:c.providers.map(xe=>a.jsxs("li",{style:{marginBottom:4},children:[xe.name,xe.has_api_key&&a.jsx("span",{style:{color:"#86efac",marginLeft:8},children:"(configured)"})]},xe.name))})]}),!c?.authenticated&&a.jsxs("div",{style:{fontSize:"13px",color:"#94a3b8",marginTop:8},children:["Run ",a.jsx("code",{style:{background:"#1e293b",padding:"2px 6px",borderRadius:4},children:"opencode auth login"})," to authenticate."]})]})]}),a.jsxs("div",{className:"mcc-agent-settings-field",style:{marginBottom:20},children:[a.jsxs("label",{className:"mcc-agent-settings-label",children:["Web Server Status",a.jsx("button",{onClick:Se,style:{marginLeft:8,padding:"2px 8px",fontSize:"12px",background:"transparent",border:"1px solid #475569",borderRadius:4,color:"#94a3b8",cursor:"pointer"},children:"Refresh"})]}),a.jsxs("div",{style:{padding:"12px 14px",background:d?.running?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",border:`1px solid ${d?.running?"rgba(34, 197, 94, 0.3)":"rgba(239, 68, 68, 0.3)"}`,borderRadius:8},children:[a.jsxs("div",{style:{color:d?.running?"#86efac":"#fca5a5",fontWeight:600,marginBottom:8,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("span",{children:d?.running?" Running":" Not running"}),a.jsx("div",{style:{display:"flex",gap:8},children:d?.running?a.jsx("button",{onClick:()=>Oe("stop"),disabled:A.running,style:{padding:"4px 12px",fontSize:"12px",background:"#ef4444",border:"none",borderRadius:4,color:"#fff",fontWeight:500,cursor:A.running?"not-allowed":"pointer",opacity:A.running?.6:1},children:A.running?"Stopping...":"Stop"}):a.jsx("button",{onClick:()=>Oe("start"),disabled:A.running,style:{padding:"4px 12px",fontSize:"12px",background:"#22c55e",border:"none",borderRadius:4,color:"#fff",fontWeight:500,cursor:A.running?"not-allowed":"pointer",opacity:A.running?.6:1},children:A.running?"Starting...":"Start"})})]}),a.jsxs("div",{style:{fontSize:"13px",color:"#94a3b8"},children:[a.jsxs("div",{children:["Port: ",a.jsx("strong",{style:{color:"#e2e8f0"},children:d?.port||"N/A"})]}),d?.domain&&a.jsxs("div",{style:{marginTop:4},children:["Domain: ",a.jsx("strong",{style:{color:"#e2e8f0"},children:d.domain})]}),d?.domain&&a.jsxs("div",{style:{marginTop:4},children:["Port Mapped:",a.jsx("strong",{style:{color:d.port_mapped?"#86efac":"#fca5a5",marginLeft:4},children:d.port_mapped?" Yes":" No"})]})]}),A.showLogs&&a.jsxs("div",{style:{marginTop:12},children:[a.jsx(ii,{lines:A.logs,maxHeight:200}),A.result&&a.jsxs("div",{style:{marginTop:8,padding:"8px 12px",borderRadius:4,fontSize:"13px",background:A.result.ok?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",border:`1px solid ${A.result.ok?"rgba(34, 197, 94, 0.3)":"rgba(239, 68, 68, 0.3)"}`,color:A.result.ok?"#86efac":"#fca5a5"},children:[A.result.ok?" ":" ",A.result.message]})]}),a.jsxs("div",{style:{marginTop:16},children:[a.jsx("label",{className:"mcc-agent-settings-label",children:"Server Password (Optional)"}),a.jsx("div",{className:"mcc-agent-settings-hint",style:{marginBottom:8,fontSize:"13px",color:"#94a3b8"},children:"Password to protect the OpenCode web server with HTTP basic auth"}),a.jsx("input",{type:"password",value:x,onChange:xe=>b(xe.target.value),placeholder:"Enter password...",disabled:F,style:{width:"100%",padding:"10px 12px",background:"#1e293b",border:x!==(f.web_server?.password||"")?"1px solid #3b82f6":"1px solid #334155",borderRadius:8,color:"#e2e8f0",fontSize:"14px"}}),f.web_server?.password&&f.web_server.password!==x&&a.jsx("div",{style:{marginTop:8,fontSize:"13px",color:"#94a3b8"},children:"Password is saved (hidden for security)"})]})]})]}),a.jsxs("div",{style:{marginBottom:20,paddingBottom:20,borderBottom:"1px solid #334155"},children:[a.jsx("h3",{style:{margin:"0 0 16px 0",color:"#e2e8f0",fontSize:"16px"},children:"Configuration"}),a.jsxs("div",{className:"mcc-agent-settings-field",style:{marginBottom:16},children:[a.jsx("label",{className:"mcc-agent-settings-label",children:"Default Domain For Web"}),a.jsx("div",{className:"mcc-agent-settings-hint",style:{marginBottom:8,fontSize:"13px",color:"#94a3b8"},children:'Domain to map the OpenCode web server port (e.g., "your-domain.com")'}),a.jsx("input",{type:"text",value:_,onChange:xe=>S(xe.target.value),placeholder:"Enter domain...",disabled:F,style:{width:"100%",padding:"10px 12px",background:"#1e293b",border:_!==(f.default_domain||"")?"1px solid #3b82f6":"1px solid #334155",borderRadius:8,color:"#e2e8f0",fontSize:"14px"}}),f.default_domain&&f.default_domain!==_&&a.jsxs("div",{style:{marginTop:8,fontSize:"13px",color:"#94a3b8"},children:["Saved: ",a.jsx("strong",{style:{color:"#e2e8f0"},children:f.default_domain})]}),f.default_domain&&P.length>0&&a.jsxs("div",{style:{marginTop:16,padding:"12px",background:"rgba(59, 130, 246, 0.05)",borderRadius:8,border:"1px solid rgba(59, 130, 246, 0.2)"},children:[a.jsxs("div",{style:{fontSize:"13px",color:"#94a3b8",marginBottom:8},children:[a.jsx("strong",{style:{color:"#60a5fa"},children:"Domain Mapping Available"}),a.jsxs("div",{style:{marginTop:4},children:["Your domain ",a.jsx("strong",{style:{color:"#e2e8f0"},children:f.default_domain})," can be mapped via Cloudflare."]})]}),$||d?.port_mapped?a.jsxs("div",{children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[a.jsx("span",{style:{color:"#86efac",fontSize:"13px"},children:" Domain mapped"}),ne&&a.jsx("a",{href:ne,target:"_blank",rel:"noopener noreferrer",style:{fontSize:"13px",color:"#60a5fa",textDecoration:"underline"},children:ne})]}),a.jsx("button",{onClick:yt,disabled:L.running,style:{padding:"6px 12px",fontSize:"12px",background:"transparent",border:"1px solid #ef4444",borderRadius:4,color:"#ef4444",cursor:L.running?"not-allowed":"pointer",opacity:L.running?.6:1},children:L.running?"Removing...":"Remove Mapping"})]}):a.jsxs("div",{children:[a.jsx("button",{onClick:De,disabled:L.running||!d?.running,style:{padding:"6px 12px",fontSize:"12px",background:d?.running?"#3b82f6":"#475569",border:"none",borderRadius:4,color:"#fff",cursor:L.running||!d?.running?"not-allowed":"pointer",opacity:L.running||!d?.running?.6:1},children:L.running?L.reconnecting?`Reconnecting... (${L.reconnectionCount})`:"Mapping...":d?.running?"Map Domain via Cloudflare":"Start Web Server to Map Domain"}),L.showLogs&&L.logs.length>0&&a.jsxs("div",{style:{marginTop:12},children:[a.jsx(ii,{lines:L.logs,maxHeight:200}),L.result&&a.jsxs("div",{style:{marginTop:8,padding:"8px 12px",borderRadius:4,fontSize:"13px",background:L.result.ok?"rgba(34, 197, 94, 0.1)":"rgba(239, 68, 68, 0.1)",border:`1px solid ${L.result.ok?"rgba(34, 197, 94, 0.3)":"rgba(239, 68, 68, 0.3)"}`,color:L.result.ok?"#86efac":"#fca5a5"},children:[L.result.ok?" ":" ",L.result.message]})]})]})]})]}),he&&a.jsxs("div",{style:{marginTop:16,display:"flex",gap:12,padding:"12px",background:"rgba(59, 130, 246, 0.1)",borderRadius:8,border:"1px solid rgba(59, 130, 246, 0.3)"},children:[a.jsx("button",{onClick:ye,disabled:F,style:{flex:1,padding:"10px 16px",background:"#3b82f6",opacity:F?.7:1,border:"none",borderRadius:6,color:"#fff",fontSize:"14px",fontWeight:500,cursor:F?"not-allowed":"pointer"},children:F?"Saving...":"Save Settings"}),a.jsx("button",{onClick:ue,disabled:F,style:{flex:1,padding:"10px 16px",background:"transparent",border:"1px solid #475569",borderRadius:6,color:"#94a3b8",fontSize:"14px",fontWeight:500,cursor:F?"not-allowed":"pointer"},children:"Cancel"})]})]}),a.jsxs("div",{className:"mcc-agent-settings-field",children:[a.jsx("label",{className:"mcc-agent-settings-label",children:"Preferred Model"}),a.jsx("div",{className:"mcc-agent-settings-hint",style:{marginBottom:8},children:"Select the AI model to use for this session."}),a.jsx("div",{style:{border:me?"1px solid #3b82f6":"1px solid #334155",borderRadius:8,padding:"2px"},children:a.jsx(uw,{models:N,currentModel:k||void 0,onSelect:xe=>R(xe),placeholder:N.length===0?"Start a session to see available models":"Select a model...",disabled:F||N.length===0})}),C&&N.length>0&&a.jsxs("div",{style:{marginTop:8,fontSize:"13px",color:"#94a3b8"},children:["Saved: ",a.jsx("strong",{style:{color:"#e2e8f0"},children:N.find(xe=>xe.id===C.modelID&&xe.providerId===C.providerID)?.name||C.modelID}),C.modelID===z&&a.jsx("span",{style:{color:"#64748b",marginLeft:4},children:"(default)"})]})]}),me&&t&&a.jsxs("div",{style:{marginTop:16,display:"flex",gap:12,padding:"12px",background:"rgba(59, 130, 246, 0.1)",borderRadius:8,border:"1px solid rgba(59, 130, 246, 0.3)"},children:[a.jsx("button",{onClick:oe,disabled:F,style:{flex:1,padding:"10px 16px",background:"#3b82f6",opacity:F?.7:1,border:"none",borderRadius:6,color:"#fff",fontSize:"14px",fontWeight:500,cursor:F?"not-allowed":"pointer"},children:F?"Saving...":"Save"}),a.jsx("button",{onClick:ue,disabled:F,style:{flex:1,padding:"10px 16px",background:"transparent",border:"1px solid #475569",borderRadius:6,color:"#94a3b8",fontSize:"14px",fontWeight:500,cursor:F?"not-allowed":"pointer"},children:"Cancel"})]}),M&&a.jsx("div",{className:"mcc-agent-settings-message mcc-agent-settings-error",style:{marginTop:12,padding:"10px 14px",background:"rgba(239, 68, 68, 0.1)",border:"1px solid rgba(239, 68, 68, 0.3)",borderRadius:8,color:"#fca5a5",fontSize:"13px"},children:M}),G&&a.jsx("div",{className:"mcc-agent-settings-message mcc-agent-settings-success",style:{marginTop:12,padding:"10px 14px",background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",borderRadius:8,color:"#86efac",fontSize:"13px"},children:G})]})]})}function yb(){const e=Qt(),{agentId:t}=es();if(!t)return e.navigateToView(""),null;const i=e.sessions[t]||null,r=i?()=>e.navigateToView(t):()=>e.navigateToView("");return t==="opencode"?a.jsx($6,{agentId:t,session:i,projectName:e.projectName,onBack:r,onRefreshAgents:e.onRefreshAgents}):a.jsx(U6,{agentId:t,session:i,projectName:e.projectName,onBack:r,onRefreshAgents:e.onRefreshAgents})}const An={Port:"port",Pid:"pid",Command:"command"},cr={Asc:"asc",Desc:"desc"};function K6({ports:e,loading:t,error:i,forwardedPorts:r,onForwardPort:l,onLsofInstalled:c}){const[u,d]=y.useState(An.Port),[m,f]=y.useState(cr.Asc),[v,_]=y.useState(!1),[S,x]=y.useState([]),[b,C]=y.useState(!1),T=i?.toLowerCase().includes("lsof not installed")||!1,k=async()=>{_(!0),x([]),C(!0);try{const z=await J1("lsof");await Hs(z,{onLog:B=>x(I=>[...I,B]),onError:B=>x(I=>[...I,B]),onDone:B=>{x(I=>[...I,{text:B}]),c?.(),setTimeout(()=>{window.location.reload()},1500)}})}catch(z){x(B=>[...B,{text:String(z),error:!0}])}finally{_(!1)}},R=z=>{u===z?f(m===cr.Asc?cr.Desc:cr.Asc):(d(z),f(cr.Asc))},N=[...e].sort((z,B)=>{let I=0;switch(u){case An.Port:I=z.port-B.port;break;case An.Pid:I=z.pid-B.pid;break;case An.Command:I=z.command.localeCompare(B.command);break}return m===cr.Asc?I:-I}),E=z=>u!==z?"":m===cr.Asc?"":"";return t&&e.length===0?a.jsxs("div",{className:"mcc-lp-loading",children:[a.jsx("div",{className:"mcc-loading-spinner"}),a.jsx("span",{children:"Loading local ports..."})]}):i&&e.length===0?a.jsxs("div",{className:"mcc-lp-error",children:[a.jsxs("div",{className:"mcc-lp-error-content",children:[a.jsx("span",{className:"mcc-lp-error-message",children:i}),T&&a.jsx("div",{className:"mcc-lp-error-actions",children:b?a.jsx("button",{className:"mcc-lp-install-btn",onClick:()=>C(!1),disabled:v,children:"Hide Logs"}):a.jsx("button",{className:"mcc-lp-install-btn",onClick:k,disabled:v,children:v?"Installing...":"Install lsof"})})]}),b&&S.length>0&&a.jsx("div",{className:"mcc-lp-install-logs",children:a.jsx(ii,{lines:S,pending:v,pendingMessage:"Installing lsof...",maxHeight:200})})]}):a.jsxs("div",{className:"mcc-lp-section",children:[a.jsxs("div",{className:"mcc-lp-header",children:[a.jsx("h3",{className:"mcc-lp-title",children:"Local Listening Ports"}),a.jsx("span",{className:"mcc-lp-count",children:e.length})]}),e.length===0?a.jsx("div",{className:"mcc-lp-empty",children:"No listening ports found on this machine."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mcc-lp-sort-bar",children:[a.jsxs("button",{className:`mcc-lp-sort-btn ${u===An.Port?"active":""}`,onClick:()=>R(An.Port),children:["Port ",E(An.Port)]}),a.jsxs("button",{className:`mcc-lp-sort-btn ${u===An.Pid?"active":""}`,onClick:()=>R(An.Pid),children:["PID ",E(An.Pid)]}),a.jsxs("button",{className:`mcc-lp-sort-btn ${u===An.Command?"active":""}`,onClick:()=>R(An.Command),children:["Process ",E(An.Command)]})]}),a.jsx("div",{className:"mcc-lp-list",children:N.map(z=>{const B=r.has(z.port);return a.jsxs("div",{className:"mcc-lp-row",children:[a.jsxs("div",{className:"mcc-lp-row-main",children:[a.jsx("code",{className:"mcc-lp-port-num",children:z.port}),a.jsx("span",{className:"mcc-lp-command",children:z.command}),B?a.jsx("span",{className:"mcc-lp-forwarded-badge",children:"Forwarded"}):a.jsx("button",{className:"mcc-lp-forward-btn",onClick:()=>l(z.port),title:`Forward port ${z.port}`,children:a.jsx(_o,{})})]}),a.jsxs("div",{className:"mcc-lp-row-meta",children:[a.jsxs("span",{className:"mcc-lp-pid",children:["PID ",z.pid]}),a.jsxs("span",{className:"mcc-lp-ppid",children:["PPID ",z.ppid]})]}),z.cmdline&&a.jsx("div",{className:"mcc-lp-cmdline",children:z.cmdline})]},`${z.port}-${z.pid}`)})})]})]})}function q6({ports:e,availableProviders:t,loading:i,error:r,actionError:l,showNewForm:c,onToggleNewForm:u,newPortNumber:d,newPortLabel:m,newPortProvider:f,newPortSubdomain:v,newPortBaseDomain:_,onPortNumberChange:S,onPortLabelChange:x,onPortProviderChange:b,onPortSubdomainChange:C,onPortBaseDomainChange:T,onGenerateSubdomain:k,onAddPort:R,onRemovePort:N,onNavigateToView:E,localPorts:z,localPortsLoading:B,localPortsError:I,onForwardLocalPort:q}){return a.jsxs("div",{className:"mcc-ports",children:[a.jsx("div",{className:"mcc-section-header",children:a.jsx("h2",{children:"Port Forwarding"})}),a.jsx(G6,{onClick:()=>E("diagnostics")}),r&&a.jsxs("div",{className:"mcc-ports-error",children:["Error: ",r]}),l&&a.jsx("div",{className:"mcc-ports-error",children:l}),a.jsx("div",{className:"mcc-ports-subtitle",children:i?"Loading...":`Active Forwards (${e.length})`}),a.jsxs("div",{className:"mcc-ports-list",children:[e.map(F=>a.jsx(J6,{port:F,onRemove:()=>N(F.localPort),onNavigateToView:E},F.localPort)),!i&&e.length===0&&a.jsx("div",{className:"mcc-ports-empty",children:"No port forwards active."})]}),a.jsx("div",{className:"mcc-add-port-section",children:c?a.jsxs("div",{className:"mcc-add-port-form",children:[a.jsxs("div",{className:"mcc-add-port-header",children:[a.jsx("span",{children:"Add Port Forward"}),a.jsx("button",{className:"mcc-close-btn",onClick:u,children:""})]}),a.jsxs("div",{className:"mcc-add-port-fields",children:[a.jsxs("div",{className:"mcc-form-field",children:[a.jsx("label",{children:"Port"}),a.jsx("input",{type:"number",placeholder:"8080",value:d,onChange:F=>S(F.target.value)})]}),a.jsxs("div",{className:"mcc-form-field",children:[a.jsx("label",{children:"Label"}),a.jsx("input",{type:"text",placeholder:"My Service",value:m,onChange:F=>x(F.target.value)})]})]}),a.jsxs("div",{className:"mcc-form-field mcc-provider-field",children:[a.jsx("label",{children:"Provider"}),a.jsx("div",{className:"mcc-provider-options",children:t.filter(F=>F.available).map(F=>a.jsx("button",{className:`mcc-provider-btn ${f===F.id?"active":""}`,onClick:()=>b(F.id),title:F.description,children:F.name},F.id))})]}),(f===an.CloudflareTunnel||f===an.CloudflareOwned)&&a.jsxs(a.Fragment,{children:[a.jsx(W6,{selectedDomain:_,onSelectDomain:T}),a.jsxs("div",{className:"mcc-form-field mcc-subdomain-field",children:[a.jsx("label",{children:"Subdomain"}),a.jsxs("div",{className:"mcc-subdomain-input-group",children:[a.jsx("input",{type:"text",placeholder:"brave-apex-dawn",value:v||"",onChange:F=>C?.(F.target.value),className:"mcc-subdomain-input"}),a.jsx("button",{className:"mcc-generate-btn",onClick:k,title:"Generate random subdomain",type:"button",children:""})]})]}),v&&_&&a.jsxs("div",{className:"mcc-domain-preview",children:[a.jsx("label",{children:"Full Domain"}),a.jsxs("div",{className:"mcc-domain-preview-value",children:[v,".",_]})]})]}),a.jsx("button",{className:"mcc-forward-btn",onClick:R,disabled:!d||(f===an.CloudflareTunnel||f===an.CloudflareOwned)&&!_,children:"Forward"})]}):a.jsxs("button",{className:"mcc-add-port-btn",onClick:u,children:[a.jsx(_o,{}),a.jsx("span",{children:"Add Port Forward"})]})}),a.jsx(K6,{ports:z,loading:B,error:I,forwardedPorts:new Set(e.map(F=>F.localPort)),onForwardPort:q}),a.jsx(V6,{})]})}function W6({selectedDomain:e,onSelectDomain:t}){const[i,r]=y.useState([]),[l,c]=y.useState(!0);return y.useEffect(()=>{c(!0),tw().then(u=>{r(u),u.length>0&&!e&&t?.(u[0])}).catch(()=>{}).finally(()=>c(!1))},[]),l?a.jsxs("div",{className:"mcc-owned-domains-hint",children:[a.jsx("label",{children:"Base Domain"}),a.jsx("div",{className:"mcc-owned-domains-loading",children:"Loading domains..."})]}):i.length===0?null:a.jsxs("div",{className:"mcc-owned-domains-hint",children:[a.jsx("label",{children:"Base Domain"}),a.jsx("div",{className:"mcc-owned-domains-list",children:i.map(u=>a.jsx("button",{className:`mcc-owned-domain-btn ${e===u?"active":""}`,onClick:()=>t?.(u),title:`Use domain: ${u}`,type:"button",children:u},u))}),a.jsx("div",{className:"mcc-owned-domains-note",children:"Select a domain as the base for your subdomain."})]})}function V6(){const[e,t]=y.useState(!1);return a.jsxs("div",{className:"mcc-ports-help",children:[a.jsxs("button",{className:"mcc-ports-help-toggle",onClick:()=>t(!e),children:[a.jsx("span",{className:"mcc-ports-help-icon",children:"?"}),a.jsx("span",{children:"How does port forwarding work?"}),a.jsx("span",{className:`mcc-ports-help-chevron ${e?"expanded":""}`,children:""})]}),e&&a.jsxs("div",{className:"mcc-ports-help-content",children:[a.jsx("p",{children:"Port forwarding creates a secure public URL for a service running on a local port of this machine, making it accessible from anywhere on the internet."}),a.jsxs("div",{className:"mcc-ports-help-steps",children:[a.jsxs("div",{className:"mcc-ports-help-step",children:[a.jsx("span",{className:"mcc-ports-help-step-num",children:"1"}),a.jsxs("span",{children:["You specify a local port (e.g. ",a.jsx("code",{children:"3000"}),") where your app is running."]})]}),a.jsxs("div",{className:"mcc-ports-help-step",children:[a.jsx("span",{className:"mcc-ports-help-step-num",children:"2"}),a.jsx("span",{children:"The server starts a tunnel process to create a public URL."})]}),a.jsxs("div",{className:"mcc-ports-help-step",children:[a.jsx("span",{className:"mcc-ports-help-step-num",children:"3"}),a.jsx("span",{children:"A temporary public URL is assigned that proxies traffic to your local service."})]})]}),a.jsx("p",{children:a.jsx("strong",{children:"Providers:"})}),a.jsxs("div",{className:"mcc-ports-help-provider",children:[a.jsx("strong",{children:"localtunnel"})," (default)",a.jsx("div",{className:"mcc-ports-help-cmd",children:a.jsx("code",{children:"npx localtunnel --port PORT"})}),a.jsxs("span",{children:["Free, no account needed. URL: ",a.jsx("code",{children:"https://xxx.loca.lt"})]})]}),a.jsxs("div",{className:"mcc-ports-help-provider",children:[a.jsx("strong",{children:"Cloudflare Quick Tunnel"}),a.jsx("div",{className:"mcc-ports-help-cmd",children:a.jsx("code",{children:"cloudflared tunnel --url http://127.0.0.1:PORT"})}),a.jsxs("span",{children:["Free via Cloudflare Quick Tunnels. URL: ",a.jsx("code",{children:"https://xxx.trycloudflare.com"})]})]}),a.jsxs("div",{className:"mcc-ports-help-provider",children:[a.jsx("strong",{children:"Cloudflare Named Tunnel"}),a.jsx("div",{className:"mcc-ports-help-cmd",children:a.jsx("code",{children:"cloudflared tunnel route dns TUNNEL random-words.YOUR-DOMAIN"})}),a.jsxs("span",{children:["Uses your own domain with a named Cloudflare tunnel. A random subdomain (e.g. ",a.jsx("code",{children:"brave-lake-fern.your-domain.xyz"}),") is generated for each port to prevent guessing. Requires ",a.jsx("code",{children:"cloudflared"})," setup and ",a.jsx("code",{children:"base_domain"})," in the server config file."]})]}),a.jsxs("div",{className:"mcc-ports-help-provider",children:[a.jsx("strong",{children:"Cloudflare (My Domain)"}),a.jsx("div",{className:"mcc-ports-help-cmd",children:a.jsx("code",{children:"cloudflared tunnel --hostname random-words.YOUR-DOMAIN"})}),a.jsx("span",{children:"Uses your configured owned domain to generate random subdomains. Requires cloudflared authentication and at least one domain configured in Cloudflare Settings."})]}),a.jsxs("p",{className:"mcc-ports-help-note",children:[a.jsx("strong",{children:"Note:"})," localtunnel and Cloudflare Quick tunnels are temporary (URLs change each time, no account needed). Named Cloudflare tunnels use random subdomains on your own domain for security, and require a Cloudflare account with tunnel setup."]})]})]})}function G6({onClick:e}){const{diagnostics:t}=In(),i=t?t.overall==="ok"?"":t.overall==="warning"?"":"":"",r=t?t.overall==="ok"?"Cloudflare: Ready":t.overall==="warning"?"Cloudflare: Warning":"Cloudflare: Issues Found":"Checking...";return a.jsxs("button",{className:`mcc-cf-status-banner mcc-cf-status-${t?.overall??"loading"}`,onClick:e,children:[a.jsx("span",{className:"mcc-cf-status-icon",children:i}),a.jsx("span",{className:"mcc-cf-status-text",children:r}),a.jsx("span",{className:"mcc-cf-status-chevron",children:""})]})}function Y6({onBack:e}){const{diagnostics:t,diagnosticsLoading:i,refreshDiagnostics:r}=In(),l={ok:"#22c55e",warning:"#eab308",error:"#ef4444"};return a.jsxs("div",{className:"mcc-ports",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:e,children:" Back"}),a.jsx("h2",{children:"Cloudflare Diagnostics"})]}),i?a.jsx("div",{className:"mcc-diag-loading",children:"Running diagnostics..."}):t?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:`mcc-diag-overall mcc-diag-overall-${t.overall}`,children:[a.jsx("span",{className:"mcc-diag-overall-icon",children:t.overall==="ok"?"":t.overall==="warning"?"":""}),a.jsx("span",{children:t.overall==="ok"?"All checks passed":t.overall==="warning"?"Some warnings":"Issues found"})]}),a.jsx("div",{className:"mcc-diag-checks",children:t.checks.map(c=>a.jsxs("div",{className:"mcc-diag-check",children:[a.jsxs("div",{className:"mcc-diag-check-header",children:[a.jsx("span",{className:"mcc-diag-check-dot",style:{background:l[c.status]??"#64748b"}}),a.jsx("span",{className:"mcc-diag-check-label",children:c.label}),a.jsx("span",{className:`mcc-diag-check-status mcc-diag-check-status-${c.status}`,children:c.status.toUpperCase()})]}),a.jsx("div",{className:"mcc-diag-check-desc",children:c.description})]},c.id))}),a.jsx("button",{className:"mcc-diag-refresh",onClick:r,children:"Refresh"})]}):a.jsx("div",{className:"mcc-ports-error",children:"Failed to load diagnostics"})]})}function X6({port:e,portData:t,onBack:i}){const[r,l]=y.useState(null),[c,u]=y.useState(!1),d=t?.publicUrl,m=async()=>{if(d){u(!0);try{const C=await fetch(d,{mode:"no-cors"}).catch(()=>null);l(C?{status:"reachable",body:`Got response (opaque due to CORS). Status type: ${C.type}`}:{status:"error",body:"Failed to reach the URL. The tunnel may not be active or the local service is not running."})}catch{l({status:"error",body:"Network error when trying to reach the URL."})}u(!1)}},[f,v]=y.useState([]);y.useEffect(()=>{M1(e).then(C=>v(C)).catch(()=>{})},[e]);const _=f.join(`
`),S=_.includes("allowedHosts")||_.includes("This host")||_.includes("is not allowed"),x=_.includes("failed to start")||_.includes("tunnel exited"),b=_.includes("timeout");return a.jsxs("div",{className:"mcc-ports",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:i,children:" Back"}),a.jsxs("h2",{children:["Diagnose Port ",e]})]}),t&&a.jsxs("div",{className:"mcc-diag-port-info",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Status:"})," ",t.status]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Provider:"})," ",t.provider]}),d&&a.jsxs("div",{children:[a.jsx("strong",{children:"URL:"})," ",a.jsx("a",{href:d,target:"_blank",rel:"noopener noreferrer",children:d})]}),t.error&&a.jsxs("div",{className:"mcc-port-url-error",children:[a.jsx("strong",{children:"Error:"})," ",t.error]})]}),a.jsxs("div",{className:"mcc-diag-checks",children:[S&&a.jsxs("div",{className:"mcc-diag-check",children:[a.jsxs("div",{className:"mcc-diag-check-header",children:[a.jsx("span",{className:"mcc-diag-check-dot",style:{background:"#ef4444"}}),a.jsx("span",{className:"mcc-diag-check-label",children:"Vite Host Blocked"}),a.jsx("span",{className:"mcc-diag-check-status mcc-diag-check-status-error",children:"DETECTED"})]}),a.jsxs("div",{className:"mcc-diag-check-desc",children:["Vite's dev server is blocking requests from the tunnel hostname. Add the following to your ",a.jsx("code",{children:"vite.config.ts"}),":"]}),a.jsx("div",{className:"mcc-ports-help-cmd",style:{margin:"8px 0"},children:a.jsx("code",{children:`server: {
  allowedHosts: true
}`})}),a.jsx("div",{className:"mcc-diag-check-desc",children:"Then restart the Vite dev server."})]}),x&&a.jsxs("div",{className:"mcc-diag-check",children:[a.jsxs("div",{className:"mcc-diag-check-header",children:[a.jsx("span",{className:"mcc-diag-check-dot",style:{background:"#ef4444"}}),a.jsx("span",{className:"mcc-diag-check-label",children:"Tunnel Process Error"}),a.jsx("span",{className:"mcc-diag-check-status mcc-diag-check-status-error",children:"DETECTED"})]}),a.jsx("div",{className:"mcc-diag-check-desc",children:"The tunnel process failed to start or exited unexpectedly. Check the logs below for details."})]}),b&&a.jsxs("div",{className:"mcc-diag-check",children:[a.jsxs("div",{className:"mcc-diag-check-header",children:[a.jsx("span",{className:"mcc-diag-check-dot",style:{background:"#eab308"}}),a.jsx("span",{className:"mcc-diag-check-label",children:"Timeout"}),a.jsx("span",{className:"mcc-diag-check-status mcc-diag-check-status-warning",children:"DETECTED"})]}),a.jsx("div",{className:"mcc-diag-check-desc",children:"The tunnel took too long to establish. This may be a network issue."})]}),!S&&!x&&!b&&t?.status===su.Active&&a.jsxs("div",{className:"mcc-diag-check",children:[a.jsxs("div",{className:"mcc-diag-check-header",children:[a.jsx("span",{className:"mcc-diag-check-dot",style:{background:"#22c55e"}}),a.jsx("span",{className:"mcc-diag-check-label",children:"No issues detected"}),a.jsx("span",{className:"mcc-diag-check-status mcc-diag-check-status-ok",children:"OK"})]}),a.jsxs("div",{className:"mcc-diag-check-desc",children:["The tunnel appears to be running normally. If you're having issues, check that the local service on port ",e," is running."]})]})]}),d&&a.jsx("button",{className:"mcc-diag-refresh",onClick:m,disabled:c,children:c?"Checking...":"Test Connectivity"}),r&&a.jsx("div",{className:`mcc-diag-port-info ${r.status==="error"?"mcc-diag-port-error":""}`,children:r.body}),f.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mcc-ports-subtitle",style:{margin:"16px 16px 8px"},children:"Recent Logs"}),a.jsx("div",{style:{margin:"0 16px 16px"},children:a.jsx(ii,{lines:f.map(C=>({text:C}))})})]})]})}function J6({port:e,onRemove:t,onNavigateToView:i}){const[r,l]=y.useState(!1),[c,u]=y.useState([]),[d,m]=y.useState(!1),f=e.status===su.Active?"":e.status===su.Connecting?"":"",v=()=>{e.publicUrl&&(navigator.clipboard.writeText(e.publicUrl),m(!0),setTimeout(()=>m(!1),1500))};return y.useEffect(()=>{if(!r)return;const _=async()=>{try{let x;e.bootstrap?x=await AL(e.label):x=await M1(e.localPort),u(x)}catch{}};_();const S=setInterval(_,2e3);return()=>clearInterval(S)},[r,e.localPort,e.bootstrap,e.label]),a.jsxs("div",{className:"mcc-port-card",children:[a.jsxs("div",{className:"mcc-port-header",children:[a.jsx("span",{className:"mcc-port-status",children:f}),a.jsxs("span",{className:"mcc-port-number",children:[":",e.localPort]}),a.jsx("span",{className:"mcc-port-arrow",children:""}),a.jsx("span",{className:"mcc-port-label",children:e.label}),a.jsx("span",{className:"mcc-port-provider-badge",children:e.provider}),e.bootstrap&&a.jsx("span",{className:"mcc-port-bootstrap-badge",title:"Started automatically during server bootstrap",children:"Bootstrap"})]}),e.publicUrl?a.jsxs("div",{className:"mcc-port-url",children:[a.jsx("a",{href:e.publicUrl,target:"_blank",rel:"noopener noreferrer",className:"mcc-port-url-link",children:e.publicUrl}),a.jsx("button",{className:"mcc-port-copy-icon",onClick:v,title:"Copy URL",children:d?"":""})]}):e.status===su.Connecting?a.jsx("div",{className:"mcc-port-url mcc-port-url-connecting",children:"Establishing tunnel..."}):e.error?a.jsx("div",{className:"mcc-port-url mcc-port-url-error",children:e.error}):null,a.jsxs("div",{className:"mcc-port-actions",children:[a.jsx("button",{className:`mcc-port-action-btn mcc-port-logs-btn ${r?"active":""}`,onClick:()=>l(!r),children:"Logs"}),a.jsx("button",{className:"mcc-port-action-btn",onClick:()=>i(`port-diagnose/${e.localPort}`),children:"Diagnose"}),a.jsx("button",{className:"mcc-port-action-btn mcc-port-stop",onClick:t,children:"Stop"})]}),r&&a.jsx(ii,{lines:c.map(_=>({text:_})),className:"mcc-port-logs-margin"})]})}function xb(){const{portForwards:{ports:e,providers:t,loading:i,error:r,addPort:l,removePort:c}}=In(),u=Mp(nt.Ports),[d,m]=y.useState(!1),[f,v]=y.useState(""),[_,S]=y.useState(""),[x,b]=y.useState(an.Localtunnel),[C,T]=y.useState(""),[k,R]=y.useState(""),[N,E]=y.useState(null),[z,B]=y.useState({}),I=y.useRef(C),q=y.useRef(x);I.current=C,q.current=x,y.useEffect(()=>{BL().then(M=>B(M)).catch(()=>{})},[]),y.useEffect(()=>{if(!f)return;const M=parseInt(f,10);if(!M||M<=0)return;const j=z[String(M)];if(!j||!(x===an.CloudflareTunnel||x===an.CloudflareOwned))return;const D=j.split(".");if(D.length>=2){const $=D[0],W=D.slice(1).join(".");T($),R(W)}},[f,z,x]);const F=y.useCallback(async M=>{try{const j=M||k||void 0;console.log("[PortsLayout] generateSubdomain called with baseDomain param:",M,"effectiveDomain:",j);const A=await Lu(j),D=A.split(".")[0];console.log("[PortsLayout] Generated subdomain:",D,"from domain:",A),T(D)}catch(j){console.log("[PortsLayout] generateSubdomain error:",j);const A=Math.random().toString(36).substring(2,8);T(A)}},[k]),Y={ports:e,availableProviders:t,loading:i,error:r,actionError:N,showNewForm:d,onToggleNewForm:()=>{const M=!d;console.log("[PortsLayout] onToggleNewForm called, newValue:",M),m(M);const j=q.current;console.log("[PortsLayout] currentProvider from ref:",j),M&&(j===an.CloudflareTunnel||j===an.CloudflareOwned)&&(console.log("[PortsLayout] Generating subdomain on form open"),F(k||void 0))},newPortNumber:f,newPortLabel:_,newPortProvider:x,newPortSubdomain:C,newPortBaseDomain:k,onPortNumberChange:v,onPortLabelChange:S,onPortProviderChange:M=>{b(M),M!==an.CloudflareTunnel&&M!==an.CloudflareOwned&&(T(""),R(""))},onPortSubdomainChange:T,onPortBaseDomainChange:M=>{console.log("[PortsLayout] onPortBaseDomainChange called with:",M),console.log("[PortsLayout] Current state before update:",{newPortBaseDomain:k,newPortSubdomain:C,newPortProvider:x}),R(M),console.log("[PortsLayout] After setNewPortBaseDomain, current ref value:",k);const j=q.current,A=I.current;console.log("[PortsLayout] Ref values - provider:",j,"subdomain:",A),M&&!A&&(j===an.CloudflareTunnel||j===an.CloudflareOwned)&&(console.log("[PortsLayout] Generating subdomain for domain:",M),F(M))},onGenerateSubdomain:()=>F(),onAddPort:async()=>{const M=parseInt(f,10);if(!M||M<=0||M>65535)return;const j=x===an.CloudflareTunnel||x===an.CloudflareOwned,A=!!C,D=!!k,$={port:M,label:_||`Port ${M}`,provider:x};j&&(A&&($.subdomain=C),D&&($.baseDomain=k),A&&D&&($.label=`${C}.${k}`)),console.log("[PortsLayout] Adding port:",{portNum:M,isCloudflareProvider:j,hasSubdomain:A,hasBaseDomain:D,newPortSubdomain:C,newPortBaseDomain:k,newPortLabel:_,req:$});try{if(E(null),j&&A&&D){const W=`${C}.${k}`;try{await OL({port:M,domain:W}),B(ne=>({...ne,[String(M)]:W})),console.log("[PortsLayout] Saved port mapping name before forwarding:",{port:M,domain:W})}catch(ne){console.error("[PortsLayout] Failed to save port mapping name:",ne)}}await l($),m(!1),v(""),S(""),T(""),R("")}catch(W){E(W instanceof Error?W.message:String(W))}},onRemovePort:async M=>{try{E(null),await c(M)}catch(j){E(j instanceof Error?j.message:String(j))}},navigateToView:u};return a.jsx(Na,{context:Y})}function Sb(){const e=Qt(),{localPorts:{ports:t,loading:i,error:r}}=In(),l=c=>{e.onPortNumberChange(c.toString()),e.onPortLabelChange(`Port ${c}`),e.showNewForm||e.onToggleNewForm()};return a.jsx(q6,{ports:e.ports,availableProviders:e.availableProviders,loading:e.loading,error:e.error,actionError:e.actionError,showNewForm:e.showNewForm,onToggleNewForm:e.onToggleNewForm,newPortNumber:e.newPortNumber,newPortLabel:e.newPortLabel,newPortProvider:e.newPortProvider,newPortSubdomain:e.newPortSubdomain,newPortBaseDomain:e.newPortBaseDomain,onPortNumberChange:e.onPortNumberChange,onPortLabelChange:e.onPortLabelChange,onPortProviderChange:e.onPortProviderChange,onPortSubdomainChange:e.onPortSubdomainChange,onPortBaseDomainChange:e.onPortBaseDomainChange,onGenerateSubdomain:e.onGenerateSubdomain,onAddPort:e.onAddPort,onRemovePort:e.onRemovePort,onNavigateToView:e.navigateToView,localPorts:t,localPortsLoading:i,localPortsError:r,onForwardLocalPort:l})}function bb(){const e=Qt();return a.jsx(Y6,{onBack:()=>e.navigateToView("")})}function wb(){const e=Qt(),t=es(),i=parseInt(t.port||"0",10),r=e.ports.find(l=>l.localPort===i);return a.jsx(X6,{port:i,portData:r,onBack:()=>e.navigateToView("")})}function Cb(){const{currentProject:e}=In(),t=Mp(nt.Files);if(!e)return a.jsxs("div",{className:"mcc-files",children:[a.jsx("div",{className:"mcc-section-header",children:a.jsx("h2",{children:"Files"})}),a.jsx("div",{style:{padding:"32px 16px",textAlign:"center",color:"#94a3b8"},children:"Select a project first"})]});const i={projectName:e.name,projectDir:e.dir,sshKeyId:e.ssh_key_id,navigateToView:t};return a.jsx("div",{className:"mcc-files",children:a.jsx(Na,{context:i})})}const fa={Checkpoints:"checkpoints",Browse:"browse",Actions:"actions"};function jb(){const e=Qt(),t=Hn(),i=t.pathname,r=i.includes("/browse"),l=i.includes("/actions"),c=r?fa.Browse:l?fa.Actions:fa.Checkpoints,u=y.useRef("browse");if(r){const d=t.pathname.match(/\/files\/browse(\/.*)?$/);d&&(u.current="browse"+(d[1]||""))}return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mcc-files-subtabs",children:[a.jsx("button",{className:`mcc-files-subtab${c===fa.Checkpoints?" mcc-files-subtab-active":""}`,onClick:()=>e.navigateToView(),children:"Checkpoints"}),a.jsx("button",{className:`mcc-files-subtab${c===fa.Browse?" mcc-files-subtab-active":""}`,onClick:()=>e.navigateToView(u.current),children:"Browse Files"}),a.jsx("button",{className:`mcc-files-subtab${c===fa.Actions?" mcc-files-subtab-active":""}`,onClick:()=>e.navigateToView("actions"),children:"Actions"})]}),a.jsx(Na,{context:e})]})}async function Z6(e){const t=await fetch(`/api/checkpoints?project=${encodeURIComponent(e)}`);if(!t.ok)throw new Error("Failed to fetch checkpoints");return t.json()}async function Q6(e,t){const i=await fetch(`/api/checkpoints?project=${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok)throw new Error("Failed to create checkpoint");return i.json()}async function eB(e,t){const i=await fetch(`/api/checkpoints/${t}?project=${encodeURIComponent(e)}`);if(!i.ok)throw new Error("Failed to fetch checkpoint detail");return i.json()}async function tB(e,t){if(!(await fetch(`/api/checkpoints/${t}?project=${encodeURIComponent(e)}`,{method:"DELETE"})).ok)throw new Error("Failed to delete checkpoint")}async function dw(e,t){const i=await fetch(`/api/checkpoints/current?project=${encodeURIComponent(e)}&project_dir=${encodeURIComponent(t)}`);if(!i.ok)throw new Error("Failed to fetch current changes");return i.json()}async function nB(e,t){const i=await fetch(`/api/checkpoints/${t}/diff?project=${encodeURIComponent(e)}`);if(!i.ok)throw new Error("Failed to fetch diff");return i.json()}async function fw(e,t){const i=await fetch(`/api/checkpoints/current/diff?project=${encodeURIComponent(e)}&project_dir=${encodeURIComponent(t)}`);if(!i.ok)throw new Error("Failed to fetch current diff");return i.json()}async function iB(e,t){let i=`/api/files?project_dir=${encodeURIComponent(e)}&hidden=true`;t&&(i+=`&path=${encodeURIComponent(t)}`);const r=await fetch(i);if(!r.ok)throw new Error("Failed to fetch files");return r.json()}async function sB(e,t){const i=await fetch(`/api/files/content?project_dir=${encodeURIComponent(e)}&path=${encodeURIComponent(t)}`);if(!i.ok)throw new Error("Failed to fetch file content");return(await i.json()).content}const Vc=5,ma=10;function ao({diffs:e}){return e.length===0?a.jsx("div",{className:"diff-empty",children:"No diffs to display"}):a.jsx("div",{className:"diff-viewer",children:e.map(t=>a.jsx(rB,{diff:t},t.path))})}function rB({diff:e}){const t=e.status==="added"?"A":e.status==="deleted"?"D":"M",i=`diff-file-status diff-file-status-${e.status}`,r=e.hunks.reduce((N,E)=>N+E.lines.filter(z=>z.type==="add").length,0),l=e.hunks.reduce((N,E)=>N+E.lines.filter(z=>z.type==="delete").length,0),c=y.useMemo(()=>{let N=0;return e.hunks.flatMap((E,z)=>E.lines.map((B,I)=>({...B,globalIndex:N++,hunkIndex:z,lineInHunk:I})))},[e]),u=c.length,[d,m]=y.useState({startLine:0,endLine:Math.min(Vc,u),totalLines:u}),f=d.startLine,v=d.totalLines-d.endLine,_=f>0,S=v>0,x=d.endLine-d.startLine>Vc,b=()=>{m(N=>({...N,startLine:Math.max(0,N.startLine-ma)}))},C=()=>{m(N=>({...N,endLine:Math.min(N.totalLines,N.endLine+ma)}))},T=()=>{const N=Math.floor((d.startLine+d.endLine)/2),E=Math.floor(Vc/2),z=Math.max(0,N-E),B=Math.min(u,z+Vc);m({startLine:z,endLine:B,totalLines:u})},k=y.useMemo(()=>c.slice(d.startLine,d.endLine),[c,d]),R=y.useMemo(()=>{const N=new Map;return k.forEach(E=>{N.has(E.hunkIndex)||N.set(E.hunkIndex,[]),N.get(E.hunkIndex).push(E)}),N},[k]);return a.jsxs("div",{className:"diff-file-card",children:[a.jsxs("div",{className:"diff-file-header",children:[a.jsx("span",{className:i,children:t}),a.jsx("span",{className:"diff-file-path",children:e.path}),a.jsxs("span",{className:"diff-file-stats",children:[r>0&&a.jsxs("span",{className:"diff-stat-add",children:["+",r]}),l>0&&a.jsxs("span",{className:"diff-stat-del",children:["-",l]})]})]}),e.hunks.length===0?a.jsx("div",{className:"diff-file-empty",children:"Binary file or no content changes"}):a.jsxs("div",{className:"diff-file-content",children:[_&&a.jsxs("button",{className:"diff-load-btn diff-load-above",onClick:b,children:[a.jsx("span",{className:"diff-load-icon",children:""}),a.jsx("span",{className:"diff-load-text",children:f<=ma?`Load ${f} more line${f!==1?"s":""}`:`Load ${ma} more lines`}),a.jsxs("span",{className:"diff-load-count",children:["(",f," above)"]})]}),a.jsx("div",{className:`diff-viewport ${_?"diff-viewport-top-truncated":""} ${S?"diff-viewport-bottom-truncated":""}`,children:e.hunks.map((N,E)=>{const z=R.get(E);return!z||z.length===0?null:a.jsx(aB,{hunk:N,hunkIdx:E,lines:z},E)})}),S&&a.jsxs("button",{className:"diff-load-btn diff-load-below",onClick:C,children:[a.jsx("span",{className:"diff-load-icon",children:""}),a.jsx("span",{className:"diff-load-text",children:v<=ma?`Load ${v} more line${v!==1?"s":""}`:`Load ${ma} more lines`}),a.jsxs("span",{className:"diff-load-count",children:["(",v," below)"]})]}),x&&a.jsxs("button",{className:"diff-collapse-btn",onClick:T,children:[a.jsx("span",{className:"diff-collapse-icon",children:""}),"Show less"]})]})]})}function aB({hunk:e,lines:t}){const i=`@@ -${e.old_start},${e.old_lines} +${e.new_start},${e.new_lines} @@`;return a.jsxs("div",{className:"diff-hunk",children:[a.jsx("div",{className:"diff-hunk-header",children:i}),a.jsx("div",{className:"diff-hunk-lines",children:t.map(r=>a.jsx(lB,{line:r},r.globalIndex))})]})}function lB({line:e}){const t=e.type==="add"?"+":e.type==="delete"?"-":" ",i=`diff-line diff-line-${e.type}`;return a.jsxs("div",{className:i,children:[a.jsx("span",{className:"diff-line-num diff-line-num-old",children:e.old_num||""}),a.jsx("span",{className:"diff-line-num diff-line-num-new",children:e.new_num||""}),a.jsx("span",{className:"diff-line-prefix",children:t}),a.jsx("span",{className:"diff-line-content",children:e.content})]})}function lo(e){const t=`mcc-file-status mcc-file-status-${e}`,i=e==="added"?"A":e==="deleted"?"D":"M";return a.jsx("span",{className:t,children:i})}function oB({projectName:e,projectDir:t,sshKeyId:i,onCreateCheckpoint:r,onSelectCheckpoint:l,onGitCommit:c}){const[u,d]=y.useState([]),[m,f]=y.useState([]),[v,_]=y.useState([]),[S,x]=y.useState(!0),[b,C]=y.useState(!1),[T,k]=y.useState(!1),[R,N]=y.useState(null),[E,z]=y.useState(null);y.useEffect(()=>{x(!0),Promise.all([Z6(e),dw(e,t)]).then(([M,j])=>{d(M||[]),f(j||[]),x(!1)}).catch(()=>x(!1))},[e,t]),y.useEffect(()=>{!b||m.length===0||(k(!0),fw(e,t).then(M=>{_(M||[]),k(!1)}).catch(()=>k(!1)))},[b,e,t,m.length]);const B=async M=>{try{await tB(e,M),d(j=>j.filter(A=>A.id!==M)),N(null)}catch{}},I=(M,j)=>{M.stopPropagation(),N(j)},q=M=>{M.stopPropagation(),N(null)},[F,V]=Is(),G=()=>{V.run(async()=>{z(null);let M;try{M=await Rp(i)}catch(j){throw j instanceof Ma&&z("Server encryption keys not configured."),j}return uA(t,M)})},Y=m.length>0;return a.jsx(a.Fragment,{children:S?a.jsx("div",{className:"mcc-files-empty",children:"Loading..."}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mcc-checkpoint-section-header",children:[a.jsx("span",{className:"mcc-checkpoint-section-label",children:"Current Changes"}),Y&&a.jsx("button",{className:`mcc-diff-toggle-btn ${b?"active":""}`,onClick:()=>C(!b),children:b?"Hide Diffs":"Show Diffs"})]}),Y?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mcc-changed-files-list mcc-changed-files-compact",children:m.map(M=>a.jsxs("div",{className:"mcc-changed-file-item mcc-changed-file-item-readonly",children:[lo(M.status),a.jsx("span",{className:"mcc-changed-file-path",children:M.path})]},M.path))}),b&&a.jsx("div",{className:"mcc-current-diffs",children:T?a.jsx("div",{className:"mcc-files-empty",children:"Loading diffs..."}):a.jsx(ao,{diffs:v})})]}):a.jsx("div",{className:"mcc-files-empty",style:{padding:"12px 16px"},children:"No changes in working tree"}),a.jsx("button",{className:"mcc-create-checkpoint-btn",onClick:r,disabled:!Y,title:Y?void 0:"No changes in working tree",children:a.jsx("span",{children:Y?`+ Create Checkpoint (${m.length} changes)`:"No changes to checkpoint"})}),u.length>0&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mcc-checkpoint-section-label",children:"History"}),a.jsx("div",{className:"mcc-checkpoint-list",children:[...u].reverse().map(M=>a.jsxs("div",{className:"mcc-checkpoint-card",onClick:()=>l(M.id),children:[a.jsxs("div",{className:"mcc-checkpoint-card-header",children:[a.jsx("span",{className:"mcc-checkpoint-name",children:M.name}),a.jsxs("span",{className:"mcc-checkpoint-file-count",children:[M.file_count," file",M.file_count!==1?"s":""]})]}),a.jsxs("div",{className:"mcc-checkpoint-card-meta",children:[a.jsx("span",{children:new Date(M.timestamp).toLocaleString()}),R===M.id?a.jsxs("div",{className:"mcc-checkpoint-delete-confirm",onClick:j=>j.stopPropagation(),children:[a.jsx("span",{className:"mcc-checkpoint-delete-confirm-text",children:"Delete?"}),a.jsx("button",{className:"mcc-checkpoint-delete-confirm-btn mcc-checkpoint-delete-confirm-yes",onClick:j=>{j.stopPropagation(),B(M.id)},children:"Yes"}),a.jsx("button",{className:"mcc-checkpoint-delete-confirm-btn mcc-checkpoint-delete-confirm-no",onClick:q,children:"No"})]}):a.jsx("button",{className:"mcc-checkpoint-delete-btn",onClick:j=>I(j,M.id),children:"Delete"})]})]},M.id))})]}),a.jsxs("div",{className:"mcc-git-actions-column",children:[a.jsx("button",{className:"mcc-git-commit-nav-btn",onClick:c,children:"Git Commit"}),!i&&a.jsx(wa,{message:"SSH key required for git operations. Configure in project settings."}),a.jsx("button",{className:"mcc-git-commit-nav-btn mcc-git-fetch-btn",onClick:G,disabled:F.running||!i,style:{opacity:i?1:.5},children:F.running?"Pulling...":"Git Pull"}),a.jsx(xr,{state:F,pendingMessage:"Pulling...",maxHeight:200})]}),E&&a.jsx("div",{className:"mcc-git-fetch-result error",children:E})]})})}function kb(){const{projectName:e,projectDir:t,sshKeyId:i,navigateToView:r}=Qt();return a.jsx(oB,{projectName:e,projectDir:t,sshKeyId:i,onCreateCheckpoint:()=>r("create-checkpoint"),onSelectCheckpoint:l=>r(`checkpoint/${l}`),onGitCommit:()=>r("git-commit")})}function cB({projectName:e,projectDir:t,onBack:i,onCreated:r}){const[l,c]=y.useState([]),[u,d]=y.useState([]),[m,f]=y.useState(!0),[v,_]=y.useState(new Set),[S,x]=y.useState(""),[b,C]=y.useState(""),[T,k]=y.useState(!1),[R,N]=y.useState(null);y.useEffect(()=>{f(!0),Promise.all([dw(e,t),fw(e,t)]).then(([I,q])=>{const F=I||[];c(F),d(q||[]),_(new Set(F.map(V=>V.path))),f(!1)}).catch(()=>f(!1))},[e,t]);const E=I=>{_(q=>{const F=new Set(q);return F.has(I)?F.delete(I):F.add(I),F})},z=()=>{v.size===l.length?_(new Set):_(new Set(l.map(I=>I.path)))},B=async()=>{if(v.size!==0){k(!0),N(null);try{await Q6(e,{project_dir:t,name:S||void 0,message:b||void 0,file_paths:Array.from(v)}),r()}catch(I){N(I instanceof Error?I.message:"Failed to create checkpoint")}finally{k(!1)}}};return a.jsxs("div",{className:"mcc-files",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:i,children:""}),a.jsx("h2",{children:"New Checkpoint"})]}),m?a.jsx("div",{className:"mcc-files-empty",children:"Scanning for changes..."}):l.length===0?a.jsx("div",{className:"mcc-files-empty",children:"No changes detected in the working tree."}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mcc-files-select-all",children:a.jsxs("label",{children:[a.jsx("input",{type:"checkbox",checked:v.size===l.length,onChange:z}),a.jsxs("span",{children:["Select all (",l.length," file",l.length!==1?"s":"",")"]})]})}),a.jsx("div",{className:"mcc-changed-files-list",children:l.map(I=>a.jsxs("label",{className:"mcc-changed-file-item",children:[a.jsx("input",{type:"checkbox",checked:v.has(I.path),onChange:()=>E(I.path)}),lo(I.status),a.jsx("span",{className:"mcc-changed-file-path",children:I.path})]},I.path))}),u.length>0&&a.jsxs("div",{className:"mcc-create-checkpoint-diffs",children:[a.jsx("div",{className:"mcc-checkpoint-section-label",children:"File Diffs"}),a.jsx(ao,{diffs:u.filter(I=>v.has(I.path))})]})]}),a.jsxs("div",{className:"mcc-checkpoint-form",children:[a.jsx("input",{className:"mcc-checkpoint-name-input",type:"text",placeholder:"Checkpoint name (optional)",value:S,onChange:I=>x(I.target.value)}),a.jsx("textarea",{className:"mcc-checkpoint-message-input",placeholder:"Message (optional)",value:b,onChange:I=>C(I.target.value),rows:3})]}),R&&a.jsx("div",{className:"mcc-checkpoint-error",children:R}),a.jsx("button",{className:"mcc-create-checkpoint-btn",onClick:B,disabled:T||v.size===0,children:T?"Creating...":`Create Checkpoint (${v.size} files)`})]})}function Nb(){const{projectName:e,projectDir:t,navigateToView:i}=Qt();return a.jsx(cB,{projectName:e,projectDir:t,onBack:()=>i(),onCreated:()=>i()})}function uB({projectName:e,checkpointId:t,onBack:i}){const[r,l]=y.useState(null),[c,u]=y.useState([]),[d,m]=y.useState(!0);return y.useEffect(()=>{m(!0),Promise.all([eB(e,t),nB(e,t)]).then(([f,v])=>{l(f),u(v||[]),m(!1)}).catch(()=>m(!1))},[e,t]),a.jsxs("div",{className:"mcc-files",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:i,children:""}),a.jsx("h2",{children:r?.name||`Checkpoint #${t}`})]}),d?a.jsx("div",{className:"mcc-files-empty",children:"Loading..."}):r?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mcc-checkpoint-detail-meta",children:[a.jsx("span",{children:new Date(r.timestamp).toLocaleString()}),a.jsxs("span",{children:[r.files.length," file",r.files.length!==1?"s":""]})]}),a.jsx("div",{className:"mcc-changed-files-list",children:r.files.map(f=>a.jsxs("div",{className:"mcc-changed-file-item mcc-changed-file-item-readonly",children:[lo(f.status),a.jsx("span",{className:"mcc-changed-file-path",children:f.path})]},f.path))}),a.jsx("div",{className:"mcc-checkpoint-section-label",children:"File Diffs"}),a.jsx(ao,{diffs:c})]}):a.jsx("div",{className:"mcc-files-empty",children:"Checkpoint not found."})]})}function Eb(){const{checkpointId:e}=es(),{projectName:t,navigateToView:i}=Qt(),r=parseInt(e||"",10);return isNaN(r)?a.jsx("div",{className:"mcc-files-empty",children:"Invalid checkpoint ID"}):a.jsx(uB,{projectName:t,checkpointId:r,onBack:()=>i()})}function hB({projectDir:e,currentPath:t,sshKeyId:i,showGitOps:r=!0,allowRootNavigation:l=!1,onNavigate:c,onViewFile:u}){const[d,m]=y.useState([]),[f,v]=y.useState(!0),[_,S]=y.useState(null);y.useEffect(()=>{v(!0),iB(e,t||void 0).then(N=>{m(N),v(!1)}).catch(()=>v(!1))},[e,t]);const[x,b]=Is(),C=N=>{b.run(async()=>{S(null);let E;try{E=await Rp(i)}catch(z){throw z instanceof Ma&&S("Server encryption keys not configured."),z}return $L(N,e,E)})},T=N=>{N.is_dir?c(N.path):u(N.path)},k=N=>N<1024?`${N} B`:N<1024*1024?`${(N/1024).toFixed(1)} KB`:`${(N/(1024*1024)).toFixed(1)} MB`,R=t?t.split("/"):[];return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"mcc-filebrowser-breadcrumb",children:[a.jsx("button",{className:"mcc-filebrowser-crumb",onClick:()=>c(""),children:"/"}),R.map((N,E)=>{const z=R.slice(0,E+1).join("/");return a.jsxs("span",{children:[a.jsx("span",{className:"mcc-filebrowser-crumb-sep",children:"/"}),a.jsx("button",{className:"mcc-filebrowser-crumb",onClick:()=>c(z),children:N})]},z)})]}),f?a.jsx("div",{className:"mcc-files-empty",children:"Loading..."}):a.jsxs("div",{className:"mcc-filebrowser-list",children:[(t||l)&&a.jsxs("div",{className:"mcc-filebrowser-entry",onClick:()=>{if(!t)c("..");else{const N=t.includes("/")?t.substring(0,t.lastIndexOf("/")):"";c(N)}},children:[a.jsx("span",{className:"mcc-filebrowser-icon",children:""}),a.jsx("span",{className:"mcc-filebrowser-name",children:".."})]}),d.length===0?a.jsx("div",{className:"mcc-files-empty",children:"Empty directory"}):d.map(N=>a.jsxs("div",{className:"mcc-filebrowser-entry",onClick:()=>T(N),children:[a.jsx("span",{className:"mcc-filebrowser-icon",children:N.is_dir?"":""}),a.jsx("span",{className:"mcc-filebrowser-name",children:N.name}),!N.is_dir&&N.size!==void 0&&a.jsx("span",{className:"mcc-filebrowser-size",children:k(N.size)})]},N.path))]}),r&&a.jsxs("div",{className:"mcc-git-actions-column",children:[!i&&a.jsx(wa,{message:"SSH key required for git operations. Configure in project settings."}),a.jsx("button",{className:"mcc-git-commit-nav-btn mcc-git-fetch-btn",onClick:()=>C(gu.Pull),disabled:x.running||!i,style:{opacity:i?1:.5},children:x.running?"Running...":"Git Pull"}),a.jsx("button",{className:"mcc-git-commit-nav-btn",onClick:()=>C(gu.Push),disabled:x.running||!i,style:{opacity:i?1:.5},children:x.running?"Running...":"Git Push"}),a.jsx(xr,{state:x,pendingMessage:"Running...",maxHeight:200})]}),r&&_&&a.jsx("div",{className:"mcc-git-fetch-result error",children:_})]})}function Gc(){const e=es(),{projectDir:t,sshKeyId:i,navigateToView:r}=Qt(),l=e["*"]||"";return a.jsx(hB,{projectDir:t,currentPath:l,sshKeyId:i,onNavigate:c=>r(c?`browse/${c}`:"browse"),onViewFile:c=>r(`file/${c}`)})}function dB({projectDir:e,filePath:t,onBack:i}){const[r,l]=y.useState(null),[c,u]=y.useState(!0),[d,m]=y.useState(null),[f,v]=y.useState(!0);y.useEffect(()=>{u(!0),m(null),sB(e,t).then(S=>{l(S),u(!1)}).catch(S=>{m(S instanceof Error?S.message:"Failed to load file"),u(!1)})},[e,t]);const _=t.includes("/")?t.substring(t.lastIndexOf("/")+1):t;return a.jsxs("div",{className:"mcc-files",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:i,children:""}),a.jsx("h2",{className:"mcc-file-viewer-title",children:_})]}),a.jsxs("div",{className:"mcc-file-viewer-toolbar",children:[a.jsx("span",{className:"mcc-file-viewer-path-inline",children:t}),a.jsxs("label",{className:"mcc-file-viewer-wrap-toggle",children:[a.jsx("input",{type:"checkbox",checked:f,onChange:S=>v(S.target.checked)}),a.jsx("span",{children:"Wrap"})]})]}),c?a.jsx("div",{className:"mcc-files-empty",children:"Loading file..."}):d?a.jsx("div",{className:"mcc-checkpoint-error",children:d}):a.jsx("div",{className:"mcc-file-viewer-content",children:a.jsx("pre",{className:`mcc-file-viewer-code${f?" mcc-file-viewer-code-wrap":""}`,children:r})})]})}function Tb(){const e=es(),{projectDir:t,navigateToView:i}=Qt(),r=e["*"]||"";return a.jsx(dB,{projectDir:t,filePath:r,onBack:()=>{const l=r.includes("/")?"browse/"+r.substring(0,r.lastIndexOf("/")):"browse";i(l)}})}function fB(e){const t=[],i=e.diff.split(`
`);let r=null,l=0,c=0;for(const u of i){const d=u.match(/^@@ -(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))? @@/);if(d){r={old_start:parseInt(d[1]),old_lines:parseInt(d[2]||"1"),new_start:parseInt(d[3]),new_lines:parseInt(d[4]||"1"),lines:[]},t.push(r),l=r.old_start,c=r.new_start;continue}if(r){if(u.startsWith("+")){const m={type:"add",content:u.substring(1),new_num:c};r.lines.push(m),c++}else if(u.startsWith("-")){const m={type:"delete",content:u.substring(1),old_num:l};r.lines.push(m),l++}else if((u.startsWith(" ")||u==="")&&u.startsWith(" ")){const m={type:"context",content:u.substring(1),old_num:l,new_num:c};r.lines.push(m),l++,c++}}}return{path:e.path,status:e.status,hunks:t}}function mB({projectDir:e,sshKeyId:t,onBack:i}){const[r,l]=y.useState([]),[c,u]=y.useState([]),[d,m]=y.useState(""),[f,v]=y.useState(!0),[_,S]=y.useState(""),[x,b]=y.useState(!1),[C,T]=y.useState(""),[k,R]=y.useState(""),[N,E]=y.useState(!1),[z,B]=y.useState([]),[I,q]=y.useState(!1),[F,V]=y.useState(null),[G,Y]=y.useState({name:"",email:""}),M=y.useRef(null);y.useEffect(()=>{const H=La();Y(H)},[]);const j=async()=>{v(!0),T("");try{const H=await lA(e);m(H.branch),l(H.files.filter(L=>L.isStaged)),u(H.files.filter(L=>!L.isStaged))}catch(H){T(H instanceof Error?H.message:"Failed to get git status")}finally{v(!1)}};y.useEffect(()=>{j()},[e]),y.useEffect(()=>{N&&(q(!0),em(e).then(H=>{const L=H.files.map(fB);B(L),q(!1)}).catch(()=>q(!1)))},[N,e]);const A=async H=>{try{await cu(H,e),await j(),N&&(E(!1),setTimeout(()=>E(!0),100))}catch(L){T(L instanceof Error?L.message:"Failed to stage file")}},D=async H=>{try{await Ux(H,e),await j(),N&&(E(!1),setTimeout(()=>E(!0),100))}catch(L){T(L instanceof Error?L.message:"Failed to unstage file")}},$=async()=>{try{for(const H of c)await cu(H.path,e);await j(),N&&(E(!1),setTimeout(()=>E(!0),100))}catch(H){T(H instanceof Error?H.message:"Failed to stage files")}},W=async()=>{try{for(const H of r)await Ux(H.path,e);await j(),N&&(E(!1),setTimeout(()=>E(!0),100))}catch(H){T(H instanceof Error?H.message:"Failed to unstage files")}},ne=async()=>{if(!_.trim()){T("Commit message is required");return}if(!G.name.trim()){T("Git user name is not configured. Please configure it in Settings > Git Settings > Git Config.");return}if(!G.email.trim()){T("Git user email is not configured. Please configure it in Settings > Git Settings > Git Config.");return}b(!0),T(""),R("");try{const H=await oA(_.trim(),e,{name:G.name,email:G.email});R(H.output||"Committed successfully"),S(""),await j()}catch(H){T(H instanceof Error?H.message:"Failed to commit")}finally{b(!1)}},U=H=>{V(F===H?null:H),N||E(!0)},P=F?z.filter(H=>H.path===F):[];return a.jsxs("div",{className:"mcc-git-commit",children:[a.jsxs("div",{className:"mcc-section-header",children:[a.jsx("button",{className:"mcc-back-btn",onClick:i,children:""}),a.jsx("h2",{children:"Git Commit"}),d&&a.jsx("span",{className:"mcc-git-branch",children:d})]}),f?a.jsx("div",{className:"mcc-files-empty",children:"Loading..."}):a.jsxs(a.Fragment,{children:[C&&a.jsx("div",{className:"mcc-checkpoint-error",children:C}),a.jsxs("div",{className:"mcc-checkpoint-section-header",children:[a.jsxs("span",{className:"mcc-checkpoint-section-label",children:["Staged (",r.length,")"]}),r.length>0&&a.jsx("button",{className:"mcc-git-action-btn",onClick:W,children:"Unstage All"})]}),r.length>0?a.jsx("div",{className:"mcc-changed-files-list",children:r.map(H=>a.jsxs("div",{className:`mcc-changed-file-item${F===H.path?" mcc-changed-file-item-selected":""}`,onClick:()=>U(H.path),children:[lo(H.status),a.jsx("span",{className:"mcc-changed-file-path",children:H.path}),a.jsx("button",{className:"mcc-git-file-action",onClick:L=>{L.stopPropagation(),D(H.path)},children:""})]},`staged-${H.path}`))}):a.jsx("div",{className:"mcc-files-empty",style:{padding:"12px 16px"},children:"No staged changes"}),a.jsxs("div",{className:"mcc-checkpoint-section-header",children:[a.jsxs("span",{className:"mcc-checkpoint-section-label",children:["Unstaged (",c.length,")"]}),c.length>0&&a.jsx("button",{className:"mcc-git-action-btn",onClick:$,children:"Stage All"})]}),c.length>0?a.jsx("div",{className:"mcc-changed-files-list",children:c.map(H=>a.jsxs("div",{className:`mcc-changed-file-item${F===H.path?" mcc-changed-file-item-selected":""}`,onClick:()=>U(H.path),children:[lo(H.status==="untracked"?"added":H.status),a.jsx("span",{className:"mcc-changed-file-path",children:H.path}),a.jsx("button",{className:"mcc-git-file-action",onClick:L=>{L.stopPropagation(),A(H.path)},children:"+"})]},`unstaged-${H.path}`))}):a.jsx("div",{className:"mcc-files-empty",style:{padding:"12px 16px"},children:"No unstaged changes"}),F&&a.jsxs("div",{className:"mcc-git-diff-section",children:[a.jsxs("div",{className:"mcc-checkpoint-section-label",children:["Diff: ",F]}),a.jsx("div",{className:"mcc-current-diffs",children:I?a.jsx("div",{className:"mcc-files-empty",children:"Loading diffs..."}):P.length>0?a.jsx(ao,{diffs:P}):a.jsx("div",{className:"mcc-files-empty",children:"No diff available"})})]}),!F&&(r.length>0||c.length>0)&&a.jsxs("div",{className:"mcc-git-diff-toggle-section",children:[a.jsx("button",{className:`mcc-diff-toggle-btn ${N?"active":""}`,onClick:()=>E(!N),children:N?"Hide All Diffs":"Show All Diffs"}),N&&a.jsx("div",{className:"mcc-current-diffs",style:{marginTop:8},children:I?a.jsx("div",{className:"mcc-files-empty",children:"Loading diffs..."}):z.length>0?a.jsx(ao,{diffs:z}):a.jsx("div",{className:"mcc-files-empty",children:"No diffs available"})})]}),a.jsxs("div",{className:"mcc-git-commit-section",children:[a.jsx("div",{className:"mcc-checkpoint-section-label",children:"Commit Message"}),a.jsxs("div",{className:"mcc-git-commit-form",children:[a.jsx("textarea",{ref:M,className:"mcc-checkpoint-message-input",placeholder:"Enter commit message...",value:_,onChange:H=>S(H.target.value),rows:3}),a.jsx("button",{className:"mcc-git-commit-btn",onClick:ne,disabled:x||r.length===0||!_.trim(),children:x?"Committing...":"Commit"}),k&&a.jsx("div",{className:"mcc-git-success",children:k}),a.jsx("div",{style:{marginTop:12},children:a.jsx(rw,{projectDir:e,sshKeyId:t})})]})]})]})]})}function Rb(){const{projectDir:e,sshKeyId:t,navigateToView:i}=Qt();return a.jsx(mB,{projectDir:e,sshKeyId:t,onBack:()=>i("browse")})}async function pB(e){const t=await fetch(`/api/actions?project=${encodeURIComponent(e)}`);if(!t.ok)throw new Error("Failed to fetch actions");return t.json()}async function gB(e,t){const i=await fetch(`/api/actions?project=${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok)throw new Error("Failed to create action");return i.json()}async function vB(e,t){const i=await fetch(`/api/actions/${t.id}?project=${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!i.ok)throw new Error("Failed to update action");return i.json()}async function _B(e,t){if(!(await fetch(`/api/actions/${t}?project=${encodeURIComponent(e)}`,{method:"DELETE"})).ok)throw new Error("Failed to delete action")}async function yB(e){return fetch("/api/actions/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}const xB=[{value:"",label:"Hammer (Build)"},{value:"",label:"Clipboard (Lint)"},{value:"",label:"Rocket (Deploy)"},{value:"",label:"Play (Run)"},{value:"",label:"Test Tube (Test)"},{value:"",label:"Package (Package)"},{value:"",label:"Sync (Update)"},{value:"",label:"Broom (Clean)"},{value:"",label:"Chart (Analyze)"},{value:"",label:"Gear (Configure)"},{value:"",label:"Search (Find)"},{value:"",label:"Check (Verify)"}];function SB({projectName:e,projectDir:t}){const[i,r]=y.useState([]),[l,c]=y.useState(!0),[u,d]=y.useState(""),[m,f]=y.useState(null),[v,_]=y.useState(!1),[S,x]=y.useState(null),[b,C]=y.useState(""),[T,k]=y.useState(""),[R,N]=y.useState(""),[E,z]=Is();y.useEffect(()=>{B()},[e]);const B=async()=>{c(!0),d("");try{const j=await pB(e);r(j)}catch(j){d(j instanceof Error?j.message:"Failed to load actions")}finally{c(!1)}},I=()=>{C(""),k(""),N(""),f(null),_(!1)},q=()=>{I(),_(!0)},F=j=>{f(j),C(j.name),k(j.icon||""),N(j.script),_(!1)},V=async()=>{if(!b.trim()||!R.trim()){d("Name and script are required");return}d("");try{m?await vB(e,{...m,name:b.trim(),icon:T,script:R.trim()}):await gB(e,{name:b.trim(),icon:T,script:R.trim()}),I(),await B()}catch(j){d(j instanceof Error?j.message:"Failed to save action")}},G=async j=>{if(confirm("Are you sure you want to delete this action?"))try{await _B(e,j),await B()}catch(A){d(A instanceof Error?A.message:"Failed to delete action")}},Y=async j=>{x(j.id);try{await z.run(async()=>yB({project_dir:t,script:j.script}))}finally{x(null)}},M=v||m!==null;return a.jsxs("div",{className:"mcc-actions-view",children:[a.jsxs("div",{className:"mcc-actions-header",children:[a.jsx("h3",{className:"mcc-actions-title",children:"Actions"}),!M&&a.jsx("button",{className:"mcc-actions-add-btn",onClick:q,children:"+ Add Action"})]}),l?a.jsx("div",{className:"mcc-actions-empty",children:"Loading..."}):a.jsxs(a.Fragment,{children:[u&&a.jsx("div",{className:"mcc-actions-error",children:u}),M&&a.jsxs("div",{className:"mcc-actions-form",children:[a.jsxs("div",{className:"mcc-actions-form-row",children:[a.jsx("label",{className:"mcc-actions-form-label",children:"Name"}),a.jsx("input",{type:"text",className:"mcc-actions-form-input",value:b,onChange:j=>C(j.target.value),placeholder:"e.g., Build Project"})]}),a.jsxs("div",{className:"mcc-actions-form-row",children:[a.jsx("label",{className:"mcc-actions-form-label",children:"Icon"}),a.jsx("select",{className:"mcc-actions-form-select",value:T,onChange:j=>k(j.target.value),children:xB.map(j=>a.jsxs("option",{value:j.value,children:[j.value," ",j.label]},j.value))})]}),a.jsxs("div",{className:"mcc-actions-form-row",children:[a.jsx("label",{className:"mcc-actions-form-label",children:"Script"}),a.jsx("textarea",{className:"mcc-actions-form-textarea",value:R,onChange:j=>N(j.target.value),placeholder:`e.g., npm run build
or
go build ./...`,rows:4})]}),a.jsxs("div",{className:"mcc-actions-form-buttons",children:[a.jsx("button",{className:"mcc-actions-form-save",onClick:V,children:"Save"}),a.jsx("button",{className:"mcc-actions-form-cancel",onClick:I,children:"Cancel"})]})]}),!M&&a.jsxs(a.Fragment,{children:[i.length===0?a.jsx("div",{className:"mcc-actions-empty",children:'No actions defined yet. Click "Add Action" to create one.'}):a.jsx("div",{className:"mcc-actions-list",children:i.map(j=>a.jsxs("div",{className:"mcc-action-item",children:[a.jsxs("div",{className:"mcc-action-main",children:[a.jsxs("button",{className:"mcc-action-run-btn",onClick:()=>Y(j),disabled:S===j.id||E.running,children:[a.jsx("span",{className:"mcc-action-icon",children:j.icon||""}),a.jsx("span",{className:"mcc-action-name",children:j.name}),S===j.id&&a.jsx("span",{className:"mcc-action-running",children:"Running..."})]}),a.jsxs("div",{className:"mcc-action-controls",children:[a.jsx("button",{className:"mcc-action-edit-btn",onClick:()=>F(j),title:"Edit",children:""}),a.jsx("button",{className:"mcc-action-delete-btn",onClick:()=>G(j.id),title:"Delete",children:""})]})]}),a.jsx("div",{className:"mcc-action-script-preview",children:a.jsx("code",{children:j.script})})]},j.id))}),(E.running||E.logs.length>0)&&a.jsx("div",{className:"mcc-actions-logs",children:a.jsx(xr,{state:E,pendingMessage:"Running action...",maxHeight:200})})]})]})]})}function Db(){const e=Qt();return a.jsx(SB,{projectName:e.projectName,projectDir:e.projectDir})}const Su=y.lazy(()=>Lb(()=>import("./MockupsPage-C6XuI1tw.js"),__vite__mapDeps([0,1])).then(e=>({default:e.MockupsPage})));function bB(){return a.jsxs("div",{className:"home-container",children:[a.jsxs("div",{className:"home-hero",children:[a.jsx("img",{src:"/ai-critic.svg",alt:"AI Critic",className:"home-logo"}),a.jsx("h1",{className:"home-title",children:"AI Critic"}),a.jsx("p",{className:"home-subtitle",children:"Intelligent code review powered by AI"}),a.jsxs("div",{className:"home-actions",children:[a.jsx(Bs,{to:"/v1",className:"home-btn home-btn-primary",children:"Start Code Review"}),a.jsx(Bs,{to:"/v1/gen",className:"home-btn home-btn-secondary",children:"Code Generator"})]})]}),a.jsxs("div",{className:"home-features",children:[a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:""}),a.jsx("h3",{children:"Smart Reviews"}),a.jsx("p",{children:"AI-powered code analysis that catches issues before they reach production"})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:""}),a.jsx("h3",{children:"Diff Viewer"}),a.jsx("p",{children:"Visual diff comparison with syntax highlighting and inline comments"})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:""}),a.jsx("h3",{children:"Terminal"}),a.jsx("p",{children:"Built-in terminal for quick command execution without leaving the app"})]}),a.jsxs("div",{className:"feature-card",children:[a.jsx("div",{className:"feature-icon",children:""}),a.jsx("h3",{children:"Mobile Ready"}),a.jsx("p",{children:"Responsive design that works seamlessly on desktop and mobile devices"})]})]})]})}function wB(){return a.jsxs("div",{style:{textAlign:"center",padding:"50px"},children:[a.jsx("h1",{children:"About"}),a.jsx("p",{children:"This is a generic about page."}),a.jsx(Bs,{to:"/v1",style:{fontSize:"18px",color:"#646cff",textDecoration:"none"},children:"Back to Home"})]})}function CB(){return a.jsx(RL,{children:a.jsxs(Gb,{children:[a.jsx(ve,{path:"/",element:a.jsx(fA,{})}),a.jsx(ve,{path:"/home",element:a.jsx(bB,{})}),a.jsx(ve,{path:"/about",element:a.jsx(wB,{})}),a.jsx(ve,{path:"/gen",element:a.jsx(_N,{})}),Su&&a.jsx(ve,{path:"/mockups/*",element:a.jsx(y.Suspense,{fallback:a.jsx("div",{style:{padding:20,textAlign:"center"},children:"Loading mockups..."}),children:a.jsx(Su,{})})})]})})}const Si={Loading:"loading",Authenticated:"authenticated",Unauthenticated:"unauthenticated",NotInitialized:"not_initialized"};function jB(){const[e,t]=y.useState(Si.Loading);return y.useEffect(()=>{EM().then(i=>{i===va.Authenticated?t(Si.Authenticated):i===va.NotInitialized?t(Si.NotInitialized):t(Si.Unauthenticated)}).catch(()=>{t(Si.Authenticated)})},[]),e===Si.Loading?null:e===Si.NotInitialized?a.jsx(PM,{onSetupComplete:()=>t(Si.Unauthenticated)}):e===Si.Unauthenticated?a.jsx(zM,{onLoginSuccess:()=>t(Si.Authenticated)}):a.jsx(rM,{children:a.jsx(Na,{})})}function kB(){return a.jsx(L1,{children:a.jsx(oN,{children:a.jsxs(Gb,{children:[Su&&a.jsx(ve,{path:"/mockups/*",element:a.jsx(y.Suspense,{fallback:a.jsx("div",{style:{padding:20,textAlign:"center"},children:"Loading mockups..."}),children:a.jsx(Su,{})})}),a.jsx(ve,{path:"/v1/*",element:a.jsx(CB,{})}),a.jsxs(ve,{path:"/",element:a.jsx(jB,{}),children:[a.jsx(ve,{index:!0,element:a.jsx(Ok,{to:"home",replace:!0})}),a.jsxs(ve,{element:a.jsx($S,{}),children:[a.jsxs(ve,{path:"home",children:[a.jsx(ve,{index:!0,element:a.jsx(JS,{})}),a.jsx(ve,{path:"diagnose",element:a.jsx(KS,{})}),a.jsx(ve,{path:"settings",element:a.jsx(GS,{})}),a.jsx(ve,{path:"settings/export",element:a.jsx(eb,{})}),a.jsx(ve,{path:"settings/import",element:a.jsx(ib,{})}),a.jsx(ve,{path:"settings/cloudflare",element:a.jsx(VS,{})}),a.jsx(ve,{path:"settings/git",element:a.jsx(qS,{})}),a.jsx(ve,{path:"settings/logs",element:a.jsx(ZS,{})}),a.jsx(ve,{path:"clone-repo",element:a.jsx(YS,{})}),a.jsx(ve,{path:"add-from-filesystem",element:a.jsx(ub,{})}),a.jsx(ve,{path:"upload-file",element:a.jsx(lb,{})}),a.jsx(ve,{path:"download-file",element:a.jsx(ob,{})}),a.jsx(ve,{path:"manage-server",element:a.jsx(cb,{})}),a.jsx(ve,{path:"ssh-servers",element:a.jsx(XS,{})})]}),a.jsxs(ve,{path:"agent",element:a.jsx(db,{}),children:[a.jsx(ve,{index:!0,element:a.jsx(fb,{})}),a.jsx(ve,{path:":agentId",element:a.jsx(pb,{})}),a.jsx(ve,{path:":agentId/settings",element:a.jsx(yb,{})}),a.jsx(ve,{path:":agentId/:sessionId",element:a.jsx(_b,{})})]}),a.jsx(ve,{path:"terminal",element:a.jsx(hb,{})}),a.jsxs(ve,{path:"ports",element:a.jsx(xb,{}),children:[a.jsx(ve,{index:!0,element:a.jsx(Sb,{})}),a.jsx(ve,{path:"diagnostics",element:a.jsx(bb,{})}),a.jsx(ve,{path:"port-diagnose/:port",element:a.jsx(wb,{})})]}),a.jsxs(ve,{path:"files",element:a.jsx(Cb,{}),children:[a.jsxs(ve,{element:a.jsx(jb,{}),children:[a.jsx(ve,{index:!0,element:a.jsx(kb,{})}),a.jsx(ve,{path:"browse",element:a.jsx(Gc,{})}),a.jsx(ve,{path:"browse/*",element:a.jsx(Gc,{})}),a.jsx(ve,{path:"actions",element:a.jsx(Db,{})})]}),a.jsx(ve,{path:"create-checkpoint",element:a.jsx(Nb,{})}),a.jsx(ve,{path:"checkpoint/:checkpointId",element:a.jsx(Eb,{})}),a.jsx(ve,{path:"file/*",element:a.jsx(Tb,{})}),a.jsx(ve,{path:"git-commit",element:a.jsx(Rb,{})})]})]}),a.jsxs(ve,{path:"project/:projectName",element:a.jsx($S,{}),children:[a.jsx(ve,{index:!0,element:a.jsx(Z5,{})}),a.jsxs(ve,{path:"home",children:[a.jsx(ve,{index:!0,element:a.jsx(JS,{})}),a.jsx(ve,{path:"diagnose",element:a.jsx(KS,{})}),a.jsx(ve,{path:"settings",element:a.jsx(GS,{})}),a.jsx(ve,{path:"settings/export",element:a.jsx(eb,{})}),a.jsx(ve,{path:"settings/import",element:a.jsx(ib,{})}),a.jsx(ve,{path:"settings/cloudflare",element:a.jsx(VS,{})}),a.jsx(ve,{path:"settings/git",element:a.jsx(qS,{})}),a.jsx(ve,{path:"settings/logs",element:a.jsx(ZS,{})}),a.jsx(ve,{path:"clone-repo",element:a.jsx(YS,{})}),a.jsx(ve,{path:"add-from-filesystem",element:a.jsx(ub,{})}),a.jsx(ve,{path:"upload-file",element:a.jsx(lb,{})}),a.jsx(ve,{path:"download-file",element:a.jsx(ob,{})}),a.jsx(ve,{path:"manage-server",element:a.jsx(cb,{})}),a.jsx(ve,{path:"manage-files",element:a.jsx(V5,{})}),a.jsx(ve,{path:"ssh-servers",element:a.jsx(XS,{})})]}),a.jsxs(ve,{path:"agent",element:a.jsx(db,{}),children:[a.jsx(ve,{index:!0,element:a.jsx(fb,{})}),a.jsx(ve,{path:":agentId",element:a.jsx(pb,{})}),a.jsx(ve,{path:":agentId/settings",element:a.jsx(yb,{})}),a.jsx(ve,{path:":agentId/:sessionId",element:a.jsx(_b,{})})]}),a.jsx(ve,{path:"terminal",element:a.jsx(hb,{})}),a.jsxs(ve,{path:"ports",element:a.jsx(xb,{}),children:[a.jsx(ve,{index:!0,element:a.jsx(Sb,{})}),a.jsx(ve,{path:"diagnostics",element:a.jsx(bb,{})}),a.jsx(ve,{path:"port-diagnose/:port",element:a.jsx(wb,{})})]}),a.jsxs(ve,{path:"files",element:a.jsx(Cb,{}),children:[a.jsxs(ve,{element:a.jsx(jb,{}),children:[a.jsx(ve,{index:!0,element:a.jsx(kb,{})}),a.jsx(ve,{path:"browse",element:a.jsx(Gc,{})}),a.jsx(ve,{path:"browse/*",element:a.jsx(Gc,{})}),a.jsx(ve,{path:"actions",element:a.jsx(Db,{})})]}),a.jsx(ve,{path:"create-checkpoint",element:a.jsx(Nb,{})}),a.jsx(ve,{path:"checkpoint/:checkpointId",element:a.jsx(Eb,{})}),a.jsx(ve,{path:"file/*",element:a.jsx(Tb,{})}),a.jsx(ve,{path:"git-commit",element:a.jsx(Rb,{})})]})]})]})]})})})}const Ab={App:kB};window.__KOOL_COMPONENTS={...Ab,renderComponent:(e,t,i)=>{const r=Ab[t];if(!r){console.error(`Component ${t} not found`);return}zj.createRoot(e).render(a.jsx(y.StrictMode,{children:a.jsx(r,{...i})}))}};const NB=new URLSearchParams(window.location.search),EB=NB.get("component")||"App";window.__KOOL_COMPONENTS.renderComponent(document.getElementById("root"),EB,{});export{Bs as L,Gb as R,es as a,TB as b,rt as c,ve as d,a as j,y as r,dt as u};
